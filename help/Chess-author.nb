(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    784867,      16057]
NotebookOptionsPosition[    779515,      15895]
NotebookOutlinePosition[    781144,      15945]
CellTagsIndexPosition[    780800,      15933]
WindowFrame->Normal
ContainsDynamic->True *)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Chess", "DemoTitle",
 CellChangeTimes->{
  3.35696210375764*^9, 3.41558754676676*^9, 3.415985786081662*^9, {
   3.4161627448221607`*^9, 3.4161627449784107`*^9}, {3.4194431396198015`*^9, 
   3.419443140511083*^9}}],

Cell[CellGroupData[{

Cell["", "InitializationSection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"version", " ", "1.0"}], ":", " ", 
     RowBox[{"basic", " ", "chess", " ", "implemented"}]}], ",", " ", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"version", " ", "1.1"}], ":", " ", 
     RowBox[{"several", " ", "bugs", " ", "corrected"}]}], ",", " ", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"version", " ", "1.2"}], ":", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"-", " ", "buttons"}], " ", "\"\<random Black\>\""}]}], ",", 
    " ", "\"\<random White\>\"", ",", " ", 
    RowBox[{"\"\<show moves\>\"", " ", "added"}], ",", " ", 
    "\[IndentingNewLine]", " ", 
    RowBox[{
     RowBox[{"-", " ", "input"}], " ", "during", " ", "history", " ", 
     "blocked"}], ",", "\[IndentingNewLine]", " ", 
    RowBox[{
     RowBox[{"-", " ", "king"}], " ", "moves", " ", "now", " ", "all", " ", 
     "legal"}], ",", " ", "\[IndentingNewLine]", " ", 
    RowBox[{
     RowBox[{"-", " ", "bug"}], " ", 
     RowBox[{"(", 
      RowBox[{"when", " ", "Black", " ", "starts"}], ")"}], " ", 
     "corrected"}], ",", "\[IndentingNewLine]", " ", 
    RowBox[{"-", " ", 
     RowBox[{"details", " ", "text", " ", "updated"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"version", " ", "1.3"}], ":", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"-", " ", "bug"}], " ", 
      RowBox[{"corrected", ":", " ", 
       RowBox[{
       "If", " ", "King", " ", "was", " ", "attacked", " ", "by", " ", "a", 
        " ", "diagonally", " ", "adjacent", " ", "Bishop"}]}]}]}], ",", " ", 
    RowBox[{
    "the", " ", "King", " ", "could", " ", "not", " ", "be", " ", "moved", 
     " ", "\[IndentingNewLine]", " ", "orthogonally", " ", "next", " ", "to", 
     " ", "the", " ", "Bishop"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"-", " ", "now"}], " ", "all", " ", "moves", " ", "are", " ", 
     "suppressed", " ", "which", " ", "leave", " ", "your", " ", "own", " ", 
     "King", " ", "attacked"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"-", " ", "move"}], " ", "notation", " ", "\"\<+\>\"", " ", 
     "for", " ", "\"\<check!\>\"", " ", "introduced"}], ",", " ", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"-", " ", "program"}], " ", "now", " ", "recognizes", " ", "and",
      " ", "announces", " ", "\"\<mate\>\"", " ", "and", " ", 
     "\"\<stalemate\>\""}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"-", " ", "colours"}], " ", "for", " ", "white", " ", "and", " ",
      "black", " ", "pieces", " ", "can", " ", "now", " ", "be", " ", 
     "selected", " ", "separately"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"-", " ", "red"}], " ", "colour", " ", "for", " ", "white", " ", 
     "pieces", " ", "improved"}], ",", "  ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"-", " ", "size"}], " ", "of", " ", "Pawns", " ", "slightly", 
     " ", "reduced", " ", "to", " ", "give", " ", "them", " ", "a", " ", 
     "more", " ", "natural", " ", "look"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"-", " ", "details"}], " ", "text", " ", "updated"}], ","}], 
   "\[IndentingNewLine]", "*)"}], "          ", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"square", "[", 
      RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
     RowBox[{"Polygon", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "-", "1"}], ",", 
          RowBox[{"y", "-", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "-", "1"}], ",", "y"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"y", "-", "1"}]}], "}"}]}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", " ", "chess"}]}]}]}]}], " ", "piece", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"diagrams", " ", "--"}], "--"}], "--"}], "--"}]}], "-"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rook", "=", 
     RowBox[{"Polygon", "[", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.1", ",", "0.1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".9", ",", "0.1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".9", ",", "0.3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".7", ",", "0.5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".9", ",", "0.7"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".9", ",", "0.9"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".1", ",", ".9"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".1", ",", "0.7"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".3", ",", "0.5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".1", ",", "0.3"}], "}"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"knight", "=", 
     RowBox[{"Polygon", "[", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.1", ",", "0.1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".9", ",", "0.1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".9", ",", "0.4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".6", ",", "0.4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".6", ",", "0.6"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".9", ",", "0.7"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".9", ",", ".9"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".4", ",", ".9"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".4", ",", ".4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".1", ",", ".4"}], "}"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"bishop", "=", 
     RowBox[{"Polygon", "[", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.1", ",", "0.1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".9", ",", "0.1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".5", ",", ".9"}], "}"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"queen", "=", 
     RowBox[{"Polygon", "[", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.1", ",", "0.1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".9", ",", "0.1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".6", ",", "0.4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".8", ",", "0.7"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".5", ",", "0.9"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".2", ",", "0.7"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".4", ",", ".4"}], "}"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"king", "=", 
     RowBox[{"Polygon", "[", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.1", ",", "0.1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".9", ",", "0.1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".9", ",", "0.9"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".7", ",", "0.7"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".5", ",", "0.9"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".3", ",", "0.7"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{".1", ",", "0.9"}], "}"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pawn", "=", 
     RowBox[{"Disk", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", ".5"}], ",", 
         RowBox[{"-", ".5"}]}], "}"}], ",", ".35"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"-", " ", "board"}]}]}]}]}]}]}]}]}]}], " ", 
     RowBox[{"setup", ":", " ", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", "-"}]}]}]}]}]}], "  ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pp", "=", "1"}], ";", 
    RowBox[{"rr", "=", "2"}], ";", 
    RowBox[{"nn", "=", "3"}], ";", 
    RowBox[{"bb", "=", "4"}], ";", 
    RowBox[{"qq", "=", "5"}], ";", 
    RowBox[{"kk", "=", "6"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"names", "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\< \>\"", ",", "\"\<R\>\"", ",", "\"\<N\>\"", ",", "\"\<B\>\"", ",", 
       "\"\<Q\>\"", ",", "\"\<K\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]",
    
   RowBox[{
    RowBox[{"alpha", "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<a\>\"", ",", "\"\<b\>\"", ",", "\"\<c\>\"", ",", "\"\<d\>\"", ",", 
       "\"\<e\>\"", ",", "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<h\>\"", 
       ",", "\"\<...\>\""}], "}"}]}], " ", ";"}], "  ", "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"type0", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "rr", ",", "pp", ",", "0", ",", "0", ",", "0", ",", "0", ",", "pp", 
         ",", "rr"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "nn", ",", "pp", ",", "0", ",", "0", ",", "0", ",", "0", ",", "pp", 
         ",", "nn"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "bb", ",", "pp", ",", "0", ",", "0", ",", "0", ",", "0", ",", "pp", 
         ",", "bb"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "qq", ",", "pp", ",", "0", ",", "0", ",", "0", ",", "0", ",", "pp", 
         ",", "qq"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "kk", ",", "pp", ",", "0", ",", "0", ",", "0", ",", "0", ",", "pp", 
         ",", "kk"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "bb", ",", "pp", ",", "0", ",", "0", ",", "0", ",", "0", ",", "pp", 
         ",", "bb"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "nn", ",", "pp", ",", "0", ",", "0", ",", "0", ",", "0", ",", "pp", 
         ",", "nn"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "rr", ",", "pp", ",", "0", ",", "0", ",", "0", ",", "0", ",", "pp", 
         ",", "rr"}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"all0", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         "0"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         "0"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         "0"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         "0"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         "0"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         "0"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         "0"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         "0"}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"side0", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"list0", "=", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "}"}]}], ";"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{"list", " ", "of", " ", "potential", " ", "moves"}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", "  ", "chess"}]}]}]}]}]}]}], " ", 
     RowBox[{"board", " ", ":", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", "--"}]}]}]}]}]}]}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"board", " ", "=", " ", "\[IndentingNewLine]", "   ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"RGBColor", "[", 
        RowBox[{".7", ",", ".7", ",", ".5"}], "]"}], ",", 
       RowBox[{"Polygon", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"8", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"8", ",", "8"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "8"}], "}"}]}], "}"}], "]"}], ",", 
       "\[IndentingNewLine]", "LightBrown", ",", "\[IndentingNewLine]", 
       RowBox[{"square", "[", 
        RowBox[{"2", ",", "1"}], "]"}], ",", 
       RowBox[{"square", "[", 
        RowBox[{"4", ",", "1"}], "]"}], ",", 
       RowBox[{"square", "[", 
        RowBox[{"6", ",", "1"}], "]"}], ",", 
       RowBox[{"square", "[", 
        RowBox[{"8", ",", "1"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"square", "[", 
        RowBox[{"1", ",", "2"}], "]"}], ",", 
       RowBox[{"square", "[", 
        RowBox[{"3", ",", "2"}], "]"}], ",", 
       RowBox[{"square", "[", 
        RowBox[{"5", ",", "2"}], "]"}], ",", 
       RowBox[{"square", "[", 
        RowBox[{"7", ",", "2"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"square", "[", 
        RowBox[{"2", ",", "3"}], "]"}], ",", 
       RowBox[{"square", "[", 
        RowBox[{"4", ",", "3"}], "]"}], ",", 
       RowBox[{"square", "[", 
        RowBox[{"6", ",", "3"}], "]"}], ",", 
       RowBox[{"square", "[", 
        RowBox[{"8", ",", "3"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"square", "[", 
        RowBox[{"1", ",", "4"}], "]"}], ",", 
       RowBox[{"square", "[", 
        RowBox[{"3", ",", "4"}], "]"}], ",", 
       RowBox[{"square", "[", 
        RowBox[{"5", ",", "4"}], "]"}], ",", 
       RowBox[{"square", "[", 
        RowBox[{"7", ",", "4"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"square", "[", 
        RowBox[{"2", ",", "5"}], "]"}], ",", 
       RowBox[{"square", "[", 
        RowBox[{"4", ",", "5"}], "]"}], ",", 
       RowBox[{"square", "[", 
        RowBox[{"6", ",", "5"}], "]"}], ",", 
       RowBox[{"square", "[", 
        RowBox[{"8", ",", "5"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"square", "[", 
        RowBox[{"1", ",", "6"}], "]"}], ",", 
       RowBox[{"square", "[", 
        RowBox[{"3", ",", "6"}], "]"}], ",", 
       RowBox[{"square", "[", 
        RowBox[{"5", ",", "6"}], "]"}], ",", 
       RowBox[{"square", "[", 
        RowBox[{"7", ",", "6"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"square", "[", 
        RowBox[{"2", ",", "7"}], "]"}], ",", 
       RowBox[{"square", "[", 
        RowBox[{"4", ",", "7"}], "]"}], ",", 
       RowBox[{"square", "[", 
        RowBox[{"6", ",", "7"}], "]"}], ",", 
       RowBox[{"square", "[", 
        RowBox[{"8", ",", "7"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"square", "[", 
        RowBox[{"1", ",", "8"}], "]"}], ",", 
       RowBox[{"square", "[", 
        RowBox[{"3", ",", "8"}], "]"}], ",", 
       RowBox[{"square", "[", 
        RowBox[{"5", ",", "8"}], "]"}], ",", 
       RowBox[{"square", "[", 
        RowBox[{"7", ",", "8"}], "]"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"GrayLevel", "[", ".5", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "8"}], "}"}]}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "1", ",", "7"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "y"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"8", ",", "y"}], "}"}]}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", "1", ",", "7"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "Black", ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "8"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"8", ",", "8"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"8", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Blue", ",", "Thick"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", ".1"}], ",", 
            RowBox[{"-", ".1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", ".1"}], ",", "8.1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"8.1", ",", "8.1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"8.1", ",", 
            RowBox[{"-", ".1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", ".1"}], ",", 
            RowBox[{"-", ".1"}]}], "}"}]}], "}"}], "]"}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"check", "[", 
      RowBox[{"si_", ",", "ty_", ",", "x_", ",", "y_", ",", "n_"}], "]"}], ":=",
      "  ", 
     RowBox[{"(*", " ", 
      RowBox[{"is", " ", "the", " ", "position", " ", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], " ", 
       RowBox[{"attacked", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "sw", "}"}], ",", "  ", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"in", ":", " ", "x"}], ",", "y", ",", " ", 
         RowBox[{
          RowBox[{"also", " ", "n"}], "=", 
          RowBox[{"1", " ", "for", " ", "player", " ", "white"}]}], ",", " ", 
         
         RowBox[{
          RowBox[{"n", "=", 
           RowBox[{
            RowBox[{"-", "1"}], " ", "for", " ", "player", " ", "black"}]}], 
          ";", " ", 
          RowBox[{"out", ":", " ", "swattacked"}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sw", "=", "False"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"check", " ", "for", " ", "pawn", " ", 
          RowBox[{"attack", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "<", "8"}], "\[And]", 
           RowBox[{
            RowBox[{"n", "*", "y"}], "<", 
            RowBox[{"4", "+", 
             RowBox[{"n", "*", "3"}]}]}], "\[And]", 
           RowBox[{
            RowBox[{"si", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"x", "+", "1"}], ",", 
               RowBox[{"y", "+", "n"}]}], "]"}], "]"}], "\[Equal]", 
            RowBox[{"-", "n"}]}], "\[And]", 
           RowBox[{
            RowBox[{"ty", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"x", "+", "1"}], ",", 
               RowBox[{"y", "+", "n"}]}], "]"}], "]"}], "\[Equal]", "pp"}]}], 
          ",", 
          RowBox[{"sw", "=", "True"}]}], "]"}], ";", "\[IndentingNewLine]", 
        " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"x", ">", "1"}], "\[And]", 
           RowBox[{
            RowBox[{"n", "*", "y"}], "<", 
            RowBox[{"4", "+", 
             RowBox[{"n", "*", "3"}]}]}], "\[And]", 
           RowBox[{
            RowBox[{"si", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"x", "-", "1"}], ",", 
               RowBox[{"y", "+", "n"}]}], "]"}], "]"}], "\[Equal]", 
            RowBox[{"-", "n"}]}], "\[And]", 
           RowBox[{
            RowBox[{"ty", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"x", "-", "1"}], ",", 
               RowBox[{"y", "+", "n"}]}], "]"}], "]"}], "\[Equal]", "pp"}]}], 
          ",", 
          RowBox[{"sw", "=", "True"}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"check", " ", "for", " ", "knight", " ", 
          RowBox[{"attack", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "<", "8"}], "\[And]", 
           RowBox[{"y", ">", "2"}], "\[And]", 
           RowBox[{
            RowBox[{"si", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"x", "+", "1"}], ",", 
               RowBox[{"y", "-", "2"}]}], "]"}], "]"}], "\[Equal]", 
            RowBox[{"-", "n"}]}], "\[And]", 
           RowBox[{
            RowBox[{"ty", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"x", "+", "1"}], ",", 
               RowBox[{"y", "-", "2"}]}], "]"}], "]"}], "\[Equal]", "nn"}]}], 
          ",", 
          RowBox[{"sw", "=", "True"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "<", "8"}], "\[And]", 
           RowBox[{"y", "<", "7"}], "\[And]", 
           RowBox[{
            RowBox[{"si", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"x", "+", "1"}], ",", 
               RowBox[{"y", "+", "2"}]}], "]"}], "]"}], "\[Equal]", 
            RowBox[{"-", "n"}]}], "\[And]", 
           RowBox[{
            RowBox[{"ty", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"x", "+", "1"}], ",", 
               RowBox[{"y", "+", "2"}]}], "]"}], "]"}], "\[Equal]", "nn"}]}], 
          ",", 
          RowBox[{"sw", "=", "True"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"x", ">", "1"}], "\[And]", 
           RowBox[{"y", ">", "2"}], "\[And]", 
           RowBox[{
            RowBox[{"si", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"x", "-", "1"}], ",", 
               RowBox[{"y", "-", "2"}]}], "]"}], "]"}], "\[Equal]", 
            RowBox[{"-", "n"}]}], "\[And]", 
           RowBox[{
            RowBox[{"ty", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"x", "-", "1"}], ",", 
               RowBox[{"y", "-", "2"}]}], "]"}], "]"}], "\[Equal]", "nn"}]}], 
          ",", 
          RowBox[{"sw", "=", "True"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"x", ">", "1"}], "\[And]", 
           RowBox[{"y", "<", "7"}], "\[And]", 
           RowBox[{
            RowBox[{"si", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"x", "-", "1"}], ",", 
               RowBox[{"y", "+", "2"}]}], "]"}], "]"}], "\[Equal]", 
            RowBox[{"-", "n"}]}], "\[And]", 
           RowBox[{
            RowBox[{"ty", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"x", "-", "1"}], ",", 
               RowBox[{"y", "+", "2"}]}], "]"}], "]"}], "\[Equal]", "nn"}]}], 
          ",", 
          RowBox[{"sw", "=", "True"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "<", "7"}], "\[And]", 
           RowBox[{"y", ">", "1"}], "\[And]", 
           RowBox[{
            RowBox[{"si", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"x", "+", "2"}], ",", 
               RowBox[{"y", "-", "1"}]}], "]"}], "]"}], "\[Equal]", 
            RowBox[{"-", "n"}]}], "\[And]", 
           RowBox[{
            RowBox[{"ty", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"x", "+", "2"}], ",", 
               RowBox[{"y", "-", "1"}]}], "]"}], "]"}], "\[Equal]", "nn"}]}], 
          ",", 
          RowBox[{"sw", "=", "True"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "<", "7"}], "\[And]", 
           RowBox[{"y", "<", "8"}], "\[And]", 
           RowBox[{
            RowBox[{"si", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"x", "+", "2"}], ",", 
               RowBox[{"y", "+", "1"}]}], "]"}], "]"}], "\[Equal]", 
            RowBox[{"-", "n"}]}], "\[And]", 
           RowBox[{
            RowBox[{"ty", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"x", "+", "2"}], ",", 
               RowBox[{"y", "+", "1"}]}], "]"}], "]"}], "\[Equal]", "nn"}]}], 
          ",", 
          RowBox[{"sw", "=", "True"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"x", ">", "2"}], "\[And]", 
           RowBox[{"y", ">", "1"}], "\[And]", 
           RowBox[{
            RowBox[{"si", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"x", "-", "2"}], ",", 
               RowBox[{"y", "-", "1"}]}], "]"}], "]"}], "\[Equal]", 
            RowBox[{"-", "n"}]}], "\[And]", 
           RowBox[{
            RowBox[{"ty", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"x", "-", "2"}], ",", 
               RowBox[{"y", "-", "1"}]}], "]"}], "]"}], "\[Equal]", "nn"}]}], 
          ",", 
          RowBox[{"sw", "=", "True"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"x", ">", "2"}], "\[And]", 
           RowBox[{"y", "<", "8"}], "\[And]", 
           RowBox[{
            RowBox[{"si", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"x", "-", "2"}], ",", 
               RowBox[{"y", "+", "1"}]}], "]"}], "]"}], "\[Equal]", 
            RowBox[{"-", "n"}]}], "\[And]", 
           RowBox[{
            RowBox[{"ty", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"x", "-", "2"}], ",", 
               RowBox[{"y", "+", "1"}]}], "]"}], "]"}], "\[Equal]", "nn"}]}], 
          ",", 
          RowBox[{"sw", "=", "True"}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "check", " ", "for", " ", "bishop", " ", "and", " ", "queen", " ", 
          RowBox[{"attack", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"7", "-", "x"}], ",", 
             RowBox[{"7", "-", "y"}]}], "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"si", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"x", "+", "i"}], ",", 
                RowBox[{"y", "+", "i"}]}], "]"}], "]"}], "\[NotEqual]", "0"}],
             ",", 
            RowBox[{"Break", "[", "]"}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "\[LessEqual]", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"8", "-", "x"}], ",", 
              RowBox[{"8", "-", "y"}]}], "]"}]}], "\[And]", 
           RowBox[{
            RowBox[{"si", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"x", "+", "i"}], ",", 
               RowBox[{"y", "+", "i"}]}], "]"}], "]"}], "\[Equal]", 
            RowBox[{"-", "n"}]}], "\[And]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"ty", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"x", "+", "i"}], ",", 
                 RowBox[{"y", "+", "i"}]}], "]"}], "]"}], "\[Equal]", "qq"}], 
             "\[Or]", 
             RowBox[{
              RowBox[{"ty", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"x", "+", "i"}], ",", 
                 RowBox[{"y", "+", "i"}]}], "]"}], "]"}], "\[Equal]", 
              "bb"}]}], ")"}]}], ",", 
          RowBox[{"sw", "=", "True"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"x", "-", "1"}], ",", 
             RowBox[{"7", "-", "y"}]}], "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"si", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"x", "-", "i"}], ",", 
                RowBox[{"y", "+", "i"}]}], "]"}], "]"}], "\[NotEqual]", "0"}],
             ",", 
            RowBox[{"Break", "[", "]"}]}], " ", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "\[LessEqual]", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"x", "-", "1"}], ",", 
              RowBox[{"8", "-", "y"}]}], "]"}]}], "\[And]", 
           RowBox[{
            RowBox[{"si", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"x", "-", "i"}], ",", 
               RowBox[{"y", "+", "i"}]}], "]"}], "]"}], "\[Equal]", 
            RowBox[{"-", "n"}]}], "\[And]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"ty", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"x", "-", "i"}], ",", 
                 RowBox[{"y", "+", "i"}]}], "]"}], "]"}], "\[Equal]", "qq"}], 
             "\[Or]", 
             RowBox[{
              RowBox[{"ty", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"x", "-", "i"}], ",", 
                 RowBox[{"y", "+", "i"}]}], "]"}], "]"}], "\[Equal]", 
              "bb"}]}], ")"}]}], ",", 
          RowBox[{"sw", "=", "True"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"7", "-", "x"}], ",", 
             RowBox[{"y", "-", "1"}]}], "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"si", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"x", "+", "i"}], ",", 
                RowBox[{"y", "-", "i"}]}], "]"}], "]"}], "\[NotEqual]", "0"}],
             ",", 
            RowBox[{"Break", "[", "]"}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "\[LessEqual]", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"8", "-", "x"}], ",", 
              RowBox[{"y", "-", "1"}]}], "]"}]}], "\[And]", 
           RowBox[{
            RowBox[{"si", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"x", "+", "i"}], ",", 
               RowBox[{"y", "-", "i"}]}], "]"}], "]"}], "\[Equal]", 
            RowBox[{"-", "n"}]}], "\[And]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"ty", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"x", "+", "i"}], ",", 
                 RowBox[{"y", "-", "i"}]}], "]"}], "]"}], "\[Equal]", "qq"}], 
             "\[Or]", 
             RowBox[{
              RowBox[{"ty", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"x", "+", "i"}], ",", 
                 RowBox[{"y", "-", "i"}]}], "]"}], "]"}], "\[Equal]", 
              "bb"}]}], ")"}]}], ",", 
          RowBox[{"sw", "=", "True"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"x", "-", "1"}], ",", 
             RowBox[{"y", "-", "1"}]}], "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"si", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"x", "-", "i"}], ",", 
                RowBox[{"y", "-", "i"}]}], "]"}], "]"}], "\[NotEqual]", "0"}],
             ",", 
            RowBox[{"Break", "[", "]"}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "\[LessEqual]", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"x", "-", "1"}], ",", 
              RowBox[{"y", "-", "1"}]}], "]"}]}], "\[And]", 
           RowBox[{
            RowBox[{"si", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"x", "-", "i"}], ",", 
               RowBox[{"y", "-", "i"}]}], "]"}], "]"}], "\[Equal]", 
            RowBox[{"-", "n"}]}], "\[And]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"ty", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"x", "-", "i"}], ",", 
                 RowBox[{"y", "-", "i"}]}], "]"}], "]"}], "\[Equal]", "qq"}], 
             "\[Or]", 
             RowBox[{
              RowBox[{"ty", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"x", "-", "i"}], ",", 
                 RowBox[{"y", "-", "i"}]}], "]"}], "]"}], "\[Equal]", 
              "bb"}]}], ")"}]}], ",", 
          RowBox[{"sw", "=", "True"}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "check", " ", "for", " ", "rook", " ", "and", " ", "queen", " ", 
          RowBox[{"attack", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"7", "-", "x"}]}], ",", 
          RowBox[{"i", "++"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"si", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"x", "+", "i"}], ",", "y"}], "]"}], "]"}], 
             "\[NotEqual]", "0"}], ",", 
            RowBox[{"Break", "[", "]"}]}], "]"}]}], "]"}], ";", 
        "             ", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "\[LessEqual]", 
            RowBox[{"8", "-", "x"}]}], "\[And]", 
           RowBox[{
            RowBox[{"si", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"x", "+", "i"}], ",", "y"}], "]"}], "]"}], "\[Equal]", 
            
            RowBox[{"-", "n"}]}], "\[And]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"ty", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"x", "+", "i"}], ",", "y"}], "]"}], "]"}], 
              "\[Equal]", "qq"}], "\[Or]", 
             RowBox[{
              RowBox[{"ty", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"x", "+", "i"}], ",", "y"}], "]"}], "]"}], 
              "\[Equal]", "rr"}]}], ")"}]}], ",", 
          RowBox[{"sw", "=", "True"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"x", "-", "1"}]}], ",", 
          RowBox[{"i", "++"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"si", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"x", "-", "i"}], ",", "y"}], "]"}], "]"}], 
             "\[NotEqual]", "0"}], ",", 
            RowBox[{"Break", "[", "]"}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "\[LessEqual]", 
            RowBox[{"x", "-", "1"}]}], "\[And]", 
           RowBox[{
            RowBox[{"si", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"x", "-", "i"}], ",", "y"}], "]"}], "]"}], "\[Equal]", 
            
            RowBox[{"-", "n"}]}], "\[And]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"ty", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"x", "-", "i"}], ",", "y"}], "]"}], "]"}], 
              "\[Equal]", "qq"}], "\[Or]", 
             RowBox[{
              RowBox[{"ty", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"x", "-", "i"}], ",", "y"}], "]"}], "]"}], 
              "\[Equal]", "rr"}]}], ")"}]}], ",", 
          RowBox[{"sw", "=", "True"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"7", "-", "y"}]}], ",", 
          RowBox[{"i", "++"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"si", "[", 
              RowBox[{"[", 
               RowBox[{"x", ",", 
                RowBox[{"y", "+", "i"}]}], "]"}], "]"}], "\[NotEqual]", "0"}],
             ",", 
            RowBox[{"Break", "[", "]"}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "\[LessEqual]", 
            RowBox[{"8", "-", "y"}]}], "\[And]", 
           RowBox[{
            RowBox[{"si", "[", 
             RowBox[{"[", 
              RowBox[{"x", ",", 
               RowBox[{"y", "+", "i"}]}], "]"}], "]"}], "\[Equal]", 
            RowBox[{"-", "n"}]}], "\[And]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"ty", "[", 
               RowBox[{"[", 
                RowBox[{"x", ",", 
                 RowBox[{"y", "+", "i"}]}], "]"}], "]"}], "\[Equal]", "qq"}], 
             "\[Or]", 
             RowBox[{
              RowBox[{"ty", "[", 
               RowBox[{"[", 
                RowBox[{"x", ",", 
                 RowBox[{"y", "+", "i"}]}], "]"}], "]"}], "\[Equal]", 
              "rr"}]}], ")"}]}], ",", 
          RowBox[{"sw", "=", "True"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"y", "-", "1"}]}], ",", 
          RowBox[{"i", "++"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"si", "[", 
              RowBox[{"[", 
               RowBox[{"x", ",", 
                RowBox[{"y", "-", "i"}]}], "]"}], "]"}], "\[NotEqual]", "0"}],
             ",", 
            RowBox[{"Break", "[", "]"}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "\[LessEqual]", 
            RowBox[{"y", "-", "1"}]}], "\[And]", 
           RowBox[{
            RowBox[{"si", "[", 
             RowBox[{"[", 
              RowBox[{"x", ",", 
               RowBox[{"y", "-", "i"}]}], "]"}], "]"}], "\[Equal]", 
            RowBox[{"-", "n"}]}], "\[And]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"ty", "[", 
               RowBox[{"[", 
                RowBox[{"x", ",", 
                 RowBox[{"y", "-", "i"}]}], "]"}], "]"}], "\[Equal]", "qq"}], 
             "\[Or]", 
             RowBox[{
              RowBox[{"ty", "[", 
               RowBox[{"[", 
                RowBox[{"x", ",", 
                 RowBox[{"y", "-", "i"}]}], "]"}], "]"}], "\[Equal]", 
              "rr"}]}], ")"}]}], ",", 
          RowBox[{"sw", "=", "True"}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"check", " ", "for", " ", "king", " ", 
          RowBox[{"attack", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "<", "8"}], "\[And]", 
           RowBox[{
            RowBox[{"si", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"x", "+", "1"}], ",", "y"}], "]"}], "]"}], "\[Equal]", 
            
            RowBox[{"-", "n"}]}], "\[And]", 
           RowBox[{
            RowBox[{"ty", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"x", "+", "1"}], ",", "y"}], "]"}], "]"}], "\[Equal]", 
            "kk"}]}], ",", 
          RowBox[{"sw", "=", "True"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"x", ">", "1"}], "\[And]", 
           RowBox[{
            RowBox[{"si", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"x", "-", "1"}], ",", "y"}], "]"}], "]"}], "\[Equal]", 
            
            RowBox[{"-", "n"}]}], "\[And]", 
           RowBox[{
            RowBox[{"ty", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"x", "-", "1"}], ",", "y"}], "]"}], "]"}], "\[Equal]", 
            "kk"}]}], ",", 
          RowBox[{"sw", "=", "True"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"y", "<", "8"}], "\[And]", 
           RowBox[{
            RowBox[{"si", "[", 
             RowBox[{"[", 
              RowBox[{"x", ",", 
               RowBox[{"y", "+", "1"}]}], "]"}], "]"}], "\[Equal]", 
            RowBox[{"-", "n"}]}], "\[And]", 
           RowBox[{
            RowBox[{"ty", "[", 
             RowBox[{"[", 
              RowBox[{"x", ",", 
               RowBox[{"y", "+", "1"}]}], "]"}], "]"}], "\[Equal]", "kk"}]}], 
          ",", 
          RowBox[{"sw", "=", "True"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"y", ">", "1"}], "\[And]", 
           RowBox[{
            RowBox[{"si", "[", 
             RowBox[{"[", 
              RowBox[{"x", ",", 
               RowBox[{"y", "-", "1"}]}], "]"}], "]"}], "\[Equal]", 
            RowBox[{"-", "n"}]}], "\[And]", 
           RowBox[{
            RowBox[{"ty", "[", 
             RowBox[{"[", 
              RowBox[{"x", ",", 
               RowBox[{"y", "-", "1"}]}], "]"}], "]"}], "\[Equal]", "kk"}]}], 
          ",", 
          RowBox[{"sw", "=", "True"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "<", "8"}], "\[And]", 
           RowBox[{"y", "<", "8"}], "\[And]", 
           RowBox[{
            RowBox[{"si", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"x", "+", "1"}], ",", 
               RowBox[{"y", "+", "1"}]}], "]"}], "]"}], "\[Equal]", 
            RowBox[{"-", "n"}]}], "\[And]", 
           RowBox[{
            RowBox[{"ty", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"x", "+", "1"}], ",", 
               RowBox[{"y", "+", "1"}]}], "]"}], "]"}], "\[Equal]", "kk"}]}], 
          ",", 
          RowBox[{"sw", "=", "True"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"x", ">", "1"}], "\[And]", 
           RowBox[{"y", ">", "1"}], "\[And]", 
           RowBox[{
            RowBox[{"si", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"x", "-", "1"}], ",", 
               RowBox[{"y", "-", "1"}]}], "]"}], "]"}], "\[Equal]", 
            RowBox[{"-", "n"}]}], "\[And]", 
           RowBox[{
            RowBox[{"ty", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"x", "-", "1"}], ",", 
               RowBox[{"y", "-", "1"}]}], "]"}], "]"}], "\[Equal]", "kk"}]}], 
          ",", 
          RowBox[{"sw", "=", "True"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "<", "8"}], "\[And]", 
           RowBox[{"y", ">", "1"}], "\[And]", 
           RowBox[{
            RowBox[{"si", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"x", "+", "1"}], ",", 
               RowBox[{"y", "-", "1"}]}], "]"}], "]"}], "\[Equal]", 
            RowBox[{"-", "n"}]}], "\[And]", 
           RowBox[{
            RowBox[{"ty", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"x", "+", "1"}], ",", 
               RowBox[{"y", "-", "1"}]}], "]"}], "]"}], "\[Equal]", "kk"}]}], 
          ",", 
          RowBox[{"sw", "=", "True"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"x", ">", "1"}], "\[And]", 
           RowBox[{"y", "<", "8"}], "\[And]", 
           RowBox[{
            RowBox[{"si", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"x", "-", "1"}], ",", 
               RowBox[{"y", "+", "1"}]}], "]"}], "]"}], "\[Equal]", 
            RowBox[{"-", "n"}]}], "\[And]", 
           RowBox[{
            RowBox[{"ty", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"x", "-", "1"}], ",", 
               RowBox[{"y", "+", "1"}]}], "]"}], "]"}], "\[Equal]", "kk"}]}], 
          ",", 
          RowBox[{"sw", "=", "True"}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "sw"}]}], "   ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "return", " ", "this", " ", "value", " ", "as", " ", "result"}], " ", 
       "*)"}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.35696210375764*^9, 3.4196182287979155`*^9, {3.4196182943722067`*^9, 
   3.419618300921624*^9}, {3.4196184640962577`*^9, 3.4196184955114307`*^9}, {
   3.419618564961294*^9, 3.4196185690271406`*^9}, {3.419618825716242*^9, 
   3.4196188294516125`*^9}, 3.419619198031605*^9, {3.419619551640069*^9, 
   3.41961955303207*^9}, {3.419619689598443*^9, 3.4196196918316545`*^9}, 
   3.419619835167762*^9, {3.41961990763196*^9, 3.4196199100153875`*^9}, {
   3.419620289551133*^9, 3.4196203301795535`*^9}, {3.419620443552576*^9, 
   3.4196204509732466`*^9}, 3.4196206900770607`*^9, {3.4196208456507645`*^9, 
   3.4196209105540915`*^9}, {3.4196209669752207`*^9, 
   3.4196209924518547`*^9}, {3.419621039199074*^9, 3.419621041943019*^9}, {
   3.419621080268128*^9, 3.419621081930518*^9}, {3.4196211373902655`*^9, 
   3.4196211413159103`*^9}, {3.4196211772676067`*^9, 
   3.4196211785694785`*^9}, {3.4196212200591373`*^9, 3.419621221220808*^9}, {
   3.419621343156142*^9, 3.419621359048995*^9}, {3.4196218462695837`*^9, 
   3.4196218511365824`*^9}, 3.419621940525117*^9, 3.419622080115838*^9, {
   3.419622827911115*^9, 3.4196228305749454`*^9}, {3.4197177886864643`*^9, 
   3.4197178272519183`*^9}, {3.4197200615947456`*^9, 3.4197201176253138`*^9}, 
   3.419722297539877*^9, {3.4197223855063667`*^9, 3.419722393828333*^9}, {
   3.419723215950486*^9, 3.4197232278876514`*^9}, {3.419723428275795*^9, 
   3.4197234286963997`*^9}, 3.419723769866979*^9, 3.419728843081904*^9, {
   3.4197294964814463`*^9, 3.4197294973426847`*^9}, 3.419729587171853*^9, {
   3.4197296240448737`*^9, 3.419729628561368*^9}, 3.4197298122955647`*^9, {
   3.419729889696862*^9, 3.419729892811341*^9}, {3.4197425820557327`*^9, 
   3.419742591309038*^9}, {3.419747412231184*^9, 3.419747414304165*^9}, {
   3.4197475765674877`*^9, 3.4197475780596333`*^9}, {3.4197484580249615`*^9, 
   3.41974845838548*^9}, {3.4197489236244607`*^9, 3.419748973105611*^9}, {
   3.419749098505928*^9, 3.4197491384233265`*^9}, {3.4197495775848093`*^9, 
   3.419749600497757*^9}, {3.419826713761987*^9, 3.419826715524522*^9}, {
   3.420101834604499*^9, 3.4201018373985167`*^9}, {3.420102044175848*^9, 
   3.4201020576051583`*^9}, 3.420436584215891*^9, {3.423038826353773*^9, 
   3.4230388298988705`*^9}, {3.4230389169540496`*^9, 3.401229717066718*^9}, {
   3.4012333428976336`*^9, 3.401233379199834*^9}, {3.4012334379242754`*^9, 
   3.4012334465967455`*^9}, {3.4012530457745886`*^9, 3.4012530564599533`*^9}, 
   3.4012532679140096`*^9, 3.4012535088003874`*^9, 3.40125585845903*^9, {
   3.4012559734744143`*^9, 3.4012560031370673`*^9}, {3.401256033691002*^9, 
   3.4012560873681855`*^9}, {3.4012561511599135`*^9, 
   3.4012561874621134`*^9}, {3.401256571874872*^9, 3.40125659085216*^9}, 
   3.4012566655796127`*^9, {3.401256763360214*^9, 3.401256769138523*^9}, 
   3.4012568443366528`*^9, {3.401256888560243*^9, 3.4012569904968204`*^9}, {
   3.4012574050729523`*^9, 3.401257422728339*^9}, {3.4012575354604397`*^9, 
   3.401257542951211*^9}, {3.4012576385286446`*^9, 3.4012576483127136`*^9}, 
   3.4012576851056194`*^9, {3.4012579986664977`*^9, 3.401258014429163*^9}, {
   3.4012580565297008`*^9, 3.4012580830678606`*^9}, {3.4012581763019247`*^9, 
   3.4012582059445486`*^9}, {3.401258277857955*^9, 3.4012582917078705`*^9}, {
   3.4012583639817953`*^9, 3.4012583660848193`*^9}, {3.401258431639082*^9, 
   3.4012585568591394`*^9}, {3.4012642965223694`*^9, 
   3.4012642994966464`*^9}, {3.4012643503998413`*^9, 3.4012643525228944`*^9}, 
   3.401267907725024*^9, {3.401297846127658*^9, 3.4012978545898256`*^9}, {
   3.4012984548729906`*^9, 3.401298455644099*^9}, 3.4012987905356493`*^9, {
   3.4013004449524975`*^9, 3.401300477939931*^9}, {3.4013005478704863`*^9, 
   3.401300553548651*^9}, {3.4013006060341215`*^9, 3.4013006198539934`*^9}, 
   3.4013007001394386`*^9, {3.4013007365718255`*^9, 3.401300754327357*^9}, {
   3.4013008559334593`*^9, 3.4013008623627043`*^9}, {3.4013009185835457`*^9, 
   3.401300951260533*^9}, {3.4013015320957327`*^9, 3.401301574686976*^9}, {
   3.4039291859456816`*^9, 3.4039292053435745`*^9}, {3.403995110243712*^9, 
   3.4039953750444765`*^9}, {3.4039970580745554`*^9, 3.403997065224837*^9}, {
   3.404085511779435*^9, 3.4040855129010477`*^9}, {3.4040874269332914`*^9, 
   3.4040874498762817`*^9}, {3.4040893270154753`*^9, 3.404089349818264*^9}, {
   3.404090777871704*^9, 3.4040908500454845`*^9}, {3.404095516265179*^9, 
   3.4040955166357117`*^9}, {3.404095636888627*^9, 3.4040956469831424`*^9}, {
   3.4040980816840706`*^9, 3.4040980909774337`*^9}, {3.404098656921221*^9, 
   3.4040986604162464`*^9}, {3.404099142479419*^9, 3.404099162978896*^9}, {
   3.404099200532896*^9, 3.4040992136918173`*^9}, {3.404099270403365*^9, 
   3.404099291363504*^9}, {3.404099545559019*^9, 3.4040995465103874`*^9}, {
   3.4041481589739904`*^9, 3.4041481686679296`*^9}, {3.4041487522539697`*^9, 
   3.40414880048332*^9}, {3.404148854991699*^9, 3.4041489353873024`*^9}, {
   3.404149267274533*^9, 3.404149268005584*^9}, {3.404149365686042*^9, 
   3.404149365856286*^9}, 3.4041494799203024`*^9, {3.4041495128676786`*^9, 
   3.4041496459690685`*^9}, {3.404149676753334*^9, 3.4041497235305967`*^9}, {
   3.404149812899102*^9, 3.404149826789075*^9}, 3.404149942245093*^9, 
   3.4041500185448065`*^9, {3.404150092561237*^9, 3.4041501121093454`*^9}, {
   3.4041505328042755`*^9, 3.404150543038992*^9}, {3.404150665635277*^9, 
   3.4041507430666175`*^9}, 3.404150781401741*^9, {3.4041508130672736`*^9, 
   3.4041508168527164`*^9}, {3.404150855618459*^9, 3.4041508571206193`*^9}, {
   3.4041508878748417`*^9, 3.4041508976889534`*^9}, {3.4041509734378753`*^9, 
   3.404150975641043*^9}, {3.4041510880827265`*^9, 3.4041511393163967`*^9}, {
   3.4041523758043795`*^9, 3.404152497038706*^9}, {3.4041525811596656`*^9, 
   3.404152613436077*^9}, {3.404152646784029*^9, 3.4041526631375437`*^9}, {
   3.4041527399179487`*^9, 3.404152755690629*^9}, {3.4041529714208336`*^9, 
   3.404153085344648*^9}, {3.404153312751643*^9, 3.404153322335424*^9}, {
   3.4041534614955263`*^9, 3.4041535115575123`*^9}, {3.404153544695162*^9, 
   3.404153562450693*^9}, {3.4041536151664944`*^9, 3.404153617139331*^9}, {
   3.404153872826992*^9, 3.404153916569891*^9}, {3.4041539555960083`*^9, 
   3.4041539565073185`*^9}, {3.404154039496651*^9, 3.4041540794240637`*^9}, {
   3.404154178867056*^9, 3.4041542605445023`*^9}, {3.4041552802507677`*^9, 
   3.4041552820633745`*^9}, 3.4041572968905535`*^9, {3.404788870451395*^9, 
   3.4047892027392015`*^9}, {3.4047924828947954`*^9, 
   3.4047924861995473`*^9}, {3.40479312623988*^9, 3.404793130455942*^9}, 
   3.40479316254208*^9, {3.404793759200032*^9, 3.404793761883891*^9}, 
   3.4047943473357296`*^9, {3.404798409957493*^9, 3.404798421183635*^9}, {
   3.404798642431774*^9, 3.4047986449554033`*^9}, {3.404798773400098*^9, 
   3.4047988141687202`*^9}, {3.404799057799043*^9, 3.404799066972234*^9}, 
   3.4047992570755887`*^9, {3.404799429633715*^9, 3.404799435091563*^9}, {
   3.4047994972609587`*^9, 3.4047995212654753`*^9}, {3.404799551579064*^9, 
   3.4047996734943695`*^9}, {3.404799850278573*^9, 3.404799861554787*^9}, {
   3.404800136940773*^9, 3.404800340513496*^9}, {3.404800549784413*^9, 
   3.4048005518273506`*^9}, {3.4048010376058655`*^9, 
   3.4048010833917027`*^9}, {3.4048011239099646`*^9, 
   3.4048011684640303`*^9}, {3.4048012098735743`*^9, 
   3.4048012304531665`*^9}, {3.4048745832872753`*^9, 
   3.4048748335571456`*^9}, {3.404875617764781*^9, 3.4048756227619667`*^9}, {
   3.4048756558094864`*^9, 3.4048759276303453`*^9}, 3.4048759726350594`*^9, 
   3.4048895947212467`*^9, 3.4048896899581904`*^9, {3.404890468818136*^9, 
   3.404890503237629*^9}, {3.404920625185955*^9, 3.404920714173914*^9}, {
   3.404920754081298*^9, 3.404920757566309*^9}, {3.404920883998109*^9, 
   3.4049209054990253`*^9}, 3.404921000565725*^9, 3.404921046892339*^9, {
   3.404921091326232*^9, 3.40492112532512*^9}, {3.404922426345896*^9, 
   3.4049224282686605`*^9}, {3.4049235840906515`*^9, 3.404923617488675*^9}, {
   3.404924168771381*^9, 3.40492417411907*^9}, {3.4049245152195487`*^9, 
   3.404924561996811*^9}, {3.40492488088535*^9, 3.4049248999928255`*^9}, {
   3.4049254108073406`*^9, 3.4049254244970255`*^9}, 3.404925500265976*^9, {
   3.4055584967491856`*^9, 3.4055585180397997`*^9}},
 CellID->551978520]
}, Closed]],

Cell[CellGroupData[{

Cell["", "ManipulateSection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"f", "=", 
     RowBox[{"Floor", "[", 
      RowBox[{"h", "*", "r"}], "]"}]}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "move", " ", "round", " ", "selected", " ", "with", " ", "slider"}], " ",
      "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"list", "\[Equal]", "list0"}], "\[And]", 
       RowBox[{"from", "\[Equal]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}], "\[And]", 
       RowBox[{"to", "\[Equal]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"t", "=", 
           RowBox[{"type", "[", 
            RowBox[{"[", 
             RowBox[{"x", ",", "y"}], "]"}], "]"}]}], ";", 
          RowBox[{"s", "=", 
           RowBox[{"side", "[", 
            RowBox[{"[", 
             RowBox[{"x", ",", "y"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", "   ", 
           RowBox[{"pawn", " ", "move"}], "  ", "*)"}], "\[IndentingNewLine]",
           
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"t", "\[Equal]", "pp"}], "\[And]", 
             RowBox[{"s", "\[Equal]", "1"}], "\[And]", 
             RowBox[{"n", "\[Equal]", "1"}]}], ",", "     ", 
            RowBox[{"(*", " ", 
             RowBox[{"white", " ", "pawn", " ", "move"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"side", "[", 
                 RowBox[{"[", 
                  RowBox[{"x", ",", 
                   RowBox[{"y", "+", "1"}]}], "]"}], "]"}], "\[Equal]", "0"}],
                ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"list", "=", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"list", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"{", " ", 
                    RowBox[{"x", ",", 
                    RowBox[{"y", "+", "1"}]}], "}"}]}], "}"}]}], "]"}]}], ";",
                 "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"y", "\[Equal]", "2"}], "\[And]", 
                   RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", " ", 
                    RowBox[{"x", ",", "4"}], "]"}], "]"}], "\[Equal]", 
                    "0"}]}], ",", 
                  RowBox[{"list", "=", 
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"list", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "4"}], "}"}]}], "}"}]}], "]"}]}]}], 
                 "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"x", "+", "1"}], ",", 
                  RowBox[{"y", "+", "1"}]}], "}"}], "==", "epblack"}], ",", 
               RowBox[{"list", "=", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"{", " ", 
                    RowBox[{
                    RowBox[{"x", "+", "1"}], ",", 
                    RowBox[{"y", "+", "1"}]}], "}"}]}], "}"}]}], "]"}]}]}], 
              "]"}], ";", " ", 
             RowBox[{"(*", " ", "enpassant", " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"x", "-", "1"}], ",", 
                  RowBox[{"y", "+", "1"}]}], "}"}], "==", "epblack"}], ",", 
               RowBox[{"list", "=", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"{", " ", 
                    RowBox[{
                    RowBox[{"x", "-", "1"}], ",", 
                    RowBox[{"y", "+", "1"}]}], "}"}]}], "}"}]}], "]"}]}]}], 
              "]"}], ";", " ", 
             RowBox[{"(*", " ", "enpassant", " ", "*)"}], 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"x", "<", "8"}], "\[And]", 
                RowBox[{"y", "<", "8"}], "\[And]", 
                RowBox[{
                 RowBox[{"side", "[", 
                  RowBox[{"[", " ", 
                   RowBox[{
                    RowBox[{"x", "+", "1"}], ",", 
                    RowBox[{"y", "+", "1"}]}], "]"}], "]"}], "\[Equal]", 
                 RowBox[{"-", "n"}]}]}], ",", 
               RowBox[{"list", "=", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"{", " ", 
                    RowBox[{
                    RowBox[{"x", "+", "1"}], ",", 
                    RowBox[{"y", "+", "1"}]}], "}"}]}], "}"}]}], "]"}]}]}], 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"x", ">", "1"}], "\[And]", 
                RowBox[{"y", "<", "8"}], "\[And]", 
                RowBox[{
                 RowBox[{"side", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"x", "-", "1"}], ",", 
                    RowBox[{"y", "+", "1"}]}], "]"}], "]"}], "\[Equal]", 
                 RowBox[{"-", "n"}]}]}], ",", 
               RowBox[{"list", "=", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"{", " ", 
                    RowBox[{
                    RowBox[{"x", "-", "1"}], ",", 
                    RowBox[{"y", "+", "1"}]}], "}"}]}], "}"}]}], "]"}]}]}], 
              "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"t", "\[Equal]", "pp"}], "\[And]", 
             RowBox[{"s", "\[Equal]", 
              RowBox[{"-", "1"}]}], "\[And]", 
             RowBox[{"n", "\[Equal]", 
              RowBox[{"-", "1"}]}]}], ",", "   ", 
            RowBox[{"(*", " ", 
             RowBox[{"black", " ", "pawn", " ", "move"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"side", "[", 
                 RowBox[{"[", 
                  RowBox[{"x", ",", 
                   RowBox[{"y", "-", "1"}]}], "]"}], "]"}], "\[Equal]", "0"}],
                ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"list", "=", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"list", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"{", " ", 
                    RowBox[{"x", ",", 
                    RowBox[{"y", "-", "1"}]}], "}"}]}], "}"}]}], "]"}]}], ";",
                 "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"y", "\[Equal]", "7"}], "\[And]", 
                   RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", " ", 
                    RowBox[{"x", ",", "5"}], "]"}], "]"}], "\[Equal]", 
                    "0"}]}], ",", 
                  RowBox[{"list", "=", 
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"list", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "7"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "5"}], "}"}]}], "}"}]}], "]"}]}]}], 
                 "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"x", "+", "1"}], ",", 
                  RowBox[{"y", "-", "1"}]}], "}"}], "==", "epwhite"}], ",", 
               RowBox[{"list", "=", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"{", " ", 
                    RowBox[{
                    RowBox[{"x", "+", "1"}], ",", 
                    RowBox[{"y", "-", "1"}]}], "}"}]}], "}"}]}], "]"}]}]}], 
              "]"}], ";", " ", 
             RowBox[{"(*", " ", "enpassant", " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"x", "-", "1"}], ",", 
                  RowBox[{"y", "-", "1"}]}], "}"}], "==", "epwhite"}], ",", 
               RowBox[{"list", "=", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"{", " ", 
                    RowBox[{
                    RowBox[{"x", "-", "1"}], ",", 
                    RowBox[{"y", "-", "1"}]}], "}"}]}], "}"}]}], "]"}]}]}], 
              "]"}], ";", " ", 
             RowBox[{"(*", " ", "enpassant", " ", "*)"}], 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"x", "<", "8"}], "\[And]", 
                RowBox[{"y", ">", "1"}], "\[And]", 
                RowBox[{
                 RowBox[{"side", "[", 
                  RowBox[{"[", " ", 
                   RowBox[{
                    RowBox[{"x", "+", "1"}], ",", 
                    RowBox[{"y", "-", "1"}]}], "]"}], "]"}], "\[Equal]", 
                 RowBox[{"-", "n"}]}]}], ",", 
               RowBox[{"list", "=", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"{", " ", 
                    RowBox[{
                    RowBox[{"x", "+", "1"}], ",", 
                    RowBox[{"y", "-", "1"}]}], "}"}]}], "}"}]}], "]"}]}]}], 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"x", ">", "1"}], "\[And]", 
                RowBox[{"y", ">", "1"}], "\[And]", 
                RowBox[{
                 RowBox[{"side", "[", 
                  RowBox[{"[", " ", 
                   RowBox[{
                    RowBox[{"x", "-", "1"}], ",", 
                    RowBox[{"y", "-", "1"}]}], "]"}], "]"}], "\[Equal]", 
                 RowBox[{"-", "n"}]}]}], ",", 
               RowBox[{"list", "=", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"{", " ", 
                    RowBox[{
                    RowBox[{"x", "-", "1"}], ",", 
                    RowBox[{"y", "-", "1"}]}], "}"}]}], "}"}]}], "]"}]}]}], 
              "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "  ", 
          RowBox[{"(*", " ", 
           RowBox[{"knight", " ", "move"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"t", "\[Equal]", "nn"}], "\[And]", 
             RowBox[{"s", "\[Equal]", "n"}]}], ",", " ", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"x", ">", "1"}], "\[And]", 
                RowBox[{"y", ">", "2"}], "\[And]", 
                RowBox[{
                 RowBox[{"side", "[", 
                  RowBox[{"[", " ", 
                   RowBox[{
                    RowBox[{"x", "-", "1"}], ",", 
                    RowBox[{"y", "-", "2"}]}], "]"}], "]"}], "\[NotEqual]", 
                 "n"}]}], ",", 
               RowBox[{"list", "=", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"{", " ", 
                    RowBox[{
                    RowBox[{"x", "-", "1"}], ",", 
                    RowBox[{"y", "-", "2"}]}], "}"}]}], "}"}]}], "]"}]}]}], 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"x", ">", "1"}], "\[And]", 
                RowBox[{"y", "<", "7"}], "\[And]", 
                RowBox[{
                 RowBox[{"side", "[", 
                  RowBox[{"[", " ", 
                   RowBox[{
                    RowBox[{"x", "-", "1"}], ",", 
                    RowBox[{"y", "+", "2"}]}], "]"}], "]"}], "\[NotEqual]", 
                 "n"}]}], ",", 
               RowBox[{"list", "=", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"{", " ", 
                    RowBox[{
                    RowBox[{"x", "-", "1"}], ",", 
                    RowBox[{"y", "+", "2"}]}], "}"}]}], "}"}]}], "]"}]}]}], 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"x", ">", "2"}], "\[And]", 
                RowBox[{"y", ">", "1"}], "\[And]", 
                RowBox[{
                 RowBox[{"side", "[", 
                  RowBox[{"[", " ", 
                   RowBox[{
                    RowBox[{"x", "-", "2"}], ",", 
                    RowBox[{"y", "-", "1"}]}], "]"}], "]"}], "\[NotEqual]", 
                 "n"}]}], ",", 
               RowBox[{"list", "=", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"{", " ", 
                    RowBox[{
                    RowBox[{"x", "-", "2"}], ",", 
                    RowBox[{"y", "-", "1"}]}], "}"}]}], "}"}]}], "]"}]}]}], 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"x", ">", "2"}], "\[And]", 
                RowBox[{"y", "<", "8"}], "\[And]", 
                RowBox[{
                 RowBox[{"side", "[", 
                  RowBox[{"[", " ", 
                   RowBox[{
                    RowBox[{"x", "-", "2"}], ",", 
                    RowBox[{"y", "+", "1"}]}], "]"}], "]"}], "\[NotEqual]", 
                 "n"}]}], ",", 
               RowBox[{"list", "=", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"{", " ", 
                    RowBox[{
                    RowBox[{"x", "-", "2"}], ",", 
                    RowBox[{"y", "+", "1"}]}], "}"}]}], "}"}]}], "]"}]}]}], 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"x", "<", "8"}], "\[And]", 
                RowBox[{"y", "<", "7"}], "\[And]", 
                RowBox[{
                 RowBox[{"side", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"x", "+", "1"}], ",", 
                    RowBox[{"y", "+", "2"}]}], "]"}], "]"}], "\[NotEqual]", 
                 "n"}]}], ",", 
               RowBox[{"list", "=", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"{", " ", 
                    RowBox[{
                    RowBox[{"x", "+", "1"}], ",", 
                    RowBox[{"y", "+", "2"}]}], "}"}]}], "}"}]}], "]"}]}]}], 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"x", "<", "8"}], "\[And]", 
                RowBox[{"y", ">", "2"}], "\[And]", 
                RowBox[{
                 RowBox[{"side", "[", 
                  RowBox[{"[", " ", 
                   RowBox[{
                    RowBox[{"x", "+", "1"}], ",", 
                    RowBox[{"y", "-", "2"}]}], "]"}], "]"}], "\[NotEqual]", 
                 "n"}]}], ",", 
               RowBox[{"list", "=", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"{", " ", 
                    RowBox[{
                    RowBox[{"x", "+", "1"}], ",", 
                    RowBox[{"y", "-", "2"}]}], "}"}]}], "}"}]}], "]"}]}]}], 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"x", "<", "7"}], "\[And]", 
                RowBox[{"y", ">", "1"}], "\[And]", 
                RowBox[{
                 RowBox[{"side", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"x", "+", "2"}], ",", 
                    RowBox[{"y", "-", "1"}]}], "]"}], "]"}], "\[NotEqual]", 
                 "n"}]}], ",", 
               RowBox[{"list", "=", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"{", " ", 
                    RowBox[{
                    RowBox[{"x", "+", "2"}], ",", 
                    RowBox[{"y", "-", "1"}]}], "}"}]}], "}"}]}], "]"}]}]}], 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"x", "<", "7"}], "\[And]", 
                RowBox[{"y", "<", "8"}], "\[And]", 
                RowBox[{
                 RowBox[{"side", "[", 
                  RowBox[{"[", " ", 
                   RowBox[{
                    RowBox[{"x", "+", "2"}], ",", 
                    RowBox[{"y", "+", "1"}]}], "]"}], "]"}], "\[NotEqual]", 
                 "n"}]}], ",", 
               RowBox[{"list", "=", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"{", " ", 
                    RowBox[{
                    RowBox[{"x", "+", "2"}], ",", 
                    RowBox[{"y", "+", "1"}]}], "}"}]}], "}"}]}], "]"}]}]}], 
              "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "bishop", " ", "move", " ", "or", " ", "queen", " ", "move"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"t", "\[Equal]", "bb"}], "\[Or]", 
               RowBox[{"t", "\[Equal]", "qq"}]}], ")"}], "\[And]", 
             RowBox[{"s", "\[Equal]", "n"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"i", "=", "1"}], ",", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"x", "+", "i"}], "<", "9"}], "\[And]", 
                RowBox[{
                 RowBox[{"y", "+", "i"}], "<", "9"}]}], ",", 
               RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"x", "+", "i"}], ",", 
                    RowBox[{"y", "+", "i"}]}], "]"}], "]"}], "\[NotEqual]", 
                   "n"}], ",", 
                  RowBox[{"list", "=", 
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"list", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", "i"}], ",", 
                    RowBox[{"y", "+", "i"}]}], "}"}]}], "}"}]}], "]"}]}]}], 
                 "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"x", "+", "i"}], ",", 
                    RowBox[{"y", "+", "i"}]}], "]"}], "]"}], "\[NotEqual]", 
                   "0"}], ",", 
                  RowBox[{"Break", "[", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"i", "=", "1"}], ",", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"x", "+", "i"}], "<", "9"}], "\[And]", 
                RowBox[{
                 RowBox[{"y", "-", "i"}], ">", "0"}]}], ",", 
               RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"x", "+", "i"}], ",", 
                    RowBox[{"y", "-", "i"}]}], "]"}], "]"}], "\[NotEqual]", 
                   "n"}], ",", 
                  RowBox[{"list", "=", 
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"list", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", "i"}], ",", 
                    RowBox[{"y", "-", "i"}]}], "}"}]}], "}"}]}], "]"}]}]}], 
                 "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"x", "+", "i"}], ",", 
                    RowBox[{"y", "-", "i"}]}], "]"}], "]"}], "\[NotEqual]", 
                   "0"}], ",", 
                  RowBox[{"Break", "[", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"i", "=", "1"}], ",", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"x", "-", "i"}], ">", "0"}], "\[And]", 
                RowBox[{
                 RowBox[{"y", "+", "i"}], "<", "9"}]}], ",", 
               RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"x", "-", "i"}], ",", 
                    RowBox[{"y", "+", "i"}]}], "]"}], "]"}], "\[NotEqual]", 
                   "n"}], ",", 
                  RowBox[{"list", "=", 
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"list", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "-", "i"}], ",", 
                    RowBox[{"y", "+", "i"}]}], "}"}]}], "}"}]}], "]"}]}]}], 
                 "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"x", "-", "i"}], ",", 
                    RowBox[{"y", "+", "i"}]}], "]"}], "]"}], "\[NotEqual]", 
                   "0"}], ",", 
                  RowBox[{"Break", "[", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"i", "=", "1"}], ",", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"x", "-", "i"}], ">", "0"}], "\[And]", 
                RowBox[{
                 RowBox[{"y", "-", "i"}], ">", "0"}]}], ",", 
               RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"x", "-", "i"}], ",", 
                    RowBox[{"y", "-", "i"}]}], "]"}], "]"}], "\[NotEqual]", 
                   "n"}], ",", 
                  RowBox[{"list", "=", 
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"list", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "-", "i"}], ",", 
                    RowBox[{"y", "-", "i"}]}], "}"}]}], "}"}]}], "]"}]}]}], 
                 "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"x", "-", "i"}], ",", 
                    RowBox[{"y", "-", "i"}]}], "]"}], "]"}], "\[NotEqual]", 
                   "0"}], ",", 
                  RowBox[{"Break", "[", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "rook", " ", "move", " ", "or", " ", "queen", " ", "move"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"t", "\[Equal]", "rr"}], "\[Or]", 
               RowBox[{"t", "\[Equal]", "qq"}]}], ")"}], "\[And]", 
             RowBox[{"s", "\[Equal]", "n"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"i", "=", " ", 
                RowBox[{"x", "+", "1"}]}], ",", 
               RowBox[{"i", "<", "9"}], ",", 
               RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "y"}], "]"}], "]"}], "\[NotEqual]", 
                   "n"}], ",", 
                  RowBox[{"list", "=", 
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"list", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "y"}], "}"}]}], "}"}]}], "]"}]}]}], 
                 "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "y"}], "]"}], "]"}], "\[NotEqual]", 
                   "0"}], ",", 
                  RowBox[{"Break", "[", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"i", "=", " ", 
                RowBox[{"x", "-", "1"}]}], ",", 
               RowBox[{"i", ">", "0"}], ",", 
               RowBox[{"i", "--"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "y"}], "]"}], "]"}], "\[NotEqual]", 
                   "n"}], ",", 
                  RowBox[{"list", "=", 
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"list", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "y"}], "}"}]}], "}"}]}], "]"}]}]}], 
                 "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "y"}], "]"}], "]"}], "\[NotEqual]", 
                   "0"}], ",", 
                  RowBox[{"Break", "[", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"i", "=", 
                RowBox[{"y", "+", "1"}]}], ",", 
               RowBox[{"i", "<", "9"}], ",", 
               RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{"x", ",", "i"}], "]"}], "]"}], "\[NotEqual]", 
                   "n"}], ",", 
                  RowBox[{"list", "=", 
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"list", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "i"}], "}"}]}], "}"}]}], "]"}]}]}], 
                 "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{"x", ",", "i"}], "]"}], "]"}], "\[NotEqual]", 
                   "0"}], ",", 
                  RowBox[{"Break", "[", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"i", "=", 
                RowBox[{"y", "-", "1"}]}], ",", 
               RowBox[{"i", ">", "0"}], ",", 
               RowBox[{"i", "--"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{"x", ",", "i"}], "]"}], "]"}], "\[NotEqual]", 
                   "n"}], ",", 
                  RowBox[{"list", "=", 
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"list", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "i"}], "}"}]}], "}"}]}], "]"}]}]}], 
                 "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{"x", ",", "i"}], "]"}], "]"}], "\[NotEqual]", 
                   "0"}], ",", 
                  RowBox[{"Break", "[", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"king", " ", "move"}], " ", "*)"}], "\[IndentingNewLine]", 
          
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"t", "\[Equal]", "kk"}], "\[And]", 
             RowBox[{"s", "\[Equal]", "n"}]}], ",", " ", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"kx", "=", "x"}], ";", 
             RowBox[{"ky", "=", "y"}], ";", "\[IndentingNewLine]", " ", 
             RowBox[{
              RowBox[{"side", "[", 
               RowBox[{"[", " ", 
                RowBox[{"x", ",", "y"}], "]"}], "]"}], "=", "0"}], ";", 
             RowBox[{
              RowBox[{"type", "[", 
               RowBox[{"[", " ", 
                RowBox[{"x", ",", "y"}], "]"}], "]"}], "=", "0"}], ";", "  ", 
             
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{
               "delete", " ", "king", " ", "temporarily", " ", "for", " ", 
                "attack"}], "-", 
               RowBox[{"checkings", "!"}]}], " ", "*)"}], 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"x", "<", "8"}], ",", 
               RowBox[{
                RowBox[{"swattacked", "=", 
                 RowBox[{"check", "[", 
                  RowBox[{"side", ",", "type", ",", 
                   RowBox[{"x", "+", "1"}], ",", "y", ",", "n"}], "]"}]}], 
                ";", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"\[Not]", "swattacked"}], ",", 
                  RowBox[{"eastok", "=", "True"}], ",", 
                  RowBox[{"eastok", "=", "False"}]}], "]"}]}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"x", ">", "1"}], ",", 
               RowBox[{
                RowBox[{"swattacked", "=", 
                 RowBox[{"check", "[", 
                  RowBox[{"side", ",", "type", ",", 
                   RowBox[{"x", "-", "1"}], ",", "y", ",", "n"}], "]"}]}], 
                ";", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"\[Not]", "swattacked"}], ",", 
                  RowBox[{"westok", "=", "True"}], ",", 
                  RowBox[{"westok", "=", "False"}]}], "]"}]}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"y", "<", "8"}], ",", 
               RowBox[{
                RowBox[{"swattacked", "=", 
                 RowBox[{"check", "[", 
                  RowBox[{"side", ",", "type", ",", "x", ",", 
                   RowBox[{"y", "+", "1"}], ",", "n"}], "]"}]}], ";", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"\[Not]", "swattacked"}], ",", 
                  RowBox[{"northok", "=", "True"}], ",", 
                  RowBox[{"northok", "=", "False"}]}], "]"}]}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"y", ">", "1"}], ",", 
               RowBox[{
                RowBox[{"swattacked", "=", 
                 RowBox[{"check", "[", 
                  RowBox[{"side", ",", "type", ",", "x", ",", 
                   RowBox[{"y", "-", "1"}], ",", "n"}], "]"}]}], ";", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"\[Not]", "swattacked"}], ",", 
                  RowBox[{"southok", "=", "True"}], ",", 
                  RowBox[{"southok", "=", "False"}]}], "]"}]}]}], "]"}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"x", ">", "1"}], "\[And]", 
                RowBox[{"westok", "==", "True"}], "\[And]", 
                RowBox[{
                 RowBox[{"side", "[", 
                  RowBox[{"[", " ", 
                   RowBox[{
                    RowBox[{"x", "-", "1"}], ",", "y"}], "]"}], "]"}], 
                 "\[NotEqual]", "n"}]}], ",", 
               RowBox[{"list", "=", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "-", "1"}], ",", "y"}], "}"}]}], "}"}]}], 
                 "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"x", "<", "8"}], "\[And]", 
                RowBox[{"eastok", "==", "True"}], "\[And]", 
                RowBox[{
                 RowBox[{"side", "[", 
                  RowBox[{"[", " ", 
                   RowBox[{
                    RowBox[{"x", "+", "1"}], ",", "y"}], "]"}], "]"}], 
                 "\[NotEqual]", "n"}]}], ",", 
               RowBox[{"list", "=", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", "1"}], ",", "y"}], "}"}]}], "}"}]}], 
                 "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"y", ">", "1"}], "\[And]", 
                RowBox[{"southok", "==", "True"}], "\[And]", 
                RowBox[{
                 RowBox[{"side", "[", 
                  RowBox[{"[", " ", 
                   RowBox[{"x", ",", 
                    RowBox[{"y", "-", "1"}]}], "]"}], "]"}], "\[NotEqual]", 
                 "n"}]}], ",", 
               RowBox[{"list", "=", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{"y", "-", "1"}]}], "}"}]}], "}"}]}], "]"}]}]}], 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"y", "<", "8"}], "\[And]", 
                RowBox[{"northok", "==", "True"}], "\[And]", 
                RowBox[{
                 RowBox[{"side", "[", 
                  RowBox[{"[", " ", 
                   RowBox[{"x", ",", 
                    RowBox[{"y", "+", "1"}]}], "]"}], "]"}], "\[NotEqual]", 
                 "n"}]}], ",", 
               RowBox[{"list", "=", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{"y", "+", "1"}]}], "}"}]}], "}"}]}], "]"}]}]}], 
              "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"x", ">", "1"}], "\[And]", 
                RowBox[{"y", ">", "1"}], "\[And]", 
                RowBox[{
                 RowBox[{"side", "[", 
                  RowBox[{"[", " ", 
                   RowBox[{
                    RowBox[{"x", "-", "1"}], ",", 
                    RowBox[{"y", "-", "1"}]}], "]"}], "]"}], "\[NotEqual]", 
                 "n"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"swattacked", "=", 
                 RowBox[{"check", "[", 
                  RowBox[{"side", ",", "type", ",", 
                   RowBox[{"x", "-", "1"}], ",", 
                   RowBox[{"y", "-", "1"}], ",", "n"}], "]"}]}], ";", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"\[Not]", "swattacked"}], ",", 
                  RowBox[{"list", "=", 
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"list", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "-", "1"}], ",", 
                    RowBox[{"y", "-", "1"}]}], "}"}]}], "}"}]}], "]"}]}]}], 
                 "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"x", ">", "1"}], "\[And]", 
                RowBox[{"y", "<", "8"}], "\[And]", 
                RowBox[{
                 RowBox[{"side", "[", 
                  RowBox[{"[", " ", 
                   RowBox[{
                    RowBox[{"x", "-", "1"}], ",", 
                    RowBox[{"y", "+", "1"}]}], "]"}], "]"}], "\[NotEqual]", 
                 "n"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"swattacked", "=", 
                 RowBox[{"check", "[", 
                  RowBox[{"side", ",", "type", ",", 
                   RowBox[{"x", "-", "1"}], ",", 
                   RowBox[{"y", "+", "1"}], ",", "n"}], "]"}]}], ";", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"\[Not]", "swattacked"}], ",", 
                  RowBox[{"list", "=", 
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"list", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "-", "1"}], ",", 
                    RowBox[{"y", "+", "1"}]}], "}"}]}], "}"}]}], "]"}]}]}], 
                 "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"x", "<", "8"}], "\[And]", 
                RowBox[{"y", ">", "1"}], "\[And]", 
                RowBox[{
                 RowBox[{"side", "[", 
                  RowBox[{"[", " ", 
                   RowBox[{
                    RowBox[{"x", "+", "1"}], ",", 
                    RowBox[{"y", "-", "1"}]}], "]"}], "]"}], "\[NotEqual]", 
                 "n"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"swattacked", "=", 
                 RowBox[{"check", "[", 
                  RowBox[{"side", ",", "type", ",", 
                   RowBox[{"x", "+", "1"}], ",", 
                   RowBox[{"y", "-", "1"}], ",", "n"}], "]"}]}], ";", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"\[Not]", "swattacked"}], ",", 
                  RowBox[{"list", "=", 
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"list", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", "1"}], ",", 
                    RowBox[{"y", "-", "1"}]}], "}"}]}], "}"}]}], "]"}]}]}], 
                 "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"x", "<", "8"}], "\[And]", 
                RowBox[{"y", "<", "8"}], "\[And]", 
                RowBox[{
                 RowBox[{"side", "[", 
                  RowBox[{"[", " ", 
                   RowBox[{
                    RowBox[{"x", "+", "1"}], ",", 
                    RowBox[{"y", "+", "1"}]}], "]"}], "]"}], "\[NotEqual]", 
                 "n"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"swattacked", "=", 
                 RowBox[{"check", "[", 
                  RowBox[{"side", ",", "type", ",", 
                   RowBox[{"x", "+", "1"}], ",", 
                   RowBox[{"y", "+", "1"}], ",", "n"}], "]"}]}], ";", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"\[Not]", "swattacked"}], ",", 
                  RowBox[{"list", "=", 
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"list", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", "1"}], ",", 
                    RowBox[{"y", "+", "1"}]}], "}"}]}], "}"}]}], "]"}]}]}], 
                 "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"castling", " ", ":", " ", 
               RowBox[{
                RowBox[{
                "check", " ", "for", " ", "attacks", " ", "on", " ", 
                 "current", " ", "from"}], "-", 
                RowBox[{
                "position", " ", "and", " ", "for", " ", "attacks", " ", "on",
                  " ", "target", " ", "positions"}]}]}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"swattacked", "=", 
              RowBox[{"check", "[", 
               RowBox[{"side", ",", "type", ",", "x", ",", "y", ",", "n"}], 
               "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"\[Not]", "swattacked"}], ",", "  ", 
               RowBox[{"(*", " ", 
                RowBox[{
                 RowBox[{"from", "-", 
                  RowBox[{"pos", " ", "not", " ", "attacked"}]}], " ", "=", 
                 RowBox[{">", " ", 
                  RowBox[{
                   RowBox[{"check", " ", "out", " ", "to"}], "-", 
                   RowBox[{
                    RowBox[{"pos", ".", " ", "of"}], " ", "castling"}]}]}]}], 
                " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "1"}], "}"}]}], "\[And]", 
                   RowBox[{"westok", "\[Equal]", "True"}], "\[And]", 
                   RowBox[{"unmoveda1", "\[Equal]", "True"}], "\[And]", 
                   RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Equal]", "n"}], 
                   "\[And]", 
                   RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{"4", ",", "1"}], "]"}], "]"}], "\[Equal]", "0"}], 
                   "\[And]", 
                   RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "1"}], "]"}], "]"}], "\[Equal]", "0"}], 
                   "\[And]", 
                   RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], "\[Equal]", 
                    "0"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"swattacked", "=", 
                    RowBox[{"check", "[", 
                    RowBox[{
                    "side", ",", "type", ",", "3", ",", "1", ",", "n"}], 
                    "]"}]}], ";", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"\[Not]", "swattacked"}], ",", 
                    RowBox[{"list", "=", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"list", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"5", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "1"}], "}"}]}], "}"}]}], "]"}]}]}], 
                    "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "1"}], "}"}]}], "\[And]", 
                   RowBox[{"eastok", "\[Equal]", "True"}], "\[And]", 
                   RowBox[{"unmovedh1", "\[Equal]", "True"}], "\[And]", 
                   RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{"8", ",", "1"}], "]"}], "]"}], "\[Equal]", "n"}], 
                   "\[And]", 
                   RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{"6", ",", "1"}], "]"}], "]"}], "\[Equal]", "0"}], 
                   "\[And]", 
                   RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{"7", ",", "1"}], "]"}], "]"}], "\[Equal]", 
                    "0"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"swattacked", "=", 
                    RowBox[{"check", "[", 
                    RowBox[{
                    "side", ",", "type", ",", "7", ",", "1", ",", "n"}], 
                    "]"}]}], ";", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"\[Not]", "swattacked"}], ",", 
                    RowBox[{"list", "=", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"list", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"5", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"7", ",", "1"}], "}"}]}], "}"}]}], "]"}]}]}], 
                    "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "8"}], "}"}]}], "\[And]", 
                   RowBox[{"westok", "\[Equal]", "True"}], "\[And]", 
                   RowBox[{"unmoveda8", "\[Equal]", "True"}], "\[And]", 
                   RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "8"}], "]"}], "]"}], "\[Equal]", "n"}], 
                   "\[And]", 
                   RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{"4", ",", "8"}], "]"}], "]"}], "\[Equal]", "0"}], 
                   "\[And]", 
                   RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "8"}], "]"}], "]"}], "\[Equal]", "0"}], 
                   "\[And]", 
                   RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "8"}], "]"}], "]"}], "\[Equal]", 
                    "0"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"swattacked", "=", 
                    RowBox[{"check", "[", 
                    RowBox[{
                    "side", ",", "type", ",", "3", ",", "8", ",", "n"}], 
                    "]"}]}], ";", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"\[Not]", "swattacked"}], ",", 
                    RowBox[{"list", "=", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"list", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"5", ",", "8"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "8"}], "}"}]}], "}"}]}], "]"}]}]}], 
                    "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "8"}], "}"}]}], "\[And]", 
                   RowBox[{"eastok", "\[Equal]", "True"}], "\[And]", 
                   RowBox[{"unmovedh8", "\[Equal]", "True"}], "\[And]", 
                   RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{"8", ",", "8"}], "]"}], "]"}], "\[Equal]", "n"}], 
                   "\[And]", 
                   RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{"6", ",", "8"}], "]"}], "]"}], "\[Equal]", "0"}], 
                   "\[And]", 
                   RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{"7", ",", "8"}], "]"}], "]"}], "\[Equal]", 
                    "0"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"swattacked", "=", 
                    RowBox[{"check", "[", 
                    RowBox[{
                    "side", ",", "type", ",", "7", ",", "8", ",", "n"}], 
                    "]"}]}], ";", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"\[Not]", "swattacked"}], ",", 
                    RowBox[{"list", "=", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"list", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"5", ",", "8"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"7", ",", "8"}], "}"}]}], "}"}]}], "]"}]}]}], 
                    "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ";", "   ", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{"end", " ", "swattacked"}], " ", "=", " ", "false"}], 
              " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"side", "[", 
               RowBox[{"[", " ", 
                RowBox[{"x", ",", "y"}], "]"}], "]"}], "=", "n"}], ";", 
             RowBox[{
              RowBox[{"type", "[", 
               RowBox[{"[", " ", 
                RowBox[{"x", ",", "y"}], "]"}], "]"}], "=", "kk"}]}]}], 
           "     ", 
           RowBox[{"(*", " ", 
            RowBox[{"restore", " ", "king"}], " ", "*)"}], 
           "\[IndentingNewLine]", "]"}]}], "  ", 
         RowBox[{"(*", " ", 
          RowBox[{"end", " ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"part1", "\[And]", 
              RowBox[{
               RowBox[{"type", "[", 
                RowBox[{"[", " ", 
                 RowBox[{"x", ",", "y"}], "]"}], "]"}], "\[Equal]", "kk"}]}], 
             ","}], "  "}]}], "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "8"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", "8"}], "}"}]}], "]"}], ";", "   ", 
       RowBox[{"(*", " ", 
        RowBox[{"end", ":", " ", 
         RowBox[{
         "scan", " ", "board", " ", "to", " ", "create", " ", "list"}]}], " ",
         "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"...", "..."}], "..."}], "..."}], "eliminate", " ", 
                "uncovered", " ", "attacks", " ", "on", " ", 
                RowBox[{"player", "'"}], "s", " ", "own", " ", "king"}], " ", 
               "..."}], "..."}], "..."}], "..."}], "..."}], "..."}], "."}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"l", "=", 
        RowBox[{"Length", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"a", "=", 
           RowBox[{"list", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "1"}], "]"}], "]"}]}], ";", 
          RowBox[{"b", "=", 
           RowBox[{"list", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "2"}], "]"}], "]"}]}], ";", 
          RowBox[{"ax", "=", 
           RowBox[{"a", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", 
          RowBox[{"ay", "=", 
           RowBox[{"a", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ";", 
          RowBox[{"bx", "=", 
           RowBox[{"b", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", 
          RowBox[{"by", "=", 
           RowBox[{"b", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ";", 
          RowBox[{"t", "=", 
           RowBox[{"type", "[", 
            RowBox[{"[", 
             RowBox[{"ax", ",", "ay"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"temporarily", " ", "execute", " ", 
            RowBox[{"move", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"t", "\[NotEqual]", "kk"}], ",", " ", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "king", " ", "is", " ", "processed", " ", "above", " ", 
               "already"}], ",", " ", "separately"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"side", "[", 
               RowBox[{"[", 
                RowBox[{"ax", ",", "ay"}], "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"type", "[", 
                RowBox[{"[", 
                 RowBox[{"ax", ",", "ay"}], "]"}], "]"}], "=", "0"}]}], ";", 
             RowBox[{"olds", "=", 
              RowBox[{"side", "[", 
               RowBox[{"[", 
                RowBox[{"bx", ",", "by"}], "]"}], "]"}]}], ";", 
             RowBox[{"oldt", "=", 
              RowBox[{"type", "[", 
               RowBox[{"[", 
                RowBox[{"bx", ",", "by"}], "]"}], "]"}]}], ";", 
             RowBox[{
              RowBox[{"side", "[", 
               RowBox[{"[", 
                RowBox[{"bx", ",", "by"}], "]"}], "]"}], "=", "n"}], ";", 
             RowBox[{
              RowBox[{"type", "[", 
               RowBox[{"[", 
                RowBox[{"bx", ",", "by"}], "]"}], "]"}], "=", "t"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"swattacked", "=", 
              RowBox[{"check", "[", 
               RowBox[{"side", ",", "type", ",", "kx", ",", "ky", ",", "n"}], 
               "]"}]}], " ", ";", " ", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"side", "[", 
               RowBox[{"[", 
                RowBox[{"ax", ",", "ay"}], "]"}], "]"}], "=", "n"}], ";", 
             RowBox[{
              RowBox[{"type", "[", 
               RowBox[{"[", 
                RowBox[{"ax", ",", "ay"}], "]"}], "]"}], "=", "t"}], ";", 
             RowBox[{
              RowBox[{"side", "[", 
               RowBox[{"[", 
                RowBox[{"bx", ",", "by"}], "]"}], "]"}], "=", "olds"}], ";", 
             RowBox[{
              RowBox[{"type", "[", 
               RowBox[{"[", 
                RowBox[{"bx", ",", "by"}], "]"}], "]"}], "=", "oldt"}], ";", 
             "  ", 
             RowBox[{"(*", " ", "restore", " ", "*)"}], "\[IndentingNewLine]",
              " ", 
             RowBox[{"If", "[", 
              RowBox[{"swattacked", ",", 
               RowBox[{
                RowBox[{"list", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}]}], "]"}]}]}], 
           "  ", 
           RowBox[{"(*", " ", 
            RowBox[{"delete", " ", "move"}], " ", "*)"}], 
           "\[IndentingNewLine]", "]"}]}], " ", ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"j", ",", "2", ",", "l"}], "}"}]}], "\[IndentingNewLine]", 
        "]"}], " ", ";", "  ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "end", " ", "do", " ", "eliminate", " ", "bad", " ", "moves"}], " ", 
        "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"...", "..."}], "..."}], "..."}], "..."}], 
                    "..."}], "..."}], ".", "shorten"}], " ", "list"}], 
                    "..."}], "..."}], "..."}], "..."}], "..."}], "..."}], 
                "..."}], "..."}], "..."}], "..."}], "..."}], "..."}], "..."}],
          "..."}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"list1", "=", "list0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"list", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "\[NotEqual]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"list1", "=", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"list1", ",", 
              RowBox[{"list", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], " ", "]"}]}]}], "  ", "]"}], 
         "\[IndentingNewLine]", " ", ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "2", ",", "l"}], "}"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "  ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "end", " ", "do", " ", "eliminate", " ", "bad", " ", "moves"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"list", "=", "list1"}]}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "]"}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "eliminate", " ", "moves", " ", "from", " ", "movelist", " ", "which", 
      " ", "leave", " ", "own", " ", "king", " ", "attacked"}], " ", "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"l", "=", 
     RowBox[{"Length", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"ClickPane", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"board", ",", "                    ", 
          RowBox[{"(*", " ", 
           RowBox[{"display", " ", "ortho", " ", "grid"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"EdgeForm", "[", "Thin", "]"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", " ", "display"}]}]}]}], " ", "stored", " ", 
            "board", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"setup", " ", "--"}], "--"}], "--"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"f", "==", "r"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Equal]", "1"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"Which", "[", 
                   RowBox[{
                    RowBox[{"colw", "\[Equal]", "1"}], ",", " ", 
                    RowBox[{"RGBColor", "[", 
                    RowBox[{".9", ",", ".9", ",", ".5"}], "]"}], ",", 
                    RowBox[{"colw", "\[Equal]", "2"}], ",", 
                    RowBox[{"RGBColor", "[", 
                    RowBox[{".7", ",", ".7", ",", ".4"}], "]"}], ",", 
                    RowBox[{"colw", "\[Equal]", "3"}], ",", 
                    RowBox[{"RGBColor", "[", 
                    RowBox[{".9", ",", ".3", ",", ".3"}], "]"}]}], "]"}], ",",
                   "    ", "\[IndentingNewLine]", 
                  RowBox[{"Which", "[", 
                   RowBox[{
                    RowBox[{"colb", "\[Equal]", "1"}], ",", 
                    RowBox[{"RGBColor", "[", 
                    RowBox[{".4", ",", ".4", ",", ".3"}], "]"}], ",", 
                    RowBox[{"colb", "\[Equal]", "2"}], ",", 
                    RowBox[{"RGBColor", "[", 
                    RowBox[{".3", ",", ".4", ",", ".1"}], "]"}], ",", 
                    RowBox[{"colb", "\[Equal]", "3"}], ",", 
                    RowBox[{"RGBColor", "[", 
                    RowBox[{".2", ",", ".5", ",", ".5"}], "]"}]}], "]"}]}], 
                 "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Which", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"type", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Equal]", "pp"}],
                   ",", 
                  RowBox[{"Translate", "[", 
                   RowBox[{"pawn", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j"}], "}"}]}], "]"}], ",", "  ", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"type", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Equal]", "rr"}],
                   ",", 
                  RowBox[{"Translate", "[", 
                   RowBox[{"rook", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j"}], "}"}]}], "]"}], ",", "  ", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"type", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Equal]", "nn"}],
                   ",", 
                  RowBox[{"Translate", "[", 
                   RowBox[{"knight", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j"}], "}"}]}], "]"}], ",", "  ", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"type", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Equal]", "bb"}],
                   ",", 
                  RowBox[{"Translate", "[", 
                   RowBox[{"bishop", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j"}], "}"}]}], "]"}], ",", "  ", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"type", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Equal]", "qq"}],
                   ",", 
                  RowBox[{"Translate", "[", 
                   RowBox[{"queen", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j"}], "}"}]}], "]"}], ",", "  ", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"type", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Equal]", "kk"}],
                   ",", 
                  RowBox[{"Translate", "[", 
                   RowBox[{"king", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j"}], "}"}]}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"type", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Equal]", "0"}], 
                  ",", 
                  RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
               "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "8"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "8"}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"f", "<", "r"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"sides", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"f", "+", "1"}], ",", "i", ",", "j"}], "]"}], 
                    "]"}], "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Which", "[", 
                   RowBox[{
                    RowBox[{"colw", "\[Equal]", "1"}], ",", " ", 
                    RowBox[{"RGBColor", "[", 
                    RowBox[{".9", ",", ".9", ",", ".5"}], "]"}], ",", 
                    RowBox[{"colw", "\[Equal]", "2"}], ",", 
                    RowBox[{"RGBColor", "[", 
                    RowBox[{".7", ",", ".7", ",", ".4"}], "]"}], ",", 
                    RowBox[{"colw", "\[Equal]", "3"}], ",", 
                    RowBox[{"RGBColor", "[", 
                    RowBox[{".9", ",", ".3", ",", ".3"}], "]"}]}], "]"}], ",",
                   "    ", "\[IndentingNewLine]", 
                  RowBox[{"Which", "[", 
                   RowBox[{
                    RowBox[{"colb", "\[Equal]", "1"}], ",", 
                    RowBox[{"RGBColor", "[", 
                    RowBox[{".4", ",", ".4", ",", ".3"}], "]"}], ",", 
                    RowBox[{"colb", "\[Equal]", "2"}], ",", 
                    RowBox[{"RGBColor", "[", 
                    RowBox[{".3", ",", ".4", ",", ".1"}], "]"}], ",", 
                    RowBox[{"colb", "\[Equal]", "3"}], ",", 
                    RowBox[{"RGBColor", "[", 
                    RowBox[{".2", ",", ".5", ",", ".5"}], "]"}]}], "]"}]}], 
                 "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Which", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"types", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"f", "+", "1"}], ",", "i", ",", "j"}], "]"}], 
                    "]"}], "\[Equal]", "pp"}], ",", 
                  RowBox[{"Translate", "[", 
                   RowBox[{"pawn", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j"}], "}"}]}], "]"}], ",", "  ", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"types", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"f", "+", "1"}], ",", "i", ",", "j"}], "]"}], 
                    "]"}], "\[Equal]", "rr"}], ",", 
                  RowBox[{"Translate", "[", 
                   RowBox[{"rook", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j"}], "}"}]}], "]"}], ",", "  ", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"types", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"f", "+", "1"}], ",", "i", ",", "j"}], "]"}], 
                    "]"}], "\[Equal]", "nn"}], ",", 
                  RowBox[{"Translate", "[", 
                   RowBox[{"knight", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j"}], "}"}]}], "]"}], ",", "  ", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"types", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"f", "+", "1"}], ",", "i", ",", "j"}], "]"}], 
                    "]"}], "\[Equal]", "bb"}], ",", 
                  RowBox[{"Translate", "[", 
                   RowBox[{"bishop", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j"}], "}"}]}], "]"}], ",", "  ", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"types", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"f", "+", "1"}], ",", "i", ",", "j"}], "]"}], 
                    "]"}], "\[Equal]", "qq"}], ",", 
                  RowBox[{"Translate", "[", 
                   RowBox[{"queen", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j"}], "}"}]}], "]"}], ",", "  ", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"types", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"f", "+", "1"}], ",", "i", ",", "j"}], "]"}], 
                    "]"}], "\[Equal]", "kk"}], ",", 
                  RowBox[{"Translate", "[", 
                   RowBox[{"king", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j"}], "}"}]}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"types", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"f", "+", "1"}], ",", "i", ",", "j"}], "]"}], 
                    "]"}], "\[Equal]", "0"}], ",", 
                  RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
               "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "8"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "8"}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", " ", "display"}]}]}]}], " ", "target", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"positions", " ", "--"}], "--"}], "--"}]}], " ", "*)"}],
           "\[IndentingNewLine]", "Green", ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"showtargets", "\[And]", 
             RowBox[{"h", "\[Equal]", "1"}], "\[And]", 
             RowBox[{"from", "\[NotEqual]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], "\[And]", 
             RowBox[{"to", "\[Equal]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}]}], ",", "\[IndentingNewLine]",
             
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"list", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "1"}], "]"}], "]"}], "\[Equal]", 
                 "oldfrom"}], ",", 
                RowBox[{"Disk", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"list", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2", ",", "1"}], "]"}], "]"}], "-", 
                    ".5"}], ",", 
                    RowBox[{
                    RowBox[{"list", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2", ",", "2"}], "]"}], "]"}], "-", 
                    ".5"}]}], "}"}], ",", ".2"}], "]"}], ",", 
                RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"i", ",", "l"}], "}"}]}], "\[IndentingNewLine]", "]"}],
             "\[IndentingNewLine]", ",", 
            RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"showmoves", "\[And]", 
             RowBox[{"h", "\[Equal]", "1"}], "\[And]", 
             RowBox[{"from", "==", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}]}], ",", "\[IndentingNewLine]",
             
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Arrow", " ", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"list", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", 
                  RowBox[{"{", 
                   RowBox[{".5", ",", ".5"}], "}"}]}], ",", " ", 
                 RowBox[{
                  RowBox[{"list", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "-", 
                  RowBox[{"{", 
                   RowBox[{".5", ",", ".5"}], "}"}]}]}], "}"}], "]"}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "2", ",", "l"}], "}"}]}], 
             "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", " ", "display"}]}]}]}], " ", "selected", " ", 
            "castling", " ", "option", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"positions", " ", "--"}], "--"}], "--"}]}], " ", "*)"}],
           "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"unmoveda1", ",", "Green", ",", "Red"}], "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"edit", "\[Equal]", "\"\<castling options\>\""}], ",", 
            RowBox[{"Disk", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{".5", ",", ".5"}], "}"}], ",", ".2"}], "]"}], ",", 
            RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"unmovedh1", ",", "Green", ",", "Red"}], "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"edit", "\[Equal]", "\"\<castling options\>\""}], ",", 
            RowBox[{"Disk", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"7.5", ",", ".5"}], "}"}], ",", ".2"}], "]"}], ",", 
            RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"unmoveda8", ",", "Green", ",", "Red"}], "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"edit", "\[Equal]", "\"\<castling options\>\""}], ",", 
            RowBox[{"Disk", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{".5", ",", "7.5"}], "}"}], ",", ".2"}], "]"}], ",", 
            RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"unmovedh8", ",", "Green", ",", "Red"}], "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"edit", "\[Equal]", "\"\<castling options\>\""}], ",", 
            RowBox[{"Disk", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"7.5", ",", "7.5"}], "}"}], ",", ".2"}], "]"}], ",", 
            RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"mark", " ", "from", " ", "and", " ", "to"}], "-", 
            "position"}], " ", "*)"}], "\[IndentingNewLine]", "Yellow", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"from", "\[NotEqual]", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], ",", 
            RowBox[{"Disk", "[", 
             RowBox[{
              RowBox[{"from", "-", 
               RowBox[{"{", 
                RowBox[{".5", ",", ".5"}], "}"}]}], ",", ".2"}], "]"}], ",", 
            RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"mark", " ", "whose", " ", "turn", " ", "it", " ", 
              RowBox[{"is", " ", ":", 
               RowBox[{
                RowBox[{"(", "NORTH", ")"}], " ", "n"}]}]}], "=", 
             RowBox[{"1", " ", "for", " ", "white"}]}], ",", " ", 
            RowBox[{
             RowBox[{"-", "1"}], " ", "for", " ", "black"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", "Black", ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"n", "==", "1"}], ",", " ", 
            RowBox[{"Disk", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", ".1"}], "]"}], ",", 
            RowBox[{"Disk", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "8"}], "}"}], ",", ".1"}], "]"}]}], "]"}], 
          ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", "move"}]}]}]}]}]}]}]}], "-", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"notation", " ", "--"}], "--"}], "--"}], "--"}], 
                   "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}]}], 
           "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"f", ">", "0"}], ",", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"wfrom", "[", 
                RowBox[{"[", "f", "]"}], "]"}], "\[NotEqual]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}]}], ",", "  ", 
              RowBox[{"(*", " ", 
               RowBox[{"White", " ", 
                RowBox[{"starts", "?"}]}], " ", "*)"}], "\[IndentingNewLine]",
               
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{"f", ",", "\"\<. \>\"", ",", 
                    RowBox[{"names", "[", 
                    RowBox[{"[", 
                    RowBox[{"wpiece", "[", 
                    RowBox[{"[", "f", "]"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"alpha", "[", 
                    RowBox[{"[", 
                    RowBox[{"wfrom", "[", 
                    RowBox[{"[", 
                    RowBox[{"f", ",", "1"}], "]"}], "]"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"wfrom", "[", 
                    RowBox[{"[", 
                    RowBox[{"f", ",", "2"}], "]"}], "]"}], ",", "\"\< \>\"", 
                    ",", 
                    RowBox[{"captures", "[", 
                    RowBox[{"[", 
                    RowBox[{"f", ",", "1"}], "]"}], "]"}]}], "}"}], "]"}], 
                  ",", "12"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"2.95", ",", 
                  RowBox[{"-", ".5"}]}], "}"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    "f", ",", "\"\<. \>\"", ",", "\"\<... - ...\>\""}], "}"}],
                    "]"}], ",", "12"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"2.95", ",", 
                  RowBox[{"-", ".5"}]}], "}"}]}], "]"}]}], 
             "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
            RowBox[{"Text", "[", 
             RowBox[{"\"\< \>\"", ",", 
              RowBox[{"{", 
               RowBox[{"2.8", ",", 
                RowBox[{"-", ".5"}]}], "}"}]}], "]"}]}], 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "wto", "]"}], "\[GreaterEqual]", "f", 
              ">", "0"}], "\[And]", 
             RowBox[{
              RowBox[{"wto", "[", 
               RowBox[{"[", "f", "]"}], "]"}], "\[NotEqual]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}]}], ",", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"alpha", "[", 
                    RowBox[{"[", 
                    RowBox[{"wto", "[", 
                    RowBox[{"[", 
                    RowBox[{"f", ",", "1"}], "]"}], "]"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"wto", "[", 
                    RowBox[{"[", 
                    RowBox[{"f", ",", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"checks", "[", 
                    RowBox[{"[", 
                    RowBox[{"f", ",", "1"}], "]"}], "]"}]}], "}"}], "]"}], 
                  ",", "12"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"3.75", ",", 
                  RowBox[{"-", ".5"}]}], "}"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"l", "\[Equal]", "1"}], "\[And]", 
                 RowBox[{"h", "\[Equal]", "1"}], "\[And]", 
                 RowBox[{
                  RowBox[{"Length", "[", "bto", "]"}], "<", "r"}]}], ",", " ",
                 
                RowBox[{"(*", " ", 
                 RowBox[{"no", " ", "move", " ", 
                  RowBox[{"left", " ", ":", " ", 
                   RowBox[{
                   "announce", " ", "mate", " ", "or", " ", "stalemate"}]}]}],
                  " ", "*)"}], "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"checks", "[", 
                    RowBox[{"[", 
                    RowBox[{"f", ",", "1"}], "]"}], "]"}], "\[Equal]", 
                   "\"\<+\>\""}], ",", 
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", "\"\<mate\>\"", "}"}], "]"}], ",", "12"}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4.4", ",", 
                    RowBox[{"-", ".5"}]}], "}"}]}], "]"}], ",", 
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", "\"\<stalemate\>\"", "}"}], "]"}], ",", 
                    "12"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4.4", ",", 
                    RowBox[{"-", ".5"}]}], "}"}]}], "]"}]}], "]"}], " ", 
                "\[IndentingNewLine]", ",", 
                RowBox[{"{", "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}], 
            ",", 
            RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "bfrom", "]"}], "\[GreaterEqual]", "f", 
             ">", "0"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"names", "[", 
                    RowBox[{"[", 
                    RowBox[{"bpiece", "[", 
                    RowBox[{"[", "f", "]"}], "]"}], "]"}], "]"}], ",", 
                   RowBox[{"alpha", "[", 
                    RowBox[{"[", 
                    RowBox[{"bfrom", "[", 
                    RowBox[{"[", 
                    RowBox[{"f", ",", "1"}], "]"}], "]"}], "]"}], "]"}], ",", 
                   
                   RowBox[{"bfrom", "[", 
                    RowBox[{"[", 
                    RowBox[{"f", ",", "2"}], "]"}], "]"}], ",", "\"\< \>\"", 
                   ",", 
                   RowBox[{"captures", "[", 
                    RowBox[{"[", 
                    RowBox[{"f", ",", "2"}], "]"}], "]"}]}], "}"}], "]"}], 
                ",", "\[IndentingNewLine]", "12"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"4.4", ",", 
                RowBox[{"-", ".5"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "bto", "]"}], "\[GreaterEqual]", "f", ">",
              "0"}], ",", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"alpha", "[", 
                    RowBox[{"[", 
                    RowBox[{"bto", "[", 
                    RowBox[{"[", 
                    RowBox[{"f", ",", "1"}], "]"}], "]"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"bto", "[", 
                    RowBox[{"[", 
                    RowBox[{"f", ",", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"checks", "[", 
                    RowBox[{"[", 
                    RowBox[{"f", ",", "2"}], "]"}], "]"}]}], "}"}], "]"}], 
                  ",", "12"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"5.0", ",", 
                  RowBox[{"-", ".5"}]}], "}"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"l", "\[Equal]", "1"}], "\[And]", 
                 RowBox[{"h", "\[Equal]", "1"}]}], ",", " ", 
                RowBox[{"(*", " ", 
                 RowBox[{"no", " ", "move", " ", 
                  RowBox[{"left", " ", ":", " ", 
                   RowBox[{
                   "announce", " ", "mate", " ", "or", " ", "stalemate"}]}]}],
                  " ", "*)"}], "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"checks", "[", 
                    RowBox[{"[", 
                    RowBox[{"f", ",", "2"}], "]"}], "]"}], "\[Equal]", 
                   "\"\<+\>\""}], ",", 
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", "\"\<mate\>\"", "}"}], "]"}], ",", "12"}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"5.8", ",", 
                    RowBox[{"-", ".5"}]}], "}"}]}], "]"}], ",", 
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", "\"\<stalemate\>\"", "}"}], "]"}], ",", 
                    "12"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"5.8", ",", 
                    RowBox[{"-", ".5"}]}], "}"}]}], "]"}]}], "]"}], 
                "\[IndentingNewLine]", ",", 
                RowBox[{"{", "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}], 
            ",", 
            RowBox[{"{", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "}"}], ",", " ", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", ".1"}], ",", "8.1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", ".9"}], ",", "8.1"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"400", ",", "400"}], "}"}]}]}], "\[IndentingNewLine]", 
       "]"}], ",", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", 
         "===", 
         RowBox[{"\[Equal]", " ", 
          RowBox[{"end", " ", "Graphics"}]}], " ", "===", "===", "===", "===",
          "===", "===", "===", "==="}], "="}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{"{", "  ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "here", " ", "we", " ", "act", " ", "on", " ", "the", " ", 
           "mouseclicks", " ", 
           RowBox[{"(", 
            RowBox[{"we", " ", "are", " ", "in", " ", "a", " ", 
             RowBox[{"ClickPane", " ", "!"}]}], ")"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"h", "\[Equal]", "1"}], "\[And]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "list", "]"}], ">", "1"}], "\[Or]", 
              RowBox[{"edit", "\[NotEqual]", "\"\<play\>\""}]}], ")"}]}], ",",
            
           RowBox[{"{", "   ", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"not", " ", "history", " ", 
                RowBox[{"selected", "?"}]}], ".."}], " ", "and", " ", "still",
               " ", "a", " ", "move", " ", 
              RowBox[{"available", "?"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"pos", "=", 
              RowBox[{
               RowBox[{"Floor", "[", "#", "]"}], "+", 
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"pos", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "=", 
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{"pos", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"pos", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "=", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"pos", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", "8"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"pos", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "=", 
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{"pos", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"pos", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "=", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"pos", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", "8"}], "]"}]}], ",", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"-", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"edit", " ", "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
               "-"}], " ", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"\[Not]", "part1"}], ",", " ", 
               RowBox[{"(*", " ", 
                RowBox[{
                 RowBox[{"not", " ", "from"}], "-", 
                 RowBox[{"pos", " ", 
                  RowBox[{"given", "?"}]}]}], " ", "*)"}], "  ", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Which", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"edit", "\[Equal]", "\"\<play\>\""}], ",", 
                  RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"edit", "\[Equal]", "\"\<delete\>\""}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
                    "0"}], ";", 
                   RowBox[{
                    RowBox[{"type", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
                    "0"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"edit", "\[Equal]", "\"\<white pawn\>\""}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
                    "1"}], ";", 
                   RowBox[{
                    RowBox[{"type", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
                    "1"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"edit", "\[Equal]", "\"\<white rook\>\""}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
                    "1"}], ";", 
                   RowBox[{
                    RowBox[{"type", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
                    "2"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"edit", "\[Equal]", "\"\<white knight\>\""}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
                    "1"}], ";", 
                   RowBox[{
                    RowBox[{"type", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
                    "3"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"edit", "\[Equal]", "\"\<white bishop\>\""}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
                    "1"}], ";", 
                   RowBox[{
                    RowBox[{"type", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
                    "4"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"edit", "\[Equal]", "\"\<white queen\>\""}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
                    "1"}], ";", 
                   RowBox[{
                    RowBox[{"type", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
                    "5"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"edit", "\[Equal]", "\"\<white king\>\""}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
                    "1"}], ";", 
                   RowBox[{
                    RowBox[{"type", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
                    "6"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"edit", "\[Equal]", "\"\<black pawn\>\""}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";", 
                   RowBox[{
                    RowBox[{"type", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
                    "1"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"edit", "\[Equal]", "\"\<black rook\>\""}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";", 
                   RowBox[{
                    RowBox[{"type", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
                    "2"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"edit", "\[Equal]", "\"\<black knight\>\""}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";", 
                   RowBox[{
                    RowBox[{"type", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
                    "3"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"edit", "\[Equal]", "\"\<black bishop\>\""}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";", 
                   RowBox[{
                    RowBox[{"type", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
                    "4"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"edit", "\[Equal]", "\"\<black queen\>\""}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";", 
                   RowBox[{
                    RowBox[{"type", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
                    "5"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"edit", "\[Equal]", "\"\<black king\>\""}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";", 
                   RowBox[{
                    RowBox[{"type", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
                    "6"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"edit", "\[Equal]", "\"\<next player\>\""}], 
                   "\[And]", 
                   RowBox[{"r", "\[Equal]", "0"}]}], ",", 
                  RowBox[{"n", "=", 
                   RowBox[{"-", "n"}]}]}], "     ", 
                 RowBox[{"(*", " ", 
                  RowBox[{"change", " ", "moveside"}], " ", "*)"}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"edit", "\[NotEqual]", "\"\<play\>\""}], ",", 
                  RowBox[{"list", "=", "list0"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"edit", "\[Equal]", "\"\<castling options\>\""}], 
                "\[And]", 
                RowBox[{
                 RowBox[{"type", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], 
                 "\[Equal]", "rr"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"pos", "\[Equal]", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}]}], ",", 
                  RowBox[{"unmoveda1", "=", 
                   RowBox[{"\[Not]", "unmoveda1"}]}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"pos", "\[Equal]", 
                   RowBox[{"{", 
                    RowBox[{"8", ",", "1"}], "}"}]}], ",", 
                  RowBox[{"unmovedh1", "=", 
                   RowBox[{"\[Not]", "unmovedh1"}]}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"pos", "\[Equal]", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "8"}], "}"}]}], ",", 
                  RowBox[{"unmoveda8", "=", 
                   RowBox[{"\[Not]", "unmoveda8"}]}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"pos", "\[Equal]", 
                   RowBox[{"{", 
                    RowBox[{"8", ",", "8"}], "}"}]}], ",", 
                  RowBox[{"unmovedh8", "=", 
                   RowBox[{"\[Not]", "unmovedh8"}]}]}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"edit", "\[Equal]", "\"\<reset\>\""}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"r", "=", "0"}], ";", 
                RowBox[{"edit", "=", "\"\<play\>\""}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"wto", "=", 
                 RowBox[{"wfrom", "=", 
                  RowBox[{"bfrom", "=", 
                   RowBox[{"bto", "=", 
                    RowBox[{"wpiece", "=", 
                    RowBox[{"bpiece", "=", 
                    RowBox[{"{", "}"}]}]}]}]}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"side", "=", "side0"}], ";", 
                RowBox[{"type", "=", "type0"}], ";", 
                RowBox[{"list", "=", "list0"}], ";", 
                RowBox[{"sides", "=", 
                 RowBox[{"{", "side0", "}"}]}], ";", 
                RowBox[{"types", "=", 
                 RowBox[{"{", "type0", "}"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"part1", "=", 
                 RowBox[{"part2", "=", "False"}]}], ";", 
                RowBox[{"ok", "=", "False"}], ";", 
                RowBox[{"from", "=", 
                 RowBox[{"to", "=", 
                  RowBox[{"epwhite", "=", 
                   RowBox[{"epblack", "=", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}]}]}]}], ";", 
                RowBox[{"n", "=", "1"}], ";", "\[IndentingNewLine]", 
                RowBox[{"unmoveda1", "=", 
                 RowBox[{"unmoveda8", "=", 
                  RowBox[{"unmovedh1", "=", 
                   RowBox[{"unmovedh8", "=", "True"}]}]}]}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"edit", "\[Equal]", "\"\<clear\>\""}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"r", "=", "0"}], ";", "\[IndentingNewLine]", 
                RowBox[{"wto", "=", 
                 RowBox[{"wfrom", "=", 
                  RowBox[{"bfrom", "=", 
                   RowBox[{"bto", "=", 
                    RowBox[{"wpiece", "=", 
                    RowBox[{"bpiece", "=", 
                    RowBox[{"{", "}"}]}]}]}]}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"list", "=", "list0"}], ";", 
                RowBox[{"side", "=", 
                 RowBox[{"type", "=", "all0"}]}], ";", 
                RowBox[{"sides", "=", 
                 RowBox[{"types", "=", 
                  RowBox[{"{", "all0", "}"}]}]}], ";", "\[IndentingNewLine]", 
                
                RowBox[{"part1", "=", 
                 RowBox[{"part2", "=", "False"}]}], ";", 
                RowBox[{"ok", "=", "False"}], ";", 
                RowBox[{"from", "=", 
                 RowBox[{"to", "=", 
                  RowBox[{"epwhite", "=", 
                   RowBox[{"epblack", "=", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}]}]}]}], ";", 
                RowBox[{"n", "=", "1"}], ";", "\[IndentingNewLine]", 
                RowBox[{"unmoveda1", "=", 
                 RowBox[{"unmoveda8", "=", 
                  RowBox[{"unmovedh1", "=", 
                   RowBox[{"unmovedh8", "=", "True"}]}]}]}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"play", " ", "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
                    "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"edit", "\[Equal]", "\"\<play\>\""}], ",", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"n", "\[Equal]", "1"}], "\[And]", 
                    RowBox[{"\[Not]", "randomwhite"}]}], ")"}], "\[Or]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"n", "\[Equal]", 
                    RowBox[{"-", "1"}]}], "\[And]", 
                    RowBox[{"\[Not]", "randomblack"}]}], ")"}]}], ",", 
                   RowBox[{
                   "{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"(*", "  ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "set", " ", "flags", " ", "part1", " ", "and", " ", 
                    RowBox[{"part2", ":", "  ", "part1"}]}], "=", 
                    RowBox[{"true", " ", "<=", ">", " ", 
                    RowBox[{"from", "-", "click"}]}]}], ",", " ", 
                    RowBox[{"part2", "=", 
                    RowBox[{"true", " ", "<=", ">", " ", 
                    RowBox[{"to", "-", "click"}]}]}]}], "  ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"l", "=", 
                    RowBox[{"Length", "[", "list", "]"}]}], ",", 
                    RowBox[{"part1", "=", 
                    RowBox[{"part2", "=", "False"}]}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"from", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], 
                    "\[And]", 
                    RowBox[{"n", "==", 
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}]}], ",", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"For", " ", "[", 
                    RowBox[{
                    RowBox[{"i", "=", "1"}], ",", 
                    RowBox[{"i", "\[LessEqual]", "l"}], ",", 
                    RowBox[{"i", "++"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"list", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "\[Equal]", 
                    "pos"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"part1", "=", "True"}], ",", 
                    RowBox[{"Break", "[", "]"}]}], "}"}]}], "]"}]}], "]"}], 
                    "\[IndentingNewLine]", "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"from", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", "0"}], 
                    "\[And]", 
                    RowBox[{
                    RowBox[{"to", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], 
                    "\[And]", 
                    RowBox[{"n", "\[NotEqual]", 
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}]}], ",", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"For", " ", "[", 
                    RowBox[{
                    RowBox[{"i", "=", "1"}], ",", 
                    RowBox[{"i", "\[LessEqual]", "l"}], ",", 
                    RowBox[{"i", "++"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"list", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "\[Equal]", 
                    "oldfrom"}], "\[And]", 
                    RowBox[{
                    RowBox[{"list", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "\[Equal]", 
                    "pos"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"part2", "=", "True"}], ",", 
                    RowBox[{"Break", "[", "]"}]}], "}"}]}], "]"}]}], "]"}], 
                    "\[IndentingNewLine]", "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    RowBox[{"store", " ", "from"}], "-", 
                    RowBox[{"pos", " ", "or", " ", "to"}], "-", "pos"}], " ", 
                    "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{"part1", ",", 
                    RowBox[{
                    RowBox[{"oldfrom", "=", 
                    RowBox[{"from", "=", "pos"}]}], ";", 
                    RowBox[{"to", "=", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{"part2", ",", 
                    RowBox[{"to", "=", "pos"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"part1", "\[And]", 
                    RowBox[{"n", "\[Equal]", "1"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"r", "=", 
                    RowBox[{"r", "+", "1"}]}], ";", 
                    RowBox[{"wfrom", "=", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"wfrom", ",", "pos"}], "]"}]}], ";", 
                    RowBox[{"wpiece", "=", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"wpiece", ",", 
                    RowBox[{"type", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], " ", 
                    "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"part1", "\[And]", 
                    RowBox[{"n", "\[Equal]", 
                    RowBox[{"-", "1"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"bfrom", "=", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"bfrom", ",", "pos"}], "]"}]}], ";", 
                    RowBox[{"bpiece", "=", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"bpiece", ",", 
                    RowBox[{"type", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}],
                     ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "0"}], ",", "   ", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    RowBox[{"if", " ", "Black", " ", "starts"}], " ", "->", 
                    " ", 
                    RowBox[{
                    "insert", " ", "dummy", " ", "White", " ", "move"}]}], 
                    " ", "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"r", "=", "1"}], ";", 
                    RowBox[{"wfrom", "=", 
                    RowBox[{"wto", "=", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], "}"}]}]}], ";", 
                    RowBox[{"wpiece", "=", 
                    RowBox[{"{", "pp", "}"}]}], ";", 
                    RowBox[{"captures", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<-\>\"", ",", "\"\<-\>\""}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<-\>\"", ",", "\"\<-\>\""}], "}"}]}], 
                    "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
                    "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    RowBox[{"from", "-", 
                    RowBox[{"position", " ", "clicked", " ", "twice"}]}], " ",
                     "=", 
                    RowBox[{
                    RowBox[{">", " ", "part1"}], "=", 
                    RowBox[{"part2", "=", 
                    RowBox[{"false", " ", "=", 
                    RowBox[{">", " ", 
                    RowBox[{"reset", " ", "targets"}]}]}]}]}]}], " ", "*)"}], 
                    " ", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"\[Not]", "part1"}], "\[And]", 
                    RowBox[{"\[Not]", "part2"}]}], ",", "\[IndentingNewLine]",
                     
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"from", "\[NotEqual]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "\[And]", 
                    RowBox[{"to", "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "\[And]", 
                    RowBox[{"n", "\[Equal]", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{"wfrom", "=", 
                    RowBox[{"Delete", "[", 
                    RowBox[{"wfrom", ",", "r"}], "]"}]}], ";", 
                    RowBox[{"wpiece", "=", 
                    RowBox[{"Delete", "[", 
                    RowBox[{"wpiece", ",", "r"}], "]"}]}], ";", 
                    RowBox[{"r", "=", 
                    RowBox[{"r", "-", "1"}]}]}], ",", 
                    RowBox[{"{", "}"}]}], "]"}], ";", " ", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"from", "\[NotEqual]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "\[And]", 
                    RowBox[{"to", "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "\[And]", 
                    RowBox[{"n", "\[Equal]", 
                    RowBox[{"-", "1"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"bfrom", "=", 
                    RowBox[{"Delete", "[", 
                    RowBox[{"wfrom", ",", "r"}], "]"}]}], ";", 
                    RowBox[{"bpiece", "=", 
                    RowBox[{"Delete", "[", 
                    RowBox[{"bpiece", ",", "r"}], "]"}]}]}], ",", 
                    RowBox[{"{", "}"}]}], "]"}], ";", " ", 
                    "\[IndentingNewLine]", 
                    RowBox[{"from", "=", 
                    RowBox[{"to", "=", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}]}]}]}], 
                    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", "}"}]}], "]"}], ",", "   ", 
                 RowBox[{"(*", " ", 
                  RowBox[{"endif", " ", "not", " ", "random"}], " ", "*)"}], 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", " ", "create"}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
                    " ", "target", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"positions", "  ", "--"}], "--"}], "--"}], "--"}],
                     "--"}]}], "-", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}], " ", "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{"randomized", " ", "white", " ", "player"}], " ", 
                  "*)"}], "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"randomwhite", "\[And]", 
                    RowBox[{"n", "==", "1"}], "\[And]", 
                    RowBox[{"from", "==", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"i", "=", 
                    RowBox[{"RandomInteger", "[", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"Length", "[", "list", "]"}]}], "}"}], "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"from", "=", 
                    RowBox[{"list", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ";", 
                    RowBox[{"pos", "=", 
                    RowBox[{"to", "=", 
                    RowBox[{"list", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"wfrom", "=", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"wfrom", ",", "from"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"wpiece", "=", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"wpiece", ",", 
                    RowBox[{"type", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"from", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"from", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}],
                     ";", "\[IndentingNewLine]", 
                    RowBox[{"captures", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"captures", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"\"\<-\>\"", ",", "\"\<-\>\""}], "}"}]}], "]"}]}],
                     ";", "\[IndentingNewLine]", 
                    RowBox[{"checks", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"checks", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", ",", "\"\< \>\""}], "}"}]}], "]"}]}],
                     ";", "\[IndentingNewLine]", 
                    RowBox[{"r", "=", 
                    RowBox[{"r", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"part1", "=", "False"}], ";", " ", 
                    RowBox[{"part2", "=", "True"}]}]}], "\[IndentingNewLine]",
                   "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{"randomized", " ", "black", " ", "player"}], " ", 
                  "*)"}], "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"randomblack", "\[And]", 
                    RowBox[{"n", "==", 
                    RowBox[{"-", "1"}]}], "\[And]", 
                    RowBox[{"from", "==", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"i", "=", 
                    RowBox[{"RandomInteger", "[", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"Length", "[", "list", "]"}]}], "}"}], "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"from", "=", 
                    RowBox[{"list", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ";", 
                    RowBox[{"pos", "=", 
                    RowBox[{"to", "=", 
                    RowBox[{"list", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"bfrom", "=", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"bfrom", ",", "from"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"bpiece", "=", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"bpiece", ",", 
                    RowBox[{"type", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"from", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"from", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}],
                     ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "==", "0"}], ",", " ", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    RowBox[{"if", " ", "Black", " ", "starts"}], " ", "->", 
                    " ", 
                    RowBox[{
                    "insert", " ", "dummy", " ", "White", " ", "move"}]}], 
                    " ", "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"r", "=", "1"}], ";", 
                    RowBox[{"wfrom", "=", 
                    RowBox[{"wto", "=", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"9", ",", "\"\< \>\""}], "}"}], "}"}]}]}], ";", 
                    RowBox[{"wpiece", "=", 
                    RowBox[{"{", "pp", "}"}]}]}]}], "]"}], ";", " ", 
                    "\[IndentingNewLine]", 
                    RowBox[{"captures", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"captures", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"\"\<-\>\"", ",", "\"\<-\>\""}], "}"}]}], "]"}]}],
                     ";", "\[IndentingNewLine]", 
                    RowBox[{"part1", "=", "False"}], ";", " ", 
                    RowBox[{"part2", "=", "True"}]}]}], "\[IndentingNewLine]",
                   "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"x", "=", 
                  RowBox[{"from", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                 RowBox[{"y", "=", 
                  RowBox[{"from", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", "execute"}]}]}]}]}]}]}]}]}], " ", 
                    "selected", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"move", "--"}], "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}]}], "-"}], " ", "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{"part2", ",", 
                   RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"from", "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}]}], "\[Or]", 
                    RowBox[{"to", "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}]}], "\[Or]", 
                    RowBox[{"from", "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "1"}], "}"}]}]}], ",", 
                    RowBox[{"unmoveda1", "=", "False"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"from", "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"8", ",", "1"}], "}"}]}], "\[Or]", 
                    RowBox[{"to", "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"8", ",", "1"}], "}"}]}], "\[Or]", 
                    RowBox[{"from", "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "1"}], "}"}]}]}], ",", 
                    RowBox[{"unmovedh1", "=", "False"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"from", "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "8"}], "}"}]}], "\[Or]", 
                    RowBox[{"to", "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "8"}], "}"}]}], "\[Or]", 
                    RowBox[{"from", "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "8"}], "}"}]}]}], ",", 
                    RowBox[{"unmoveda8", "=", "False"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"from", "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"8", ",", "8"}], "}"}]}], "\[Or]", 
                    RowBox[{"to", "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"8", ",", "8"}], "}"}]}], "\[Or]", 
                    RowBox[{"from", "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "8"}], "}"}]}]}], ",", 
                    RowBox[{"unmovedh8", "=", "False"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"type", "[", 
                    RowBox[{"[", " ", 
                    RowBox[{"x", ",", "y"}], "]"}], "]"}], "\[Equal]", "pp"}],
                     "\[And]", 
                    RowBox[{"y", "\[Equal]", "2"}], "\[And]", 
                    RowBox[{
                    RowBox[{"to", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "4"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"epwhite", "=", 
                    RowBox[{"{", " ", 
                    RowBox[{"x", ",", "3"}], "}"}]}]}], "]"}], ",", " ", 
                    RowBox[{"(*", " ", 
                    RowBox[{"set", " ", "en", " ", "passant", " ", "marker"}],
                     " ", "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"type", "[", 
                    RowBox[{"[", " ", 
                    RowBox[{"x", ",", "y"}], "]"}], "]"}], "\[Equal]", "pp"}],
                     "\[And]", 
                    RowBox[{"y", "\[Equal]", "7"}], "\[And]", 
                    RowBox[{
                    RowBox[{"to", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "5"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"epblack", "=", 
                    RowBox[{"{", " ", 
                    RowBox[{"x", ",", "6"}], "}"}]}]}], "]"}], ",", " ", 
                    RowBox[{"(*", " ", 
                    RowBox[{"set", " ", "en", " ", "passant", " ", "marker"}],
                     " ", "*)"}], "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"type", "[", 
                    RowBox[{"[", " ", 
                    RowBox[{"x", ",", "y"}], "]"}], "]"}], "\[Equal]", "pp"}],
                     "\[And]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"to", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "8"}], 
                    "\[Or]", 
                    RowBox[{
                    RowBox[{"to", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}]}], 
                    ")"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Which", "[", "     ", 
                    RowBox[{"(*", " ", "promotion", " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"prom", "\[Equal]", "\"\<queen\>\""}], ",", 
                    RowBox[{
                    RowBox[{"type", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"to", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"to", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
                    "qq"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"prom", "\[Equal]", "\"\<rook\>\""}], ",", 
                    RowBox[{
                    RowBox[{"type", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"to", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"to", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
                    "rr"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"prom", "\[Equal]", "\"\<bishop\>\""}], ",", 
                    RowBox[{
                    RowBox[{"type", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"to", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"to", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
                    "bb"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"prom", "\[Equal]", "\"\<knight\>\""}], ",", 
                    RowBox[{
                    RowBox[{"type", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"to", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"to", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
                    "nn"}]}], "\[IndentingNewLine]", "]"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"type", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"to", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"to", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
                    RowBox[{"type", "[", 
                    RowBox[{"[", " ", 
                    RowBox[{"x", ",", "y"}], "]"}], "]"}]}]}], " ", 
                    RowBox[{"(*", " ", 
                    RowBox[{"normal", " ", "move"}], " ", "*)"}], 
                    "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", "castling", "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"type", "[", 
                    RowBox[{"[", " ", 
                    RowBox[{"x", ",", "y"}], "]"}], "]"}], "==", "kk"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"from", "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "1"}], "}"}]}], "\[And]", 
                    RowBox[{"to", "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "1"}], "}"}]}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"type", "[", 
                    RowBox[{"[", 
                    RowBox[{"4", ",", "1"}], "]"}], "]"}], "=", "rr"}], ";", 
                    RowBox[{
                    RowBox[{"type", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", "0"}], ";", 
                    RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{"4", ",", "1"}], "]"}], "]"}], "=", "1"}], ";", 
                    RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", "0"}]}]}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"from", "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "1"}], "}"}]}], "\[And]", 
                    RowBox[{"to", "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"7", ",", "1"}], "}"}]}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"type", "[", 
                    RowBox[{"[", 
                    RowBox[{"6", ",", "1"}], "]"}], "]"}], "=", "rr"}], ";", 
                    RowBox[{
                    RowBox[{"type", "[", 
                    RowBox[{"[", 
                    RowBox[{"8", ",", "1"}], "]"}], "]"}], "=", "0"}], ";", 
                    RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{"6", ",", "1"}], "]"}], "]"}], "=", "1"}], ";", 
                    RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{"8", ",", "1"}], "]"}], "]"}], "=", "0"}]}]}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"from", "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "8"}], "}"}]}], "\[And]", 
                    RowBox[{"to", "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "8"}], "}"}]}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"type", "[", 
                    RowBox[{"[", 
                    RowBox[{"4", ",", "8"}], "]"}], "]"}], "=", "rr"}], ";", 
                    RowBox[{
                    RowBox[{"type", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "8"}], "]"}], "]"}], "=", "0"}], ";", 
                    RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{"4", ",", "8"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";", 
                    RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "8"}], "]"}], "]"}], "=", "0"}]}]}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"from", "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "8"}], "}"}]}], "\[And]", 
                    RowBox[{"to", "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"7", ",", "8"}], "}"}]}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"type", "[", 
                    RowBox[{"[", 
                    RowBox[{"6", ",", "8"}], "]"}], "]"}], "=", "rr"}], ";", 
                    RowBox[{
                    RowBox[{"type", "[", 
                    RowBox[{"[", 
                    RowBox[{"8", ",", "8"}], "]"}], "]"}], "=", "0"}], ";", 
                    RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{"6", ",", "8"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";", 
                    RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{"8", ",", "8"}], "]"}], "]"}], "=", "0"}]}]}], 
                    "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", "enpassant", " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"capture", "=", "\"\<-\>\""}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"type", "[", 
                    RowBox[{"[", " ", 
                    RowBox[{"x", ",", "y"}], "]"}], "]"}], "\[Equal]", "pp"}],
                     "\[And]", 
                    RowBox[{"to", "==", "epblack"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"type", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"to", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"to", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", "1"}]}], "]"}], 
                    "]"}], "=", "0"}], ";", 
                    RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"to", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"to", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", "1"}]}], "]"}], 
                    "]"}], "=", "0"}], ";", 
                    RowBox[{"capture", "=", "\"\<x\>\""}]}]}], 
                    "\[IndentingNewLine]", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"type", "[", 
                    RowBox[{"[", " ", 
                    RowBox[{"x", ",", "y"}], "]"}], "]"}], "\[Equal]", "pp"}],
                     "\[And]", 
                    RowBox[{"to", "==", "epwhite"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"type", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"to", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"to", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], "]"}], 
                    "]"}], "=", "0"}], ";", 
                    RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"to", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"to", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], "]"}], 
                    "]"}], "=", "0"}], ";", 
                    RowBox[{"capture", "=", "\"\<x\>\""}]}]}], 
                    "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"type", "[", 
                    RowBox[{"[", " ", 
                    RowBox[{"x", ",", "y"}], "]"}], "]"}], "=", "0"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"to", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"to", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], 
                    "\[NotEqual]", "0"}], ",", " ", 
                    RowBox[{"capture", "=", "\"\<x\>\""}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"to", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"to", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
                    RowBox[{"side", "[", 
                    RowBox[{"[", " ", 
                    RowBox[{"x", ",", "y"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", " ", 
                    RowBox[{"x", ",", "y"}], "]"}], "]"}], "=", "0"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"n", "==", "1"}], ",", "  ", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    RowBox[{"white", "'"}], "s", " ", 
                    RowBox[{"move", "?"}]}], " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"wto", "=", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"wto", ",", "pos"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", " ", 
                    RowBox[{"captures", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"captures", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"\"\<-\>\"", ",", "\"\<-\>\""}], "}"}]}], "]"}]}],
                     ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"captures", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", ",", "1"}], "]"}], "]"}], "=", "capture"}], 
                    ";", " ", "\[IndentingNewLine]", 
                    RowBox[{"list", "=", "list0"}], ";", 
                    "\[IndentingNewLine]", " ", 
                    RowBox[{"checks", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"checks", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", ",", "\"\< \>\""}], "}"}]}], "]"}]}],
                     ";", "\[IndentingNewLine]", 
                    RowBox[{"Do", "[", "   ", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    "are", " ", "we", " ", "attacking", " ", "the", " ", 
                    RowBox[{"opponent", "'"}], "s", " ", 
                    RowBox[{"king", "?"}]}], " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"type", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Equal]", "kk"}],
                     "\[And]", 
                    RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Equal]", 
                    RowBox[{"-", "n"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"swattacked", "=", 
                    RowBox[{"check", "[", 
                    RowBox[{"side", ",", "type", ",", "i", ",", "j", ",", 
                    RowBox[{"-", "n"}]}], "]"}]}], ";", 
                    RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "8"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "8"}], "}"}]}], "\[IndentingNewLine]", 
                    "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{"swattacked", ",", 
                    RowBox[{
                    RowBox[{"checks", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", ",", "1"}], "]"}], "]"}], "=", 
                    "\"\<+\>\""}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"n", "\[Equal]", 
                    RowBox[{"-", "1"}]}], ",", "  ", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    RowBox[{"black", "'"}], "s", " ", 
                    RowBox[{"move", "?"}]}], " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"bto", "=", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"bto", ",", "pos"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"sides", "=", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"sides", ",", "side"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"types", "=", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"types", ",", "type"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"captures", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", ",", "2"}], "]"}], "]"}], "=", "capture"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"list", "=", "list0"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Do", "[", "  ", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    "are", " ", "we", " ", "attacking", " ", "the", " ", 
                    RowBox[{"opponent", "'"}], "s", " ", 
                    RowBox[{"king", "?"}]}], " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"type", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Equal]", "kk"}],
                     "\[And]", 
                    RowBox[{
                    RowBox[{"side", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Equal]", 
                    RowBox[{"-", "n"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"swattacked", "=", 
                    RowBox[{"check", "[", 
                    RowBox[{"side", ",", "type", ",", "i", ",", "j", ",", 
                    RowBox[{"-", "n"}]}], "]"}]}], ";", 
                    RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "8"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "8"}], "}"}]}], "\[IndentingNewLine]", 
                    "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{"swattacked", ",", 
                    RowBox[{
                    RowBox[{"checks", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", ",", "2"}], "]"}], "]"}], "=", 
                    "\"\<+\>\""}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
                    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"n", "\[Equal]", "1"}], ",", 
                    RowBox[{"epblack", "=", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], ",", 
                    RowBox[{"epwhite", "=", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}]}], "]"}], ",", " ", 
                    RowBox[{"(*", " ", 
                    RowBox[{"reset", " ", "en", " ", "passant", " ", "move"}],
                     " ", "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"n", "=", 
                    RowBox[{"-", "n"}]}], ",", 
                    RowBox[{"list", "=", "list0"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"part1", "=", 
                    RowBox[{"part2", "=", "False"}]}], ",", 
                    RowBox[{"from", "=", 
                    RowBox[{"to", "=", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}]}]}], 
                    "\[IndentingNewLine]", "}"}]}], "]"}]}], "    ", 
                RowBox[{"(*", " ", 
                 RowBox[{
                  RowBox[{"endif", " ", "part2"}], "=", "True"}], " ", "*)"}],
                 "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", "end"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}],
                    " ", "of", " ", "moving", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"code", " ", "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}]}], 
                  "-"}], " ", "*)"}], "\[IndentingNewLine]", "}"}]}], "]"}]}],
             "  ", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"endif", " ", "edit"}], " ", "=", " ", "\"\<play\>\""}],
              " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "}"}]}], "]"}], "  ", 
         RowBox[{"(*", " ", 
          RowBox[{"history", " ", 
           RowBox[{"selected", " ", "?"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], 
        "\[IndentingNewLine]", ")"}], "&"}]}], "\[IndentingNewLine]", "]"}]}],
    ",", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"end", " ", "clickpane"}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", "manipulation"}]}]}]}]}]}]}]}]}], " ", 
     RowBox[{"input", " ", ":", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"colw", ",", "1", ",", 
       RowBox[{"Style", "[", 
        RowBox[{"\"\<color White\>\"", ",", "10"}], "]"}]}], "}"}], ",", 
     RowBox[{"Range", "[", "3", "]"}], ",", " ", 
     RowBox[{"ControlType", "\[Rule]", "PopupMenu"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"colb", ",", "1", ",", 
       RowBox[{"Style", "[", 
        RowBox[{"\"\<color Black\>\"", ",", "10"}], "]"}]}], "}"}], ",", 
     RowBox[{"Range", "[", "3", "]"}], ",", " ", 
     RowBox[{"ControlType", "\[Rule]", "PopupMenu"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"randomwhite", ",", "False", ",", "\"\<random White\>\""}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", "  ", 
   RowBox[{"(*", " ", 
    RowBox[{"White", " ", "makes", " ", "random", " ", "moves"}], " ", "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"randomblack", ",", "False", ",", "\"\<random Black\>\""}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", "  ", 
   RowBox[{"(*", " ", 
    RowBox[{"Black", " ", "makes", " ", "random", " ", "moves"}], " ", "*)"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"showmoves", ",", "False", ",", "\"\<show moves\>\""}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", "  ", 
   RowBox[{"(*", " ", 
    RowBox[{"show", " ", "all", " ", "potential", " ", "moves"}], " ", "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"showtargets", ",", "True", ",", "\"\<show targets\>\""}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"prom", ",", "\"\<queen\>\"", ",", 
       RowBox[{"Style", "[", 
        RowBox[{"\"\<promotion to\>\"", ",", "10"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<queen\>\"", ",", "\"\<rook\>\"", ",", "\"\<bishop\>\"", ",", 
       "\"\<knight\>\""}], "}"}], ",", " ", 
     RowBox[{"ControlType", "\[Rule]", "PopupMenu"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"edit", ",", "\"\<play\>\"", ",", 
       RowBox[{"Style", "[", 
        RowBox[{"\"\<edit position\>\"", ",", "10"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<play\>\"", ",", "\"\<reset\>\"", ",", "\"\<clear\>\"", ",", 
       "\"\<delete\>\"", ",", "\"\<white pawn\>\"", ",", 
       "\"\<white knight\>\"", ",", "\"\<white bishop\>\"", ",", 
       "\"\<white rook\>\"", ",", "\"\<white queen\>\"", ",", 
       "\"\<white king\>\"", ",", "\"\<black pawn\>\"", ",", 
       "\"\<black knight\>\"", ",", "\"\<black bishop\>\"", ",", 
       "\"\<black rook\>\"", ",", "\"\<black queen\>\"", ",", 
       "\"\<black king\>\"", ",", "\"\<castling options\>\"", ",", 
       "\"\<next player\>\""}], "}"}], ",", " ", 
     RowBox[{"ControlType", "\[Rule]", "PopupMenu"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"h", ",", "1", ",", 
       RowBox[{"Style", "[", "\"\<history\>\"", "]"}]}], "}"}], ",", "0", ",",
      "1", ",", 
     RowBox[{"ControlType", "\[Rule]", "Slider"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "0"}], "}"}], ",", "   ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"temporary", " ", "loop", " ", "counter"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"j", ",", "0"}], "}"}], ",", "   ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", "  ", 
   RowBox[{"(*", " ", 
    RowBox[{"temporary", " ", "loop", " ", "counter"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"kx", ",", "0"}], "}"}], ",", "   ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"king", " ", 
      RowBox[{"position", "'"}], "s", " ", "x"}], "-", "coordinate"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ky", ",", "0"}], "}"}], ",", "   ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"king", " ", 
      RowBox[{"position", "'"}], "s", " ", "y"}], "-", "coordinate"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pos", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", "   ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"stores", " ", "last", " ", "clicked", " ", "position"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"from", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", "   ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"stores", " ", "last", " ", "from"}], "-", 
     RowBox[{"position", " ", "until", " ", "to"}], "-", 
     RowBox[{"pos", " ", "clicked"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"oldfrom", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", "   ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"stores", " ", "last", " ", "from"}], "-", "position"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"to", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", "   ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"stores", " ", "last", " ", "to"}], "-", "position"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"side", ",", "side0"}], "}"}], ",", "   ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"stores", " ", "piece", " ", "ownership"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"type", ",", "type0"}], "}"}], ",", "   ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   RowBox[{"(*", " ", 
    RowBox[{"stores", " ", "piece", " ", "type"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", "1"}], "}"}], ",", "   ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"moveside", " ", 
       RowBox[{"(", 
        RowBox[{"North", "=", "n"}], ")"}], " ", "1"}], " ", "=", " ", 
      "white"}], ",", " ", 
     RowBox[{
      RowBox[{"-", "1"}], " ", "=", " ", 
      RowBox[{"black", " ", "to", " ", "move"}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"list", ",", "list0"}], "}"}], ",", "   ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "lists", " ", "potential", " ", "moves", " ", "in", " ", "current", " ", 
     "situation"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"sides", ",", 
       RowBox[{"{", "side0", "}"}]}], "}"}], ",", "   ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   RowBox[{"(*", " ", 
    RowBox[{"stores", " ", "setups"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"types", ",", 
       RowBox[{"{", "type0", "}"}]}], "}"}], ",", "   ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   RowBox[{"(*", " ", 
    RowBox[{"stores", " ", "setups"}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"wfrom", ",", 
       RowBox[{"{", "}"}]}], "}"}], ",", "   ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"stores", " ", "from"}], "-", "position"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"wto", ",", 
       RowBox[{"{", "}"}]}], " ", "}"}], ",", "   ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"stores", " ", "to"}], "-", "position"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"wpiece", ",", 
       RowBox[{"{", "}"}]}], "}"}], ",", "  ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"bfrom", ",", 
       RowBox[{"{", "}"}]}], "}"}], ",", "   ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"stores", " ", "from"}], "-", "position"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"bto", ",", 
       RowBox[{"{", "}"}]}], " ", "}"}], ",", "   ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"stores", " ", "to"}], "-", "position"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"bpiece", ",", 
       RowBox[{"{", "}"}]}], "}"}], ",", "  ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"unmoveda1", ",", "True"}], "}"}], ",", "   ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"castling", " ", "option"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"unmoveda8", ",", "True"}], "}"}], ",", "   ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"castling", " ", "option"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"unmovedh1", ",", "True"}], "}"}], ",", "   ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"castling", " ", "option"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"unmovedh8", ",", "True"}], "}"}], ",", "   ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"castling", " ", "option"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"epwhite", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", "   ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"stores", " ", "white"}], "-", 
     RowBox[{"pawn", " ", "two"}], "-", "step"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"epblack", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", "   ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"stores", " ", "black"}], "-", 
     RowBox[{"pawn", " ", "two"}], "-", "step"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r", ",", "0"}], "}"}], ",", "   ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", "  ", 
   RowBox[{"(*", " ", 
    RowBox[{"number", " ", "of", " ", "last", " ", "move"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"f", ",", "0"}], "}"}], ",", "   ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", "  ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "move", " ", "number", " ", "selected", " ", "by", " ", "slider"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"capture", ",", "\"\<-\>\""}], "}"}], ",", "   ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", "  ", 
   RowBox[{"(*", " ", 
    RowBox[{"is", " ", "the", " ", "last", " ", "move", " ", "a", " ", 
     RowBox[{"capture", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"captures", ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"\"\<-\>\"", ",", "\"\<-\>\""}], "}"}], "}"}]}], "}"}], ",", 
     "   ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", "  ", 
   RowBox[{"(*", " ", 
    RowBox[{"is", " ", "the", " ", "last", " ", "move", " ", "a", " ", 
     RowBox[{"capture", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"checks", ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"\"\< \>\"", ",", "\"\< \>\""}], "}"}], "}"}]}], "}"}], ",", 
     "   ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", "  ", 
   RowBox[{"(*", " ", 
    RowBox[{"is", " ", "the", " ", "last", " ", "move", " ", "a", " ", 
     RowBox[{"capture", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Style", "[", 
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<x \>\"", ",", 
         RowBox[{"Dynamic", "[", "x", "]"}]}], "}"}], "]"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Style", "[", 
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<y \>\"", ",", 
         RowBox[{"Dynamic", "[", "y", "]"}]}], "}"}], "]"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Style", "[", 
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<temp \>\"", ",", 
         RowBox[{"Dynamic", "[", "temp", "]"}]}], "}"}], "]"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Style", "[", 
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<i\>\"", ",", 
         RowBox[{"Dynamic", "[", "i", "]"}]}], "}"}], "]"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Style", "[", 
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<a: \>\"", ",", 
         RowBox[{"Dynamic", "[", " ", "a", "  ", "]"}]}], "}"}], "]"}], "]"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"Style", "[", 
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<ax: \>\"", ",", 
         RowBox[{"Dynamic", "[", "  ", "ax", "  ", "]"}]}], "}"}], "]"}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Style", "[", 
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<ay: \>\"", ",", 
         RowBox[{"Dynamic", "[", "  ", "ay", "  ", "]"}]}], "}"}], "]"}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Style", "[", 
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<b: \>\"", ",", 
         RowBox[{"Dynamic", "[", " ", "b", "  ", "]"}]}], "}"}], "]"}], "]"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"Style", "[", 
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<kx: \>\"", ",", 
         RowBox[{"Dynamic", "[", "  ", "kx", "  ", "]"}]}], "}"}], "]"}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Style", "[", 
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<ky: \>\"", ",", 
         RowBox[{"Dynamic", "[", "  ", "ky", "  ", "]"}]}], "}"}], "]"}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Style", "[", 
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<l: \>\"", ",", 
         RowBox[{"Dynamic", "[", "  ", "l", "  ", "]"}]}], "}"}], "]"}], 
      "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Style", "[", 
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<i: \>\"", ",", 
         RowBox[{"Dynamic", "[", "  ", "iii", "  ", "]"}]}], "}"}], "]"}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Style", "[", 
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<list2: \>\"", ",", 
         RowBox[{"Dynamic", "[", "   ", 
          RowBox[{"list", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "  ", "]"}]}], "}"}], "]"}], "]"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"Style", "[", 
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<list3: \>\"", ",", 
         RowBox[{"Dynamic", "[", "   ", 
          RowBox[{"list", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "  ", "]"}]}], "}"}], "]"}], "]"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"Style", "[", 
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<list10: \>\"", ",", 
         RowBox[{"Dynamic", "[", "   ", 
          RowBox[{"list", "[", 
           RowBox[{"[", "10", "]"}], "]"}], "  ", "]"}]}], "}"}], "]"}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Style", "[", 
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<list11: \>\"", ",", 
         RowBox[{"Dynamic", "[", "   ", 
          RowBox[{"list", "[", 
           RowBox[{"[", "11", "]"}], "]"}], "  ", "]"}]}], "}"}], "]"}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Style", "[", 
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<+: \>\"", ",", 
         RowBox[{"Dynamic", "[", " ", 
          RowBox[{"checks", "[", 
           RowBox[{"[", "f", "]"}], "]"}], "  ", "]"}]}], "}"}], "]"}], "]"}],
      ","}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"part1", ",", "False"}], "}"}], ",", "   ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"from", "-", 
     RowBox[{"position", " ", "has", " ", "been", " ", "clicked"}]}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"part2", ",", "False"}], "}"}], ",", "   ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"to", "-", 
     RowBox[{"position", " ", "has", " ", "been", " ", "clicked"}]}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ok", ",", "False"}], "}"}], ",", "   ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"ready", " ", "to", " ", "execute", " ", "move"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eastok", ",", "False"}], "}"}], ",", "   ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"position", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"x", "+", "1"}], ",", "y"}], ")"}], " ", "is", " ", "not", " ",
      "attacked"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"westok", ",", "False"}], "}"}], ",", "   ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"position", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"x", "-", "1"}], ",", "y"}], ")"}], " ", "is", " ", "not", " ",
      "attacked"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"southok", ",", "False"}], "}"}], ",", "   ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"position", " ", 
     RowBox[{"(", 
      RowBox[{"x", ",", 
       RowBox[{"y", "-", "1"}]}], ")"}], " ", "is", " ", "not", " ", 
     "attacked"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"northok", ",", "False"}], "}"}], ",", "   ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"position", " ", 
     RowBox[{"(", 
      RowBox[{"x", ",", 
       RowBox[{"y", "+", "1"}]}], ")"}], " ", "is", " ", "not", " ", 
     "attacked"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "0"}], "}"}], ",", "   ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"horizontal", " ", "from"}], "-", 
     RowBox[{"coordinate", " ", "of", " ", "move"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"y", ",", "0"}], "}"}], ",", "   ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"vert", " ", "from"}], "-", 
     RowBox[{"coordinate", " ", "of", " ", "mov"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"swattacked", ",", "False"}], "}"}], ",", "   ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"is", " ", "the", " ", "position", " ", 
     RowBox[{"attacked", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"ControlPlacement", "\[Rule]", "Left"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"AutorunSequencing", "\[Rule]", 
    RowBox[{"{", "1", "}"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"SaveDefinitions", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{
  3.35696210375764*^9, 3.419623783435091*^9, {3.4197173960819263`*^9, 
   3.4197173974138412`*^9}, {3.4197174330651054`*^9, 
   3.4197175168355618`*^9}, {3.419717695332227*^9, 3.4197177607462883`*^9}, {
   3.4197179753949375`*^9, 3.4197180381852255`*^9}, {3.419718120944227*^9, 
   3.419718145028859*^9}, {3.419718175953326*^9, 3.419718200979312*^9}, {
   3.419718235629136*^9, 3.419718239925314*^9}, {3.4197182858513517`*^9, 
   3.419718289827069*^9}, {3.419718328302394*^9, 3.419718345957781*^9}, {
   3.4197183769924064`*^9, 3.41971841248344*^9}, {3.419718452941616*^9, 
   3.419718588566635*^9}, {3.4197186310777636`*^9, 3.4197187181529713`*^9}, {
   3.419718815452882*^9, 3.419718832657621*^9}, {3.4197188771215568`*^9, 
   3.419718895578096*^9}, {3.419718929296581*^9, 3.4197189512481456`*^9}, {
   3.4197190002285757`*^9, 3.41971900583664*^9}, {3.4197190474865294`*^9, 
   3.41971906858687*^9}, {3.4197191234457536`*^9, 3.4197191381669216`*^9}, {
   3.41971918459368*^9, 3.419719277166794*^9}, {3.4197193089324703`*^9, 
   3.419719311175696*^9}, 3.4197193527755136`*^9, 3.4197194420939474`*^9, {
   3.4197194934878483`*^9, 3.419719504273357*^9}, {3.419719572351248*^9, 
   3.4197196240155373`*^9}, {3.419719673867221*^9, 3.4197198104836655`*^9}, {
   3.419719877710333*^9, 3.41971993057635*^9}, {3.419720207845043*^9, 
   3.419720219702093*^9}, {3.4197202567253294`*^9, 3.4197203526833105`*^9}, 
   3.4197203877236958`*^9, {3.4197204178069534`*^9, 3.419720507195488*^9}, {
   3.4197205526308208`*^9, 3.4197206016713376`*^9}, 3.419720691160016*^9, {
   3.419720785575779*^9, 3.419720788520013*^9}, {3.4197208377608175`*^9, 
   3.4197208400841584`*^9}, {3.419720872420656*^9, 3.4197208739128017`*^9}, {
   3.4197209901098847`*^9, 3.419721115199755*^9}, {3.4197211508209763`*^9, 
   3.4197212383568463`*^9}, {3.419721286716384*^9, 3.419721376565581*^9}, {
   3.4197214705206814`*^9, 3.4197215041390224`*^9}, {3.4197215369662256`*^9, 
   3.4197215650666323`*^9}, {3.4197215964517612`*^9, 3.4197216001270466`*^9}, 
   3.4197216352074895`*^9, {3.4197219739846272`*^9, 3.4197220472900352`*^9}, {
   3.4197223735391583`*^9, 3.419722377695134*^9}, {3.419722409130336*^9, 
   3.419722428458128*^9}, {3.4197226459608817`*^9, 3.4197226479637613`*^9}, {
   3.4197231365362945`*^9, 3.419723160570854*^9}, {3.4197232023008595`*^9, 
   3.419723205525496*^9}, {3.4197234373488417`*^9, 3.4197235394556637`*^9}, {
   3.4197235933531647`*^9, 3.4197236670992064`*^9}, {3.419723721647643*^9, 
   3.4197237327936707`*^9}, {3.4197238123280354`*^9, 3.419723819568446*^9}, {
   3.4197238952272387`*^9, 3.419723946811413*^9}, {3.419724040806571*^9, 
   3.419724084589528*^9}, {3.4197241224740033`*^9, 3.4197241292136946`*^9}, {
   3.419724253913003*^9, 3.419724256817179*^9}, {3.4197243596250095`*^9, 
   3.4197243863434286`*^9}, {3.41972446309379*^9, 3.419724540274771*^9}, {
   3.419724594452675*^9, 3.4197246127489843`*^9}, {3.4197246535476494`*^9, 
   3.419724744187984*^9}, {3.4197248508313293`*^9, 3.419724853014469*^9}, {
   3.4197248939433217`*^9, 3.419724915284008*^9}, {3.4197249599081745`*^9, 
   3.4197249864463344`*^9}, {3.419725125686552*^9, 3.419725141839779*^9}, {
   3.419725179243563*^9, 3.419725192532672*^9}, {3.419725285586477*^9, 
   3.4197253423881536`*^9}, {3.419725525491443*^9, 3.41972556560913*^9}, {
   3.4197256205180845`*^9, 3.419725636721384*^9}, {3.4197258455416527`*^9, 
   3.4197259808261824`*^9}, {3.419726022826576*^9, 3.4197260298566847`*^9}, {
   3.419726069774083*^9, 3.419726070935754*^9}, {3.419726177879531*^9, 
   3.419726221141739*^9}, {3.419726253277949*^9, 3.4197263047419505`*^9}, {
   3.4197263810316496`*^9, 3.419726675244707*^9}, {3.4197267122779584`*^9, 
   3.419726746797595*^9}, {3.419726789729328*^9, 3.419726832641032*^9}, {
   3.4197268835041695`*^9, 3.4197269423688126`*^9}, {3.4197269904880047`*^9, 
   3.4197270940869727`*^9}, {3.4197272755378866`*^9, 
   3.4197272801445103`*^9}, {3.4197276439977055`*^9, 
   3.4197277492690783`*^9}, {3.419727784029061*^9, 3.419727808534298*^9}, {
   3.4197278702931023`*^9, 3.4197278793561344`*^9}, {3.419727974753309*^9, 
   3.419727977086664*^9}, {3.4197280668357167`*^9, 3.4197280720131617`*^9}, 
   3.4197281383585615`*^9, {3.419728210492285*^9, 3.4197283640631084`*^9}, {
   3.4197284001850495`*^9, 3.419728489994189*^9}, {3.419728677694088*^9, 
   3.419728704632824*^9}, {3.419728745822051*^9, 3.4197287506089344`*^9}, {
   3.4197287904462175`*^9, 3.419728800250315*^9}, {3.4197288995731344`*^9, 
   3.419728915015339*^9}, {3.4197289663191104`*^9, 3.4197289808399906`*^9}, {
   3.4197291250473504`*^9, 3.419729189209611*^9}, {3.4197293446731567`*^9, 
   3.4197293480079517`*^9}, {3.419729485335419*^9, 3.41972950777769*^9}, {
   3.4197295999802704`*^9, 3.419729602273568*^9}, {3.419729667707658*^9, 
   3.4197296712827983`*^9}, {3.4197297954713726`*^9, 3.419729799256816*^9}, {
   3.4197298411069937`*^9, 3.4197298498395505`*^9}, 3.4197299057699747`*^9, {
   3.419730005102808*^9, 3.4197300647285457`*^9}, {3.4197305514283857`*^9, 
   3.419730557677371*^9}, {3.419733841551056*^9, 3.4197339521901474`*^9}, {
   3.4197345005786915`*^9, 3.4197345232212496`*^9}, {3.4197347391016703`*^9, 
   3.419734765409499*^9}, {3.4197356029769616`*^9, 3.4197357689055552`*^9}, {
   3.419735808412363*^9, 3.4197358633313327`*^9}, {3.4197358979511137`*^9, 
   3.419736006066576*^9}, {3.419736093532346*^9, 3.419736269595512*^9}, {
   3.419736323092437*^9, 3.4197363436119423`*^9}, {3.4197364160961695`*^9, 
   3.4197364339919024`*^9}, {3.4197365535337954`*^9, 
   3.4197366738568115`*^9}, {3.419737967590458*^9, 3.419737971205656*^9}, {
   3.419738096255469*^9, 3.419738133769411*^9}, 3.4197383828876257`*^9, 
   3.419738461991371*^9, {3.41973849480856*^9, 3.4197384988643923`*^9}, {
   3.419738541545765*^9, 3.419738573000995*^9}, {3.4197386245050545`*^9, 
   3.419738628350584*^9}, {3.4197387572759695`*^9, 3.419738828969059*^9}, {
   3.419738879191275*^9, 3.419738936864205*^9}, {3.4197389844426193`*^9, 
   3.419738993846141*^9}, {3.4197390565162563`*^9, 3.419739092177534*^9}, 
   3.4197391460850496`*^9, 3.419739185201296*^9, {3.4197393252226367`*^9, 
   3.419739339342941*^9}, {3.419739387742536*^9, 3.4197393941918097`*^9}, {
   3.419739491671979*^9, 3.4197396590626755`*^9}, {3.4197397137713423`*^9, 
   3.419739774498664*^9}, {3.4197398197136803`*^9, 3.419739889634221*^9}, 
   3.419739969749421*^9, {3.419740017518109*^9, 3.4197400800279937`*^9}, {
   3.4197401537039347`*^9, 3.4197401792907267`*^9}, 3.4197402299235325`*^9, {
   3.4197403198929024`*^9, 3.419740323958749*^9}, {3.419740478631157*^9, 
   3.4197406041316175`*^9}, {3.4197406674927263`*^9, 3.419740689364176*^9}, 
   3.4197407632804623`*^9, 3.419741178727846*^9, {3.419741254927416*^9, 
   3.4197413082440815`*^9}, {3.419741396561075*^9, 3.4197413990246177`*^9}, {
   3.4197415070799932`*^9, 3.4197416597495213`*^9}, {3.419741719124899*^9, 
   3.4197418098153057`*^9}, {3.419741853768507*^9, 3.4197419529010525`*^9}, {
   3.4197419878312798`*^9, 3.419742045644411*^9}, {3.4197421128210063`*^9, 
   3.4197421438456173`*^9}, {3.419742212253984*^9, 3.4197422907268224`*^9}, {
   3.419742351203784*^9, 3.419742353807528*^9}, 3.4197424454092445`*^9, {
   3.4197425680255585`*^9, 3.4197425741143136`*^9}, {3.419747366355218*^9, 
   3.4197474054314065`*^9}, {3.4197475529735613`*^9, 
   3.4197475581009345`*^9}, {3.4197475899467263`*^9, 3.419747590557605*^9}, {
   3.4197478067885294`*^9, 3.419747810784275*^9}, {3.4197481189073343`*^9, 
   3.4197481381850543`*^9}, {3.419748211911067*^9, 3.419748283263667*^9}, {
   3.419748320837696*^9, 3.4197483232311373`*^9}, {3.4197484302350016`*^9, 
   3.4197484495828223`*^9}, {3.4197486158719344`*^9, 
   3.4197486414487123`*^9}, {3.4197488050739937`*^9, 
   3.4197488808129005`*^9}, {3.4197491590630045`*^9, 3.4197492551111155`*^9}, 
   3.419749321676832*^9, {3.41974948260824*^9, 3.4197495308275757`*^9}, {
   3.4197496194450016`*^9, 3.4197496733925743`*^9}, {3.4197497104258256`*^9, 
   3.4197497326878366`*^9}, {3.4197498347245584`*^9, 
   3.4197498696948433`*^9}, {3.4197499247039423`*^9, 3.419749952113355*^9}, {
   3.4197501336043262`*^9, 3.419750170527419*^9}, {3.419750249080373*^9, 
   3.4197502772608943`*^9}, {3.4197504095411043`*^9, 3.419750411243552*^9}, {
   3.4197504806834016`*^9, 3.4197505664567375`*^9}, {3.4197506520397997`*^9, 
   3.4197506901846495`*^9}, {3.4197507441121936`*^9, 
   3.4197507867735376`*^9}, {3.4197508208625555`*^9, 
   3.4197508771334686`*^9}, {3.4197510157728224`*^9, 3.419751026047597*^9}, {
   3.4197510616387744`*^9, 3.4197510831396914`*^9}, {3.41975130331629*^9, 
   3.419751497876053*^9}, {3.419751530783371*^9, 3.419751538123926*^9}, {
   3.41975159079967*^9, 3.4197515922818017`*^9}, {3.419751669602984*^9, 
   3.419751674930645*^9}, {3.419751730069931*^9, 3.419751776937323*^9}, {
   3.4197518589152017`*^9, 3.4197519294666495`*^9}, {3.4197519895830927`*^9, 
   3.419752075206213*^9}, 3.419752177112747*^9, {3.419752218682522*^9, 
   3.419752305116808*^9}, {3.4197529347121215`*^9, 3.4197530151477823`*^9}, {
   3.419753102763768*^9, 3.419753105337469*^9}, {3.4201013569476624`*^9, 
   3.420101376005066*^9}, {3.4201014285606365`*^9, 3.4201014383146625`*^9}, {
   3.4201015586176496`*^9, 3.4201015639252815`*^9}, {3.4201018209148145`*^9, 
   3.420101849966589*^9}, {3.420102025929611*^9, 3.4201020266806912`*^9}, {
   3.4201020675694866`*^9, 3.420102068480797*^9}, {3.4201022745070477`*^9, 
   3.4201023019665327`*^9}, {3.4201023560042353`*^9, 
   3.4201023777254686`*^9}, {3.4201025333392305`*^9, 
   3.4201025372248173`*^9}, {3.420102848171938*^9, 3.420102862502544*^9}, {
   3.4201029770772943`*^9, 3.4201030230333757`*^9}, 3.4201033338302803`*^9, {
   3.4201035956267247`*^9, 3.42010360330777*^9}, {3.420103774564024*^9, 
   3.4201039616230016`*^9}, {3.42019489456949*^9, 3.4201949085338864`*^9}, {
   3.4202994619587197`*^9, 3.4202994659981236`*^9}, 3.420382129023266*^9, {
   3.4204324313042974`*^9, 3.4204324343086176`*^9}, {3.420432571045235*^9, 
   3.420432624692376*^9}, {3.42043277141335*^9, 3.4204327850729923`*^9}, 
   3.4204328305283537`*^9, {3.420432862954981*^9, 3.420432868202526*^9}, {
   3.4204329200170317`*^9, 3.4204329247939005`*^9}, {3.4204329970177536`*^9, 
   3.4204330312670016`*^9}, {3.4204330636635857`*^9, 3.420433102599573*^9}, {
   3.420433146672947*^9, 3.420433172610243*^9}, {3.4204332112558126`*^9, 
   3.4204332173445683`*^9}, {3.4204332476080847`*^9, 
   3.4204332858831215`*^9}, {3.420433423871539*^9, 3.420433455757389*^9}, {
   3.420433487983728*^9, 3.4204336404129105`*^9}, {3.4204337410976877`*^9, 
   3.420433786943611*^9}, {3.420433946212629*^9, 3.420434051423915*^9}, {
   3.420434492347933*^9, 3.420434604709501*^9}, {3.420434676352518*^9, 
   3.420434741205773*^9}, 3.4204347736324*^9, {3.4204349724382687`*^9, 
   3.420435034657736*^9}, {3.4204352427469535`*^9, 3.4204352655597568`*^9}, {
   3.4204353265073953`*^9, 3.420435442013485*^9}, {3.4204354790066786`*^9, 
   3.420435524361896*^9}, {3.4204356287319727`*^9, 3.4204356300238304`*^9}, {
   3.420435703739829*^9, 3.4204357073049555`*^9}, {3.4204359796565776`*^9, 
   3.4204359809985075`*^9}, 3.4204364152829776`*^9, {3.4204365074655294`*^9, 
   3.420436508236638*^9}, 3.420437118744506*^9, {3.4204374881456785`*^9, 
   3.420437495516277*^9}, {3.4204376320325775`*^9, 3.420437632593384*^9}, 
   3.4204377092335873`*^9, {3.423037965515949*^9, 3.4230380900850706`*^9}, {
   3.423038747069768*^9, 3.423038750204275*^9}, {3.4230388539334307`*^9, 
   3.4230388557360225`*^9}, {3.423039050926693*^9, 3.4230390538609123`*^9}, {
   3.42303914268864*^9, 3.4230391519419456`*^9}, {3.4230728544354*^9, 
   3.4230728634283314`*^9}, {3.423074203325008*^9, 3.423074212958861*^9}, {
   3.4230742630208464`*^9, 3.4230742681982913`*^9}, {3.423074660552469*^9, 
   3.4230746953925667`*^9}, {3.423075019528651*^9, 3.4230752552776413`*^9}, {
   3.423075287834456*^9, 3.423075291089136*^9}, {3.4230754739620943`*^9, 
   3.4230756081250114`*^9}, {3.423076106661872*^9, 3.4230761453575134`*^9}, {
   3.4230766592063923`*^9, 3.423076702759018*^9}, {3.423077404758443*^9, 
   3.423077472996565*^9}, {3.4230775112515726`*^9, 3.42307753316308*^9}, {
   3.423077570386605*^9, 3.42307764206968*^9}, {3.4230777490034432`*^9, 
   3.423077836419141*^9}, {3.4230779396175327`*^9, 3.4230779467277565`*^9}, {
   3.4230780974645057`*^9, 3.4230781173831472`*^9}, {3.4230781678156652`*^9, 
   3.4230782091751375`*^9}, {3.4230782499337454`*^9, 
   3.4230782593472815`*^9}, {3.4230784168137074`*^9, 
   3.4230785177688737`*^9}, {3.423078558397294*^9, 3.423078560970995*^9}, {
   3.423078621057395*^9, 3.423078682015048*^9}, {3.4230789062474785`*^9, 
   3.4230789141588545`*^9}, {3.42307897473596*^9, 3.4230789926216784`*^9}, {
   3.4231605824257298`*^9, 3.423160614231464*^9}, {3.423160659566653*^9, 
   3.423160673917288*^9}, {3.423160951486453*^9, 3.4231609533992033`*^9}, {
   3.423469009242424*^9, 3.4234690777309055`*^9}, {3.4234691680307503`*^9, 
   3.4234691701838465`*^9}, {3.42350764165625*^9, 3.423507642*^9}, {
   3.4326579309807425`*^9, 3.4326579719196095`*^9}, {3.4326580138899603`*^9, 
   3.4326580740765038`*^9}, {3.432658134863912*^9, 3.401229497170523*^9}, {
   3.401229588591981*^9, 3.401229659574048*^9}, 3.4012297485920496`*^9, {
   3.401229787007288*^9, 3.401229789260528*^9}, {3.401229885388754*^9, 
   3.401229910164379*^9}, {3.401229973936078*^9, 3.401230012251173*^9}, 
   3.4012300429753523`*^9, {3.4012300784263277`*^9, 3.4012302179169054`*^9}, {
   3.4012303487450275`*^9, 3.401230582571253*^9}, {3.401230626414296*^9, 
   3.401230635096781*^9}, {3.401230675605029*^9, 3.401230819241568*^9}, {
   3.4012308741705523`*^9, 3.4012310962899437`*^9}, {3.401231159731168*^9, 
   3.4012311616539326`*^9}, {3.4012312179048176`*^9, 3.401231218645883*^9}, {
   3.401231274085602*^9, 3.4012313216940594`*^9}, {3.4012313801180687`*^9, 
   3.4012314262343807`*^9}, {3.4012315315958834`*^9, 3.401231532897755*^9}, {
   3.4012319160887566`*^9, 3.401231937699832*^9}, {3.401232010184059*^9, 
   3.4012320385248113`*^9}, {3.4012322579002576`*^9, 3.401232609515856*^9}, {
   3.401232902256797*^9, 3.40123295085668*^9}, {3.401232989362048*^9, 
   3.40123299066392*^9}, {3.401233047095064*^9, 3.401233047976331*^9}, {
   3.401233303420869*^9, 3.4012333354569345`*^9}, {3.401233454428006*^9, 
   3.40123349793056*^9}, {3.401233579007142*^9, 3.4012335961517954`*^9}, {
   3.4012336544956894`*^9, 3.401233806604411*^9}, {3.401233847803653*^9, 
   3.401233874802475*^9}, 3.4012339667446814`*^9, {3.401234107126541*^9, 
   3.4012341129649363`*^9}, {3.401234185589365*^9, 3.401234202293384*^9}, {
   3.401234232967491*^9, 3.401234248079221*^9}, {3.401235344706093*^9, 
   3.401235353218333*^9}, {3.40123542554233*^9, 3.4012355631502*^9}, {
   3.401235605741443*^9, 3.4012357014490643`*^9}, {3.4012357382519836`*^9, 
   3.4012357651005907`*^9}, {3.4012357955443664`*^9, 
   3.4012358239852624`*^9}, {3.401235866686664*^9, 3.4012359606417646`*^9}, {
   3.401236047546728*^9, 3.4012360486082544`*^9}, {3.401236179636664*^9, 
   3.4012361822904797`*^9}, {3.4012362699965954`*^9, 3.401236275995221*^9}, {
   3.4012364650170207`*^9, 3.40123650049804*^9}, {3.401236581965184*^9, 
   3.401236586391549*^9}, {3.401236668359413*^9, 3.4012366867558656`*^9}, {
   3.4012369121699953`*^9, 3.401236915244416*^9}, {3.4012372702248526`*^9, 
   3.4012372962723074`*^9}, 3.4012373509509315`*^9, {3.4012374092046957`*^9, 
   3.4012374374052467`*^9}, 3.4012375463919616`*^9, {3.401237591947467*^9, 
   3.401237610884698*^9}, {3.4012431825319424`*^9, 3.4012432920293922`*^9}, {
   3.401243324906667*^9, 3.401243332137064*^9}, {3.401243498626464*^9, 
   3.4012435331561155`*^9}, {3.4012435662837505`*^9, 
   3.4012436245174866`*^9}, {3.401243693186227*^9, 3.40124369505892*^9}, {
   3.4012437287673903`*^9, 3.4012437298890033`*^9}, {3.4012438605068226`*^9, 
   3.4012438608072543`*^9}, 3.4012439237077007`*^9, {3.401243970474949*^9, 
   3.4012439748912992`*^9}, {3.4012440284983826`*^9, 
   3.4012440312723713`*^9}, {3.4012440851598577`*^9, 3.4012441126994576`*^9}, 
   3.401244158525352*^9, {3.4012443685974207`*^9, 3.401244461611168*^9}, {
   3.4012444928661103`*^9, 3.4012445105315123`*^9}, {3.401244635180749*^9, 
   3.4012446516744657`*^9}, {3.4012447393305087`*^9, 3.401244750246205*^9}, {
   3.401244798505598*^9, 3.4012448042238207`*^9}, {3.401244836770621*^9, 
   3.401244872902576*^9}, {3.4012449228143454`*^9, 3.401244929103389*^9}, {
   3.40124497373757*^9, 3.401245028656539*^9}, {3.401245072940216*^9, 
   3.40124510984328*^9}, 3.401245150551816*^9, {3.401245199271872*^9, 
   3.4012452331405725`*^9}, {3.4012452689120097`*^9, 3.401245316470395*^9}, {
   3.4012453871620445`*^9, 3.401245391578395*^9}, {3.4012455349445457`*^9, 
   3.401245553330984*^9}, {3.4012456081998816`*^9, 3.401245714793155*^9}, {
   3.4012457559723682`*^9, 3.401245798253165*^9}, {3.401245833964515*^9, 
   3.401246097583581*^9}, {3.4012464443421955`*^9, 3.401246576782635*^9}, {
   3.4012466205555773`*^9, 3.401246620715808*^9}, {3.40124672632767*^9, 
   3.4012467347197375`*^9}, {3.4012468258207345`*^9, 
   3.4012468290553856`*^9}, {3.4012468715564995`*^9, 
   3.4012469555773153`*^9}, {3.4012470715440674`*^9, 3.401247105442811*^9}, {
   3.401247220748613*^9, 3.4012472236027164`*^9}, {3.401247339749728*^9, 
   3.4012473412919455`*^9}, {3.4012473871278543`*^9, 
   3.4012473905127215`*^9}, {3.401247535711507*^9, 3.401247587526013*^9}, 
   3.4012476250299406`*^9, {3.4012476654781027`*^9, 3.4012477199263954`*^9}, {
   3.401247749969595*^9, 3.4012478156740737`*^9}, {3.401247891132578*^9, 
   3.401248041338563*^9}, {3.401248083919792*^9, 3.4012483122781553`*^9}, {
   3.401252873787283*^9, 3.401252969184458*^9}, 3.4012530374526224`*^9, {
   3.4012532862804193`*^9, 3.401253287922781*^9}, {3.4012533220919137`*^9, 
   3.4012533264682064`*^9}, 3.4012562596859665`*^9, {3.401256859057821*^9, 
   3.401256882651747*^9}, {3.40125700269436*^9, 3.401257004627139*^9}, {
   3.4012572721217775`*^9, 3.4012573126200113`*^9}, {3.4012586073517437`*^9, 
   3.401258647679733*^9}, {3.401258699003533*^9, 3.4012587006158514`*^9}, {
   3.4012590384115777`*^9, 3.4012591062090654`*^9}, {3.4012592929475822`*^9, 
   3.4012593707694845`*^9}, {3.4012594574841747`*^9, 3.401259614680211*^9}, {
   3.4012597333909087`*^9, 3.401259803571824*^9}, {3.4012599704517856`*^9, 
   3.401259980005523*^9}, {3.401260231036488*^9, 3.4012602686305456`*^9}, {
   3.4012603005664673`*^9, 3.4012603412049026`*^9}, {3.401260526230957*^9, 
   3.4012605297760544`*^9}, {3.401260663147834*^9, 3.4012606838576126`*^9}, {
   3.401260810609874*^9, 3.401260848053715*^9}, {3.401261002025115*^9, 
   3.4012610056703568`*^9}, {3.4012610581658416`*^9, 3.401261065085792*^9}, {
   3.4012611746733713`*^9, 3.4012611915376205`*^9}, {3.4012613629941635`*^9, 
   3.4012613703847904`*^9}, {3.401261411844406*^9, 3.4012614265255165`*^9}, {
   3.401261480503133*^9, 3.401261888820264*^9}, {3.4012620252063775`*^9, 
   3.401262135134446*^9}, {3.401262248267123*^9, 3.401262483355163*^9}, {
   3.401262521810459*^9, 3.401262525415643*^9}, {3.4012626190102253`*^9, 
   3.401262630616915*^9}, {3.401263646687954*^9, 3.4012636529669824`*^9}, {
   3.40126386922795*^9, 3.401263872522688*^9}, {3.4012643398346496`*^9, 
   3.4012643411064787`*^9}, {3.401264472555493*^9, 3.401264476491152*^9}, {
   3.4012646531451683`*^9, 3.401264699141307*^9}, {3.4012648396533537`*^9, 
   3.401264879700939*^9}, {3.4012649680279474`*^9, 3.4012649888679132`*^9}, 
   3.401265099366803*^9, {3.4012652911225348`*^9, 3.4012653146563745`*^9}, {
   3.401265347894168*^9, 3.401265398957594*^9}, {3.4012655976132464`*^9, 
   3.4012656043729663`*^9}, 3.4012658604211454`*^9, {3.4012660081836176`*^9, 
   3.401266027591525*^9}, {3.4012660765519266`*^9, 3.4012660976322384`*^9}, {
   3.4012661748733053`*^9, 3.4012662000795507`*^9}, {3.401266582068824*^9, 
   3.401266639621581*^9}, {3.401267039977264*^9, 3.401267076639982*^9}, 
   3.401267903238573*^9, {3.4012982845781183`*^9, 3.4012983546689043`*^9}, {
   3.4013005142321167`*^9, 3.4013005336800814`*^9}, {3.4013006063445683`*^9, 
   3.4013006099597664`*^9}, {3.4013015911506495`*^9, 3.401301632419992*^9}, {
   3.4038235775880527`*^9, 3.403823646046491*^9}, {3.403825655215534*^9, 
   3.403825943790485*^9}, {3.403995398027525*^9, 3.403995461518821*^9}, {
   3.4040855335407267`*^9, 3.404085561971608*^9}, {3.404087483104061*^9, 
   3.404087483454565*^9}, 3.4040875296910496`*^9, {3.40408758652277*^9, 
   3.404087605480029*^9}, {3.404087673287531*^9, 3.4040876854650416`*^9}, {
   3.4040877411951776`*^9, 3.404087741335379*^9}, {3.4040878561905327`*^9, 
   3.404087903668803*^9}, {3.4040880698377423`*^9, 3.404088069977944*^9}, {
   3.4040881074117713`*^9, 3.4040881168052783`*^9}, {3.4040881916729326`*^9, 
   3.4040881944969935`*^9}, {3.404088278708083*^9, 3.4040882807410064`*^9}, {
   3.404088324874467*^9, 3.404088368747554*^9}, {3.4040884020153904`*^9, 
   3.4040884268310738`*^9}, {3.4040884689115825`*^9, 
   3.4040884711447935`*^9}, {3.404088525402813*^9, 3.4040885442198706`*^9}, {
   3.4040885994793296`*^9, 3.404088611296322*^9}, {3.404088710028291*^9, 
   3.404088736806797*^9}, {3.4040887797585583`*^9, 3.404088788210712*^9}, {
   3.4040888586219587`*^9, 3.404088863278654*^9}, {3.404088927751362*^9, 
   3.4040889567831073`*^9}, {3.4040890238395295`*^9, 
   3.4040890437982287`*^9}, {3.40408908124207*^9, 3.404089139045187*^9}, {
   3.4040891872745376`*^9, 3.4040892836631374`*^9}, {3.404089488798107*^9, 
   3.4040895006751857`*^9}, {3.404089854664197*^9, 3.4040898578187327`*^9}, {
   3.40408991453028*^9, 3.40408992270203*^9}, 3.404089954437664*^9, {
   3.404090129359189*^9, 3.404090204246872*^9}, {3.4040902735164766`*^9, 
   3.4040902841317406`*^9}, {3.404090364447229*^9, 3.404090370295638*^9}, {
   3.404090641315346*^9, 3.4040906483654833`*^9}, {3.4040906791898065`*^9, 
   3.4040907014317884`*^9}, {3.404091467042683*^9, 3.40409149789705*^9}, {
   3.404091577441429*^9, 3.404091672638315*^9}, {3.4040917850299263`*^9, 
   3.4040918165652723`*^9}, {3.404091859446933*^9, 3.404092015220925*^9}, 
   3.4040920539966817`*^9, {3.404092093112928*^9, 3.404092160159336*^9}, {
   3.4040927643581314`*^9, 3.404092767963315*^9}, {3.4040928527352114`*^9, 
   3.404092857241691*^9}, 3.4040932001748047`*^9, {3.4040937900930653`*^9, 
   3.4040938200761795`*^9}, {3.404093856378379*^9, 3.4040939191085806`*^9}, {
   3.4040940142253523`*^9, 3.4040940858683696`*^9}, {3.4040941534355264`*^9, 
   3.404094154356851*^9}, {3.4040942165562897`*^9, 3.404094246889907*^9}, {
   3.404094322488613*^9, 3.4040943234299664`*^9}, {3.404094368174306*^9, 
   3.4040944076811132`*^9}, {3.4040945052413983`*^9, 
   3.4040945069738894`*^9}, {3.4040945410729218`*^9, 3.404094546210309*^9}, {
   3.404094683357517*^9, 3.404094744495429*^9}, {3.404094817730736*^9, 
   3.4040948486151457`*^9}, {3.4040949081807966`*^9, 3.404094952544589*^9}, {
   3.4040950144135523`*^9, 3.4040950299759293`*^9}, {3.404095131582032*^9, 
   3.404095167413555*^9}, {3.4040952679681454`*^9, 3.404095281727931*^9}, {
   3.404095329536677*^9, 3.404095331169024*^9}, {3.4040953636457233`*^9, 
   3.404095376233824*^9}, {3.4040954416378703`*^9, 3.4040954421285763`*^9}, {
   3.4040955318976574`*^9, 3.4040955904017825`*^9}, {3.4040956644282274`*^9, 
   3.404095672710136*^9}, {3.404095752374688*^9, 3.404095812461088*^9}, {
   3.404095869192664*^9, 3.4040958757921534`*^9}, {3.404095920155946*^9, 
   3.4040959471046963`*^9}, {3.4040960013927584`*^9, 
   3.4040960233042655`*^9}, {3.4040963114185534`*^9, 3.404096323325675*^9}, {
   3.4040963537594366`*^9, 3.404096354690776*^9}, 3.404096396991602*^9, {
   3.4040965026234927`*^9, 3.4040965057780285`*^9}, {3.4040965465065937`*^9, 
   3.404096582328102*^9}, {3.4040967302207613`*^9, 3.4040970036739683`*^9}, {
   3.4040970726531553`*^9, 3.4040970918908176`*^9}, {3.4040971413719683`*^9, 
   3.4040971450172095`*^9}, {3.4040971865469265`*^9, 3.4040972834362464`*^9}, 
   3.404097316103219*^9, {3.4040973588346643`*^9, 3.40409743743769*^9}, {
   3.404097563168482*^9, 3.404097811715875*^9}, {3.404097872623456*^9, 
   3.4040980461329503`*^9}, {3.4040981124282784`*^9, 3.404098132717453*^9}, {
   3.4040982495855007`*^9, 3.40409829983776*^9}, {3.4040987202022142`*^9, 
   3.4040988076279263`*^9}, {3.404098952626424*^9, 3.404098960667987*^9}, 
   3.4040990260419903`*^9, 3.4040993365484767`*^9, {3.4040994417697773`*^9, 
   3.4040994432218657`*^9}, {3.404099510608763*^9, 3.4040995261310835`*^9}, {
   3.404099584575122*^9, 3.4040995961117105`*^9}, {3.40409974867108*^9, 
   3.404099753077416*^9}, {3.4040997905713296`*^9, 3.4040997934354477`*^9}, {
   3.40409987710576*^9, 3.404099937512621*^9}, {3.4041000704237375`*^9, 
   3.4041000760318017`*^9}, {3.404100168504771*^9, 3.4041001908769407`*^9}, {
   3.40410025039252*^9, 3.4041002615385475`*^9}, {3.4041003379083614`*^9, 
   3.4041003428554754`*^9}, {3.404100397914646*^9, 3.404100435448618*^9}, {
   3.404100482656499*^9, 3.4041004884448223`*^9}, {3.404100592604597*^9, 
   3.404100595759133*^9}, {3.404100770240024*^9, 3.4041007801843233`*^9}, {
   3.4041009436493745`*^9, 3.404100946463421*^9}, {3.404101498707509*^9, 
   3.4041015096332192`*^9}, 3.404101875469266*^9, {3.40410226312669*^9, 
   3.404102267693256*^9}, {3.404102297826586*^9, 3.404102318045659*^9}, {
   3.4041024125815954`*^9, 3.4041024206932592`*^9}, {3.4041024941088257`*^9, 
   3.4041025344868865`*^9}, {3.40410260853336*^9, 3.4041027260523443`*^9}, {
   3.4041027682830687`*^9, 3.404102837142083*^9}, {3.4041028744056654`*^9, 
   3.4041028789321747`*^9}, {3.404102938187379*^9, 3.4041029483620095`*^9}, {
   3.404103078739483*^9, 3.4041033436403923`*^9}, {3.4041035029594817`*^9, 
   3.4041035894037824`*^9}, {3.404103655238448*^9, 3.4041036702199907`*^9}, {
   3.4041037128813343`*^9, 3.404103744116248*^9}, {3.4041037854957485`*^9, 
   3.404104095872048*^9}, {3.404104483359227*^9, 3.4041046114634323`*^9}, {
   3.4041046492978354`*^9, 3.404104759496293*^9}, {3.404104795307787*^9, 
   3.404104858418536*^9}, {3.404104922130149*^9, 3.404104927317608*^9}, {
   3.4041049645110893`*^9, 3.4041049755469584`*^9}, {3.4041050404602995`*^9, 
   3.404105044636304*^9}, {3.4041050757710733`*^9, 3.404105086796928*^9}, {
   3.404105218055669*^9, 3.404105327212629*^9}, {3.404105674341776*^9, 
   3.404105686178797*^9}, {3.404105868200531*^9, 3.4041059268448577`*^9}, {
   3.404105958860894*^9, 3.4041060089629374`*^9}, {3.4041060464067793`*^9, 
   3.4041061522389584`*^9}, {3.40410637394776*^9, 3.404106482804288*^9}, {
   3.404106519086459*^9, 3.404106558012432*^9}, {3.4041066005836463`*^9, 
   3.404106743959811*^9}, {3.4041068109160895`*^9, 3.4041068170348883`*^9}, {
   3.4041068771313024`*^9, 3.4041069014662943`*^9}, {3.4041069638059344`*^9, 
   3.404106978166584*^9}, {3.4041070222900305`*^9, 3.4041070287593327`*^9}, {
   3.404107061456349*^9, 3.4041070916197214`*^9}, {3.4041071509450274`*^9, 
   3.40410715548155*^9}, {3.4041073196476097`*^9, 3.4041073201483297`*^9}, {
   3.404107723468275*^9, 3.4041078919405265`*^9}, {3.404107932709149*^9, 
   3.4041079605692096`*^9}, {3.404108042056382*^9, 3.404108067162483*^9}, {
   3.4041082238177423`*^9, 3.404108256284427*^9}, {3.4041083489777136`*^9, 
   3.404108410095597*^9}, 3.4041084451760397`*^9, {3.404108498522749*^9, 
   3.404108586509267*^9}, {3.404108702015357*^9, 3.4041087048394175`*^9}, {
   3.4041087846241426`*^9, 3.4041087886299024`*^9}, {3.4041088617850943`*^9, 
   3.404108868985448*^9}, {3.404109198689539*^9, 3.4041092137211533`*^9}, {
   3.4041092808877344`*^9, 3.404109288238304*^9}, {3.4041093578584127`*^9, 
   3.4041094264570527`*^9}, {3.4041094927724094`*^9, 
   3.4041095077038803`*^9}, {3.4041096679943666`*^9, 3.4041096909473715`*^9}, 
   3.4041097928338766`*^9, {3.4041115538861456`*^9, 3.4041115586329713`*^9}, {
   3.404111609275792*^9, 3.4041116164260736`*^9}, {3.404111756287184*^9, 
   3.404111805878493*^9}, {3.404111864362589*^9, 3.4041118685085506`*^9}, 
   3.4041119975741377`*^9, {3.404112055297139*^9, 3.4041120576405087`*^9}, {
   3.404112162351075*^9, 3.4041121644340706`*^9}, {3.404112468791715*^9, 
   3.4041124854857197`*^9}, {3.4041126118574333`*^9, 3.4041126427017856`*^9}, 
   3.4041128416378417`*^9, {3.4041134294430637`*^9, 3.404113463592168*^9}, {
   3.4041140100879903`*^9, 3.404114120666995*^9}, {3.4041141684356833`*^9, 
   3.404114173312696*^9}, {3.4041142066706624`*^9, 3.404114264994528*^9}, {
   3.4041143223369827`*^9, 3.404114394260403*^9}, {3.4041144318644753`*^9, 
   3.4041144320146914`*^9}, 3.404114463099389*^9, {3.4041145345521326`*^9, 
   3.404114562241949*^9}, {3.404114594308058*^9, 3.4041146684646893`*^9}, {
   3.404114708582376*^9, 3.404114734349427*^9}, {3.4041148417438526`*^9, 
   3.404114849104437*^9}, 3.404115356784445*^9, {3.4041157345476418`*^9, 
   3.4041157400255184`*^9}, {3.4041159193433647`*^9, 
   3.4041159228584194`*^9}, {3.4041163220424175`*^9, 
   3.4041163997040896`*^9}, {3.4041165116650815`*^9, 3.404116544552371*^9}, {
   3.4041166857153535`*^9, 3.4041167082878113`*^9}, {3.404116845905696*^9, 
   3.4041168486796846`*^9}, {3.404117145406357*^9, 3.4041173246040306`*^9}, {
   3.404117529138136*^9, 3.4041175295186834`*^9}, {3.4041175654503503`*^9, 
   3.4041175678538065`*^9}, {3.4041176030343933`*^9, 3.404117728554883*^9}, {
   3.4041178724117393`*^9, 3.4041178730126033`*^9}, {3.4041180395520754`*^9, 
   3.404118045310355*^9}, {3.404118095222125*^9, 3.404118104896035*^9}, {
   3.4041181386746063`*^9, 3.4041181666748686`*^9}, 3.404118255001877*^9, {
   3.4041187336601534`*^9, 3.40411877502964*^9}, {3.404118826373469*^9, 
   3.404118829387803*^9}, {3.4041189246648045`*^9, 3.4041189266276274`*^9}, {
   3.404119179801674*^9, 3.404119180743027*^9}, {3.404119278052952*^9, 
   3.4041192890187197`*^9}, {3.4041194536354275`*^9, 3.404119455738451*^9}, {
   3.4041200062400336`*^9, 3.404120023004139*^9}, {3.4041202539462175`*^9, 
   3.404120274245406*^9}, {3.404120609297187*^9, 3.404120623066987*^9}, 
   3.404120783647891*^9, {3.4041208728161087`*^9, 3.4041209744422398`*^9}, {
   3.4041216198202477`*^9, 3.404121651065176*^9}, {3.404121719313312*^9, 
   3.4041217224077616`*^9}, {3.4041434752090673`*^9, 3.404143497491107*^9}, {
   3.404143782951579*^9, 3.404143837720333*^9}, {3.4041440634749517`*^9, 
   3.4041440662389264`*^9}, {3.4041441311322384`*^9, 
   3.4041441318132176`*^9}, {3.404144340543357*^9, 3.404144404815776*^9}, {
   3.4041444549779053`*^9, 3.4041444799538193`*^9}, {3.4041445570947423`*^9, 
   3.4041445585268016`*^9}, 3.404144631762109*^9, {3.404144891735933*^9, 
   3.404144900348317*^9}, 3.404145144489374*^9, {3.404145189934722*^9, 
   3.404145289357685*^9}, {3.4041453376971936`*^9, 3.404145362152358*^9}, {
   3.404145497957637*^9, 3.4041455376346893`*^9}, {3.4041456004650354`*^9, 
   3.4041456039901037`*^9}, {3.404145701360115*^9, 3.4041457034831676`*^9}, {
   3.404145736400501*^9, 3.4041457393647633`*^9}, {3.40414581528393*^9, 
   3.4041458190593586`*^9}, {3.4041458667879887`*^9, 
   3.4041459207756195`*^9}, {3.4041461346631746`*^9, 3.404146177564864*^9}, {
   3.4041462902669215`*^9, 3.4041462976475344`*^9}, {3.404146514729683*^9, 
   3.4041465382434945`*^9}, {3.4041466079537325`*^9, 3.404146637886774*^9}, {
   3.4041468414795265`*^9, 3.404146936876701*^9}, 3.404147200305493*^9, {
   3.4041481320152254`*^9, 3.4041481379237213`*^9}, {3.4041498762101393`*^9, 
   3.4041499017268305`*^9}, {3.404150068957296*^9, 3.4041500824266644`*^9}, {
   3.4041501243769855`*^9, 3.4041501486318626`*^9}, {3.4041506412201695`*^9, 
   3.4041506451057568`*^9}, 3.4041507651083117`*^9, 3.4041508298113503`*^9, {
   3.4041508635799074`*^9, 3.4041508670148463`*^9}, {3.404150911078206*^9, 
   3.404150931948216*^9}, {3.4041509648855777`*^9, 3.404150965376283*^9}, {
   3.404151075134107*^9, 3.4041510786691904`*^9}, {3.404151244697928*^9, 
   3.4041512736796017`*^9}, {3.4041513098215714`*^9, 
   3.4041513399849443`*^9}, {3.404151401102827*^9, 3.404151426259*^9}, {
   3.404152722022216*^9, 3.404152780836787*^9}, {3.4041528782368417`*^9, 
   3.404152902251373*^9}, {3.4041532019423075`*^9, 3.404153216002525*^9}, {
   3.4041534930709295`*^9, 3.4041534963656673`*^9}, {3.4041543262890387`*^9, 
   3.4041543969105873`*^9}, {3.4041553553387394`*^9, 
   3.4041553660541472`*^9}, {3.404155418119013*^9, 3.4041554498045745`*^9}, {
   3.40415550237016*^9, 3.404155508098397*^9}, {3.404155619758957*^9, 
   3.40415563781492*^9}, {3.4041556886580286`*^9, 3.40415575047692*^9}, 
   3.404155819676424*^9, {3.404155870319245*^9, 3.4041559675991263`*^9}, 
   3.4047884754634304`*^9, {3.4047885130174303`*^9, 3.4047885135782366`*^9}, {
   3.404788587334293*^9, 3.404788588345747*^9}, {3.4047886624422927`*^9, 
   3.404788707607237*^9}, {3.4047943474659166`*^9, 3.4047943492785234`*^9}, {
   3.4047965291530285`*^9, 3.4047965721047907`*^9}, {3.404796642245648*^9, 
   3.4047966515490255`*^9}, {3.404796789016694*^9, 3.4047967926519213`*^9}, {
   3.4047968671390285`*^9, 3.404796953292912*^9}, {3.4047969893848095`*^9, 
   3.404797175242059*^9}, {3.4047973083434496`*^9, 3.4047973115680866`*^9}, {
   3.404797438590736*^9, 3.404797537132432*^9}, {3.404798023732128*^9, 
   3.404798039655024*^9}, {3.404798157925088*^9, 3.404798158626096*^9}, {
   3.4047984945491295`*^9, 3.404798504353227*^9}, {3.4047988595639954`*^9, 
   3.404798860034672*^9}, {3.4047990827749567`*^9, 3.404799089865152*^9}, {
   3.4048009469655313`*^9, 3.4048009477867117`*^9}, {3.40480381686224*^9, 
   3.404803817573262*^9}, {3.404803948651744*^9, 3.4048040072059407`*^9}, {
   3.404804091306872*^9, 3.404804107500157*^9}, {3.404804223937586*^9, 
   3.404804267830701*^9}, 3.404804318633752*^9, 3.4048043554466867`*^9, {
   3.404804460317483*^9, 3.404804469270357*^9}, {3.4048045091977696`*^9, 
   3.4048045999883204`*^9}, 3.4048047030565248`*^9, {3.4048048067255936`*^9, 
   3.404804810771411*^9}, {3.4048048654900928`*^9, 3.404804869676112*^9}, {
   3.4048049302732463`*^9, 3.4048049551089582`*^9}, {3.404805038699155*^9, 
   3.4048050607007923`*^9}, {3.4048051319933057`*^9, 
   3.4048051588118687`*^9}, {3.4048052176364546`*^9, 
   3.4048052601976547`*^9}, {3.4048053394215727`*^9, 3.40480536659064*^9}, {
   3.4048053982061005`*^9, 3.404805419747075*^9}, {3.4048055503749084`*^9, 
   3.404805565757027*^9}, 3.404805662365944*^9, {3.40480592079755*^9, 
   3.40480593006087*^9}, {3.404805961225683*^9, 3.4048059843389187`*^9}, {
   3.404810844817944*^9, 3.404810860540552*^9}, {3.4048109830366926`*^9, 
   3.4048109882642097`*^9}, {3.4048110212115855`*^9, 
   3.4048110302245455`*^9}, {3.404811072845832*^9, 3.404811076350872*^9}, {
   3.4048115810065312`*^9, 3.4048116390299644`*^9}, {3.4048117022408576`*^9, 
   3.404811705856056*^9}, {3.4048117886651297`*^9, 3.404811794463467*^9}, {
   3.404811828762787*^9, 3.4048118468487935`*^9}, {3.4048120147101665`*^9, 
   3.404812040316987*^9}, {3.404812198514464*^9, 3.404812233735109*^9}, {
   3.4048123980113263`*^9, 3.404812481591509*^9}, {3.4048125203672657`*^9, 
   3.4048125368008957`*^9}, {3.4048125700386896`*^9, 3.404812614382453*^9}, {
   3.4048126675489025`*^9, 3.4048126712942877`*^9}, {3.404812855058528*^9, 
   3.4048128579627037`*^9}, {3.404813225631386*^9, 3.4048132378890114`*^9}, {
   3.404813388255227*^9, 3.4048134062210608`*^9}, {3.4048135942814784`*^9, 
   3.404813597205683*^9}, {3.4048136480287633`*^9, 3.4048136828888893`*^9}, {
   3.4048140462613935`*^9, 3.4048140525704656`*^9}, {3.4048141544469566`*^9, 
   3.404814191159747*^9}, {3.4048143664217615`*^9, 3.4048144024035006`*^9}, {
   3.4048144445340815`*^9, 3.404814456180829*^9}, {3.4048145837342415`*^9, 
   3.404814633395651*^9}, {3.4048147178771296`*^9, 3.4048147222534227`*^9}, {
   3.404814841094307*^9, 3.404814844519232*^9}, {3.4048148761547213`*^9, 
   3.404814889063283*^9}, {3.4048150303464384`*^9, 3.4048150895215282`*^9}, {
   3.404815192699891*^9, 3.404815198157739*^9}, {3.4048153310588417`*^9, 
   3.404815339500981*^9}, {3.404815428428853*^9, 3.404815454776739*^9}, {
   3.4048154872834816`*^9, 3.4048155082336063`*^9}, 3.4048158978738813`*^9, {
   3.4048163805879903`*^9, 3.404816386015795*^9}, {3.404816545314856*^9, 
   3.4048167613254642`*^9}, {3.4048168046778016`*^9, 
   3.4048168064303217`*^9}, {3.4048168791548944`*^9, 
   3.4048168843623824`*^9}, {3.40481702886016*^9, 3.4048170739850464`*^9}, {
   3.4048172126244*^9, 3.404817221437072*^9}, {3.40481729858801*^9, 
   3.4048173219616194`*^9}, {3.4048173807761903`*^9, 
   3.4048174163773823`*^9}, {3.4048176941868525`*^9, 3.404817743057125*^9}, {
   3.404817821950568*^9, 3.4048178350594177`*^9}, {3.404817908104451*^9, 
   3.404817930757024*^9}, {3.4048326823554163`*^9, 3.4048326989392624`*^9}, {
   3.4048327311455727`*^9, 3.4048327440541344`*^9}, {3.40483297421509*^9, 
   3.4048330100866704`*^9}, {3.4048331258230915`*^9, 
   3.4048331484956927`*^9}, {3.404833196705014*^9, 3.4048332530360146`*^9}, {
   3.4048333228664255`*^9, 3.4048333278936543`*^9}, 3.404833416220662*^9, {
   3.404833478450144*^9, 3.4048335028752656`*^9}, {3.4048335964998913`*^9, 
   3.404833614746128*^9}, {3.4048336457707396`*^9, 3.4048336479338493`*^9}, {
   3.4048337577317314`*^9, 3.4048337587331715`*^9}, {3.4048341086663504`*^9, 
   3.4048341090068398`*^9}, {3.404834143286131*^9, 3.404834144788291*^9}, {
   3.404834204373971*^9, 3.404834239264141*^9}, {3.4048343653754797`*^9, 
   3.404834385093834*^9}, {3.4048346229658766`*^9, 3.4048346350432434`*^9}, {
   3.404834733514838*^9, 3.4048347379712467`*^9}, {3.4048347900060687`*^9, 
   3.4048347911777534`*^9}, {3.4048348492813025`*^9, 3.404834854458747*^9}, 
   3.4048349348343215`*^9, {3.404834967441208*^9, 3.404834989903507*^9}, 
   3.4048350259453325`*^9, {3.404835335190005*^9, 3.404835368277582*^9}, 
   3.4048354021062255`*^9, {3.4048354355242786`*^9, 3.4048354728379326`*^9}, {
   3.4048356965496144`*^9, 3.4048357276543407`*^9}, {3.4048358751464243`*^9, 
   3.4048358869333725`*^9}, {3.404836122552176*^9, 3.404836175007603*^9}, {
   3.4048362339022894`*^9, 3.404836249404581*^9}, {3.4048363775288143`*^9, 
   3.4048363893558207`*^9}, {3.40483651847148*^9, 3.404836532010949*^9}, {
   3.404836826975086*^9, 3.4048368281567855`*^9}, {3.4048717882782497`*^9, 
   3.4048718634563503`*^9}, {3.4048720799376354`*^9, 3.404872150318838*^9}, 
   3.40487238053988*^9, {3.404872853820424*^9, 3.404872893707779*^9}, {
   3.4048730036959343`*^9, 3.4048730074513345`*^9}, {3.404873221769509*^9, 
   3.4048732314033613`*^9}, {3.4048733189192033`*^9, 
   3.4048733268405933`*^9}, {3.404873358996832*^9, 3.4048733638137584`*^9}, {
   3.40487343530656*^9, 3.4048735347595663`*^9}, {3.404873685035653*^9, 
   3.404873706716829*^9}, {3.4048738262787504`*^9, 3.4048738615394526`*^9}, {
   3.404873933382758*^9, 3.4048740530448236`*^9}, {3.4048741573047423`*^9, 
   3.404874163774045*^9}, {3.404874348039005*^9, 3.4048743634211235`*^9}, {
   3.4048743960680676`*^9, 3.404874403508766*^9}, {3.404874456154467*^9, 
   3.4048744631345043`*^9}, {3.404874525444101*^9, 3.4048745340264416`*^9}, {
   3.404876375183896*^9, 3.404876413038328*^9}, {3.404876452575179*^9, 
   3.40487663866276*^9}, {3.4048768972145395`*^9, 3.4048769319544926`*^9}, {
   3.404876997358539*^9, 3.4048770181484337`*^9}, {3.4048772074606514`*^9, 
   3.404877220759774*^9}, {3.404877304500187*^9, 3.4048775076322765`*^9}, {
   3.404877548491029*^9, 3.4048776232485247`*^9}, {3.4048777236328707`*^9, 
   3.404877761206899*^9}, 3.4048778669189053`*^9, {3.404877974383432*^9, 
   3.404877975695318*^9}, {3.404878026177909*^9, 3.4048780334083056`*^9}, {
   3.40487809876228*^9, 3.4048781362061214`*^9}, {3.404878202451378*^9, 
   3.4048782030322127`*^9}, {3.404878287293374*^9, 3.4048783029158382`*^9}, {
   3.4048859882654176`*^9, 3.4048860069522877`*^9}, {3.404886050595043*^9, 
   3.4048860740387535`*^9}, 3.404886231805611*^9, {3.404886434266736*^9, 
   3.40488653701448*^9}, {3.4048874206651073`*^9, 3.4048874359170384`*^9}, 
   3.404887469565422*^9, 3.4048875009906096`*^9, {3.4048875400567837`*^9, 
   3.4048875416991453`*^9}, {3.404887771659813*^9, 3.4048878971602736`*^9}, {
   3.4048880024116173`*^9, 3.404888004724944*^9}, 3.404888065732669*^9, {
   3.4048883290813456`*^9, 3.4048883312544703`*^9}, {3.4048883972794094`*^9, 
   3.4048884042394176`*^9}, {3.404888462833672*^9, 3.404888476333083*^9}, {
   3.4048885258342624`*^9, 3.4048885697474065`*^9}, {3.404888637074218*^9, 
   3.4048886437538223`*^9}, {3.4048887059933186`*^9, 3.404888738480032*^9}, {
   3.4048890052235904`*^9, 3.4048890323726287`*^9}, 3.404889458935997*^9, {
   3.404890512761323*^9, 3.4048905206126127`*^9}, {3.4049216781300144`*^9, 
   3.4049217198900623`*^9}, {3.404921797571763*^9, 3.4049218306993985`*^9}, 
   3.4049230283014655`*^9, {3.4049231822928944`*^9, 3.404923205516288*^9}, {
   3.404923261106222*^9, 3.4049232838088675`*^9}, {3.404923351015506*^9, 
   3.404923424851677*^9}, {3.4049234998795614`*^9, 3.4049235014518223`*^9}, {
   3.404923872505371*^9, 3.404923908276808*^9}, {3.4049239480239615`*^9, 
   3.404923956526187*^9}, {3.4049239890930157`*^9, 3.4049240108042355`*^9}, {
   3.404924091109709*^9, 3.404924096397312*^9}, {3.4049242426676383`*^9, 
   3.404924307440778*^9}, {3.404924348690091*^9, 3.4049244794681406`*^9}, 
   3.4055547878037343`*^9},
 CellID->289034776],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`bfrom$$ = {}, $CellContext`bpiece$$ = {}, \
$CellContext`bto$$ = {}, $CellContext`capture$$ = 
    "-", $CellContext`captures$$ = {{"-", "-"}}, $CellContext`checks$$ = {{
     " ", " "}}, $CellContext`colb$$ = 1, $CellContext`colw$$ = 
    1, $CellContext`eastok$$ = True, $CellContext`edit$$ = 
    "play", $CellContext`epblack$$ = {0, 0}, $CellContext`epwhite$$ = {0, 
    0}, $CellContext`f$$ = 0, $CellContext`from$$ = {0, 0}, $CellContext`h$$ =
     1, $CellContext`i$$ = 1, $CellContext`j$$ = 0, $CellContext`kx$$ = 
    5, $CellContext`ky$$ = 1, $CellContext`list$$ = {{{0, 0}, {0, 0}}, {{1, 
    2}, {1, 3}}, {{1, 2}, {1, 4}}, {{2, 1}, {1, 3}}, {{2, 1}, {3, 3}}, {{2, 
    2}, {2, 3}}, {{2, 2}, {2, 4}}, {{3, 2}, {3, 3}}, {{3, 2}, {3, 4}}, {{4, 
    2}, {4, 3}}, {{4, 2}, {4, 4}}, {{5, 2}, {5, 3}}, {{5, 2}, {5, 4}}, {{6, 
    2}, {6, 3}}, {{6, 2}, {6, 4}}, {{7, 1}, {6, 3}}, {{7, 1}, {8, 3}}, {{7, 
    2}, {7, 3}}, {{7, 2}, {7, 4}}, {{8, 2}, {8, 3}}, {{8, 2}, {8, 
    4}}}, $CellContext`n$$ = 1, $CellContext`northok$$ = 
    True, $CellContext`ok$$ = False, $CellContext`oldfrom$$ = {0, 
    0}, $CellContext`part1$$ = False, $CellContext`part2$$ = 
    False, $CellContext`pos$$ = {0, 0}, $CellContext`prom$$ = 
    "queen", $CellContext`r$$ = 0, $CellContext`randomblack$$ = 
    False, $CellContext`randomwhite$$ = False, $CellContext`showmoves$$ = 
    False, $CellContext`showtargets$$ = True, $CellContext`side$$ = {{1, 1, 0,
     0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
    0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1,
     0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
    0, -1, -1}}, $CellContext`sides$$ = {{{1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 
    0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
    0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1,
     0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
    0, -1, -1}}}, $CellContext`southok$$ = False, $CellContext`swattacked$$ = 
    False, $CellContext`to$$ = {0, 0}, $CellContext`type$$ = {{2, 1, 0, 0, 0, 
    0, 1, 2}, {3, 1, 0, 0, 0, 0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 4}, {5, 1, 0, 0,
     0, 0, 1, 5}, {6, 1, 0, 0, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0, 1, 4}, {3, 1, 
    0, 0, 0, 0, 1, 3}, {2, 1, 0, 0, 0, 0, 1, 2}}, $CellContext`types$$ = {{{2,
     1, 0, 0, 0, 0, 1, 2}, {3, 1, 0, 0, 0, 0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 
    4}, {5, 1, 0, 0, 0, 0, 1, 5}, {6, 1, 0, 0, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0,
     1, 4}, {3, 1, 0, 0, 0, 0, 1, 3}, {2, 1, 0, 0, 0, 0, 1, 
    2}}}, $CellContext`unmoveda1$$ = True, $CellContext`unmoveda8$$ = 
    True, $CellContext`unmovedh1$$ = True, $CellContext`unmovedh8$$ = 
    True, $CellContext`westok$$ = 
    True, $CellContext`wfrom$$ = {}, $CellContext`wpiece$$ = {}, \
$CellContext`wto$$ = {}, $CellContext`x$$ = 0, $CellContext`y$$ = 0, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`colw$$], 1, 
       Style["color White", 10]}, {1, 2, 3}}, {{
       Hold[$CellContext`colb$$], 1, 
       Style["color Black", 10]}, {1, 2, 3}}, {{
       Hold[$CellContext`randomwhite$$], False, "random White"}, {
      True, False}}, {{
       Hold[$CellContext`randomblack$$], False, "random Black"}, {
      True, False}}, {{
       Hold[$CellContext`showmoves$$], False, "show moves"}, {
      True, False}}, {{
       Hold[$CellContext`showtargets$$], True, "show targets"}, {
      True, False}}, {{
       Hold[$CellContext`prom$$], "queen", 
       Style["promotion to", 10]}, {"queen", "rook", "bishop", "knight"}}, {{
       Hold[$CellContext`edit$$], "play", 
       Style["edit position", 10]}, {
      "play", "reset", "clear", "delete", "white pawn", "white knight", 
       "white bishop", "white rook", "white queen", "white king", 
       "black pawn", "black knight", "black bishop", "black rook", 
       "black queen", "black king", "castling options", "next player"}}, {{
       Hold[$CellContext`h$$], 1, 
       Style["history"]}, 0, 1}, {{
       Hold[$CellContext`i$$], 0}}, {{
       Hold[$CellContext`j$$], 0}}, {{
       Hold[$CellContext`kx$$], 0}}, {{
       Hold[$CellContext`ky$$], 0}}, {{
       Hold[$CellContext`pos$$], {0, 0}}}, {{
       Hold[$CellContext`from$$], {0, 0}}}, {{
       Hold[$CellContext`oldfrom$$], {0, 0}}}, {{
       Hold[$CellContext`to$$], {0, 0}}}, {{
       Hold[$CellContext`side$$], {{1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0,
        0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {
       1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
       0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}}}}, {{
       Hold[$CellContext`type$$], {{2, 1, 0, 0, 0, 0, 1, 2}, {3, 1, 0, 0, 0, 
       0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 4}, {5, 1, 0, 0, 0, 0, 1, 5}, {6, 1, 0,
        0, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0, 1, 4}, {3, 1, 0, 0, 0, 0, 1, 3}, {
       2, 1, 0, 0, 0, 0, 1, 2}}}}, {{
       Hold[$CellContext`n$$], 1}}, {{
       Hold[$CellContext`list$$], {{{0, 0}, {0, 0}}}}}, {{
       Hold[$CellContext`sides$$], {{{1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 
       0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
       0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1,
        1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}}}}}, {{
       Hold[$CellContext`types$$], {{{2, 1, 0, 0, 0, 0, 1, 2}, {3, 1, 0, 0, 0,
        0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 4}, {5, 1, 0, 0, 0, 0, 1, 5}, {6, 1, 
       0, 0, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0, 1, 4}, {3, 1, 0, 0, 0, 0, 1, 
       3}, {2, 1, 0, 0, 0, 0, 1, 2}}}}}, {{
       Hold[$CellContext`wfrom$$], {}}}, {{
       Hold[$CellContext`wto$$], {}}}, {{
       Hold[$CellContext`wpiece$$], {}}}, {{
       Hold[$CellContext`bfrom$$], {}}}, {{
       Hold[$CellContext`bto$$], {}}}, {{
       Hold[$CellContext`bpiece$$], {}}}, {{
       Hold[$CellContext`unmoveda1$$], True}}, {{
       Hold[$CellContext`unmoveda8$$], True}}, {{
       Hold[$CellContext`unmovedh1$$], True}}, {{
       Hold[$CellContext`unmovedh8$$], True}}, {{
       Hold[$CellContext`epwhite$$], {0, 0}}}, {{
       Hold[$CellContext`epblack$$], {0, 0}}}, {{
       Hold[$CellContext`r$$], 0}}, {{
       Hold[$CellContext`f$$], 0}}, {{
       Hold[$CellContext`capture$$], "-"}}, {{
       Hold[$CellContext`captures$$], {{"-", "-"}}}}, {{
       Hold[$CellContext`checks$$], {{" ", " "}}}}, {{
       Hold[$CellContext`part1$$], False}}, {{
       Hold[$CellContext`part2$$], False}}, {{
       Hold[$CellContext`ok$$], False}}, {{
       Hold[$CellContext`eastok$$], False}}, {{
       Hold[$CellContext`westok$$], False}}, {{
       Hold[$CellContext`southok$$], False}}, {{
       Hold[$CellContext`northok$$], False}}, {{
       Hold[$CellContext`x$$], 0}}, {{
       Hold[$CellContext`y$$], 0}}, {{
       Hold[$CellContext`swattacked$$], False}}}, Typeset`size$$ = {
    400., {198., 202.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = False, $CellContext`colw$6907$$ = 
    0, $CellContext`colb$6908$$ = 0, $CellContext`randomwhite$6909$$ = 
    False, $CellContext`randomblack$6910$$ = 
    False, $CellContext`showmoves$6911$$ = 
    False, $CellContext`showtargets$6912$$ = False, $CellContext`prom$6913$$ =
     0, $CellContext`edit$6914$$ = 0, $CellContext`h$6915$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`bfrom$$ = {}, $CellContext`bpiece$$ = {}, \
$CellContext`bto$$ = {}, $CellContext`capture$$ = 
        "-", $CellContext`captures$$ = {{
          "-", "-"}}, $CellContext`checks$$ = {{
          " ", " "}}, $CellContext`colb$$ = 1, $CellContext`colw$$ = 
        1, $CellContext`eastok$$ = False, $CellContext`edit$$ = 
        "play", $CellContext`epblack$$ = {0, 0}, $CellContext`epwhite$$ = {0, 
         0}, $CellContext`f$$ = 
        0, $CellContext`from$$ = {0, 0}, $CellContext`h$$ = 
        1, $CellContext`i$$ = 0, $CellContext`j$$ = 0, $CellContext`kx$$ = 
        0, $CellContext`ky$$ = 
        0, $CellContext`list$$ = {{{0, 0}, {0, 0}}}, $CellContext`n$$ = 
        1, $CellContext`northok$$ = False, $CellContext`ok$$ = 
        False, $CellContext`oldfrom$$ = {0, 0}, $CellContext`part1$$ = 
        False, $CellContext`part2$$ = 
        False, $CellContext`pos$$ = {0, 0}, $CellContext`prom$$ = 
        "queen", $CellContext`r$$ = 0, $CellContext`randomblack$$ = 
        False, $CellContext`randomwhite$$ = False, $CellContext`showmoves$$ = 
        False, $CellContext`showtargets$$ = 
        True, $CellContext`side$$ = {{1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 
         0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
         0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {
         1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
         0, -1, -1}}, $CellContext`sides$$ = {{{1, 1, 0, 0, 0, 0, -1, -1}, {1,
          1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
         0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {
         1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
         0, -1, -1}}}, $CellContext`southok$$ = 
        False, $CellContext`swattacked$$ = 
        False, $CellContext`to$$ = {0, 0}, $CellContext`type$$ = {{2, 1, 0, 0,
          0, 0, 1, 2}, {3, 1, 0, 0, 0, 0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 4}, {5,
          1, 0, 0, 0, 0, 1, 5}, {6, 1, 0, 0, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0, 
         1, 4}, {3, 1, 0, 0, 0, 0, 1, 3}, {2, 1, 0, 0, 0, 0, 1, 
         2}}, $CellContext`types$$ = {{{2, 1, 0, 0, 0, 0, 1, 2}, {3, 1, 0, 0, 
         0, 0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 4}, {5, 1, 0, 0, 0, 0, 1, 5}, {6, 
         1, 0, 0, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0, 1, 4}, {3, 1, 0, 0, 0, 0, 1,
          3}, {2, 1, 0, 0, 0, 0, 1, 2}}}, $CellContext`unmoveda1$$ = 
        True, $CellContext`unmoveda8$$ = True, $CellContext`unmovedh1$$ = 
        True, $CellContext`unmovedh8$$ = True, $CellContext`westok$$ = 
        False, $CellContext`wfrom$$ = {}, $CellContext`wpiece$$ = {}, \
$CellContext`wto$$ = {}, $CellContext`x$$ = 0, $CellContext`y$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`colw$$, $CellContext`colw$6907$$, 0], 
        Hold[$CellContext`colb$$, $CellContext`colb$6908$$, 0], 
        Hold[$CellContext`randomwhite$$, $CellContext`randomwhite$6909$$, 
         False], 
        Hold[$CellContext`randomblack$$, $CellContext`randomblack$6910$$, 
         False], 
        Hold[$CellContext`showmoves$$, $CellContext`showmoves$6911$$, False], 
        
        Hold[$CellContext`showtargets$$, $CellContext`showtargets$6912$$, 
         False], 
        Hold[$CellContext`prom$$, $CellContext`prom$6913$$, 0], 
        Hold[$CellContext`edit$$, $CellContext`edit$6914$$, 0], 
        Hold[$CellContext`h$$, $CellContext`h$6915$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`f$$ = Floor[$CellContext`h$$ $CellContext`r$$]; 
       If[
         And[$CellContext`list$$ == $CellContext`list0, $CellContext`from$$ == \
{0, 0}, $CellContext`to$$ == {0, 0}], 
         Do[$CellContext`t = 
            Part[$CellContext`type$$, $CellContext`x$$, $CellContext`y$$]; \
$CellContext`s = 
            Part[$CellContext`side$$, $CellContext`x$$, $CellContext`y$$]; 
           If[
             
             And[$CellContext`t == $CellContext`pp, $CellContext`s == 
              1, $CellContext`n$$ == 1], 
             If[Part[$CellContext`side$$, $CellContext`x$$, $CellContext`y$$ + 
                 1] == 0, $CellContext`list$$ = 
                AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$, $CellContext`y$$ + 1}}]; If[
                 
                 And[$CellContext`y$$ == 2, 
                  Part[$CellContext`side$$, $CellContext`x$$, 4] == 
                  0], $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, 
                    2}, {$CellContext`x$$, 4}}]]]; 
             If[{$CellContext`x$$ + 1, $CellContext`y$$ + 
                 1} == $CellContext`epblack$$, $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$ + 1}}]]; 
             If[{$CellContext`x$$ - 1, $CellContext`y$$ + 
                 1} == $CellContext`epblack$$, $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$ + 1}}]]; If[
               
               And[$CellContext`x$$ < 8, $CellContext`y$$ < 8, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  1, $CellContext`y$$ + 
                  1] == -$CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$ + 1}}]]; If[
               
               And[$CellContext`x$$ > 1, $CellContext`y$$ < 8, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  1, $CellContext`y$$ + 
                  1] == -$CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$ + 1}}]]]; If[
             
             And[$CellContext`t == $CellContext`pp, $CellContext`s == -1, \
$CellContext`n$$ == -1], 
             If[Part[$CellContext`side$$, $CellContext`x$$, $CellContext`y$$ - 
                 1] == 0, $CellContext`list$$ = 
                AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$, $CellContext`y$$ - 1}}]; If[
                 
                 And[$CellContext`y$$ == 7, 
                  Part[$CellContext`side$$, $CellContext`x$$, 5] == 
                  0], $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, 
                    7}, {$CellContext`x$$, 5}}]]]; 
             If[{$CellContext`x$$ + 1, $CellContext`y$$ - 
                 1} == $CellContext`epwhite$$, $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$ - 1}}]]; 
             If[{$CellContext`x$$ - 1, $CellContext`y$$ - 
                 1} == $CellContext`epwhite$$, $CellContext`list$$ = 
               
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$ - 1}}]]; If[
               
               And[$CellContext`x$$ < 8, $CellContext`y$$ > 1, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  1, $CellContext`y$$ - 
                  1] == -$CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$ - 1}}]]; If[
               
               And[$CellContext`x$$ > 1, $CellContext`y$$ > 1, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  1, $CellContext`y$$ - 
                  1] == -$CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$ - 1}}]]]; If[
             
             And[$CellContext`t == $CellContext`nn, $CellContext`s == \
$CellContext`n$$], If[
               
               And[$CellContext`x$$ > 1, $CellContext`y$$ > 2, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  1, $CellContext`y$$ - 
                  2] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$ - 2}}]]; If[
               
               And[$CellContext`x$$ > 1, $CellContext`y$$ < 7, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  1, $CellContext`y$$ + 
                  2] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$ + 2}}]]; If[
               
               And[$CellContext`x$$ > 2, $CellContext`y$$ > 1, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  2, $CellContext`y$$ - 
                  1] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 2, $CellContext`y$$ - 1}}]]; If[
               
               And[$CellContext`x$$ > 2, $CellContext`y$$ < 8, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  2, $CellContext`y$$ + 
                  1] != $CellContext`n$$], $CellContext`list$$ = 
               
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 2, $CellContext`y$$ + 1}}]]; If[
               
               And[$CellContext`x$$ < 8, $CellContext`y$$ < 7, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  1, $CellContext`y$$ + 
                  2] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$ + 2}}]]; If[
               
               And[$CellContext`x$$ < 8, $CellContext`y$$ > 2, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  1, $CellContext`y$$ - 
                  2] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$ - 2}}]]; If[
               
               And[$CellContext`x$$ < 7, $CellContext`y$$ > 1, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  2, $CellContext`y$$ - 
                  1] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 2, $CellContext`y$$ - 1}}]]; If[
               
               And[$CellContext`x$$ < 7, $CellContext`y$$ < 8, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  2, $CellContext`y$$ + 
                  1] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 2, $CellContext`y$$ + 1}}]]]; If[
             And[
              
              Or[$CellContext`t == $CellContext`bb, $CellContext`t == \
$CellContext`qq], $CellContext`s == $CellContext`n$$], 
             For[$CellContext`i$$ = 1, 
               
               And[$CellContext`x$$ + $CellContext`i$$ < 
                9, $CellContext`y$$ + $CellContext`i$$ < 9], 
               Increment[$CellContext`i$$], 
               If[Part[$CellContext`side$$, $CellContext`x$$ + \
$CellContext`i$$, $CellContext`y$$ + $CellContext`i$$] != $CellContext`n$$, \
$CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + $CellContext`i$$, $CellContext`y$$ + \
$CellContext`i$$}}]]; 
               If[Part[$CellContext`side$$, $CellContext`x$$ + \
$CellContext`i$$, $CellContext`y$$ + $CellContext`i$$] != 0, 
                 Break[]]]; For[$CellContext`i$$ = 1, 
               
               And[$CellContext`x$$ + $CellContext`i$$ < 
                9, $CellContext`y$$ - $CellContext`i$$ > 0], 
               Increment[$CellContext`i$$], 
               If[Part[$CellContext`side$$, $CellContext`x$$ + \
$CellContext`i$$, $CellContext`y$$ - $CellContext`i$$] != $CellContext`n$$, \
$CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + $CellContext`i$$, $CellContext`y$$ - \
$CellContext`i$$}}]]; 
               If[Part[$CellContext`side$$, $CellContext`x$$ + \
$CellContext`i$$, $CellContext`y$$ - $CellContext`i$$] != 0, 
                 Break[]]]; For[$CellContext`i$$ = 1, 
               
               And[$CellContext`x$$ - $CellContext`i$$ > 
                0, $CellContext`y$$ + $CellContext`i$$ < 9], 
               Increment[$CellContext`i$$], 
               If[Part[$CellContext`side$$, $CellContext`x$$ - \
$CellContext`i$$, $CellContext`y$$ + $CellContext`i$$] != $CellContext`n$$, \
$CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - $CellContext`i$$, $CellContext`y$$ + \
$CellContext`i$$}}]]; 
               If[Part[$CellContext`side$$, $CellContext`x$$ - \
$CellContext`i$$, $CellContext`y$$ + $CellContext`i$$] != 0, 
                 Break[]]]; For[$CellContext`i$$ = 1, 
               
               And[$CellContext`x$$ - $CellContext`i$$ > 
                0, $CellContext`y$$ - $CellContext`i$$ > 0], 
               Increment[$CellContext`i$$], 
               If[Part[$CellContext`side$$, $CellContext`x$$ - \
$CellContext`i$$, $CellContext`y$$ - $CellContext`i$$] != $CellContext`n$$, \
$CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - $CellContext`i$$, $CellContext`y$$ - \
$CellContext`i$$}}]]; 
               If[Part[$CellContext`side$$, $CellContext`x$$ - \
$CellContext`i$$, $CellContext`y$$ - $CellContext`i$$] != 0, 
                 Break[]]]]; If[
             And[
              
              Or[$CellContext`t == $CellContext`rr, $CellContext`t == \
$CellContext`qq], $CellContext`s == $CellContext`n$$], 
             For[$CellContext`i$$ = $CellContext`x$$ + 1, $CellContext`i$$ < 
               9, 
               Increment[$CellContext`i$$], 
               If[Part[$CellContext`side$$, $CellContext`i$$, \
$CellContext`y$$] != $CellContext`n$$, $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`i$$, $CellContext`y$$}}]]; 
               If[Part[$CellContext`side$$, $CellContext`i$$, \
$CellContext`y$$] != 0, 
                 Break[]]]; 
             For[$CellContext`i$$ = $CellContext`x$$ - 1, $CellContext`i$$ > 
               0, 
               Decrement[$CellContext`i$$], 
               If[Part[$CellContext`side$$, $CellContext`i$$, \
$CellContext`y$$] != $CellContext`n$$, $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`i$$, $CellContext`y$$}}]]; 
               If[Part[$CellContext`side$$, $CellContext`i$$, \
$CellContext`y$$] != 0, 
                 Break[]]]; 
             For[$CellContext`i$$ = $CellContext`y$$ + 1, $CellContext`i$$ < 
               9, 
               Increment[$CellContext`i$$], 
               If[Part[$CellContext`side$$, $CellContext`x$$, \
$CellContext`i$$] != $CellContext`n$$, $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$, $CellContext`i$$}}]]; 
               If[Part[$CellContext`side$$, $CellContext`x$$, \
$CellContext`i$$] != 0, 
                 Break[]]]; 
             For[$CellContext`i$$ = $CellContext`y$$ - 1, $CellContext`i$$ > 
               0, 
               Decrement[$CellContext`i$$], 
               If[Part[$CellContext`side$$, $CellContext`x$$, \
$CellContext`i$$] != $CellContext`n$$, $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$, $CellContext`i$$}}]]; 
               If[Part[$CellContext`side$$, $CellContext`x$$, \
$CellContext`i$$] != 0, 
                 Break[]]]]; If[
             
             And[$CellContext`t == $CellContext`kk, $CellContext`s == \
$CellContext`n$$], $CellContext`kx$$ = $CellContext`x$$; $CellContext`ky$$ = \
$CellContext`y$$; 
             Part[$CellContext`side$$, $CellContext`x$$, $CellContext`y$$] = 
              0; Part[$CellContext`type$$, $CellContext`x$$, \
$CellContext`y$$] = 0; 
             If[$CellContext`x$$ < 
               8, $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, $CellContext`x$$ + 
                  1, $CellContext`y$$, $CellContext`n$$]; If[
                 Not[$CellContext`swattacked$$], $CellContext`eastok$$ = 
                 True, $CellContext`eastok$$ = False]]; 
             If[$CellContext`x$$ > 
               1, $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, $CellContext`x$$ - 
                  1, $CellContext`y$$, $CellContext`n$$]; If[
                 Not[$CellContext`swattacked$$], $CellContext`westok$$ = 
                 True, $CellContext`westok$$ = False]]; 
             If[$CellContext`y$$ < 
               8, $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, \
$CellContext`x$$, $CellContext`y$$ + 1, $CellContext`n$$]; If[
                 Not[$CellContext`swattacked$$], $CellContext`northok$$ = 
                 True, $CellContext`northok$$ = False]]; 
             If[$CellContext`y$$ > 
               1, $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, \
$CellContext`x$$, $CellContext`y$$ - 1, $CellContext`n$$]; If[
                 Not[$CellContext`swattacked$$], $CellContext`southok$$ = 
                 True, $CellContext`southok$$ = False]]; If[
               
               And[$CellContext`x$$ > 1, $CellContext`westok$$ == True, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  1, $CellContext`y$$] != $CellContext`n$$], \
$CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$}}]]; If[
               
               And[$CellContext`x$$ < 8, $CellContext`eastok$$ == True, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  1, $CellContext`y$$] != $CellContext`n$$], \
$CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$}}]]; If[
               
               And[$CellContext`y$$ > 1, $CellContext`southok$$ == True, 
                Part[$CellContext`side$$, $CellContext`x$$, $CellContext`y$$ - 
                  1] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$, $CellContext`y$$ - 1}}]]; If[
               
               And[$CellContext`y$$ < 8, $CellContext`northok$$ == True, 
                Part[$CellContext`side$$, $CellContext`x$$, $CellContext`y$$ + 
                  1] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$, $CellContext`y$$ + 1}}]]; If[
               
               And[$CellContext`x$$ > 1, $CellContext`y$$ > 1, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  1, $CellContext`y$$ - 
                  1] != $CellContext`n$$], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, $CellContext`x$$ - 
                  1, $CellContext`y$$ - 1, $CellContext`n$$]; If[
                 Not[$CellContext`swattacked$$], $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$ - 1}}]]]; If[
               
               And[$CellContext`x$$ > 1, $CellContext`y$$ < 8, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  1, $CellContext`y$$ + 
                  1] != $CellContext`n$$], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, $CellContext`x$$ - 
                  1, $CellContext`y$$ + 1, $CellContext`n$$]; If[
                 Not[$CellContext`swattacked$$], $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$ + 1}}]]]; If[
               
               And[$CellContext`x$$ < 8, $CellContext`y$$ > 1, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  1, $CellContext`y$$ - 
                  1] != $CellContext`n$$], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, $CellContext`x$$ + 
                  1, $CellContext`y$$ - 1, $CellContext`n$$]; If[
                 Not[$CellContext`swattacked$$], $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$ - 1}}]]]; If[
               
               And[$CellContext`x$$ < 8, $CellContext`y$$ < 8, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  1, $CellContext`y$$ + 
                  1] != $CellContext`n$$], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, $CellContext`x$$ + 
                  1, $CellContext`y$$ + 1, $CellContext`n$$]; If[
                 Not[$CellContext`swattacked$$], $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$ + 
                    1}}]]]; $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, \
$CellContext`x$$, $CellContext`y$$, $CellContext`n$$]; If[
               Not[$CellContext`swattacked$$], If[
                 
                 And[{$CellContext`x$$, $CellContext`y$$} == {5, 
                   1}, $CellContext`westok$$ == 
                  True, $CellContext`unmoveda1$$ == True, 
                  Part[$CellContext`side$$, 1, 1] == $CellContext`n$$, 
                  Part[$CellContext`side$$, 4, 1] == 0, 
                  Part[$CellContext`side$$, 3, 1] == 0, 
                  Part[$CellContext`side$$, 2, 1] == 
                  0], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, 3, 
                    1, $CellContext`n$$]; If[
                   Not[$CellContext`swattacked$$], $CellContext`list$$ = 
                   AppendTo[$CellContext`list$$, {{5, 1}, {3, 1}}]]]; If[
                 
                 And[{$CellContext`x$$, $CellContext`y$$} == {5, 
                   1}, $CellContext`eastok$$ == 
                  True, $CellContext`unmovedh1$$ == True, 
                  Part[$CellContext`side$$, 8, 1] == $CellContext`n$$, 
                  Part[$CellContext`side$$, 6, 1] == 0, 
                  Part[$CellContext`side$$, 7, 1] == 
                  0], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, 7, 
                    1, $CellContext`n$$]; If[
                   Not[$CellContext`swattacked$$], $CellContext`list$$ = 
                   AppendTo[$CellContext`list$$, {{5, 1}, {7, 1}}]]]; If[
                 
                 And[{$CellContext`x$$, $CellContext`y$$} == {5, 
                   8}, $CellContext`westok$$ == 
                  True, $CellContext`unmoveda8$$ == True, 
                  Part[$CellContext`side$$, 1, 8] == $CellContext`n$$, 
                  Part[$CellContext`side$$, 4, 8] == 0, 
                  Part[$CellContext`side$$, 3, 8] == 0, 
                  Part[$CellContext`side$$, 2, 8] == 
                  0], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, 3, 
                    8, $CellContext`n$$]; If[
                   Not[$CellContext`swattacked$$], $CellContext`list$$ = 
                   AppendTo[$CellContext`list$$, {{5, 8}, {3, 8}}]]]; If[
                 
                 And[{$CellContext`x$$, $CellContext`y$$} == {5, 
                   8}, $CellContext`eastok$$ == 
                  True, $CellContext`unmovedh8$$ == True, 
                  Part[$CellContext`side$$, 8, 8] == $CellContext`n$$, 
                  Part[$CellContext`side$$, 6, 8] == 0, 
                  Part[$CellContext`side$$, 7, 8] == 
                  0], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, 7, 
                    8, $CellContext`n$$]; If[
                   Not[$CellContext`swattacked$$], $CellContext`list$$ = 
                   AppendTo[$CellContext`list$$, {{5, 8}, {7, 8}}]]]]; 
             Part[$CellContext`side$$, $CellContext`x$$, $CellContext`y$$] = \
$CellContext`n$$; 
             Part[$CellContext`type$$, $CellContext`x$$, $CellContext`y$$] = \
$CellContext`kk], {$CellContext`x$$, 8}, {$CellContext`y$$, 
            8}]; $CellContext`l = Length[$CellContext`list$$]; 
         Do[$CellContext`a = 
            Part[$CellContext`list$$, $CellContext`j$$, 1]; $CellContext`b = 
            Part[$CellContext`list$$, $CellContext`j$$, 2]; $CellContext`ax = 
            Part[$CellContext`a, 1]; $CellContext`ay = 
            Part[$CellContext`a, 2]; $CellContext`bx = 
            Part[$CellContext`b, 1]; $CellContext`by = 
            Part[$CellContext`b, 2]; $CellContext`t = 
            Part[$CellContext`type$$, $CellContext`ax, $CellContext`ay]; 
           If[$CellContext`t != $CellContext`kk, 
             Part[$CellContext`side$$, $CellContext`ax, $CellContext`ay] = (
               Part[$CellContext`type$$, $CellContext`ax, $CellContext`ay] = 
               0); $CellContext`olds = 
              Part[$CellContext`side$$, $CellContext`bx, $CellContext`by]; \
$CellContext`oldt = 
              Part[$CellContext`type$$, $CellContext`bx, $CellContext`by]; 
             Part[$CellContext`side$$, $CellContext`bx, $CellContext`by] = \
$CellContext`n$$; 
             Part[$CellContext`type$$, $CellContext`bx, $CellContext`by] = \
$CellContext`t; $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, \
$CellContext`kx$$, $CellContext`ky$$, $CellContext`n$$]; 
             Part[$CellContext`side$$, $CellContext`ax, $CellContext`ay] = \
$CellContext`n$$; 
             Part[$CellContext`type$$, $CellContext`ax, $CellContext`ay] = \
$CellContext`t; 
             Part[$CellContext`side$$, $CellContext`bx, $CellContext`by] = \
$CellContext`olds; 
             Part[$CellContext`type$$, $CellContext`bx, $CellContext`by] = \
$CellContext`oldt; 
             If[$CellContext`swattacked$$, 
               Part[$CellContext`list$$, $CellContext`j$$] = {{0, 0}, {0, 
                0}}]], {$CellContext`j$$, 
            2, $CellContext`l}]; $CellContext`list1 = $CellContext`list0; Do[
           If[
           Part[$CellContext`list$$, $CellContext`j$$] != {{0, 0}, {0, 
             0}}, $CellContext`list1 = AppendTo[$CellContext`list1, 
              
              Part[$CellContext`list$$, $CellContext`j$$]]], \
{$CellContext`j$$, 
            2, $CellContext`l}]; $CellContext`list$$ = $CellContext`list1]; \
$CellContext`l = Length[$CellContext`list$$]; ClickPane[
         Graphics[{$CellContext`board, 
           EdgeForm[Thin], 
           If[$CellContext`f$$ == $CellContext`r$$, 
            Table[{
              If[
              Part[$CellContext`side$$, $CellContext`i$$, $CellContext`j$$] == 
               1, 
               Which[$CellContext`colw$$ == 1, 
                RGBColor[0.9, 0.9, 0.5], $CellContext`colw$$ == 2, 
                RGBColor[0.7, 0.7, 0.4], $CellContext`colw$$ == 3, 
                RGBColor[0.9, 0.3, 0.3]], 
               Which[$CellContext`colb$$ == 1, 
                RGBColor[0.4, 0.4, 0.3], $CellContext`colb$$ == 2, 
                RGBColor[0.3, 0.4, 0.1], $CellContext`colb$$ == 3, 
                RGBColor[0.2, 0.5, 0.5]]], 
              Which[
              Part[$CellContext`type$$, $CellContext`i$$, $CellContext`j$$] == \
$CellContext`pp, 
               
               Translate[$CellContext`pawn, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`type$$, $CellContext`i$$, $CellContext`j$$] == \
$CellContext`rr, 
               
               Translate[$CellContext`rook, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`type$$, $CellContext`i$$, $CellContext`j$$] == \
$CellContext`nn, 
               
               Translate[$CellContext`knight, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`type$$, $CellContext`i$$, $CellContext`j$$] == \
$CellContext`bb, 
               
               Translate[$CellContext`bishop, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`type$$, $CellContext`i$$, $CellContext`j$$] == \
$CellContext`qq, 
               
               Translate[$CellContext`queen, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`type$$, $CellContext`i$$, $CellContext`j$$] == \
$CellContext`kk, 
               
               Translate[$CellContext`king, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`type$$, $CellContext`i$$, $CellContext`j$$] == 
               0, {}]}, {$CellContext`i$$, 8}, {$CellContext`j$$, 8}], {}], 
           If[$CellContext`f$$ < $CellContext`r$$, 
            Table[{
              If[
              Part[$CellContext`sides$$, $CellContext`f$$ + 
                 1, $CellContext`i$$, $CellContext`j$$] == 1, 
               Which[$CellContext`colw$$ == 1, 
                RGBColor[0.9, 0.9, 0.5], $CellContext`colw$$ == 2, 
                RGBColor[0.7, 0.7, 0.4], $CellContext`colw$$ == 3, 
                RGBColor[0.9, 0.3, 0.3]], 
               Which[$CellContext`colb$$ == 1, 
                RGBColor[0.4, 0.4, 0.3], $CellContext`colb$$ == 2, 
                RGBColor[0.3, 0.4, 0.1], $CellContext`colb$$ == 3, 
                RGBColor[0.2, 0.5, 0.5]]], 
              Which[
              Part[$CellContext`types$$, $CellContext`f$$ + 
                 1, $CellContext`i$$, $CellContext`j$$] == $CellContext`pp, 
               
               Translate[$CellContext`pawn, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`types$$, $CellContext`f$$ + 
                 1, $CellContext`i$$, $CellContext`j$$] == $CellContext`rr, 
               
               Translate[$CellContext`rook, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`types$$, $CellContext`f$$ + 
                 1, $CellContext`i$$, $CellContext`j$$] == $CellContext`nn, 
               
               Translate[$CellContext`knight, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`types$$, $CellContext`f$$ + 
                 1, $CellContext`i$$, $CellContext`j$$] == $CellContext`bb, 
               
               Translate[$CellContext`bishop, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`types$$, $CellContext`f$$ + 
                 1, $CellContext`i$$, $CellContext`j$$] == $CellContext`qq, 
               
               Translate[$CellContext`queen, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`types$$, $CellContext`f$$ + 
                 1, $CellContext`i$$, $CellContext`j$$] == $CellContext`kk, 
               
               Translate[$CellContext`king, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`types$$, $CellContext`f$$ + 
                 1, $CellContext`i$$, $CellContext`j$$] == 
               0, {}]}, {$CellContext`i$$, 8}, {$CellContext`j$$, 8}], {}], 
           Green, 
           If[
            
            And[$CellContext`showtargets$$, $CellContext`h$$ == 
             1, $CellContext`from$$ != {0, 0}, $CellContext`to$$ == {0, 0}], 
            Table[
             If[
             Part[$CellContext`list$$, $CellContext`i$$, 
                1] == $CellContext`oldfrom$$, 
              
              Disk[{Part[$CellContext`list$$, $CellContext`i$$, 2, 1] - 0.5, 
                Part[$CellContext`list$$, $CellContext`i$$, 2, 2] - 0.5}, 
               0.2], {}], {$CellContext`i$$, $CellContext`l}], {}], 
           If[
            
            And[$CellContext`showmoves$$, $CellContext`h$$ == 
             1, $CellContext`from$$ == {0, 0}], 
            Table[
             
             Arrow[{Part[$CellContext`list$$, $CellContext`i$$, 1] - {0.5, 
               0.5}, Part[$CellContext`list$$, $CellContext`i$$, 2] - {0.5, 
               0.5}}], {$CellContext`i$$, 2, $CellContext`l}], {}], 
           If[$CellContext`unmoveda1$$, Green, Red], 
           If[$CellContext`edit$$ == "castling options", 
            Disk[{0.5, 0.5}, 0.2], {}], 
           If[$CellContext`unmovedh1$$, Green, Red], 
           If[$CellContext`edit$$ == "castling options", 
            Disk[{7.5, 0.5}, 0.2], {}], 
           If[$CellContext`unmoveda8$$, Green, Red], 
           If[$CellContext`edit$$ == "castling options", 
            Disk[{0.5, 7.5}, 0.2], {}], 
           If[$CellContext`unmovedh8$$, Green, Red], 
           If[$CellContext`edit$$ == "castling options", 
            Disk[{7.5, 7.5}, 0.2], {}], Yellow, 
           If[$CellContext`from$$ != {0, 0}, 
            Disk[$CellContext`from$$ - {0.5, 0.5}, 0.2], {}], Black, 
           If[$CellContext`n$$ == 1, 
            Disk[{0, 0}, 0.1], 
            Disk[{0, 8}, 0.1]], 
           If[$CellContext`f$$ > 0, 
            If[Part[$CellContext`wfrom$$, $CellContext`f$$] != {0, 0}, 
             Text[
              Style[
               Row[{$CellContext`f$$, ". ", 
                 Part[$CellContext`names, 
                  Part[$CellContext`wpiece$$, $CellContext`f$$]], 
                 Part[$CellContext`alpha, 
                  Part[$CellContext`wfrom$$, $CellContext`f$$, 1]], 
                 Part[$CellContext`wfrom$$, $CellContext`f$$, 2], " ", 
                 Part[$CellContext`captures$$, $CellContext`f$$, 1]}], 12], {
              2.95, -0.5}], 
             Text[
              Style[
               Row[{$CellContext`f$$, ". ", "... - ..."}], 12], {
              2.95, -0.5}]], 
            Text[" ", {2.8, -0.5}]], 
           If[
            And[
             Inequality[
              Length[$CellContext`wto$$], GreaterEqual, $CellContext`f$$, 
              Greater, 0], 
             Part[$CellContext`wto$$, $CellContext`f$$] != {0, 0}], {
             Text[
              Style[
               Row[{
                 Part[$CellContext`alpha, 
                  Part[$CellContext`wto$$, $CellContext`f$$, 1]], 
                 Part[$CellContext`wto$$, $CellContext`f$$, 2], 
                 Part[$CellContext`checks$$, $CellContext`f$$, 1]}], 12], {
              3.75, -0.5}], 
             If[
              
              And[$CellContext`l == 1, $CellContext`h$$ == 1, 
               Length[$CellContext`bto$$] < $CellContext`r$$], 
              If[Part[$CellContext`checks$$, $CellContext`f$$, 1] == "+", 
               Text[
                Style[
                 Row[{"mate"}], 12], {4.4, -0.5}], 
               Text[
                Style[
                 Row[{"stalemate"}], 12], {4.4, -0.5}]], {}]}, {}], 
           If[
            Inequality[
             Length[$CellContext`bfrom$$], GreaterEqual, $CellContext`f$$, 
             Greater, 0], 
            Text[
             Style[
              Row[{
                Part[$CellContext`names, 
                 Part[$CellContext`bpiece$$, $CellContext`f$$]], 
                Part[$CellContext`alpha, 
                 Part[$CellContext`bfrom$$, $CellContext`f$$, 1]], 
                Part[$CellContext`bfrom$$, $CellContext`f$$, 2], " ", 
                Part[$CellContext`captures$$, $CellContext`f$$, 2]}], 12], {
             4.4, -0.5}], {}], 
           If[
            Inequality[
             Length[$CellContext`bto$$], GreaterEqual, $CellContext`f$$, 
             Greater, 0], {
             Text[
              Style[
               Row[{
                 Part[$CellContext`alpha, 
                  Part[$CellContext`bto$$, $CellContext`f$$, 1]], 
                 Part[$CellContext`bto$$, $CellContext`f$$, 2], 
                 Part[$CellContext`checks$$, $CellContext`f$$, 2]}], 12], {
              5., -0.5}], 
             If[
              And[$CellContext`l == 1, $CellContext`h$$ == 1], 
              If[Part[$CellContext`checks$$, $CellContext`f$$, 2] == "+", 
               Text[
                Style[
                 Row[{"mate"}], 12], {5.8, -0.5}], 
               Text[
                Style[
                 Row[{"stalemate"}], 12], {5.8, -0.5}]], {}]}, {}]}, 
          PlotRange -> {{-0.1, 8.1}, {-0.9, 8.1}}, ImageSize -> {400, 400}], {
         
          If[
           And[$CellContext`h$$ == 1, 
            Or[
            Length[$CellContext`list$$] > 1, $CellContext`edit$$ != 
             "play"]], {$CellContext`pos$$ = Floor[#] + {1, 1}, 
            Part[$CellContext`pos$$, 1] = Max[
              Part[$CellContext`pos$$, 1], 1], Part[$CellContext`pos$$, 1] = 
            Min[
              Part[$CellContext`pos$$, 1], 8], Part[$CellContext`pos$$, 2] = 
            Max[
              Part[$CellContext`pos$$, 2], 1], Part[$CellContext`pos$$, 2] = 
            Min[
              Part[$CellContext`pos$$, 2], 8], 
            If[
             Not[$CellContext`part1$$], 
             Which[$CellContext`edit$$ == "play", {}, $CellContext`edit$$ == 
               "delete", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 0; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 0, $CellContext`edit$$ == 
               "white pawn", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 1, $CellContext`edit$$ == 
               "white rook", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 2, $CellContext`edit$$ == 
               "white knight", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 3, $CellContext`edit$$ == 
               "white bishop", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 4, $CellContext`edit$$ == 
               "white queen", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 5, $CellContext`edit$$ == 
               "white king", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 6, $CellContext`edit$$ == 
               "black pawn", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = -1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 1, $CellContext`edit$$ == 
               "black rook", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = -1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 2, $CellContext`edit$$ == 
               "black knight", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = -1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 3, $CellContext`edit$$ == 
               "black bishop", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = -1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 4, $CellContext`edit$$ == 
               "black queen", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = -1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 5, $CellContext`edit$$ == 
               "black king", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = -1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 6, 
               
               And[$CellContext`edit$$ == "next player", $CellContext`r$$ == 
                0], $CellContext`n$$ = -$CellContext`n$$]; 
             If[$CellContext`edit$$ != 
               "play", $CellContext`list$$ = $CellContext`list0]], 
            If[
             
             And[$CellContext`edit$$ == "castling options", 
              Part[$CellContext`type$$, 
                Part[$CellContext`pos$$, 1], 
                Part[$CellContext`pos$$, 2]] == $CellContext`rr], 
             If[$CellContext`pos$$ == {1, 1}, $CellContext`unmoveda1$$ = 
               Not[$CellContext`unmoveda1$$]]; 
             If[$CellContext`pos$$ == {8, 1}, $CellContext`unmovedh1$$ = 
               Not[$CellContext`unmovedh1$$]]; 
             If[$CellContext`pos$$ == {1, 8}, $CellContext`unmoveda8$$ = 
               Not[$CellContext`unmoveda8$$]]; 
             If[$CellContext`pos$$ == {8, 8}, $CellContext`unmovedh8$$ = 
               Not[$CellContext`unmovedh8$$]], {}], 
            
            If[$CellContext`edit$$ == 
             "reset", $CellContext`r$$ = 0; $CellContext`edit$$ = 
              "play"; $CellContext`wto$$ = ($CellContext`wfrom$$ = \
($CellContext`bfrom$$ = ($CellContext`bto$$ = ($CellContext`wpiece$$ = \
($CellContext`bpiece$$ = {}))))); $CellContext`side$$ = $CellContext`side0; \
$CellContext`type$$ = $CellContext`type0; $CellContext`list$$ = \
$CellContext`list0; $CellContext`sides$$ = {$CellContext`side0}; \
$CellContext`types$$ = {$CellContext`type0}; $CellContext`part1$$ = \
($CellContext`part2$$ = False); $CellContext`ok$$ = 
              False; $CellContext`from$$ = ($CellContext`to$$ = \
($CellContext`epwhite$$ = ($CellContext`epblack$$ = {0, 
                  0}))); $CellContext`n$$ = 
              1; $CellContext`unmoveda1$$ = ($CellContext`unmoveda8$$ = \
($CellContext`unmovedh1$$ = ($CellContext`unmovedh8$$ = True)))], 
            
            If[$CellContext`edit$$ == 
             "clear", $CellContext`r$$ = 
              0; $CellContext`wto$$ = ($CellContext`wfrom$$ = \
($CellContext`bfrom$$ = ($CellContext`bto$$ = ($CellContext`wpiece$$ = \
($CellContext`bpiece$$ = {}))))); $CellContext`list$$ = $CellContext`list0; \
$CellContext`side$$ = ($CellContext`type$$ = $CellContext`all0); \
$CellContext`sides$$ = ($CellContext`types$$ = {$CellContext`all0}); \
$CellContext`part1$$ = ($CellContext`part2$$ = False); $CellContext`ok$$ = 
              
              False; $CellContext`from$$ = ($CellContext`to$$ = \
($CellContext`epwhite$$ = ($CellContext`epblack$$ = {0, 
                  0}))); $CellContext`n$$ = 
              1; $CellContext`unmoveda1$$ = ($CellContext`unmoveda8$$ = \
($CellContext`unmovedh1$$ = ($CellContext`unmovedh8$$ = True)))], 
            If[$CellContext`edit$$ == "play", {
              If[
               Or[
                And[$CellContext`n$$ == 1, 
                 Not[$CellContext`randomwhite$$]], 
                And[$CellContext`n$$ == -1, 
                 Not[$CellContext`randomblack$$]]], {$CellContext`l = 
                Length[$CellContext`list$$], $CellContext`part1$$ = \
($CellContext`part2$$ = False), 
                If[
                 And[
                 Part[$CellContext`from$$, 1] == 0, $CellContext`n$$ == 
                  Part[$CellContext`side$$, 
                    Part[$CellContext`pos$$, 1], 
                    Part[$CellContext`pos$$, 2]]], {
                  
                  For[$CellContext`i$$ = 
                   1, $CellContext`i$$ <= $CellContext`l, 
                   Increment[$CellContext`i$$], 
                   If[
                   Part[$CellContext`list$$, $CellContext`i$$, 
                    1] == $CellContext`pos$$, {$CellContext`part1$$ = True, 
                    Break[]}]]}], 
                If[
                 And[
                 Part[$CellContext`from$$, 1] != 0, 
                  Part[$CellContext`to$$, 1] == 0, $CellContext`n$$ != 
                  Part[$CellContext`side$$, 
                    Part[$CellContext`pos$$, 1], 
                    Part[$CellContext`pos$$, 2]]], {
                  
                  For[$CellContext`i$$ = 
                   1, $CellContext`i$$ <= $CellContext`l, 
                   Increment[$CellContext`i$$], 
                   If[
                    And[
                    Part[$CellContext`list$$, $CellContext`i$$, 
                    1] == $CellContext`oldfrom$$, 
                    Part[$CellContext`list$$, $CellContext`i$$, 
                    2] == $CellContext`pos$$], {$CellContext`part2$$ = True, 
                    Break[]}]]}], 
                
                If[$CellContext`part1$$, $CellContext`oldfrom$$ = \
($CellContext`from$$ = $CellContext`pos$$); $CellContext`to$$ = {0, 0}], 
                
                If[$CellContext`part2$$, $CellContext`to$$ = \
$CellContext`pos$$], 
                If[
                 
                 And[$CellContext`part1$$, $CellContext`n$$ == 
                  1], $CellContext`r$$ = $CellContext`r$$ + 
                   1; $CellContext`wfrom$$ = 
                  AppendTo[$CellContext`wfrom$$, $CellContext`pos$$]; \
$CellContext`wpiece$$ = AppendTo[$CellContext`wpiece$$, 
                    Part[$CellContext`type$$, 
                    Part[$CellContext`pos$$, 1], 
                    Part[$CellContext`pos$$, 2]]]], 
                If[
                 
                 And[$CellContext`part1$$, $CellContext`n$$ == -1], \
$CellContext`bfrom$$ = 
                  AppendTo[$CellContext`bfrom$$, $CellContext`pos$$]; \
$CellContext`bpiece$$ = AppendTo[$CellContext`bpiece$$, 
                    Part[$CellContext`type$$, 
                    Part[$CellContext`pos$$, 1], 
                    Part[$CellContext`pos$$, 2]]]; 
                 If[$CellContext`r$$ == 
                   0, $CellContext`r$$ = 
                    1; $CellContext`wfrom$$ = ($CellContext`wto$$ = {{0, 
                    0}}); $CellContext`wpiece$$ = {$CellContext`pp}; \
$CellContext`captures$$ = {{"-", "-"}, {"-", "-"}}]], 
                If[
                 And[
                  Not[$CellContext`part1$$], 
                  Not[$CellContext`part2$$]], If[
                   
                   And[$CellContext`from$$ != {0, 0}, $CellContext`to$$ == {0,
                     0}, $CellContext`n$$ == 1], $CellContext`wfrom$$ = 
                    Delete[$CellContext`wfrom$$, $CellContext`r$$]; \
$CellContext`wpiece$$ = 
                    Delete[$CellContext`wpiece$$, $CellContext`r$$]; \
$CellContext`r$$ = $CellContext`r$$ - 1, {}]; If[
                   
                   And[$CellContext`from$$ != {0, 0}, $CellContext`to$$ == {0,
                     0}, $CellContext`n$$ == -1], $CellContext`bfrom$$ = 
                    Delete[$CellContext`wfrom$$, $CellContext`r$$]; \
$CellContext`bpiece$$ = 
                    Delete[$CellContext`bpiece$$, $CellContext`r$$], {}]; \
$CellContext`from$$ = ($CellContext`to$$ = {0, 0})]}], 
              If[
               
               And[$CellContext`randomwhite$$, $CellContext`n$$ == 
                1, $CellContext`from$$ == {0, 0}], $CellContext`i$$ = 
                RandomInteger[{2, 
                   Length[$CellContext`list$$]}]; $CellContext`from$$ = 
                Part[$CellContext`list$$, $CellContext`i$$, 
                  1]; $CellContext`pos$$ = ($CellContext`to$$ = 
                 Part[$CellContext`list$$, $CellContext`i$$, 
                   2]); $CellContext`wfrom$$ = 
                AppendTo[$CellContext`wfrom$$, $CellContext`from$$]; \
$CellContext`wpiece$$ = AppendTo[$CellContext`wpiece$$, 
                  Part[$CellContext`type$$, 
                   Part[$CellContext`from$$, 1], 
                   Part[$CellContext`from$$, 2]]]; $CellContext`captures$$ = 
                Append[$CellContext`captures$$, {
                  "-", "-"}]; $CellContext`checks$$ = 
                Append[$CellContext`checks$$, {
                  " ", " "}]; $CellContext`r$$ = $CellContext`r$$ + 
                 1; $CellContext`part1$$ = False; $CellContext`part2$$ = 
                True], 
              If[
               
               And[$CellContext`randomblack$$, $CellContext`n$$ == -1, \
$CellContext`from$$ == {0, 0}], $CellContext`i$$ = RandomInteger[{2, 
                   Length[$CellContext`list$$]}]; $CellContext`from$$ = 
                Part[$CellContext`list$$, $CellContext`i$$, 
                  1]; $CellContext`pos$$ = ($CellContext`to$$ = 
                 Part[$CellContext`list$$, $CellContext`i$$, 
                   2]); $CellContext`bfrom$$ = 
                AppendTo[$CellContext`bfrom$$, $CellContext`from$$]; \
$CellContext`bpiece$$ = AppendTo[$CellContext`bpiece$$, 
                  Part[$CellContext`type$$, 
                   Part[$CellContext`from$$, 1], 
                   Part[$CellContext`from$$, 2]]]; 
               If[$CellContext`r$$ == 
                 0, $CellContext`r$$ = 
                  1; $CellContext`wfrom$$ = ($CellContext`wto$$ = {{
                    9, " "}}); $CellContext`wpiece$$ = {$CellContext`pp}]; \
$CellContext`captures$$ = 
                Append[$CellContext`captures$$, {
                  "-", "-"}]; $CellContext`part1$$ = 
                False; $CellContext`part2$$ = True], $CellContext`x$$ = 
              Part[$CellContext`from$$, 1], $CellContext`y$$ = 
              Part[$CellContext`from$$, 2], 
              If[$CellContext`part2$$, {
                If[
                 
                 Or[$CellContext`from$$ == {1, 1}, $CellContext`to$$ == {1, 
                   1}, $CellContext`from$$ == {5, 
                   1}], $CellContext`unmoveda1$$ = False], 
                If[
                 
                 Or[$CellContext`from$$ == {8, 1}, $CellContext`to$$ == {8, 
                   1}, $CellContext`from$$ == {5, 
                   1}], $CellContext`unmovedh1$$ = False], 
                If[
                 
                 Or[$CellContext`from$$ == {1, 8}, $CellContext`to$$ == {1, 
                   8}, $CellContext`from$$ == {5, 
                   8}], $CellContext`unmoveda8$$ = False], 
                If[
                 
                 Or[$CellContext`from$$ == {8, 8}, $CellContext`to$$ == {8, 
                   8}, $CellContext`from$$ == {5, 
                   8}], $CellContext`unmovedh8$$ = False], 
                If[
                 And[
                 Part[$CellContext`type$$, $CellContext`x$$, \
$CellContext`y$$] == $CellContext`pp, $CellContext`y$$ == 2, 
                  Part[$CellContext`to$$, 2] == 
                  4], $CellContext`epwhite$$ = {$CellContext`x$$, 3}], 
                If[
                 And[
                 Part[$CellContext`type$$, $CellContext`x$$, \
$CellContext`y$$] == $CellContext`pp, $CellContext`y$$ == 7, 
                  Part[$CellContext`to$$, 2] == 
                  5], $CellContext`epblack$$ = {$CellContext`x$$, 6}], 
                If[
                 And[
                 Part[$CellContext`type$$, $CellContext`x$$, \
$CellContext`y$$] == $CellContext`pp, 
                  Or[
                  Part[$CellContext`to$$, 2] == 8, Part[$CellContext`to$$, 2] == 
                   1]], 
                 
                 Which[$CellContext`prom$$ == "queen", 
                  Part[$CellContext`type$$, 
                    Part[$CellContext`to$$, 1], 
                    
                    Part[$CellContext`to$$, 
                    2]] = $CellContext`qq, $CellContext`prom$$ == "rook", 
                  Part[$CellContext`type$$, 
                    Part[$CellContext`to$$, 1], 
                    
                    Part[$CellContext`to$$, 
                    2]] = $CellContext`rr, $CellContext`prom$$ == "bishop", 
                  Part[$CellContext`type$$, 
                    Part[$CellContext`to$$, 1], 
                    
                    Part[$CellContext`to$$, 
                    2]] = $CellContext`bb, $CellContext`prom$$ == "knight", 
                  Part[$CellContext`type$$, 
                    Part[$CellContext`to$$, 1], 
                    Part[$CellContext`to$$, 2]] = $CellContext`nn], 
                 Part[$CellContext`type$$, 
                   Part[$CellContext`to$$, 1], 
                   Part[$CellContext`to$$, 2]] = 
                 Part[$CellContext`type$$, $CellContext`x$$, \
$CellContext`y$$]], 
                If[
                Part[$CellContext`type$$, $CellContext`x$$, $CellContext`y$$] == \
$CellContext`kk, If[
                   
                   And[$CellContext`from$$ == {5, 1}, $CellContext`to$$ == {3,
                     1}], Part[$CellContext`type$$, 4, 1] = $CellContext`rr; 
                   Part[$CellContext`type$$, 1, 1] = 0; 
                   Part[$CellContext`side$$, 4, 1] = 1; 
                   Part[$CellContext`side$$, 1, 1] = 0]; If[
                   
                   And[$CellContext`from$$ == {5, 1}, $CellContext`to$$ == {7,
                     1}], Part[$CellContext`type$$, 6, 1] = $CellContext`rr; 
                   Part[$CellContext`type$$, 8, 1] = 0; 
                   Part[$CellContext`side$$, 6, 1] = 1; 
                   Part[$CellContext`side$$, 8, 1] = 0]; If[
                   
                   And[$CellContext`from$$ == {5, 8}, $CellContext`to$$ == {3,
                     8}], Part[$CellContext`type$$, 4, 8] = $CellContext`rr; 
                   Part[$CellContext`type$$, 1, 8] = 0; 
                   Part[$CellContext`side$$, 4, 8] = -1; 
                   Part[$CellContext`side$$, 1, 8] = 0]; If[
                   
                   And[$CellContext`from$$ == {5, 8}, $CellContext`to$$ == {7,
                     8}], Part[$CellContext`type$$, 6, 8] = $CellContext`rr; 
                   Part[$CellContext`type$$, 8, 8] = 0; 
                   Part[$CellContext`side$$, 6, 8] = -1; 
                   Part[$CellContext`side$$, 8, 8] = 
                    0]], $CellContext`capture$$ = "-"; If[
                  And[
                  Part[$CellContext`type$$, $CellContext`x$$, \
$CellContext`y$$] == $CellContext`pp, $CellContext`to$$ == \
$CellContext`epblack$$], Part[$CellContext`type$$, 
                    Part[$CellContext`to$$, 1], Part[$CellContext`to$$, 2] - 
                    1] = 0; Part[$CellContext`side$$, 
                    Part[$CellContext`to$$, 1], Part[$CellContext`to$$, 2] - 
                    1] = 0; $CellContext`capture$$ = "x"], 
                If[
                 And[
                 Part[$CellContext`type$$, $CellContext`x$$, \
$CellContext`y$$] == $CellContext`pp, $CellContext`to$$ == \
$CellContext`epwhite$$], Part[$CellContext`type$$, 
                    Part[$CellContext`to$$, 1], Part[$CellContext`to$$, 2] + 
                    1] = 0; Part[$CellContext`side$$, 
                    Part[$CellContext`to$$, 1], Part[$CellContext`to$$, 2] + 
                    1] = 0; $CellContext`capture$$ = "x"], 
                Part[$CellContext`type$$, $CellContext`x$$, $CellContext`y$$] = 
                0, 
                If[Part[$CellContext`side$$, 
                   Part[$CellContext`to$$, 1], 
                   Part[$CellContext`to$$, 2]] != 0, $CellContext`capture$$ = 
                 "x"], Part[$CellContext`side$$, 
                  Part[$CellContext`to$$, 1], 
                  Part[$CellContext`to$$, 2]] = 
                Part[$CellContext`side$$, $CellContext`x$$, $CellContext`y$$],
                 Part[$CellContext`side$$, $CellContext`x$$, \
$CellContext`y$$] = 0, 
                
                If[$CellContext`n$$ == 
                 1, $CellContext`wto$$ = 
                  AppendTo[$CellContext`wto$$, $CellContext`pos$$]; \
$CellContext`captures$$ = Append[$CellContext`captures$$, {"-", "-"}]; 
                 Part[$CellContext`captures$$, $CellContext`r$$, 
                    1] = $CellContext`capture$$; $CellContext`list$$ = \
$CellContext`list0; $CellContext`checks$$ = 
                  Append[$CellContext`checks$$, {" ", " "}]; Do[
                   If[
                    And[
                    Part[$CellContext`type$$, $CellContext`i$$, \
$CellContext`j$$] == $CellContext`kk, 
                    Part[$CellContext`side$$, $CellContext`i$$, \
$CellContext`j$$] == -$CellContext`n$$], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, \
$CellContext`i$$, $CellContext`j$$, -$CellContext`n$$]; 
                    Break[]], {$CellContext`i$$, 8}, {$CellContext`j$$, 8}]; 
                 If[$CellContext`swattacked$$, 
                   Part[$CellContext`checks$$, $CellContext`r$$, 1] = "+"]], 
                
                If[$CellContext`n$$ == -1, $CellContext`bto$$ = 
                  AppendTo[$CellContext`bto$$, $CellContext`pos$$]; \
$CellContext`sides$$ = 
                  AppendTo[$CellContext`sides$$, $CellContext`side$$]; \
$CellContext`types$$ = AppendTo[$CellContext`types$$, $CellContext`type$$]; 
                 Part[$CellContext`captures$$, $CellContext`r$$, 
                    2] = $CellContext`capture$$; $CellContext`list$$ = \
$CellContext`list0; Do[
                   If[
                    And[
                    Part[$CellContext`type$$, $CellContext`i$$, \
$CellContext`j$$] == $CellContext`kk, 
                    Part[$CellContext`side$$, $CellContext`i$$, \
$CellContext`j$$] == -$CellContext`n$$], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, \
$CellContext`i$$, $CellContext`j$$, -$CellContext`n$$]; 
                    Break[]], {$CellContext`i$$, 8}, {$CellContext`j$$, 8}]; 
                 If[$CellContext`swattacked$$, 
                   Part[$CellContext`checks$$, $CellContext`r$$, 2] = "+"]], 
                
                If[$CellContext`n$$ == 
                 1, $CellContext`epblack$$ = {0, 
                  0}, $CellContext`epwhite$$ = {0, 
                  0}], $CellContext`n$$ = -$CellContext`n$$, \
$CellContext`list$$ = $CellContext`list0, $CellContext`part1$$ = \
($CellContext`part2$$ = 
                 False), $CellContext`from$$ = ($CellContext`to$$ = {0, 
                  0})}]}]}]}& ]), 
      "Specifications" :> {{{$CellContext`colw$$, 1, 
          Style["color White", 10]}, {1, 2, 3}, ControlType -> 
         PopupMenu}, {{$CellContext`colb$$, 1, 
          Style["color Black", 10]}, {1, 2, 3}, ControlType -> 
         PopupMenu}, {{$CellContext`randomwhite$$, False, "random White"}, {
         True, False}}, {{$CellContext`randomblack$$, False, 
          "random Black"}, {
         True, False}}, {{$CellContext`showmoves$$, False, "show moves"}, {
         True, False}}, {{$CellContext`showtargets$$, True, "show targets"}, {
         True, False}}, {{$CellContext`prom$$, "queen", 
          Style["promotion to", 10]}, {"queen", "rook", "bishop", "knight"}, 
         ControlType -> PopupMenu}, {{$CellContext`edit$$, "play", 
          Style["edit position", 10]}, {
         "play", "reset", "clear", "delete", "white pawn", "white knight", 
          "white bishop", "white rook", "white queen", "white king", 
          "black pawn", "black knight", "black bishop", "black rook", 
          "black queen", "black king", "castling options", "next player"}, 
         ControlType -> PopupMenu}, {{$CellContext`h$$, 1, 
          Style["history"]}, 0, 1, ControlType -> Slider, ImageSize -> 
         Small}, {{$CellContext`i$$, 0}, ControlType -> 
         None}, {{$CellContext`j$$, 0}, ControlType -> 
         None}, {{$CellContext`kx$$, 0}, ControlType -> 
         None}, {{$CellContext`ky$$, 0}, ControlType -> 
         None}, {{$CellContext`pos$$, {0, 0}}, ControlType -> 
         None}, {{$CellContext`from$$, {0, 0}}, ControlType -> 
         None}, {{$CellContext`oldfrom$$, {0, 0}}, ControlType -> 
         None}, {{$CellContext`to$$, {0, 0}}, ControlType -> 
         None}, {{$CellContext`side$$, {{1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 
          0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
          0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
          0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
          0, -1, -1}}}, ControlType -> 
         None}, {{$CellContext`type$$, {{2, 1, 0, 0, 0, 0, 1, 2}, {3, 1, 0, 0,
           0, 0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 4}, {5, 1, 0, 0, 0, 0, 1, 5}, {
          6, 1, 0, 0, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0, 1, 4}, {3, 1, 0, 0, 0, 
          0, 1, 3}, {2, 1, 0, 0, 0, 0, 1, 2}}}, ControlType -> 
         None}, {{$CellContext`n$$, 1}, ControlType -> 
         None}, {{$CellContext`list$$, {{{0, 0}, {0, 0}}}}, ControlType -> 
         None}, {{$CellContext`sides$$, {{{1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 
          0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
          0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
          0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
          0, -1, -1}}}}, ControlType -> 
         None}, {{$CellContext`types$$, {{{2, 1, 0, 0, 0, 0, 1, 2}, {3, 1, 0, 
          0, 0, 0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 4}, {5, 1, 0, 0, 0, 0, 1, 
          5}, {6, 1, 0, 0, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0, 1, 4}, {3, 1, 0, 0,
           0, 0, 1, 3}, {2, 1, 0, 0, 0, 0, 1, 2}}}}, ControlType -> 
         None}, {{$CellContext`wfrom$$, {}}, ControlType -> 
         None}, {{$CellContext`wto$$, {}}, ControlType -> 
         None}, {{$CellContext`wpiece$$, {}}, ControlType -> 
         None}, {{$CellContext`bfrom$$, {}}, ControlType -> 
         None}, {{$CellContext`bto$$, {}}, ControlType -> 
         None}, {{$CellContext`bpiece$$, {}}, ControlType -> 
         None}, {{$CellContext`unmoveda1$$, True}, ControlType -> 
         None}, {{$CellContext`unmoveda8$$, True}, ControlType -> 
         None}, {{$CellContext`unmovedh1$$, True}, ControlType -> 
         None}, {{$CellContext`unmovedh8$$, True}, ControlType -> 
         None}, {{$CellContext`epwhite$$, {0, 0}}, ControlType -> 
         None}, {{$CellContext`epblack$$, {0, 0}}, ControlType -> 
         None}, {{$CellContext`r$$, 0}, ControlType -> 
         None}, {{$CellContext`f$$, 0}, ControlType -> 
         None}, {{$CellContext`capture$$, "-"}, ControlType -> 
         None}, {{$CellContext`captures$$, {{"-", "-"}}}, ControlType -> 
         None}, {{$CellContext`checks$$, {{" ", " "}}}, ControlType -> 
         None}, {{$CellContext`part1$$, False}, ControlType -> 
         None}, {{$CellContext`part2$$, False}, ControlType -> 
         None}, {{$CellContext`ok$$, False}, ControlType -> 
         None}, {{$CellContext`eastok$$, False}, ControlType -> 
         None}, {{$CellContext`westok$$, False}, ControlType -> 
         None}, {{$CellContext`southok$$, False}, ControlType -> 
         None}, {{$CellContext`northok$$, False}, ControlType -> 
         None}, {{$CellContext`x$$, 0}, ControlType -> 
         None}, {{$CellContext`y$$, 0}, ControlType -> 
         None}, {{$CellContext`swattacked$$, False}, ControlType -> None}}, 
      "Options" :> {ControlPlacement -> Left, AutorunSequencing -> {1}}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{651., {226., 231.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`list0 = {{{0, 0}, {0, 
        0}}}, $CellContext`pp = 1, $CellContext`nn = 3, $CellContext`bb = 
       4, $CellContext`qq = 5, $CellContext`rr = 2, $CellContext`kk = 
       6, $CellContext`check[
         Pattern[$CellContext`si$, 
          Blank[]], 
         Pattern[$CellContext`ty$, 
          Blank[]], 
         Pattern[$CellContext`x$, 
          Blank[]], 
         Pattern[$CellContext`y$, 
          Blank[]], 
         Pattern[$CellContext`n$, 
          Blank[]]] := 
       Module[{$CellContext`sw$}, $CellContext`sw$ = False; If[
           
           And[$CellContext`x$ < 8, $CellContext`n$ $CellContext`y$ < 
            4 + $CellContext`n$ 3, 
            Part[$CellContext`si$, $CellContext`x$ + 
              1, $CellContext`y$ + $CellContext`n$] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ + 
              1, $CellContext`y$ + $CellContext`n$] == $CellContext`pp], \
$CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ > 1, $CellContext`n$ $CellContext`y$ < 
            4 + $CellContext`n$ 3, 
            Part[$CellContext`si$, $CellContext`x$ - 
              1, $CellContext`y$ + $CellContext`n$] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ - 
              1, $CellContext`y$ + $CellContext`n$] == $CellContext`pp], \
$CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ < 8, $CellContext`y$ > 2, 
            Part[$CellContext`si$, $CellContext`x$ + 1, $CellContext`y$ - 
              2] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ + 1, $CellContext`y$ - 
              2] == $CellContext`nn], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ < 8, $CellContext`y$ < 7, 
            Part[$CellContext`si$, $CellContext`x$ + 1, $CellContext`y$ + 
              2] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ + 1, $CellContext`y$ + 
              2] == $CellContext`nn], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ > 1, $CellContext`y$ > 2, 
            Part[$CellContext`si$, $CellContext`x$ - 1, $CellContext`y$ - 
              2] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ - 1, $CellContext`y$ - 
              2] == $CellContext`nn], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ > 1, $CellContext`y$ < 7, 
            Part[$CellContext`si$, $CellContext`x$ - 1, $CellContext`y$ + 
              2] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ - 1, $CellContext`y$ + 
              2] == $CellContext`nn], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ < 7, $CellContext`y$ > 1, 
            Part[$CellContext`si$, $CellContext`x$ + 2, $CellContext`y$ - 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ + 2, $CellContext`y$ - 
              1] == $CellContext`nn], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ < 7, $CellContext`y$ < 8, 
            Part[$CellContext`si$, $CellContext`x$ + 2, $CellContext`y$ + 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ + 2, $CellContext`y$ + 
              1] == $CellContext`nn], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ > 2, $CellContext`y$ > 1, 
            Part[$CellContext`si$, $CellContext`x$ - 2, $CellContext`y$ - 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ - 2, $CellContext`y$ - 
              1] == $CellContext`nn], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ > 2, $CellContext`y$ < 8, 
            Part[$CellContext`si$, $CellContext`x$ - 2, $CellContext`y$ + 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ - 2, $CellContext`y$ + 
              1] == $CellContext`nn], $CellContext`sw$ = True]; 
         For[$CellContext`i$$ = 1, $CellContext`i$$ <= 
           Min[7 - $CellContext`x$, 7 - $CellContext`y$], 
           Increment[$CellContext`i$$], 
           If[
           Part[$CellContext`si$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$ + $CellContext`i$$] != 0, 
            Break[]]]; If[
           
           And[$CellContext`i$$ <= 
            Min[8 - $CellContext`x$, 8 - $CellContext`y$], 
            Part[$CellContext`si$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$ + $CellContext`i$$] == -$CellContext`n$, 
            Or[
            Part[$CellContext`ty$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$ + $CellContext`i$$] == $CellContext`qq, 
             Part[$CellContext`ty$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$ + $CellContext`i$$] == $CellContext`bb]], $CellContext`sw$ = 
           True]; For[$CellContext`i$$ = 1, $CellContext`i$$ <= 
           Min[$CellContext`x$ - 1, 7 - $CellContext`y$], 
           Increment[$CellContext`i$$], 
           If[
           Part[$CellContext`si$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$ + $CellContext`i$$] != 0, 
            Break[]]]; If[
           
           And[$CellContext`i$$ <= 
            Min[$CellContext`x$ - 1, 8 - $CellContext`y$], 
            Part[$CellContext`si$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$ + $CellContext`i$$] == -$CellContext`n$, 
            Or[
            Part[$CellContext`ty$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$ + $CellContext`i$$] == $CellContext`qq, 
             Part[$CellContext`ty$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$ + $CellContext`i$$] == $CellContext`bb]], $CellContext`sw$ = 
           True]; For[$CellContext`i$$ = 1, $CellContext`i$$ <= 
           Min[7 - $CellContext`x$, $CellContext`y$ - 1], 
           Increment[$CellContext`i$$], 
           If[
           Part[$CellContext`si$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$ - $CellContext`i$$] != 0, 
            Break[]]]; If[
           
           And[$CellContext`i$$ <= 
            Min[8 - $CellContext`x$, $CellContext`y$ - 1], 
            Part[$CellContext`si$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$ - $CellContext`i$$] == -$CellContext`n$, 
            Or[
            Part[$CellContext`ty$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$ - $CellContext`i$$] == $CellContext`qq, 
             Part[$CellContext`ty$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$ - $CellContext`i$$] == $CellContext`bb]], $CellContext`sw$ = 
           True]; For[$CellContext`i$$ = 1, $CellContext`i$$ <= 
           Min[$CellContext`x$ - 1, $CellContext`y$ - 1], 
           Increment[$CellContext`i$$], 
           If[
           Part[$CellContext`si$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$ - $CellContext`i$$] != 0, 
            Break[]]]; If[
           
           And[$CellContext`i$$ <= 
            Min[$CellContext`x$ - 1, $CellContext`y$ - 1], 
            Part[$CellContext`si$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$ - $CellContext`i$$] == -$CellContext`n$, 
            Or[
            Part[$CellContext`ty$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$ - $CellContext`i$$] == $CellContext`qq, 
             Part[$CellContext`ty$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$ - $CellContext`i$$] == $CellContext`bb]], $CellContext`sw$ = 
           True]; For[$CellContext`i$$ = 1, $CellContext`i$$ <= 
           7 - $CellContext`x$, 
           Increment[$CellContext`i$$], 
           If[
           Part[$CellContext`si$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$] != 0, 
            Break[]]]; If[
           
           And[$CellContext`i$$ <= 8 - $CellContext`x$, 
            Part[$CellContext`si$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$] == -$CellContext`n$, 
            Or[
            Part[$CellContext`ty$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$] == $CellContext`qq, 
             Part[$CellContext`ty$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$] == $CellContext`rr]], $CellContext`sw$ = True]; 
         For[$CellContext`i$$ = 1, $CellContext`i$$ <= $CellContext`x$ - 1, 
           Increment[$CellContext`i$$], 
           If[
           Part[$CellContext`si$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$] != 0, 
            Break[]]]; If[
           
           And[$CellContext`i$$ <= $CellContext`x$ - 1, 
            Part[$CellContext`si$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$] == -$CellContext`n$, 
            Or[
            Part[$CellContext`ty$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$] == $CellContext`qq, 
             Part[$CellContext`ty$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$] == $CellContext`rr]], $CellContext`sw$ = True]; 
         For[$CellContext`i$$ = 1, $CellContext`i$$ <= 7 - $CellContext`y$, 
           Increment[$CellContext`i$$], 
           If[
           Part[$CellContext`si$, $CellContext`x$, $CellContext`y$ + \
$CellContext`i$$] != 0, 
            Break[]]]; If[
           
           And[$CellContext`i$$ <= 8 - $CellContext`y$, 
            Part[$CellContext`si$, $CellContext`x$, $CellContext`y$ + \
$CellContext`i$$] == -$CellContext`n$, 
            Or[
            Part[$CellContext`ty$, $CellContext`x$, $CellContext`y$ + \
$CellContext`i$$] == $CellContext`qq, 
             Part[$CellContext`ty$, $CellContext`x$, $CellContext`y$ + \
$CellContext`i$$] == $CellContext`rr]], $CellContext`sw$ = True]; 
         For[$CellContext`i$$ = 1, $CellContext`i$$ <= $CellContext`y$ - 1, 
           Increment[$CellContext`i$$], 
           If[
           Part[$CellContext`si$, $CellContext`x$, $CellContext`y$ - \
$CellContext`i$$] != 0, 
            Break[]]]; If[
           
           And[$CellContext`i$$ <= $CellContext`y$ - 1, 
            Part[$CellContext`si$, $CellContext`x$, $CellContext`y$ - \
$CellContext`i$$] == -$CellContext`n$, 
            Or[
            Part[$CellContext`ty$, $CellContext`x$, $CellContext`y$ - \
$CellContext`i$$] == $CellContext`qq, 
             Part[$CellContext`ty$, $CellContext`x$, $CellContext`y$ - \
$CellContext`i$$] == $CellContext`rr]], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ < 8, 
            Part[$CellContext`si$, $CellContext`x$ + 
              1, $CellContext`y$] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ + 
              1, $CellContext`y$] == $CellContext`kk], $CellContext`sw$ = 
           True]; If[
           
           And[$CellContext`x$ > 1, 
            Part[$CellContext`si$, $CellContext`x$ - 
              1, $CellContext`y$] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ - 
              1, $CellContext`y$] == $CellContext`kk], $CellContext`sw$ = 
           True]; If[
           
           And[$CellContext`y$ < 8, 
            Part[$CellContext`si$, $CellContext`x$, $CellContext`y$ + 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$, $CellContext`y$ + 
              1] == $CellContext`kk], $CellContext`sw$ = True]; If[
           
           And[$CellContext`y$ > 1, 
            Part[$CellContext`si$, $CellContext`x$, $CellContext`y$ - 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$, $CellContext`y$ - 
              1] == $CellContext`kk], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ < 8, $CellContext`y$ < 8, 
            Part[$CellContext`si$, $CellContext`x$ + 1, $CellContext`y$ + 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ + 1, $CellContext`y$ + 
              1] == $CellContext`kk], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ > 1, $CellContext`y$ > 1, 
            Part[$CellContext`si$, $CellContext`x$ - 1, $CellContext`y$ - 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ - 1, $CellContext`y$ - 
              1] == $CellContext`kk], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ < 8, $CellContext`y$ > 1, 
            Part[$CellContext`si$, $CellContext`x$ + 1, $CellContext`y$ - 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ + 1, $CellContext`y$ - 
              1] == $CellContext`kk], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ > 1, $CellContext`y$ < 8, 
            Part[$CellContext`si$, $CellContext`x$ - 1, $CellContext`y$ + 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ - 1, $CellContext`y$ + 
              1] == $CellContext`kk], $CellContext`sw$ = 
           True]; $CellContext`sw$], $CellContext`board = {
         RGBColor[0.7, 0.7, 0.5], 
         Polygon[{{0, 0}, {8, 0}, {8, 8}, {0, 8}}], 
         RGBColor[0.94, 0.91, 0.88], 
         Polygon[{{1, 0}, {1, 1}, {2, 1}, {2, 0}}], 
         Polygon[{{3, 0}, {3, 1}, {4, 1}, {4, 0}}], 
         Polygon[{{5, 0}, {5, 1}, {6, 1}, {6, 0}}], 
         Polygon[{{7, 0}, {7, 1}, {8, 1}, {8, 0}}], 
         Polygon[{{0, 1}, {0, 2}, {1, 2}, {1, 1}}], 
         Polygon[{{2, 1}, {2, 2}, {3, 2}, {3, 1}}], 
         Polygon[{{4, 1}, {4, 2}, {5, 2}, {5, 1}}], 
         Polygon[{{6, 1}, {6, 2}, {7, 2}, {7, 1}}], 
         Polygon[{{1, 2}, {1, 3}, {2, 3}, {2, 2}}], 
         Polygon[{{3, 2}, {3, 3}, {4, 3}, {4, 2}}], 
         Polygon[{{5, 2}, {5, 3}, {6, 3}, {6, 2}}], 
         Polygon[{{7, 2}, {7, 3}, {8, 3}, {8, 2}}], 
         Polygon[{{0, 3}, {0, 4}, {1, 4}, {1, 3}}], 
         Polygon[{{2, 3}, {2, 4}, {3, 4}, {3, 3}}], 
         Polygon[{{4, 3}, {4, 4}, {5, 4}, {5, 3}}], 
         Polygon[{{6, 3}, {6, 4}, {7, 4}, {7, 3}}], 
         Polygon[{{1, 4}, {1, 5}, {2, 5}, {2, 4}}], 
         Polygon[{{3, 4}, {3, 5}, {4, 5}, {4, 4}}], 
         Polygon[{{5, 4}, {5, 5}, {6, 5}, {6, 4}}], 
         Polygon[{{7, 4}, {7, 5}, {8, 5}, {8, 4}}], 
         Polygon[{{0, 5}, {0, 6}, {1, 6}, {1, 5}}], 
         Polygon[{{2, 5}, {2, 6}, {3, 6}, {3, 5}}], 
         Polygon[{{4, 5}, {4, 6}, {5, 6}, {5, 5}}], 
         Polygon[{{6, 5}, {6, 6}, {7, 6}, {7, 5}}], 
         Polygon[{{1, 6}, {1, 7}, {2, 7}, {2, 6}}], 
         Polygon[{{3, 6}, {3, 7}, {4, 7}, {4, 6}}], 
         Polygon[{{5, 6}, {5, 7}, {6, 7}, {6, 6}}], 
         Polygon[{{7, 6}, {7, 7}, {8, 7}, {8, 6}}], 
         Polygon[{{0, 7}, {0, 8}, {1, 8}, {1, 7}}], 
         Polygon[{{2, 7}, {2, 8}, {3, 8}, {3, 7}}], 
         Polygon[{{4, 7}, {4, 8}, {5, 8}, {5, 7}}], 
         Polygon[{{6, 7}, {6, 8}, {7, 8}, {7, 7}}], 
         GrayLevel[0.5], {
          Line[{{1, 0}, {1, 8}}], 
          Line[{{2, 0}, {2, 8}}], 
          Line[{{3, 0}, {3, 8}}], 
          Line[{{4, 0}, {4, 8}}], 
          Line[{{5, 0}, {5, 8}}], 
          Line[{{6, 0}, {6, 8}}], 
          Line[{{7, 0}, {7, 8}}]}, {
          Line[{{0, 1}, {8, 1}}], 
          Line[{{0, 2}, {8, 2}}], 
          Line[{{0, 3}, {8, 3}}], 
          Line[{{0, 4}, {8, 4}}], 
          Line[{{0, 5}, {8, 5}}], 
          Line[{{0, 6}, {8, 6}}], 
          Line[{{0, 7}, {8, 7}}]}, 
         GrayLevel[0], 
         Line[{{0, 0}, {0, 8}, {8, 8}, {8, 0}, {0, 0}}], {
          RGBColor[0, 0, 1], 
          Thickness[Large]}, 
         Line[{{-0.1, -0.1}, {-0.1, 8.1}, {8.1, 8.1}, {
          8.1, -0.1}, {-0.1, -0.1}}]}, $CellContext`pawn = 
       Disk[{-0.5, -0.5}, 0.35], $CellContext`rook = 
       Polygon[{{-0.9, -0.9}, {-0.09999999999999998, -0.9}, \
{-0.09999999999999998, -0.7}, {-0.30000000000000004`, -0.5}, \
{-0.09999999999999998, -0.30000000000000004`}, {-0.09999999999999998, \
-0.09999999999999998}, {-0.9, -0.09999999999999998}, {-0.9, \
-0.30000000000000004`}, {-0.7, -0.5}, {-0.9, -0.7}}], $CellContext`knight = 
       Polygon[{{-0.9, -0.9}, {-0.09999999999999998, -0.9}, \
{-0.09999999999999998, -0.6}, {-0.4, -0.6}, {-0.4, -0.4}, \
{-0.09999999999999998, -0.30000000000000004`}, {-0.09999999999999998, \
-0.09999999999999998}, {-0.6, -0.09999999999999998}, {-0.6, -0.6}, {-0.9, \
-0.6}}], $CellContext`bishop = 
       Polygon[{{-0.9, -0.9}, {-0.09999999999999998, -0.9}, {-0.5, \
-0.09999999999999998}}], $CellContext`queen = 
       Polygon[{{-0.9, -0.9}, {-0.09999999999999998, -0.9}, {-0.4, -0.6}, \
{-0.19999999999999996`, -0.30000000000000004`}, {-0.5, -0.09999999999999998}, \
{-0.8, -0.30000000000000004`}, {-0.6, -0.6}}], $CellContext`king = 
       Polygon[{{-0.9, -0.9}, {-0.09999999999999998, -0.9}, \
{-0.09999999999999998, -0.09999999999999998}, {-0.30000000000000004`, \
-0.30000000000000004`}, {-0.5, -0.09999999999999998}, {-0.7, \
-0.30000000000000004`}, {-0.9, -0.09999999999999998}}], $CellContext`names = {
        " ", "R", "N", "B", "Q", "K"}, $CellContext`alpha = {
        "a", "b", "c", "d", "e", "f", "g", "h", 
         "..."}, $CellContext`side0 = {{1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 
        0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
        0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {
        1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
        0, -1, -1}}, $CellContext`type0 = {{2, 1, 0, 0, 0, 0, 1, 2}, {3, 1, 0,
         0, 0, 0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 4}, {5, 1, 0, 0, 0, 0, 1, 5}, {
        6, 1, 0, 0, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0, 1, 4}, {3, 1, 0, 0, 0, 0, 
        1, 3}, {2, 1, 0, 0, 0, 0, 1, 2}}, $CellContext`all0 = {{0, 0, 0, 0, 0,
         0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 
        0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 
        0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}}}; 
     Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.35696210375764*^9, 3.404836196558592*^9, 3.404836269663712*^9, 
   3.404836408873886*^9, 3.4048365510683517`*^9, 3.4048716288690305`*^9, 
   3.4048718933092766`*^9, 3.404872167713851*^9, 3.404872416411461*^9, 
   3.404872924802491*^9, 3.404873037965211*^9, 3.4048732462647314`*^9, 
   3.4048733844634514`*^9, 3.404873552705371*^9, 3.4048737249630656`*^9, 
   3.404874484044571*^9, 3.404874989571483*^9, 3.404875987356227*^9, 
   3.404876670138019*^9, 3.404876953545539*^9, 3.404877042723771*^9, 
   3.4048775867961087`*^9, 3.4048776335132847`*^9, 3.4048777787721567`*^9, 
   3.404878160320797*^9, 3.404878218404317*^9, 3.4048858903446145`*^9, 
   3.404886017387293*^9, 3.404886080958704*^9, 3.404886254127709*^9, 
   3.4048865511948705`*^9, 3.404887475844451*^9, 3.4048875084413233`*^9, 
   3.404887548448851*^9, 3.4048879063334637`*^9, 3.4048880141084366`*^9, 
   3.4048880758972845`*^9, 3.404888341058568*^9, 3.404888486918304*^9, 
   3.4048885760064063`*^9, 3.40488865205576*^9, 3.404888748774835*^9, 
   3.4048890442697363`*^9, 3.4048894689103394`*^9, 3.4048896054166255`*^9, 
   3.4049210101895633`*^9, 3.4049218545536995`*^9, 3.4049230541886897`*^9, 
   3.4049233014342113`*^9, 3.404923440273853*^9, 3.4049235057179565`*^9, 
   3.40492396040176*^9, {3.404923995512246*^9, 3.404924015701277*^9}, 
   3.404924119961195*^9, 3.404924579141464*^9, 3.405034898546605*^9, {
   3.4050349377429667`*^9, 3.4050349652324944`*^9}, 3.4055549600013423`*^9, 
   3.4373282854104404`*^9},
 CellID->60040281]
}, {2}]]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ManipulateCaptionSection"],

Cell["\<\
Basic chess game with optional board editing and history reviewing.\
\>", "ManipulateCaption",
 CellChangeTimes->{
  3.35696210375764*^9, {3.415587804757733*^9, 3.4155878660859184`*^9}, {
   3.415589314939267*^9, 3.4155893908083615`*^9}, {3.4159860091624365`*^9, 
   3.415986035410179*^9}, {3.4159866138018656`*^9, 3.415986682710952*^9}, {
   3.4161627008690357`*^9, 3.4161627075565357`*^9}, {3.416220154425355*^9, 
   3.416220161651127*^9}, {3.4162287488278604`*^9, 3.4162287497966104`*^9}, {
   3.4194497818054094`*^9, 3.419449809104664*^9}, {3.419449839448296*^9, 
   3.4194498522066417`*^9}, {3.4198269832795343`*^9, 3.4198269954770737`*^9}},
 
 CellID->173026597],

Cell["You can only make legal moves.", "ManipulateCaption",
 CellChangeTimes->{
  3.35696210375764*^9, {3.4194498106468816`*^9, 3.401266825248499*^9}, {
   3.4038256070662994`*^9, 3.4038256070662994`*^9}, {3.4359430457806664`*^9, 
   3.4359430471087914`*^9}},
 CellID->147701185]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ThumbnailSection"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`bfrom$$ = {}, $CellContext`bpiece$$ = {}, \
$CellContext`bto$$ = {}, $CellContext`capture$$ = 
    "-", $CellContext`captures$$ = {{"-", "-"}, {
     "-", "-"}}, $CellContext`checks$$ = {{" ", " "}, {
     " ", " "}}, $CellContext`colb$$ = 1, $CellContext`colw$$ = 
    1, $CellContext`eastok$$ = True, $CellContext`edit$$ = 
    "play", $CellContext`epblack$$ = {0, 0}, $CellContext`epwhite$$ = {5, 
    3}, $CellContext`f$$ = 1, $CellContext`from$$ = {0, 0}, $CellContext`h$$ =
     1., $CellContext`i$$ = 1, $CellContext`j$$ = 0, $CellContext`kx$$ = 
    5, $CellContext`ky$$ = 8, $CellContext`list$$ = {{{0, 0}, {0, 0}}, {{1, 
    7}, {1, 6}}, {{1, 7}, {1, 5}}, {{2, 7}, {2, 6}}, {{2, 7}, {2, 5}}, {{2, 
    8}, {1, 6}}, {{2, 8}, {3, 6}}, {{3, 7}, {3, 6}}, {{3, 7}, {3, 5}}, {{4, 
    7}, {4, 6}}, {{4, 7}, {4, 5}}, {{5, 7}, {5, 6}}, {{5, 7}, {5, 5}}, {{6, 
    7}, {6, 6}}, {{6, 7}, {6, 5}}, {{7, 7}, {7, 6}}, {{7, 7}, {7, 5}}, {{7, 
    8}, {6, 6}}, {{7, 8}, {8, 6}}, {{8, 7}, {8, 6}}, {{8, 7}, {8, 
    5}}}, $CellContext`n$$ = -1, $CellContext`northok$$ = 
    True, $CellContext`ok$$ = False, $CellContext`oldfrom$$ = {5, 
    2}, $CellContext`part1$$ = False, $CellContext`part2$$ = 
    False, $CellContext`pos$$ = {5, 4}, $CellContext`prom$$ = 
    "queen", $CellContext`r$$ = 1, $CellContext`randomblack$$ = 
    False, $CellContext`randomwhite$$ = False, $CellContext`showmoves$$ = 
    False, $CellContext`showtargets$$ = True, $CellContext`side$$ = {{1, 1, 0,
     0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
    0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 0, 0, 1, 0, 0, -1, -1}, {1, 1,
     0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
    0, -1, -1}}, $CellContext`sides$$ = {{{1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 
    0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
    0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1,
     0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
    0, -1, -1}}}, $CellContext`southok$$ = True, $CellContext`swattacked$$ = 
    False, $CellContext`to$$ = {0, 0}, $CellContext`type$$ = {{2, 1, 0, 0, 0, 
    0, 1, 2}, {3, 1, 0, 0, 0, 0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 4}, {5, 1, 0, 0,
     0, 0, 1, 5}, {6, 0, 0, 1, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0, 1, 4}, {3, 1, 
    0, 0, 0, 0, 1, 3}, {2, 1, 0, 0, 0, 0, 1, 2}}, $CellContext`types$$ = {{{2,
     1, 0, 0, 0, 0, 1, 2}, {3, 1, 0, 0, 0, 0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 
    4}, {5, 1, 0, 0, 0, 0, 1, 5}, {6, 1, 0, 0, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0,
     1, 4}, {3, 1, 0, 0, 0, 0, 1, 3}, {2, 1, 0, 0, 0, 0, 1, 
    2}}}, $CellContext`unmoveda1$$ = True, $CellContext`unmoveda8$$ = 
    True, $CellContext`unmovedh1$$ = True, $CellContext`unmovedh8$$ = 
    True, $CellContext`westok$$ = True, $CellContext`wfrom$$ = {{5, 
    2}}, $CellContext`wpiece$$ = {1}, $CellContext`wto$$ = {{5, 
    4}}, $CellContext`x$$ = 5, $CellContext`y$$ = 2, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`colw$$], 1, 
       Style["color White", 10]}, {1, 2, 3}}, {{
       Hold[$CellContext`colb$$], 1, 
       Style["color Black", 10]}, {1, 2, 3}}, {{
       Hold[$CellContext`randomwhite$$], False, "random White"}, {
      True, False}}, {{
       Hold[$CellContext`randomblack$$], False, "random Black"}, {
      True, False}}, {{
       Hold[$CellContext`showmoves$$], False, "show moves"}, {
      True, False}}, {{
       Hold[$CellContext`showtargets$$], True, "show targets"}, {
      True, False}}, {{
       Hold[$CellContext`prom$$], "queen", 
       Style["promotion to", 10]}, {"queen", "rook", "bishop", "knight"}}, {{
       Hold[$CellContext`edit$$], "play", 
       Style["edit position", 10]}, {
      "play", "reset", "clear", "delete", "white pawn", "white knight", 
       "white bishop", "white rook", "white queen", "white king", 
       "black pawn", "black knight", "black bishop", "black rook", 
       "black queen", "black king", "castling options", "next player"}}, {{
       Hold[$CellContext`h$$], 1, 
       Style["history"]}, 0, 1}, {{
       Hold[$CellContext`i$$], 0}}, {{
       Hold[$CellContext`j$$], 0}}, {{
       Hold[$CellContext`kx$$], 0}}, {{
       Hold[$CellContext`ky$$], 0}}, {{
       Hold[$CellContext`pos$$], {0, 0}}}, {{
       Hold[$CellContext`from$$], {0, 0}}}, {{
       Hold[$CellContext`oldfrom$$], {0, 0}}}, {{
       Hold[$CellContext`to$$], {0, 0}}}, {{
       Hold[$CellContext`side$$], {{1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0,
        0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {
       1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
       0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}}}}, {{
       Hold[$CellContext`type$$], {{2, 1, 0, 0, 0, 0, 1, 2}, {3, 1, 0, 0, 0, 
       0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 4}, {5, 1, 0, 0, 0, 0, 1, 5}, {6, 1, 0,
        0, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0, 1, 4}, {3, 1, 0, 0, 0, 0, 1, 3}, {
       2, 1, 0, 0, 0, 0, 1, 2}}}}, {{
       Hold[$CellContext`n$$], 1}}, {{
       Hold[$CellContext`list$$], {{{0, 0}, {0, 0}}}}}, {{
       Hold[$CellContext`sides$$], {{{1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 
       0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
       0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1,
        1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}}}}}, {{
       Hold[$CellContext`types$$], {{{2, 1, 0, 0, 0, 0, 1, 2}, {3, 1, 0, 0, 0,
        0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 4}, {5, 1, 0, 0, 0, 0, 1, 5}, {6, 1, 
       0, 0, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0, 1, 4}, {3, 1, 0, 0, 0, 0, 1, 
       3}, {2, 1, 0, 0, 0, 0, 1, 2}}}}}, {{
       Hold[$CellContext`wfrom$$], {}}}, {{
       Hold[$CellContext`wto$$], {}}}, {{
       Hold[$CellContext`wpiece$$], {}}}, {{
       Hold[$CellContext`bfrom$$], {}}}, {{
       Hold[$CellContext`bto$$], {}}}, {{
       Hold[$CellContext`bpiece$$], {}}}, {{
       Hold[$CellContext`unmoveda1$$], True}}, {{
       Hold[$CellContext`unmoveda8$$], True}}, {{
       Hold[$CellContext`unmovedh1$$], True}}, {{
       Hold[$CellContext`unmovedh8$$], True}}, {{
       Hold[$CellContext`epwhite$$], {0, 0}}}, {{
       Hold[$CellContext`epblack$$], {0, 0}}}, {{
       Hold[$CellContext`r$$], 0}}, {{
       Hold[$CellContext`f$$], 0}}, {{
       Hold[$CellContext`capture$$], "-"}}, {{
       Hold[$CellContext`captures$$], {{"-", "-"}}}}, {{
       Hold[$CellContext`checks$$], {{" ", " "}}}}, {{
       Hold[$CellContext`part1$$], False}}, {{
       Hold[$CellContext`part2$$], False}}, {{
       Hold[$CellContext`ok$$], False}}, {{
       Hold[$CellContext`eastok$$], False}}, {{
       Hold[$CellContext`westok$$], False}}, {{
       Hold[$CellContext`southok$$], False}}, {{
       Hold[$CellContext`northok$$], False}}, {{
       Hold[$CellContext`x$$], 0}}, {{
       Hold[$CellContext`y$$], 0}}, {{
       Hold[$CellContext`swattacked$$], False}}}, Typeset`size$$ = {
    400., {198., 202.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = False, $CellContext`colw$396$$ = 
    0, $CellContext`colb$397$$ = 0, $CellContext`randomwhite$398$$ = 
    False, $CellContext`randomblack$399$$ = 
    False, $CellContext`showmoves$400$$ = 
    False, $CellContext`showtargets$401$$ = False, $CellContext`prom$402$$ = 
    0, $CellContext`edit$403$$ = 0, $CellContext`h$404$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`bfrom$$ = {}, $CellContext`bpiece$$ = {}, \
$CellContext`bto$$ = {}, $CellContext`capture$$ = 
        "-", $CellContext`captures$$ = {{
          "-", "-"}}, $CellContext`checks$$ = {{
          " ", " "}}, $CellContext`colb$$ = 1, $CellContext`colw$$ = 
        1, $CellContext`eastok$$ = False, $CellContext`edit$$ = 
        "play", $CellContext`epblack$$ = {0, 0}, $CellContext`epwhite$$ = {0, 
         0}, $CellContext`f$$ = 
        0, $CellContext`from$$ = {0, 0}, $CellContext`h$$ = 
        1, $CellContext`i$$ = 0, $CellContext`j$$ = 0, $CellContext`kx$$ = 
        0, $CellContext`ky$$ = 
        0, $CellContext`list$$ = {{{0, 0}, {0, 0}}}, $CellContext`n$$ = 
        1, $CellContext`northok$$ = False, $CellContext`ok$$ = 
        False, $CellContext`oldfrom$$ = {0, 0}, $CellContext`part1$$ = 
        False, $CellContext`part2$$ = 
        False, $CellContext`pos$$ = {0, 0}, $CellContext`prom$$ = 
        "queen", $CellContext`r$$ = 0, $CellContext`randomblack$$ = 
        False, $CellContext`randomwhite$$ = False, $CellContext`showmoves$$ = 
        False, $CellContext`showtargets$$ = 
        True, $CellContext`side$$ = {{1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 
         0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
         0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {
         1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
         0, -1, -1}}, $CellContext`sides$$ = {{{1, 1, 0, 0, 0, 0, -1, -1}, {1,
          1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
         0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {
         1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
         0, -1, -1}}}, $CellContext`southok$$ = 
        False, $CellContext`swattacked$$ = 
        False, $CellContext`to$$ = {0, 0}, $CellContext`type$$ = {{2, 1, 0, 0,
          0, 0, 1, 2}, {3, 1, 0, 0, 0, 0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 4}, {5,
          1, 0, 0, 0, 0, 1, 5}, {6, 1, 0, 0, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0, 
         1, 4}, {3, 1, 0, 0, 0, 0, 1, 3}, {2, 1, 0, 0, 0, 0, 1, 
         2}}, $CellContext`types$$ = {{{2, 1, 0, 0, 0, 0, 1, 2}, {3, 1, 0, 0, 
         0, 0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 4}, {5, 1, 0, 0, 0, 0, 1, 5}, {6, 
         1, 0, 0, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0, 1, 4}, {3, 1, 0, 0, 0, 0, 1,
          3}, {2, 1, 0, 0, 0, 0, 1, 2}}}, $CellContext`unmoveda1$$ = 
        True, $CellContext`unmoveda8$$ = True, $CellContext`unmovedh1$$ = 
        True, $CellContext`unmovedh8$$ = True, $CellContext`westok$$ = 
        False, $CellContext`wfrom$$ = {}, $CellContext`wpiece$$ = {}, \
$CellContext`wto$$ = {}, $CellContext`x$$ = 0, $CellContext`y$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`colw$$, $CellContext`colw$396$$, 0], 
        Hold[$CellContext`colb$$, $CellContext`colb$397$$, 0], 
        Hold[$CellContext`randomwhite$$, $CellContext`randomwhite$398$$, 
         False], 
        Hold[$CellContext`randomblack$$, $CellContext`randomblack$399$$, 
         False], 
        Hold[$CellContext`showmoves$$, $CellContext`showmoves$400$$, False], 
        Hold[$CellContext`showtargets$$, $CellContext`showtargets$401$$, 
         False], 
        Hold[$CellContext`prom$$, $CellContext`prom$402$$, 0], 
        Hold[$CellContext`edit$$, $CellContext`edit$403$$, 0], 
        Hold[$CellContext`h$$, $CellContext`h$404$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`f$$ = Floor[$CellContext`h$$ $CellContext`r$$]; 
       If[
         And[$CellContext`list$$ == $CellContext`list0, $CellContext`from$$ == \
{0, 0}, $CellContext`to$$ == {0, 0}], 
         Do[$CellContext`t = 
            Part[$CellContext`type$$, $CellContext`x$$, $CellContext`y$$]; \
$CellContext`s = 
            Part[$CellContext`side$$, $CellContext`x$$, $CellContext`y$$]; 
           If[
             
             And[$CellContext`t == $CellContext`pp, $CellContext`s == 
              1, $CellContext`n$$ == 1], 
             If[Part[$CellContext`side$$, $CellContext`x$$, $CellContext`y$$ + 
                 1] == 0, $CellContext`list$$ = 
                AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$, $CellContext`y$$ + 1}}]; If[
                 And[$CellContext`y$$ == 2, 
                  Part[$CellContext`side$$, $CellContext`x$$, 4] == 
                  0], $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, 
                    2}, {$CellContext`x$$, 4}}]]]; 
             If[{$CellContext`x$$ + 1, $CellContext`y$$ + 
                 1} == $CellContext`epblack$$, $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$ + 1}}]]; 
             If[{$CellContext`x$$ - 1, $CellContext`y$$ + 
                 1} == $CellContext`epblack$$, $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$ + 1}}]]; If[
               
               And[$CellContext`x$$ < 8, $CellContext`y$$ < 8, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  1, $CellContext`y$$ + 
                  1] == -$CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$ + 1}}]]; If[
               
               And[$CellContext`x$$ > 1, $CellContext`y$$ < 8, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  1, $CellContext`y$$ + 
                  1] == -$CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$ + 1}}]]]; If[
             
             And[$CellContext`t == $CellContext`pp, $CellContext`s == -1, \
$CellContext`n$$ == -1], 
             If[Part[$CellContext`side$$, $CellContext`x$$, $CellContext`y$$ - 
                 1] == 0, $CellContext`list$$ = 
                AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$, $CellContext`y$$ - 1}}]; If[
                 
                 And[$CellContext`y$$ == 7, 
                  Part[$CellContext`side$$, $CellContext`x$$, 5] == 
                  0], $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, 
                    7}, {$CellContext`x$$, 5}}]]]; 
             If[{$CellContext`x$$ + 1, $CellContext`y$$ - 
                 1} == $CellContext`epwhite$$, $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$ - 1}}]]; 
             If[{$CellContext`x$$ - 1, $CellContext`y$$ - 
                 1} == $CellContext`epwhite$$, $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$ - 1}}]]; If[
               
               And[$CellContext`x$$ < 8, $CellContext`y$$ > 1, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  1, $CellContext`y$$ - 
                  1] == -$CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$ - 1}}]]; If[
               
               And[$CellContext`x$$ > 1, $CellContext`y$$ > 1, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  1, $CellContext`y$$ - 
                  1] == -$CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$ - 1}}]]]; If[
             
             And[$CellContext`t == $CellContext`nn, $CellContext`s == \
$CellContext`n$$], If[
               
               And[$CellContext`x$$ > 1, $CellContext`y$$ > 2, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  1, $CellContext`y$$ - 
                  2] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$ - 2}}]]; If[
               
               And[$CellContext`x$$ > 1, $CellContext`y$$ < 7, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  1, $CellContext`y$$ + 
                  2] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$ + 2}}]]; If[
               
               And[$CellContext`x$$ > 2, $CellContext`y$$ > 1, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  2, $CellContext`y$$ - 
                  1] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 2, $CellContext`y$$ - 1}}]]; If[
               And[$CellContext`x$$ > 2, $CellContext`y$$ < 8, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  2, $CellContext`y$$ + 
                  1] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 2, $CellContext`y$$ + 1}}]]; If[
               
               And[$CellContext`x$$ < 8, $CellContext`y$$ < 7, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  1, $CellContext`y$$ + 
                  2] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$ + 2}}]]; If[
               
               And[$CellContext`x$$ < 8, $CellContext`y$$ > 2, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  1, $CellContext`y$$ - 
                  2] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$ - 2}}]]; If[
               
               And[$CellContext`x$$ < 7, $CellContext`y$$ > 1, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  2, $CellContext`y$$ - 
                  1] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 2, $CellContext`y$$ - 1}}]]; If[
               
               And[$CellContext`x$$ < 7, $CellContext`y$$ < 8, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  2, $CellContext`y$$ + 
                  1] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 2, $CellContext`y$$ + 1}}]]]; If[
             And[
              
              Or[$CellContext`t == $CellContext`bb, $CellContext`t == \
$CellContext`qq], $CellContext`s == $CellContext`n$$], 
             For[$CellContext`i$$ = 1, 
               
               And[$CellContext`x$$ + $CellContext`i$$ < 
                9, $CellContext`y$$ + $CellContext`i$$ < 9], 
               Increment[$CellContext`i$$], 
               If[Part[$CellContext`side$$, $CellContext`x$$ + \
$CellContext`i$$, $CellContext`y$$ + $CellContext`i$$] != $CellContext`n$$, \
$CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + $CellContext`i$$, $CellContext`y$$ + \
$CellContext`i$$}}]]; 
               If[Part[$CellContext`side$$, $CellContext`x$$ + \
$CellContext`i$$, $CellContext`y$$ + $CellContext`i$$] != 0, 
                 Break[]]]; For[$CellContext`i$$ = 1, 
               
               And[$CellContext`x$$ + $CellContext`i$$ < 
                9, $CellContext`y$$ - $CellContext`i$$ > 0], 
               Increment[$CellContext`i$$], 
               If[Part[$CellContext`side$$, $CellContext`x$$ + \
$CellContext`i$$, $CellContext`y$$ - $CellContext`i$$] != $CellContext`n$$, \
$CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + $CellContext`i$$, $CellContext`y$$ - \
$CellContext`i$$}}]]; 
               If[Part[$CellContext`side$$, $CellContext`x$$ + \
$CellContext`i$$, $CellContext`y$$ - $CellContext`i$$] != 0, 
                 Break[]]]; For[$CellContext`i$$ = 1, 
               
               And[$CellContext`x$$ - $CellContext`i$$ > 
                0, $CellContext`y$$ + $CellContext`i$$ < 9], 
               Increment[$CellContext`i$$], 
               If[Part[$CellContext`side$$, $CellContext`x$$ - \
$CellContext`i$$, $CellContext`y$$ + $CellContext`i$$] != $CellContext`n$$, \
$CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - $CellContext`i$$, $CellContext`y$$ + \
$CellContext`i$$}}]]; 
               If[Part[$CellContext`side$$, $CellContext`x$$ - \
$CellContext`i$$, $CellContext`y$$ + $CellContext`i$$] != 0, 
                 Break[]]]; For[$CellContext`i$$ = 1, 
               
               And[$CellContext`x$$ - $CellContext`i$$ > 
                0, $CellContext`y$$ - $CellContext`i$$ > 0], 
               Increment[$CellContext`i$$], 
               If[Part[$CellContext`side$$, $CellContext`x$$ - \
$CellContext`i$$, $CellContext`y$$ - $CellContext`i$$] != $CellContext`n$$, \
$CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - $CellContext`i$$, $CellContext`y$$ - \
$CellContext`i$$}}]]; 
               If[Part[$CellContext`side$$, $CellContext`x$$ - \
$CellContext`i$$, $CellContext`y$$ - $CellContext`i$$] != 0, 
                 Break[]]]]; If[
             And[
              
              Or[$CellContext`t == $CellContext`rr, $CellContext`t == \
$CellContext`qq], $CellContext`s == $CellContext`n$$], 
             For[$CellContext`i$$ = $CellContext`x$$ + 1, $CellContext`i$$ < 
               9, 
               Increment[$CellContext`i$$], 
               If[Part[$CellContext`side$$, $CellContext`i$$, \
$CellContext`y$$] != $CellContext`n$$, $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`i$$, $CellContext`y$$}}]]; 
               If[Part[$CellContext`side$$, $CellContext`i$$, \
$CellContext`y$$] != 0, 
                 Break[]]]; 
             For[$CellContext`i$$ = $CellContext`x$$ - 1, $CellContext`i$$ > 
               0, 
               Decrement[$CellContext`i$$], 
               If[Part[$CellContext`side$$, $CellContext`i$$, \
$CellContext`y$$] != $CellContext`n$$, $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`i$$, $CellContext`y$$}}]]; 
               If[Part[$CellContext`side$$, $CellContext`i$$, \
$CellContext`y$$] != 0, 
                 Break[]]]; 
             For[$CellContext`i$$ = $CellContext`y$$ + 1, $CellContext`i$$ < 
               9, 
               Increment[$CellContext`i$$], 
               If[Part[$CellContext`side$$, $CellContext`x$$, \
$CellContext`i$$] != $CellContext`n$$, $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$, $CellContext`i$$}}]]; 
               If[Part[$CellContext`side$$, $CellContext`x$$, \
$CellContext`i$$] != 0, 
                 Break[]]]; 
             For[$CellContext`i$$ = $CellContext`y$$ - 1, $CellContext`i$$ > 
               0, 
               Decrement[$CellContext`i$$], 
               If[
                Part[$CellContext`side$$, $CellContext`x$$, $CellContext`i$$] != \
$CellContext`n$$, $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$, $CellContext`i$$}}]]; 
               If[Part[$CellContext`side$$, $CellContext`x$$, \
$CellContext`i$$] != 0, 
                 Break[]]]]; If[
             
             And[$CellContext`t == $CellContext`kk, $CellContext`s == \
$CellContext`n$$], $CellContext`kx$$ = $CellContext`x$$; $CellContext`ky$$ = \
$CellContext`y$$; 
             Part[$CellContext`side$$, $CellContext`x$$, $CellContext`y$$] = 
              0; Part[$CellContext`type$$, $CellContext`x$$, \
$CellContext`y$$] = 0; 
             If[$CellContext`x$$ < 
               8, $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, $CellContext`x$$ + 
                  1, $CellContext`y$$, $CellContext`n$$]; If[
                 Not[$CellContext`swattacked$$], $CellContext`eastok$$ = 
                 True, $CellContext`eastok$$ = False]]; 
             If[$CellContext`x$$ > 
               1, $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, $CellContext`x$$ - 
                  1, $CellContext`y$$, $CellContext`n$$]; If[
                 Not[$CellContext`swattacked$$], $CellContext`westok$$ = 
                 True, $CellContext`westok$$ = False]]; 
             If[$CellContext`y$$ < 
               8, $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, \
$CellContext`x$$, $CellContext`y$$ + 1, $CellContext`n$$]; If[
                 Not[$CellContext`swattacked$$], $CellContext`northok$$ = 
                 True, $CellContext`northok$$ = False]]; 
             If[$CellContext`y$$ > 
               1, $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, \
$CellContext`x$$, $CellContext`y$$ - 1, $CellContext`n$$]; If[
                 Not[$CellContext`swattacked$$], $CellContext`southok$$ = 
                 True, $CellContext`southok$$ = False]]; If[
               
               And[$CellContext`x$$ > 1, $CellContext`westok$$ == True, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  1, $CellContext`y$$] != $CellContext`n$$], \
$CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$}}]]; If[
               
               And[$CellContext`x$$ < 8, $CellContext`eastok$$ == True, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  1, $CellContext`y$$] != $CellContext`n$$], \
$CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$}}]]; If[
               
               And[$CellContext`y$$ > 1, $CellContext`southok$$ == True, 
                Part[$CellContext`side$$, $CellContext`x$$, $CellContext`y$$ - 
                  1] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$, $CellContext`y$$ - 1}}]]; If[
               
               And[$CellContext`y$$ < 8, $CellContext`northok$$ == True, 
                Part[$CellContext`side$$, $CellContext`x$$, $CellContext`y$$ + 
                  1] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$, $CellContext`y$$ + 1}}]]; If[
               
               And[$CellContext`x$$ > 1, $CellContext`y$$ > 1, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  1, $CellContext`y$$ - 
                  1] != $CellContext`n$$], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, $CellContext`x$$ - 
                  1, $CellContext`y$$ - 1, $CellContext`n$$]; If[
                 Not[$CellContext`swattacked$$], $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$ - 1}}]]]; If[
               
               And[$CellContext`x$$ > 1, $CellContext`y$$ < 8, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  1, $CellContext`y$$ + 
                  1] != $CellContext`n$$], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, $CellContext`x$$ - 
                  1, $CellContext`y$$ + 1, $CellContext`n$$]; If[
                 Not[$CellContext`swattacked$$], $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$ + 1}}]]]; If[
               
               And[$CellContext`x$$ < 8, $CellContext`y$$ > 1, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  1, $CellContext`y$$ - 
                  1] != $CellContext`n$$], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, $CellContext`x$$ + 
                  1, $CellContext`y$$ - 1, $CellContext`n$$]; If[
                 Not[$CellContext`swattacked$$], $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$ - 1}}]]]; If[
               
               And[$CellContext`x$$ < 8, $CellContext`y$$ < 8, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  1, $CellContext`y$$ + 
                  1] != $CellContext`n$$], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, $CellContext`x$$ + 
                  1, $CellContext`y$$ + 1, $CellContext`n$$]; If[
                 Not[$CellContext`swattacked$$], $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$ + 
                    1}}]]]; $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, \
$CellContext`x$$, $CellContext`y$$, $CellContext`n$$]; If[
               Not[$CellContext`swattacked$$], If[
                 
                 And[{$CellContext`x$$, $CellContext`y$$} == {5, 
                   1}, $CellContext`westok$$ == 
                  True, $CellContext`unmoveda1$$ == True, 
                  Part[$CellContext`side$$, 1, 1] == $CellContext`n$$, 
                  Part[$CellContext`side$$, 4, 1] == 0, 
                  Part[$CellContext`side$$, 3, 1] == 0, 
                  Part[$CellContext`side$$, 2, 1] == 
                  0], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, 3, 
                    1, $CellContext`n$$]; If[
                   Not[$CellContext`swattacked$$], $CellContext`list$$ = 
                   AppendTo[$CellContext`list$$, {{5, 1}, {3, 1}}]]]; If[
                 
                 And[{$CellContext`x$$, $CellContext`y$$} == {5, 
                   1}, $CellContext`eastok$$ == 
                  True, $CellContext`unmovedh1$$ == True, 
                  Part[$CellContext`side$$, 8, 1] == $CellContext`n$$, 
                  Part[$CellContext`side$$, 6, 1] == 0, 
                  Part[$CellContext`side$$, 7, 1] == 
                  0], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, 7, 
                    1, $CellContext`n$$]; If[
                   Not[$CellContext`swattacked$$], $CellContext`list$$ = 
                   AppendTo[$CellContext`list$$, {{5, 1}, {7, 1}}]]]; If[
                 
                 And[{$CellContext`x$$, $CellContext`y$$} == {5, 
                   8}, $CellContext`westok$$ == 
                  True, $CellContext`unmoveda8$$ == True, 
                  Part[$CellContext`side$$, 1, 8] == $CellContext`n$$, 
                  Part[$CellContext`side$$, 4, 8] == 0, 
                  Part[$CellContext`side$$, 3, 8] == 0, 
                  Part[$CellContext`side$$, 2, 8] == 
                  0], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, 3, 
                    8, $CellContext`n$$]; If[
                   Not[$CellContext`swattacked$$], $CellContext`list$$ = 
                   AppendTo[$CellContext`list$$, {{5, 8}, {3, 8}}]]]; If[
                 
                 And[{$CellContext`x$$, $CellContext`y$$} == {5, 
                   8}, $CellContext`eastok$$ == 
                  True, $CellContext`unmovedh8$$ == True, 
                  Part[$CellContext`side$$, 8, 8] == $CellContext`n$$, 
                  Part[$CellContext`side$$, 6, 8] == 0, 
                  Part[$CellContext`side$$, 7, 8] == 
                  0], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, 7, 
                    8, $CellContext`n$$]; If[
                   Not[$CellContext`swattacked$$], $CellContext`list$$ = 
                   AppendTo[$CellContext`list$$, {{5, 8}, {7, 8}}]]]]; 
             Part[$CellContext`side$$, $CellContext`x$$, $CellContext`y$$] = \
$CellContext`n$$; 
             Part[$CellContext`type$$, $CellContext`x$$, $CellContext`y$$] = \
$CellContext`kk], {$CellContext`x$$, 8}, {$CellContext`y$$, 
            8}]; $CellContext`l = Length[$CellContext`list$$]; 
         Do[$CellContext`a = 
            Part[$CellContext`list$$, $CellContext`j$$, 1]; $CellContext`b = 
            Part[$CellContext`list$$, $CellContext`j$$, 2]; $CellContext`ax = 
            Part[$CellContext`a, 1]; $CellContext`ay = 
            Part[$CellContext`a, 2]; $CellContext`bx = 
            Part[$CellContext`b, 1]; $CellContext`by = 
            Part[$CellContext`b, 2]; $CellContext`t = 
            Part[$CellContext`type$$, $CellContext`ax, $CellContext`ay]; 
           If[$CellContext`t != $CellContext`kk, 
             Part[$CellContext`side$$, $CellContext`ax, $CellContext`ay] = (
               Part[$CellContext`type$$, $CellContext`ax, $CellContext`ay] = 
               0); $CellContext`olds = 
              Part[$CellContext`side$$, $CellContext`bx, $CellContext`by]; \
$CellContext`oldt = 
              Part[$CellContext`type$$, $CellContext`bx, $CellContext`by]; 
             Part[$CellContext`side$$, $CellContext`bx, $CellContext`by] = \
$CellContext`n$$; 
             Part[$CellContext`type$$, $CellContext`bx, $CellContext`by] = \
$CellContext`t; $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, \
$CellContext`kx$$, $CellContext`ky$$, $CellContext`n$$]; 
             Part[$CellContext`side$$, $CellContext`ax, $CellContext`ay] = \
$CellContext`n$$; 
             Part[$CellContext`type$$, $CellContext`ax, $CellContext`ay] = \
$CellContext`t; 
             Part[$CellContext`side$$, $CellContext`bx, $CellContext`by] = \
$CellContext`olds; 
             Part[$CellContext`type$$, $CellContext`bx, $CellContext`by] = \
$CellContext`oldt; 
             If[$CellContext`swattacked$$, 
               Part[$CellContext`list$$, $CellContext`j$$] = {{0, 0}, {0, 
                0}}]], {$CellContext`j$$, 
            2, $CellContext`l}]; $CellContext`list1 = $CellContext`list0; Do[
           If[
           Part[$CellContext`list$$, $CellContext`j$$] != {{0, 0}, {0, 
             0}}, $CellContext`list1 = AppendTo[$CellContext`list1, 
              
              Part[$CellContext`list$$, $CellContext`j$$]]], \
{$CellContext`j$$, 
            2, $CellContext`l}]; $CellContext`list$$ = $CellContext`list1]; \
$CellContext`l = Length[$CellContext`list$$]; ClickPane[
         Graphics[{$CellContext`board, 
           EdgeForm[Thin], 
           If[$CellContext`f$$ == $CellContext`r$$, 
            Table[{
              If[
              Part[$CellContext`side$$, $CellContext`i$$, $CellContext`j$$] == 
               1, 
               Which[$CellContext`colw$$ == 1, 
                RGBColor[0.9, 0.9, 0.5], $CellContext`colw$$ == 2, 
                RGBColor[0.7, 0.7, 0.4], $CellContext`colw$$ == 3, 
                RGBColor[0.9, 0.3, 0.3]], 
               Which[$CellContext`colb$$ == 1, 
                RGBColor[0.4, 0.4, 0.3], $CellContext`colb$$ == 2, 
                RGBColor[0.3, 0.4, 0.1], $CellContext`colb$$ == 3, 
                RGBColor[0.2, 0.5, 0.5]]], 
              Which[
              Part[$CellContext`type$$, $CellContext`i$$, $CellContext`j$$] == \
$CellContext`pp, 
               
               Translate[$CellContext`pawn, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`type$$, $CellContext`i$$, $CellContext`j$$] == \
$CellContext`rr, 
               
               Translate[$CellContext`rook, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`type$$, $CellContext`i$$, $CellContext`j$$] == \
$CellContext`nn, 
               
               Translate[$CellContext`knight, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`type$$, $CellContext`i$$, $CellContext`j$$] == \
$CellContext`bb, 
               
               Translate[$CellContext`bishop, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`type$$, $CellContext`i$$, $CellContext`j$$] == \
$CellContext`qq, 
               
               Translate[$CellContext`queen, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`type$$, $CellContext`i$$, $CellContext`j$$] == \
$CellContext`kk, 
               
               Translate[$CellContext`king, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`type$$, $CellContext`i$$, $CellContext`j$$] == 
               0, {}]}, {$CellContext`i$$, 8}, {$CellContext`j$$, 8}], {}], 
           If[$CellContext`f$$ < $CellContext`r$$, 
            Table[{
              If[
              Part[$CellContext`sides$$, $CellContext`f$$ + 
                 1, $CellContext`i$$, $CellContext`j$$] == 1, 
               Which[$CellContext`colw$$ == 1, 
                RGBColor[0.9, 0.9, 0.5], $CellContext`colw$$ == 2, 
                RGBColor[0.7, 0.7, 0.4], $CellContext`colw$$ == 3, 
                RGBColor[0.9, 0.3, 0.3]], 
               Which[$CellContext`colb$$ == 1, 
                RGBColor[0.4, 0.4, 0.3], $CellContext`colb$$ == 2, 
                RGBColor[0.3, 0.4, 0.1], $CellContext`colb$$ == 3, 
                RGBColor[0.2, 0.5, 0.5]]], 
              Which[
              Part[$CellContext`types$$, $CellContext`f$$ + 
                 1, $CellContext`i$$, $CellContext`j$$] == $CellContext`pp, 
               
               Translate[$CellContext`pawn, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`types$$, $CellContext`f$$ + 
                 1, $CellContext`i$$, $CellContext`j$$] == $CellContext`rr, 
               
               Translate[$CellContext`rook, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`types$$, $CellContext`f$$ + 
                 1, $CellContext`i$$, $CellContext`j$$] == $CellContext`nn, 
               
               Translate[$CellContext`knight, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`types$$, $CellContext`f$$ + 
                 1, $CellContext`i$$, $CellContext`j$$] == $CellContext`bb, 
               
               Translate[$CellContext`bishop, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`types$$, $CellContext`f$$ + 
                 1, $CellContext`i$$, $CellContext`j$$] == $CellContext`qq, 
               
               Translate[$CellContext`queen, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`types$$, $CellContext`f$$ + 
                 1, $CellContext`i$$, $CellContext`j$$] == $CellContext`kk, 
               
               Translate[$CellContext`king, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`types$$, $CellContext`f$$ + 
                 1, $CellContext`i$$, $CellContext`j$$] == 
               0, {}]}, {$CellContext`i$$, 8}, {$CellContext`j$$, 8}], {}], 
           Green, 
           If[
            
            And[$CellContext`showtargets$$, $CellContext`h$$ == 
             1, $CellContext`from$$ != {0, 0}, $CellContext`to$$ == {0, 0}], 
            Table[
             If[
             Part[$CellContext`list$$, $CellContext`i$$, 
                1] == $CellContext`oldfrom$$, 
              
              Disk[{Part[$CellContext`list$$, $CellContext`i$$, 2, 1] - 0.5, 
                Part[$CellContext`list$$, $CellContext`i$$, 2, 2] - 0.5}, 
               0.2], {}], {$CellContext`i$$, $CellContext`l}], {}], 
           If[
            
            And[$CellContext`showmoves$$, $CellContext`h$$ == 
             1, $CellContext`from$$ == {0, 0}], 
            Table[
             
             Arrow[{Part[$CellContext`list$$, $CellContext`i$$, 1] - {0.5, 
               0.5}, Part[$CellContext`list$$, $CellContext`i$$, 2] - {0.5, 
               0.5}}], {$CellContext`i$$, 2, $CellContext`l}], {}], 
           If[$CellContext`unmoveda1$$, Green, Red], 
           If[$CellContext`edit$$ == "castling options", 
            Disk[{0.5, 0.5}, 0.2], {}], 
           If[$CellContext`unmovedh1$$, Green, Red], 
           If[$CellContext`edit$$ == "castling options", 
            Disk[{7.5, 0.5}, 0.2], {}], 
           If[$CellContext`unmoveda8$$, Green, Red], 
           If[$CellContext`edit$$ == "castling options", 
            Disk[{0.5, 7.5}, 0.2], {}], 
           If[$CellContext`unmovedh8$$, Green, Red], 
           If[$CellContext`edit$$ == "castling options", 
            Disk[{7.5, 7.5}, 0.2], {}], Yellow, 
           If[$CellContext`from$$ != {0, 0}, 
            Disk[$CellContext`from$$ - {0.5, 0.5}, 0.2], {}], Black, 
           If[$CellContext`n$$ == 1, 
            Disk[{0, 0}, 0.1], 
            Disk[{0, 8}, 0.1]], 
           If[$CellContext`f$$ > 0, 
            If[Part[$CellContext`wfrom$$, $CellContext`f$$] != {0, 0}, 
             Text[
              Style[
               Row[{$CellContext`f$$, ". ", 
                 Part[$CellContext`names, 
                  Part[$CellContext`wpiece$$, $CellContext`f$$]], 
                 Part[$CellContext`alpha, 
                  Part[$CellContext`wfrom$$, $CellContext`f$$, 1]], 
                 Part[$CellContext`wfrom$$, $CellContext`f$$, 2], " ", 
                 Part[$CellContext`captures$$, $CellContext`f$$, 1]}], 12], {
              2.95, -0.5}], 
             Text[
              Style[
               Row[{$CellContext`f$$, ". ", "... - ..."}], 12], {
              2.95, -0.5}]], 
            Text[" ", {2.8, -0.5}]], 
           If[
            And[
             Inequality[
              Length[$CellContext`wto$$], GreaterEqual, $CellContext`f$$, 
              Greater, 0], 
             Part[$CellContext`wto$$, $CellContext`f$$] != {0, 0}], {
             Text[
              Style[
               Row[{
                 Part[$CellContext`alpha, 
                  Part[$CellContext`wto$$, $CellContext`f$$, 1]], 
                 Part[$CellContext`wto$$, $CellContext`f$$, 2], 
                 Part[$CellContext`checks$$, $CellContext`f$$, 1]}], 12], {
              3.75, -0.5}], 
             If[
              
              And[$CellContext`l == 1, $CellContext`h$$ == 1, 
               Length[$CellContext`bto$$] < $CellContext`r$$], 
              If[Part[$CellContext`checks$$, $CellContext`f$$, 1] == "+", 
               Text[
                Style[
                 Row[{"mate"}], 12], {4.4, -0.5}], 
               Text[
                Style[
                 Row[{"stalemate"}], 12], {4.4, -0.5}]], {}]}, {}], 
           If[
            Inequality[
             Length[$CellContext`bfrom$$], GreaterEqual, $CellContext`f$$, 
             Greater, 0], 
            Text[
             Style[
              Row[{
                Part[$CellContext`names, 
                 Part[$CellContext`bpiece$$, $CellContext`f$$]], 
                Part[$CellContext`alpha, 
                 Part[$CellContext`bfrom$$, $CellContext`f$$, 1]], 
                Part[$CellContext`bfrom$$, $CellContext`f$$, 2], " ", 
                Part[$CellContext`captures$$, $CellContext`f$$, 2]}], 12], {
             4.4, -0.5}], {}], 
           If[
            Inequality[
             Length[$CellContext`bto$$], GreaterEqual, $CellContext`f$$, 
             Greater, 0], {
             Text[
              Style[
               Row[{
                 Part[$CellContext`alpha, 
                  Part[$CellContext`bto$$, $CellContext`f$$, 1]], 
                 Part[$CellContext`bto$$, $CellContext`f$$, 2], 
                 Part[$CellContext`checks$$, $CellContext`f$$, 2]}], 12], {
              5., -0.5}], 
             If[
              And[$CellContext`l == 1, $CellContext`h$$ == 1], 
              If[Part[$CellContext`checks$$, $CellContext`f$$, 2] == "+", 
               Text[
                Style[
                 Row[{"mate"}], 12], {5.8, -0.5}], 
               Text[
                Style[
                 Row[{"stalemate"}], 12], {5.8, -0.5}]], {}]}, {}]}, 
          PlotRange -> {{-0.1, 8.1}, {-0.9, 8.1}}, ImageSize -> {400, 400}], {
         
          If[
           And[$CellContext`h$$ == 1, 
            Or[
            Length[$CellContext`list$$] > 1, $CellContext`edit$$ != 
             "play"]], {$CellContext`pos$$ = Floor[#] + {1, 1}, 
            Part[$CellContext`pos$$, 1] = Max[
              Part[$CellContext`pos$$, 1], 1], Part[$CellContext`pos$$, 1] = 
            Min[
              Part[$CellContext`pos$$, 1], 8], Part[$CellContext`pos$$, 2] = 
            Max[
              Part[$CellContext`pos$$, 2], 1], Part[$CellContext`pos$$, 2] = 
            Min[
              Part[$CellContext`pos$$, 2], 8], 
            If[
             Not[$CellContext`part1$$], 
             Which[$CellContext`edit$$ == "play", {}, $CellContext`edit$$ == 
               "delete", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 0; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 0, $CellContext`edit$$ == 
               "white pawn", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 1, $CellContext`edit$$ == 
               "white rook", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 2, $CellContext`edit$$ == 
               "white knight", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 3, $CellContext`edit$$ == 
               "white bishop", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 4, $CellContext`edit$$ == 
               "white queen", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 5, $CellContext`edit$$ == 
               "white king", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 6, $CellContext`edit$$ == 
               "black pawn", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = -1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 1, $CellContext`edit$$ == 
               "black rook", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = -1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 2, $CellContext`edit$$ == 
               "black knight", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = -1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 3, $CellContext`edit$$ == 
               "black bishop", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = -1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 4, $CellContext`edit$$ == 
               "black queen", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = -1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 5, $CellContext`edit$$ == 
               "black king", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = -1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 6, 
               
               And[$CellContext`edit$$ == "next player", $CellContext`r$$ == 
                0], $CellContext`n$$ = -$CellContext`n$$]; 
             If[$CellContext`edit$$ != 
               "play", $CellContext`list$$ = $CellContext`list0]], 
            If[
             
             And[$CellContext`edit$$ == "castling options", 
              Part[$CellContext`type$$, 
                Part[$CellContext`pos$$, 1], 
                Part[$CellContext`pos$$, 2]] == $CellContext`rr], 
             If[$CellContext`pos$$ == {1, 1}, $CellContext`unmoveda1$$ = 
               Not[$CellContext`unmoveda1$$]]; 
             If[$CellContext`pos$$ == {8, 1}, $CellContext`unmovedh1$$ = 
               Not[$CellContext`unmovedh1$$]]; 
             If[$CellContext`pos$$ == {1, 8}, $CellContext`unmoveda8$$ = 
               Not[$CellContext`unmoveda8$$]]; 
             If[$CellContext`pos$$ == {8, 8}, $CellContext`unmovedh8$$ = 
               Not[$CellContext`unmovedh8$$]], {}], 
            
            If[$CellContext`edit$$ == 
             "reset", $CellContext`r$$ = 0; $CellContext`edit$$ = 
              "play"; $CellContext`wto$$ = ($CellContext`wfrom$$ = \
($CellContext`bfrom$$ = ($CellContext`bto$$ = ($CellContext`wpiece$$ = \
($CellContext`bpiece$$ = {}))))); $CellContext`side$$ = $CellContext`side0; \
$CellContext`type$$ = $CellContext`type0; $CellContext`list$$ = \
$CellContext`list0; $CellContext`sides$$ = {$CellContext`side0}; \
$CellContext`types$$ = {$CellContext`type0}; $CellContext`part1$$ = \
($CellContext`part2$$ = False); $CellContext`ok$$ = 
              False; $CellContext`from$$ = ($CellContext`to$$ = \
($CellContext`epwhite$$ = ($CellContext`epblack$$ = {0, 
                  0}))); $CellContext`n$$ = 
              1; $CellContext`unmoveda1$$ = ($CellContext`unmoveda8$$ = \
($CellContext`unmovedh1$$ = ($CellContext`unmovedh8$$ = True)))], 
            
            If[$CellContext`edit$$ == 
             "clear", $CellContext`r$$ = 
              0; $CellContext`wto$$ = ($CellContext`wfrom$$ = \
($CellContext`bfrom$$ = ($CellContext`bto$$ = ($CellContext`wpiece$$ = \
($CellContext`bpiece$$ = {}))))); $CellContext`list$$ = $CellContext`list0; \
$CellContext`side$$ = ($CellContext`type$$ = $CellContext`all0); \
$CellContext`sides$$ = ($CellContext`types$$ = {$CellContext`all0}); \
$CellContext`part1$$ = ($CellContext`part2$$ = False); $CellContext`ok$$ = 
              False; $CellContext`from$$ = ($CellContext`to$$ = \
($CellContext`epwhite$$ = ($CellContext`epblack$$ = {0, 
                  0}))); $CellContext`n$$ = 
              1; $CellContext`unmoveda1$$ = ($CellContext`unmoveda8$$ = \
($CellContext`unmovedh1$$ = ($CellContext`unmovedh8$$ = True)))], 
            If[$CellContext`edit$$ == "play", {
              If[
               Or[
                And[$CellContext`n$$ == 1, 
                 Not[$CellContext`randomwhite$$]], 
                And[$CellContext`n$$ == -1, 
                 Not[$CellContext`randomblack$$]]], {$CellContext`l = 
                Length[$CellContext`list$$], $CellContext`part1$$ = \
($CellContext`part2$$ = False), 
                If[
                 And[
                 Part[$CellContext`from$$, 1] == 0, $CellContext`n$$ == 
                  Part[$CellContext`side$$, 
                    Part[$CellContext`pos$$, 1], 
                    Part[$CellContext`pos$$, 2]]], {
                  
                  For[$CellContext`i$$ = 
                   1, $CellContext`i$$ <= $CellContext`l, 
                   Increment[$CellContext`i$$], 
                   If[
                   Part[$CellContext`list$$, $CellContext`i$$, 
                    1] == $CellContext`pos$$, {$CellContext`part1$$ = True, 
                    Break[]}]]}], 
                If[
                 And[
                 Part[$CellContext`from$$, 1] != 0, 
                  Part[$CellContext`to$$, 1] == 0, $CellContext`n$$ != 
                  Part[$CellContext`side$$, 
                    Part[$CellContext`pos$$, 1], 
                    Part[$CellContext`pos$$, 2]]], {
                  
                  For[$CellContext`i$$ = 
                   1, $CellContext`i$$ <= $CellContext`l, 
                   Increment[$CellContext`i$$], 
                   If[
                    And[
                    Part[$CellContext`list$$, $CellContext`i$$, 
                    1] == $CellContext`oldfrom$$, 
                    Part[$CellContext`list$$, $CellContext`i$$, 
                    2] == $CellContext`pos$$], {$CellContext`part2$$ = True, 
                    Break[]}]]}], 
                
                If[$CellContext`part1$$, $CellContext`oldfrom$$ = \
($CellContext`from$$ = $CellContext`pos$$); $CellContext`to$$ = {0, 0}], 
                
                If[$CellContext`part2$$, $CellContext`to$$ = \
$CellContext`pos$$], 
                If[
                 
                 And[$CellContext`part1$$, $CellContext`n$$ == 
                  1], $CellContext`r$$ = $CellContext`r$$ + 
                   1; $CellContext`wfrom$$ = 
                  AppendTo[$CellContext`wfrom$$, $CellContext`pos$$]; \
$CellContext`wpiece$$ = AppendTo[$CellContext`wpiece$$, 
                    Part[$CellContext`type$$, 
                    Part[$CellContext`pos$$, 1], 
                    Part[$CellContext`pos$$, 2]]]], 
                If[
                 
                 And[$CellContext`part1$$, $CellContext`n$$ == -1], \
$CellContext`bfrom$$ = 
                  AppendTo[$CellContext`bfrom$$, $CellContext`pos$$]; \
$CellContext`bpiece$$ = AppendTo[$CellContext`bpiece$$, 
                    Part[$CellContext`type$$, 
                    Part[$CellContext`pos$$, 1], 
                    Part[$CellContext`pos$$, 2]]]; 
                 If[$CellContext`r$$ == 
                   0, $CellContext`r$$ = 
                    1; $CellContext`wfrom$$ = ($CellContext`wto$$ = {{0, 
                    0}}); $CellContext`wpiece$$ = {$CellContext`pp}; \
$CellContext`captures$$ = {{"-", "-"}, {"-", "-"}}]], 
                If[
                 And[
                  Not[$CellContext`part1$$], 
                  Not[$CellContext`part2$$]], If[
                   
                   And[$CellContext`from$$ != {0, 0}, $CellContext`to$$ == {0,
                     0}, $CellContext`n$$ == 1], $CellContext`wfrom$$ = 
                    Delete[$CellContext`wfrom$$, $CellContext`r$$]; \
$CellContext`wpiece$$ = 
                    Delete[$CellContext`wpiece$$, $CellContext`r$$]; \
$CellContext`r$$ = $CellContext`r$$ - 1, {}]; If[
                   
                   And[$CellContext`from$$ != {0, 0}, $CellContext`to$$ == {0,
                     0}, $CellContext`n$$ == -1], $CellContext`bfrom$$ = 
                    Delete[$CellContext`wfrom$$, $CellContext`r$$]; \
$CellContext`bpiece$$ = 
                    Delete[$CellContext`bpiece$$, $CellContext`r$$], {}]; \
$CellContext`from$$ = ($CellContext`to$$ = {0, 0})]}], 
              If[
               
               And[$CellContext`randomwhite$$, $CellContext`n$$ == 
                1, $CellContext`from$$ == {0, 0}], $CellContext`i$$ = 
                RandomInteger[{2, 
                   Length[$CellContext`list$$]}]; $CellContext`from$$ = 
                Part[$CellContext`list$$, $CellContext`i$$, 
                  1]; $CellContext`pos$$ = ($CellContext`to$$ = 
                 Part[$CellContext`list$$, $CellContext`i$$, 
                   2]); $CellContext`wfrom$$ = 
                AppendTo[$CellContext`wfrom$$, $CellContext`from$$]; \
$CellContext`wpiece$$ = AppendTo[$CellContext`wpiece$$, 
                  Part[$CellContext`type$$, 
                   Part[$CellContext`from$$, 1], 
                   Part[$CellContext`from$$, 2]]]; $CellContext`captures$$ = 
                Append[$CellContext`captures$$, {
                  "-", "-"}]; $CellContext`checks$$ = 
                Append[$CellContext`checks$$, {
                  " ", " "}]; $CellContext`r$$ = $CellContext`r$$ + 
                 1; $CellContext`part1$$ = False; $CellContext`part2$$ = 
                True], 
              If[
               
               And[$CellContext`randomblack$$, $CellContext`n$$ == -1, \
$CellContext`from$$ == {0, 0}], $CellContext`i$$ = RandomInteger[{2, 
                   Length[$CellContext`list$$]}]; $CellContext`from$$ = 
                Part[$CellContext`list$$, $CellContext`i$$, 
                  1]; $CellContext`pos$$ = ($CellContext`to$$ = 
                 Part[$CellContext`list$$, $CellContext`i$$, 
                   2]); $CellContext`bfrom$$ = 
                AppendTo[$CellContext`bfrom$$, $CellContext`from$$]; \
$CellContext`bpiece$$ = AppendTo[$CellContext`bpiece$$, 
                  Part[$CellContext`type$$, 
                   Part[$CellContext`from$$, 1], 
                   Part[$CellContext`from$$, 2]]]; 
               If[$CellContext`r$$ == 
                 0, $CellContext`r$$ = 
                  1; $CellContext`wfrom$$ = ($CellContext`wto$$ = {{
                    9, 
                    " "}}); $CellContext`wpiece$$ = {$CellContext`pp}]; \
$CellContext`captures$$ = 
                Append[$CellContext`captures$$, {
                  "-", "-"}]; $CellContext`part1$$ = 
                False; $CellContext`part2$$ = True], $CellContext`x$$ = 
              Part[$CellContext`from$$, 1], $CellContext`y$$ = 
              Part[$CellContext`from$$, 2], 
              If[$CellContext`part2$$, {
                If[
                 
                 Or[$CellContext`from$$ == {1, 1}, $CellContext`to$$ == {1, 
                   1}, $CellContext`from$$ == {5, 
                   1}], $CellContext`unmoveda1$$ = False], 
                If[
                 
                 Or[$CellContext`from$$ == {8, 1}, $CellContext`to$$ == {8, 
                   1}, $CellContext`from$$ == {5, 
                   1}], $CellContext`unmovedh1$$ = False], 
                If[
                 
                 Or[$CellContext`from$$ == {1, 8}, $CellContext`to$$ == {1, 
                   8}, $CellContext`from$$ == {5, 
                   8}], $CellContext`unmoveda8$$ = False], 
                If[
                 
                 Or[$CellContext`from$$ == {8, 8}, $CellContext`to$$ == {8, 
                   8}, $CellContext`from$$ == {5, 
                   8}], $CellContext`unmovedh8$$ = False], 
                If[
                 And[
                 Part[$CellContext`type$$, $CellContext`x$$, \
$CellContext`y$$] == $CellContext`pp, $CellContext`y$$ == 2, 
                  Part[$CellContext`to$$, 2] == 
                  4], $CellContext`epwhite$$ = {$CellContext`x$$, 3}], 
                If[
                 And[
                 Part[$CellContext`type$$, $CellContext`x$$, \
$CellContext`y$$] == $CellContext`pp, $CellContext`y$$ == 7, 
                  Part[$CellContext`to$$, 2] == 
                  5], $CellContext`epblack$$ = {$CellContext`x$$, 6}], 
                If[
                 And[
                 Part[$CellContext`type$$, $CellContext`x$$, \
$CellContext`y$$] == $CellContext`pp, 
                  Or[
                  Part[$CellContext`to$$, 2] == 8, Part[$CellContext`to$$, 2] == 
                   1]], 
                 
                 Which[$CellContext`prom$$ == "queen", 
                  Part[$CellContext`type$$, 
                    Part[$CellContext`to$$, 1], 
                    
                    Part[$CellContext`to$$, 
                    2]] = $CellContext`qq, $CellContext`prom$$ == "rook", 
                  Part[$CellContext`type$$, 
                    Part[$CellContext`to$$, 1], 
                    
                    Part[$CellContext`to$$, 
                    2]] = $CellContext`rr, $CellContext`prom$$ == "bishop", 
                  Part[$CellContext`type$$, 
                    Part[$CellContext`to$$, 1], 
                    
                    Part[$CellContext`to$$, 
                    2]] = $CellContext`bb, $CellContext`prom$$ == "knight", 
                  Part[$CellContext`type$$, 
                    Part[$CellContext`to$$, 1], 
                    Part[$CellContext`to$$, 2]] = $CellContext`nn], 
                 Part[$CellContext`type$$, 
                   Part[$CellContext`to$$, 1], 
                   Part[$CellContext`to$$, 2]] = 
                 Part[$CellContext`type$$, $CellContext`x$$, \
$CellContext`y$$]], 
                If[
                Part[$CellContext`type$$, $CellContext`x$$, $CellContext`y$$] == \
$CellContext`kk, If[
                   
                   And[$CellContext`from$$ == {5, 1}, $CellContext`to$$ == {3,
                     1}], Part[$CellContext`type$$, 4, 1] = $CellContext`rr; 
                   Part[$CellContext`type$$, 1, 1] = 0; 
                   Part[$CellContext`side$$, 4, 1] = 1; 
                   Part[$CellContext`side$$, 1, 1] = 0]; If[
                   
                   And[$CellContext`from$$ == {5, 1}, $CellContext`to$$ == {7,
                     1}], Part[$CellContext`type$$, 6, 1] = $CellContext`rr; 
                   Part[$CellContext`type$$, 8, 1] = 0; 
                   Part[$CellContext`side$$, 6, 1] = 1; 
                   Part[$CellContext`side$$, 8, 1] = 0]; If[
                   
                   And[$CellContext`from$$ == {5, 8}, $CellContext`to$$ == {3,
                     8}], Part[$CellContext`type$$, 4, 8] = $CellContext`rr; 
                   Part[$CellContext`type$$, 1, 8] = 0; 
                   Part[$CellContext`side$$, 4, 8] = -1; 
                   Part[$CellContext`side$$, 1, 8] = 0]; If[
                   
                   And[$CellContext`from$$ == {5, 8}, $CellContext`to$$ == {7,
                     8}], Part[$CellContext`type$$, 6, 8] = $CellContext`rr; 
                   Part[$CellContext`type$$, 8, 8] = 0; 
                   Part[$CellContext`side$$, 6, 8] = -1; 
                   Part[$CellContext`side$$, 8, 8] = 
                    0]], $CellContext`capture$$ = "-"; If[
                  And[
                  Part[$CellContext`type$$, $CellContext`x$$, \
$CellContext`y$$] == $CellContext`pp, $CellContext`to$$ == \
$CellContext`epblack$$], Part[$CellContext`type$$, 
                    Part[$CellContext`to$$, 1], Part[$CellContext`to$$, 2] - 
                    1] = 0; Part[$CellContext`side$$, 
                    Part[$CellContext`to$$, 1], Part[$CellContext`to$$, 2] - 
                    1] = 0; $CellContext`capture$$ = "x"], 
                If[
                 And[
                 Part[$CellContext`type$$, $CellContext`x$$, \
$CellContext`y$$] == $CellContext`pp, $CellContext`to$$ == \
$CellContext`epwhite$$], Part[$CellContext`type$$, 
                    Part[$CellContext`to$$, 1], Part[$CellContext`to$$, 2] + 
                    1] = 0; Part[$CellContext`side$$, 
                    Part[$CellContext`to$$, 1], Part[$CellContext`to$$, 2] + 
                    1] = 0; $CellContext`capture$$ = "x"], 
                Part[$CellContext`type$$, $CellContext`x$$, $CellContext`y$$] = 
                0, 
                If[Part[$CellContext`side$$, 
                   Part[$CellContext`to$$, 1], 
                   Part[$CellContext`to$$, 2]] != 0, $CellContext`capture$$ = 
                 "x"], Part[$CellContext`side$$, 
                  Part[$CellContext`to$$, 1], 
                  Part[$CellContext`to$$, 2]] = 
                Part[$CellContext`side$$, $CellContext`x$$, $CellContext`y$$],
                 Part[$CellContext`side$$, $CellContext`x$$, \
$CellContext`y$$] = 0, 
                
                If[$CellContext`n$$ == 
                 1, $CellContext`wto$$ = 
                  AppendTo[$CellContext`wto$$, $CellContext`pos$$]; \
$CellContext`captures$$ = Append[$CellContext`captures$$, {"-", "-"}]; 
                 Part[$CellContext`captures$$, $CellContext`r$$, 
                    1] = $CellContext`capture$$; $CellContext`list$$ = \
$CellContext`list0; $CellContext`checks$$ = 
                  Append[$CellContext`checks$$, {" ", " "}]; Do[
                   If[
                    And[
                    Part[$CellContext`type$$, $CellContext`i$$, \
$CellContext`j$$] == $CellContext`kk, 
                    Part[$CellContext`side$$, $CellContext`i$$, \
$CellContext`j$$] == -$CellContext`n$$], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, \
$CellContext`i$$, $CellContext`j$$, -$CellContext`n$$]; 
                    Break[]], {$CellContext`i$$, 8}, {$CellContext`j$$, 8}]; 
                 If[$CellContext`swattacked$$, 
                   Part[$CellContext`checks$$, $CellContext`r$$, 1] = "+"]], 
                
                If[$CellContext`n$$ == -1, $CellContext`bto$$ = 
                  AppendTo[$CellContext`bto$$, $CellContext`pos$$]; \
$CellContext`sides$$ = 
                  AppendTo[$CellContext`sides$$, $CellContext`side$$]; \
$CellContext`types$$ = AppendTo[$CellContext`types$$, $CellContext`type$$]; 
                 Part[$CellContext`captures$$, $CellContext`r$$, 
                    2] = $CellContext`capture$$; $CellContext`list$$ = \
$CellContext`list0; Do[
                   If[
                    And[
                    Part[$CellContext`type$$, $CellContext`i$$, \
$CellContext`j$$] == $CellContext`kk, 
                    Part[$CellContext`side$$, $CellContext`i$$, \
$CellContext`j$$] == -$CellContext`n$$], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, \
$CellContext`i$$, $CellContext`j$$, -$CellContext`n$$]; 
                    Break[]], {$CellContext`i$$, 8}, {$CellContext`j$$, 8}]; 
                 If[$CellContext`swattacked$$, 
                   Part[$CellContext`checks$$, $CellContext`r$$, 2] = "+"]], 
                
                If[$CellContext`n$$ == 
                 1, $CellContext`epblack$$ = {0, 
                  0}, $CellContext`epwhite$$ = {0, 
                  0}], $CellContext`n$$ = -$CellContext`n$$, \
$CellContext`list$$ = $CellContext`list0, $CellContext`part1$$ = \
($CellContext`part2$$ = 
                 False), $CellContext`from$$ = ($CellContext`to$$ = {0, 
                  0})}]}]}]}& ]), 
      "Specifications" :> {{{$CellContext`colw$$, 1, 
          Style["color White", 10]}, {1, 2, 3}, ControlType -> 
         PopupMenu}, {{$CellContext`colb$$, 1, 
          Style["color Black", 10]}, {1, 2, 3}, ControlType -> 
         PopupMenu}, {{$CellContext`randomwhite$$, False, "random White"}, {
         True, False}}, {{$CellContext`randomblack$$, False, 
          "random Black"}, {
         True, False}}, {{$CellContext`showmoves$$, False, "show moves"}, {
         True, False}}, {{$CellContext`showtargets$$, True, "show targets"}, {
         True, False}}, {{$CellContext`prom$$, "queen", 
          Style["promotion to", 10]}, {"queen", "rook", "bishop", "knight"}, 
         ControlType -> PopupMenu}, {{$CellContext`edit$$, "play", 
          Style["edit position", 10]}, {
         "play", "reset", "clear", "delete", "white pawn", "white knight", 
          "white bishop", "white rook", "white queen", "white king", 
          "black pawn", "black knight", "black bishop", "black rook", 
          "black queen", "black king", "castling options", "next player"}, 
         ControlType -> PopupMenu}, {{$CellContext`h$$, 1, 
          Style["history"]}, 0, 1, ControlType -> Slider, ImageSize -> 
         Small}, {{$CellContext`i$$, 0}, ControlType -> 
         None}, {{$CellContext`j$$, 0}, ControlType -> 
         None}, {{$CellContext`kx$$, 0}, ControlType -> 
         None}, {{$CellContext`ky$$, 0}, ControlType -> 
         None}, {{$CellContext`pos$$, {0, 0}}, ControlType -> 
         None}, {{$CellContext`from$$, {0, 0}}, ControlType -> 
         None}, {{$CellContext`oldfrom$$, {0, 0}}, ControlType -> 
         None}, {{$CellContext`to$$, {0, 0}}, ControlType -> 
         None}, {{$CellContext`side$$, {{1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 
          0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
          0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
          0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
          0, -1, -1}}}, ControlType -> 
         None}, {{$CellContext`type$$, {{2, 1, 0, 0, 0, 0, 1, 2}, {3, 1, 0, 0,
           0, 0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 4}, {5, 1, 0, 0, 0, 0, 1, 5}, {
          6, 1, 0, 0, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0, 1, 4}, {3, 1, 0, 0, 0, 
          0, 1, 3}, {2, 1, 0, 0, 0, 0, 1, 2}}}, ControlType -> 
         None}, {{$CellContext`n$$, 1}, ControlType -> 
         None}, {{$CellContext`list$$, {{{0, 0}, {0, 0}}}}, ControlType -> 
         None}, {{$CellContext`sides$$, {{{1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 
          0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
          0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
          0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
          0, -1, -1}}}}, ControlType -> 
         None}, {{$CellContext`types$$, {{{2, 1, 0, 0, 0, 0, 1, 2}, {3, 1, 0, 
          0, 0, 0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 4}, {5, 1, 0, 0, 0, 0, 1, 
          5}, {6, 1, 0, 0, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0, 1, 4}, {3, 1, 0, 0,
           0, 0, 1, 3}, {2, 1, 0, 0, 0, 0, 1, 2}}}}, ControlType -> 
         None}, {{$CellContext`wfrom$$, {}}, ControlType -> 
         None}, {{$CellContext`wto$$, {}}, ControlType -> 
         None}, {{$CellContext`wpiece$$, {}}, ControlType -> 
         None}, {{$CellContext`bfrom$$, {}}, ControlType -> 
         None}, {{$CellContext`bto$$, {}}, ControlType -> 
         None}, {{$CellContext`bpiece$$, {}}, ControlType -> 
         None}, {{$CellContext`unmoveda1$$, True}, ControlType -> 
         None}, {{$CellContext`unmoveda8$$, True}, ControlType -> 
         None}, {{$CellContext`unmovedh1$$, True}, ControlType -> 
         None}, {{$CellContext`unmovedh8$$, True}, ControlType -> 
         None}, {{$CellContext`epwhite$$, {0, 0}}, ControlType -> 
         None}, {{$CellContext`epblack$$, {0, 0}}, ControlType -> 
         None}, {{$CellContext`r$$, 0}, ControlType -> 
         None}, {{$CellContext`f$$, 0}, ControlType -> 
         None}, {{$CellContext`capture$$, "-"}, ControlType -> 
         None}, {{$CellContext`captures$$, {{"-", "-"}}}, ControlType -> 
         None}, {{$CellContext`checks$$, {{" ", " "}}}, ControlType -> 
         None}, {{$CellContext`part1$$, False}, ControlType -> 
         None}, {{$CellContext`part2$$, False}, ControlType -> 
         None}, {{$CellContext`ok$$, False}, ControlType -> 
         None}, {{$CellContext`eastok$$, False}, ControlType -> 
         None}, {{$CellContext`westok$$, False}, ControlType -> 
         None}, {{$CellContext`southok$$, False}, ControlType -> 
         None}, {{$CellContext`northok$$, False}, ControlType -> 
         None}, {{$CellContext`x$$, 0}, ControlType -> 
         None}, {{$CellContext`y$$, 0}, ControlType -> 
         None}, {{$CellContext`swattacked$$, False}, ControlType -> None}}, 
      "Options" :> {ControlPlacement -> Left, AutorunSequencing -> {1}}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{651., {226., 231.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`list0 = {{{0, 0}, {0, 0}}}, $CellContext`t = 
       1, $CellContext`s = -1, $CellContext`pp = 1, $CellContext`nn = 
       3, $CellContext`bb = 4, $CellContext`qq = 5, $CellContext`rr = 
       2, $CellContext`kk = 6, $CellContext`check[
         Pattern[$CellContext`si$, 
          Blank[]], 
         Pattern[$CellContext`ty$, 
          Blank[]], 
         Pattern[$CellContext`x$, 
          Blank[]], 
         Pattern[$CellContext`y$, 
          Blank[]], 
         Pattern[$CellContext`n$, 
          Blank[]]] := 
       Module[{$CellContext`sw$}, $CellContext`sw$ = False; If[
           
           And[$CellContext`x$ < 8, $CellContext`n$ $CellContext`y$ < 
            4 + $CellContext`n$ 3, 
            Part[$CellContext`si$, $CellContext`x$ + 
              1, $CellContext`y$ + $CellContext`n$] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ + 
              1, $CellContext`y$ + $CellContext`n$] == $CellContext`pp], \
$CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ > 1, $CellContext`n$ $CellContext`y$ < 
            4 + $CellContext`n$ 3, 
            Part[$CellContext`si$, $CellContext`x$ - 
              1, $CellContext`y$ + $CellContext`n$] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ - 
              1, $CellContext`y$ + $CellContext`n$] == $CellContext`pp], \
$CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ < 8, $CellContext`y$ > 2, 
            Part[$CellContext`si$, $CellContext`x$ + 1, $CellContext`y$ - 
              2] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ + 1, $CellContext`y$ - 
              2] == $CellContext`nn], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ < 8, $CellContext`y$ < 7, 
            Part[$CellContext`si$, $CellContext`x$ + 1, $CellContext`y$ + 
              2] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ + 1, $CellContext`y$ + 
              2] == $CellContext`nn], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ > 1, $CellContext`y$ > 2, 
            Part[$CellContext`si$, $CellContext`x$ - 1, $CellContext`y$ - 
              2] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ - 1, $CellContext`y$ - 
              2] == $CellContext`nn], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ > 1, $CellContext`y$ < 7, 
            Part[$CellContext`si$, $CellContext`x$ - 1, $CellContext`y$ + 
              2] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ - 1, $CellContext`y$ + 
              2] == $CellContext`nn], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ < 7, $CellContext`y$ > 1, 
            Part[$CellContext`si$, $CellContext`x$ + 2, $CellContext`y$ - 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ + 2, $CellContext`y$ - 
              1] == $CellContext`nn], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ < 7, $CellContext`y$ < 8, 
            Part[$CellContext`si$, $CellContext`x$ + 2, $CellContext`y$ + 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ + 2, $CellContext`y$ + 
              1] == $CellContext`nn], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ > 2, $CellContext`y$ > 1, 
            Part[$CellContext`si$, $CellContext`x$ - 2, $CellContext`y$ - 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ - 2, $CellContext`y$ - 
              1] == $CellContext`nn], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ > 2, $CellContext`y$ < 8, 
            Part[$CellContext`si$, $CellContext`x$ - 2, $CellContext`y$ + 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ - 2, $CellContext`y$ + 
              1] == $CellContext`nn], $CellContext`sw$ = True]; 
         For[$CellContext`i$$ = 1, $CellContext`i$$ <= 
           Min[7 - $CellContext`x$, 7 - $CellContext`y$], 
           Increment[$CellContext`i$$], 
           If[
           Part[$CellContext`si$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$ + $CellContext`i$$] != 0, 
            Break[]]]; If[
           
           And[$CellContext`i$$ <= 
            Min[8 - $CellContext`x$, 8 - $CellContext`y$], 
            Part[$CellContext`si$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$ + $CellContext`i$$] == -$CellContext`n$, 
            Or[
            Part[$CellContext`ty$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$ + $CellContext`i$$] == $CellContext`qq, 
             Part[$CellContext`ty$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$ + $CellContext`i$$] == $CellContext`bb]], $CellContext`sw$ = 
           True]; For[$CellContext`i$$ = 1, $CellContext`i$$ <= 
           Min[$CellContext`x$ - 1, 7 - $CellContext`y$], 
           Increment[$CellContext`i$$], 
           If[
           Part[$CellContext`si$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$ + $CellContext`i$$] != 0, 
            Break[]]]; If[
           
           And[$CellContext`i$$ <= 
            Min[$CellContext`x$ - 1, 8 - $CellContext`y$], 
            Part[$CellContext`si$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$ + $CellContext`i$$] == -$CellContext`n$, 
            Or[
            Part[$CellContext`ty$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$ + $CellContext`i$$] == $CellContext`qq, 
             Part[$CellContext`ty$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$ + $CellContext`i$$] == $CellContext`bb]], $CellContext`sw$ = 
           True]; For[$CellContext`i$$ = 1, $CellContext`i$$ <= 
           Min[7 - $CellContext`x$, $CellContext`y$ - 1], 
           Increment[$CellContext`i$$], 
           If[
           Part[$CellContext`si$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$ - $CellContext`i$$] != 0, 
            Break[]]]; If[
           
           And[$CellContext`i$$ <= 
            Min[8 - $CellContext`x$, $CellContext`y$ - 1], 
            Part[$CellContext`si$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$ - $CellContext`i$$] == -$CellContext`n$, 
            Or[
            Part[$CellContext`ty$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$ - $CellContext`i$$] == $CellContext`qq, 
             Part[$CellContext`ty$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$ - $CellContext`i$$] == $CellContext`bb]], $CellContext`sw$ = 
           True]; For[$CellContext`i$$ = 1, $CellContext`i$$ <= 
           Min[$CellContext`x$ - 1, $CellContext`y$ - 1], 
           Increment[$CellContext`i$$], 
           If[
           Part[$CellContext`si$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$ - $CellContext`i$$] != 0, 
            Break[]]]; If[
           
           And[$CellContext`i$$ <= 
            Min[$CellContext`x$ - 1, $CellContext`y$ - 1], 
            Part[$CellContext`si$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$ - $CellContext`i$$] == -$CellContext`n$, 
            Or[
            Part[$CellContext`ty$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$ - $CellContext`i$$] == $CellContext`qq, 
             Part[$CellContext`ty$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$ - $CellContext`i$$] == $CellContext`bb]], $CellContext`sw$ = 
           True]; For[$CellContext`i$$ = 1, $CellContext`i$$ <= 
           7 - $CellContext`x$, 
           Increment[$CellContext`i$$], 
           If[
           Part[$CellContext`si$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$] != 0, 
            Break[]]]; If[
           
           And[$CellContext`i$$ <= 8 - $CellContext`x$, 
            Part[$CellContext`si$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$] == -$CellContext`n$, 
            Or[
            Part[$CellContext`ty$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$] == $CellContext`qq, 
             Part[$CellContext`ty$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$] == $CellContext`rr]], $CellContext`sw$ = True]; 
         For[$CellContext`i$$ = 1, $CellContext`i$$ <= $CellContext`x$ - 1, 
           Increment[$CellContext`i$$], 
           If[
           Part[$CellContext`si$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$] != 0, 
            Break[]]]; If[
           
           And[$CellContext`i$$ <= $CellContext`x$ - 1, 
            Part[$CellContext`si$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$] == -$CellContext`n$, 
            Or[
            Part[$CellContext`ty$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$] == $CellContext`qq, 
             Part[$CellContext`ty$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$] == $CellContext`rr]], $CellContext`sw$ = True]; 
         For[$CellContext`i$$ = 1, $CellContext`i$$ <= 7 - $CellContext`y$, 
           Increment[$CellContext`i$$], 
           If[
           Part[$CellContext`si$, $CellContext`x$, $CellContext`y$ + \
$CellContext`i$$] != 0, 
            Break[]]]; If[
           
           And[$CellContext`i$$ <= 8 - $CellContext`y$, 
            Part[$CellContext`si$, $CellContext`x$, $CellContext`y$ + \
$CellContext`i$$] == -$CellContext`n$, 
            Or[
            Part[$CellContext`ty$, $CellContext`x$, $CellContext`y$ + \
$CellContext`i$$] == $CellContext`qq, 
             Part[$CellContext`ty$, $CellContext`x$, $CellContext`y$ + \
$CellContext`i$$] == $CellContext`rr]], $CellContext`sw$ = True]; 
         For[$CellContext`i$$ = 1, $CellContext`i$$ <= $CellContext`y$ - 1, 
           Increment[$CellContext`i$$], 
           If[
           Part[$CellContext`si$, $CellContext`x$, $CellContext`y$ - \
$CellContext`i$$] != 0, 
            Break[]]]; If[
           
           And[$CellContext`i$$ <= $CellContext`y$ - 1, 
            Part[$CellContext`si$, $CellContext`x$, $CellContext`y$ - \
$CellContext`i$$] == -$CellContext`n$, 
            Or[
            Part[$CellContext`ty$, $CellContext`x$, $CellContext`y$ - \
$CellContext`i$$] == $CellContext`qq, 
             Part[$CellContext`ty$, $CellContext`x$, $CellContext`y$ - \
$CellContext`i$$] == $CellContext`rr]], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ < 8, 
            Part[$CellContext`si$, $CellContext`x$ + 
              1, $CellContext`y$] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ + 
              1, $CellContext`y$] == $CellContext`kk], $CellContext`sw$ = 
           True]; If[
           
           And[$CellContext`x$ > 1, 
            Part[$CellContext`si$, $CellContext`x$ - 
              1, $CellContext`y$] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ - 
              1, $CellContext`y$] == $CellContext`kk], $CellContext`sw$ = 
           True]; If[
           
           And[$CellContext`y$ < 8, 
            Part[$CellContext`si$, $CellContext`x$, $CellContext`y$ + 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$, $CellContext`y$ + 
              1] == $CellContext`kk], $CellContext`sw$ = True]; If[
           
           And[$CellContext`y$ > 1, 
            Part[$CellContext`si$, $CellContext`x$, $CellContext`y$ - 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$, $CellContext`y$ - 
              1] == $CellContext`kk], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ < 8, $CellContext`y$ < 8, 
            Part[$CellContext`si$, $CellContext`x$ + 1, $CellContext`y$ + 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ + 1, $CellContext`y$ + 
              1] == $CellContext`kk], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ > 1, $CellContext`y$ > 1, 
            Part[$CellContext`si$, $CellContext`x$ - 1, $CellContext`y$ - 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ - 1, $CellContext`y$ - 
              1] == $CellContext`kk], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ < 8, $CellContext`y$ > 1, 
            Part[$CellContext`si$, $CellContext`x$ + 1, $CellContext`y$ - 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ + 1, $CellContext`y$ - 
              1] == $CellContext`kk], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ > 1, $CellContext`y$ < 8, 
            Part[$CellContext`si$, $CellContext`x$ - 1, $CellContext`y$ + 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ - 1, $CellContext`y$ + 
              1] == $CellContext`kk], $CellContext`sw$ = 
           True]; $CellContext`sw$], $CellContext`l = 
       21, $CellContext`a = {8, 2}, $CellContext`b = {8, 4}, $CellContext`ax = 
       8, $CellContext`ay = 2, $CellContext`bx = 8, $CellContext`by = 
       4, $CellContext`olds = 0, $CellContext`oldt = 
       0, $CellContext`list1 = {{{0, 0}, {0, 0}}, {{1, 2}, {1, 3}}, {{1, 2}, {
        1, 4}}, {{2, 1}, {1, 3}}, {{2, 1}, {3, 3}}, {{2, 2}, {2, 3}}, {{2, 
        2}, {2, 4}}, {{3, 2}, {3, 3}}, {{3, 2}, {3, 4}}, {{4, 2}, {4, 3}}, {{
        4, 2}, {4, 4}}, {{5, 2}, {5, 3}}, {{5, 2}, {5, 4}}, {{6, 2}, {6, 
        3}}, {{6, 2}, {6, 4}}, {{7, 1}, {6, 3}}, {{7, 1}, {8, 3}}, {{7, 2}, {
        7, 3}}, {{7, 2}, {7, 4}}, {{8, 2}, {8, 3}}, {{8, 2}, {8, 
        4}}}, $CellContext`board = {
         RGBColor[0.7, 0.7, 0.5], 
         Polygon[{{0, 0}, {8, 0}, {8, 8}, {0, 8}}], 
         RGBColor[0.94, 0.91, 0.88], 
         Polygon[{{1, 0}, {1, 1}, {2, 1}, {2, 0}}], 
         Polygon[{{3, 0}, {3, 1}, {4, 1}, {4, 0}}], 
         Polygon[{{5, 0}, {5, 1}, {6, 1}, {6, 0}}], 
         Polygon[{{7, 0}, {7, 1}, {8, 1}, {8, 0}}], 
         Polygon[{{0, 1}, {0, 2}, {1, 2}, {1, 1}}], 
         Polygon[{{2, 1}, {2, 2}, {3, 2}, {3, 1}}], 
         Polygon[{{4, 1}, {4, 2}, {5, 2}, {5, 1}}], 
         Polygon[{{6, 1}, {6, 2}, {7, 2}, {7, 1}}], 
         Polygon[{{1, 2}, {1, 3}, {2, 3}, {2, 2}}], 
         Polygon[{{3, 2}, {3, 3}, {4, 3}, {4, 2}}], 
         Polygon[{{5, 2}, {5, 3}, {6, 3}, {6, 2}}], 
         Polygon[{{7, 2}, {7, 3}, {8, 3}, {8, 2}}], 
         Polygon[{{0, 3}, {0, 4}, {1, 4}, {1, 3}}], 
         Polygon[{{2, 3}, {2, 4}, {3, 4}, {3, 3}}], 
         Polygon[{{4, 3}, {4, 4}, {5, 4}, {5, 3}}], 
         Polygon[{{6, 3}, {6, 4}, {7, 4}, {7, 3}}], 
         Polygon[{{1, 4}, {1, 5}, {2, 5}, {2, 4}}], 
         Polygon[{{3, 4}, {3, 5}, {4, 5}, {4, 4}}], 
         Polygon[{{5, 4}, {5, 5}, {6, 5}, {6, 4}}], 
         Polygon[{{7, 4}, {7, 5}, {8, 5}, {8, 4}}], 
         Polygon[{{0, 5}, {0, 6}, {1, 6}, {1, 5}}], 
         Polygon[{{2, 5}, {2, 6}, {3, 6}, {3, 5}}], 
         Polygon[{{4, 5}, {4, 6}, {5, 6}, {5, 5}}], 
         Polygon[{{6, 5}, {6, 6}, {7, 6}, {7, 5}}], 
         Polygon[{{1, 6}, {1, 7}, {2, 7}, {2, 6}}], 
         Polygon[{{3, 6}, {3, 7}, {4, 7}, {4, 6}}], 
         Polygon[{{5, 6}, {5, 7}, {6, 7}, {6, 6}}], 
         Polygon[{{7, 6}, {7, 7}, {8, 7}, {8, 6}}], 
         Polygon[{{0, 7}, {0, 8}, {1, 8}, {1, 7}}], 
         Polygon[{{2, 7}, {2, 8}, {3, 8}, {3, 7}}], 
         Polygon[{{4, 7}, {4, 8}, {5, 8}, {5, 7}}], 
         Polygon[{{6, 7}, {6, 8}, {7, 8}, {7, 7}}], 
         GrayLevel[0.5], {
          Line[{{1, 0}, {1, 8}}], 
          Line[{{2, 0}, {2, 8}}], 
          Line[{{3, 0}, {3, 8}}], 
          Line[{{4, 0}, {4, 8}}], 
          Line[{{5, 0}, {5, 8}}], 
          Line[{{6, 0}, {6, 8}}], 
          Line[{{7, 0}, {7, 8}}]}, {
          Line[{{0, 1}, {8, 1}}], 
          Line[{{0, 2}, {8, 2}}], 
          Line[{{0, 3}, {8, 3}}], 
          Line[{{0, 4}, {8, 4}}], 
          Line[{{0, 5}, {8, 5}}], 
          Line[{{0, 6}, {8, 6}}], 
          Line[{{0, 7}, {8, 7}}]}, 
         GrayLevel[0], 
         Line[{{0, 0}, {0, 8}, {8, 8}, {8, 0}, {0, 0}}], {
          RGBColor[0, 0, 1], 
          Thickness[Large]}, 
         Line[{{-0.1, -0.1}, {-0.1, 8.1}, {8.1, 8.1}, {
          8.1, -0.1}, {-0.1, -0.1}}]}, $CellContext`pawn = 
       Disk[{-0.5, -0.5}, 0.35], $CellContext`rook = 
       Polygon[{{-0.9, -0.9}, {-0.09999999999999998, -0.9}, \
{-0.09999999999999998, -0.7}, {-0.30000000000000004`, -0.5}, \
{-0.09999999999999998, -0.30000000000000004`}, {-0.09999999999999998, \
-0.09999999999999998}, {-0.9, -0.09999999999999998}, {-0.9, \
-0.30000000000000004`}, {-0.7, -0.5}, {-0.9, -0.7}}], $CellContext`knight = 
       Polygon[{{-0.9, -0.9}, {-0.09999999999999998, -0.9}, \
{-0.09999999999999998, -0.6}, {-0.4, -0.6}, {-0.4, -0.4}, \
{-0.09999999999999998, -0.30000000000000004`}, {-0.09999999999999998, \
-0.09999999999999998}, {-0.6, -0.09999999999999998}, {-0.6, -0.6}, {-0.9, \
-0.6}}], $CellContext`bishop = 
       Polygon[{{-0.9, -0.9}, {-0.09999999999999998, -0.9}, {-0.5, \
-0.09999999999999998}}], $CellContext`queen = 
       Polygon[{{-0.9, -0.9}, {-0.09999999999999998, -0.9}, {-0.4, -0.6}, \
{-0.19999999999999996`, -0.30000000000000004`}, {-0.5, -0.09999999999999998}, \
{-0.8, -0.30000000000000004`}, {-0.6, -0.6}}], $CellContext`king = 
       Polygon[{{-0.9, -0.9}, {-0.09999999999999998, -0.9}, \
{-0.09999999999999998, -0.09999999999999998}, {-0.30000000000000004`, \
-0.30000000000000004`}, {-0.5, -0.09999999999999998}, {-0.7, \
-0.30000000000000004`}, {-0.9, -0.09999999999999998}}], $CellContext`names = {
        " ", "R", "N", "B", "Q", "K"}, $CellContext`alpha = {
        "a", "b", "c", "d", "e", "f", "g", "h", 
         "..."}, $CellContext`side0 = {{1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 
        0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
        0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {
        1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
        0, -1, -1}}, $CellContext`type0 = {{2, 1, 0, 0, 0, 0, 1, 2}, {3, 1, 0,
         0, 0, 0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 4}, {5, 1, 0, 0, 0, 0, 1, 5}, {
        6, 1, 0, 0, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0, 1, 4}, {3, 1, 0, 0, 0, 0, 
        1, 3}, {2, 1, 0, 0, 0, 0, 1, 2}}, $CellContext`all0 = {{0, 0, 0, 0, 0,
         0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 
        0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 
        0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}}}; 
     Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.35696210375764*^9, 3.404836196558592*^9, 3.404836269663712*^9, 
   3.404836408873886*^9, 3.4048365510683517`*^9, 3.4048716288690305`*^9, 
   3.4048718933092766`*^9, 3.404872167713851*^9, 3.404872416411461*^9, 
   3.404872924802491*^9, 3.404873037965211*^9, 3.4048732462647314`*^9, 
   3.4048733844634514`*^9, 3.404873552705371*^9, 3.4048737249630656`*^9, 
   3.404874484044571*^9, 3.404874989571483*^9, 3.404875987356227*^9, 
   3.404876670138019*^9, 3.404876953545539*^9, 3.404877042723771*^9, 
   3.4048775867961087`*^9, 3.4048776335132847`*^9, 3.4048777787721567`*^9, 
   3.404878160320797*^9, 3.404878218404317*^9, 3.4048858903446145`*^9, 
   3.404886017387293*^9, 3.404886080958704*^9, 3.404886254127709*^9, 
   3.4048865511948705`*^9, 3.404887475844451*^9, 3.4048875084413233`*^9, 
   3.404887548448851*^9, 3.4048879063334637`*^9, 3.4048880141084366`*^9, 
   3.4048880758972845`*^9, 3.404888341058568*^9, 3.404888486918304*^9, 
   3.4048885760064063`*^9, 3.40488865205576*^9, 3.404888748774835*^9, 
   3.4048890442697363`*^9, 3.4048894689103394`*^9, 3.4048896054166255`*^9, 
   3.4049210101895633`*^9, 3.4049218545536995`*^9, 3.4049230541886897`*^9, 
   3.4049233014342113`*^9, 3.404923440273853*^9, 3.4049235057179565`*^9, 
   3.40492396040176*^9, {3.404923995512246*^9, 3.404924015701277*^9}, 
   3.404924119961195*^9, 3.404924579141464*^9, 3.405034898546605*^9, {
   3.4050349377429667`*^9, 3.4050349652324944`*^9}, 3.4055549600013423`*^9},
 CellID->887323984]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SnapshotsSection"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`bfrom$$ = {{5, 
    7}}, $CellContext`bpiece$$ = {
    1}, $CellContext`bto$$ = {}, $CellContext`capture$$ = 
    "-", $CellContext`captures$$ = {{"-", "-"}, {
     "-", "-"}}, $CellContext`checks$$ = {{" ", " "}, {
     " ", " "}}, $CellContext`colb$$ = 1, $CellContext`colw$$ = 
    1, $CellContext`eastok$$ = True, $CellContext`edit$$ = 
    "play", $CellContext`epblack$$ = {0, 0}, $CellContext`epwhite$$ = {5, 
    3}, $CellContext`f$$ = 1, $CellContext`from$$ = {5, 7}, $CellContext`h$$ =
     1., $CellContext`i$$ = 12, $CellContext`j$$ = 0, $CellContext`kx$$ = 
    5, $CellContext`ky$$ = 8, $CellContext`list$$ = {{{0, 0}, {0, 0}}, {{1, 
    7}, {1, 6}}, {{1, 7}, {1, 5}}, {{2, 7}, {2, 6}}, {{2, 7}, {2, 5}}, {{2, 
    8}, {1, 6}}, {{2, 8}, {3, 6}}, {{3, 7}, {3, 6}}, {{3, 7}, {3, 5}}, {{4, 
    7}, {4, 6}}, {{4, 7}, {4, 5}}, {{5, 7}, {5, 6}}, {{5, 7}, {5, 5}}, {{6, 
    7}, {6, 6}}, {{6, 7}, {6, 5}}, {{7, 7}, {7, 6}}, {{7, 7}, {7, 5}}, {{7, 
    8}, {6, 6}}, {{7, 8}, {8, 6}}, {{8, 7}, {8, 6}}, {{8, 7}, {8, 
    5}}}, $CellContext`n$$ = -1, $CellContext`northok$$ = 
    True, $CellContext`ok$$ = False, $CellContext`oldfrom$$ = {5, 
    7}, $CellContext`part1$$ = True, $CellContext`part2$$ = 
    False, $CellContext`pos$$ = {5, 7}, $CellContext`prom$$ = 
    "queen", $CellContext`r$$ = 1, $CellContext`randomblack$$ = 
    False, $CellContext`randomwhite$$ = False, $CellContext`showmoves$$ = 
    False, $CellContext`showtargets$$ = True, $CellContext`side$$ = {{1, 1, 0,
     0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
    0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 0, 0, 1, 0, 0, -1, -1}, {1, 1,
     0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
    0, -1, -1}}, $CellContext`sides$$ = {{{1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 
    0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
    0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1,
     0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
    0, -1, -1}}}, $CellContext`southok$$ = True, $CellContext`swattacked$$ = 
    False, $CellContext`to$$ = {0, 0}, $CellContext`type$$ = {{2, 1, 0, 0, 0, 
    0, 1, 2}, {3, 1, 0, 0, 0, 0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 4}, {5, 1, 0, 0,
     0, 0, 1, 5}, {6, 0, 0, 1, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0, 1, 4}, {3, 1, 
    0, 0, 0, 0, 1, 3}, {2, 1, 0, 0, 0, 0, 1, 2}}, $CellContext`types$$ = {{{2,
     1, 0, 0, 0, 0, 1, 2}, {3, 1, 0, 0, 0, 0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 
    4}, {5, 1, 0, 0, 0, 0, 1, 5}, {6, 1, 0, 0, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0,
     1, 4}, {3, 1, 0, 0, 0, 0, 1, 3}, {2, 1, 0, 0, 0, 0, 1, 
    2}}}, $CellContext`unmoveda1$$ = True, $CellContext`unmoveda8$$ = 
    True, $CellContext`unmovedh1$$ = True, $CellContext`unmovedh8$$ = 
    True, $CellContext`westok$$ = True, $CellContext`wfrom$$ = {{5, 
    2}}, $CellContext`wpiece$$ = {1}, $CellContext`wto$$ = {{5, 
    4}}, $CellContext`x$$ = 5, $CellContext`y$$ = 7, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`colw$$], 1, 
       Style["color White", 10]}, {1, 2, 3}}, {{
       Hold[$CellContext`colb$$], 1, 
       Style["color Black", 10]}, {1, 2, 3}}, {{
       Hold[$CellContext`randomwhite$$], False, "random White"}, {
      True, False}}, {{
       Hold[$CellContext`randomblack$$], False, "random Black"}, {
      True, False}}, {{
       Hold[$CellContext`showmoves$$], False, "show moves"}, {
      True, False}}, {{
       Hold[$CellContext`showtargets$$], True, "show targets"}, {
      True, False}}, {{
       Hold[$CellContext`prom$$], "queen", 
       Style["promotion to", 10]}, {"queen", "rook", "bishop", "knight"}}, {{
       Hold[$CellContext`edit$$], "play", 
       Style["edit position", 10]}, {
      "play", "reset", "clear", "delete", "white pawn", "white knight", 
       "white bishop", "white rook", "white queen", "white king", 
       "black pawn", "black knight", "black bishop", "black rook", 
       "black queen", "black king", "castling options", "next player"}}, {{
       Hold[$CellContext`h$$], 1, 
       Style["history"]}, 0, 1}, {{
       Hold[$CellContext`i$$], 0}}, {{
       Hold[$CellContext`j$$], 0}}, {{
       Hold[$CellContext`kx$$], 0}}, {{
       Hold[$CellContext`ky$$], 0}}, {{
       Hold[$CellContext`pos$$], {0, 0}}}, {{
       Hold[$CellContext`from$$], {0, 0}}}, {{
       Hold[$CellContext`oldfrom$$], {0, 0}}}, {{
       Hold[$CellContext`to$$], {0, 0}}}, {{
       Hold[$CellContext`side$$], {{1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0,
        0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {
       1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
       0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}}}}, {{
       Hold[$CellContext`type$$], {{2, 1, 0, 0, 0, 0, 1, 2}, {3, 1, 0, 0, 0, 
       0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 4}, {5, 1, 0, 0, 0, 0, 1, 5}, {6, 1, 0,
        0, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0, 1, 4}, {3, 1, 0, 0, 0, 0, 1, 3}, {
       2, 1, 0, 0, 0, 0, 1, 2}}}}, {{
       Hold[$CellContext`n$$], 1}}, {{
       Hold[$CellContext`list$$], {{{0, 0}, {0, 0}}}}}, {{
       Hold[$CellContext`sides$$], {{{1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 
       0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
       0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1,
        1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}}}}}, {{
       Hold[$CellContext`types$$], {{{2, 1, 0, 0, 0, 0, 1, 2}, {3, 1, 0, 0, 0,
        0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 4}, {5, 1, 0, 0, 0, 0, 1, 5}, {6, 1, 
       0, 0, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0, 1, 4}, {3, 1, 0, 0, 0, 0, 1, 
       3}, {2, 1, 0, 0, 0, 0, 1, 2}}}}}, {{
       Hold[$CellContext`wfrom$$], {}}}, {{
       Hold[$CellContext`wto$$], {}}}, {{
       Hold[$CellContext`wpiece$$], {}}}, {{
       Hold[$CellContext`bfrom$$], {}}}, {{
       Hold[$CellContext`bto$$], {}}}, {{
       Hold[$CellContext`bpiece$$], {}}}, {{
       Hold[$CellContext`unmoveda1$$], True}}, {{
       Hold[$CellContext`unmoveda8$$], True}}, {{
       Hold[$CellContext`unmovedh1$$], True}}, {{
       Hold[$CellContext`unmovedh8$$], True}}, {{
       Hold[$CellContext`epwhite$$], {0, 0}}}, {{
       Hold[$CellContext`epblack$$], {0, 0}}}, {{
       Hold[$CellContext`r$$], 0}}, {{
       Hold[$CellContext`f$$], 0}}, {{
       Hold[$CellContext`capture$$], "-"}}, {{
       Hold[$CellContext`captures$$], {{"-", "-"}}}}, {{
       Hold[$CellContext`checks$$], {{" ", " "}}}}, {{
       Hold[$CellContext`part1$$], False}}, {{
       Hold[$CellContext`part2$$], False}}, {{
       Hold[$CellContext`ok$$], False}}, {{
       Hold[$CellContext`eastok$$], False}}, {{
       Hold[$CellContext`westok$$], False}}, {{
       Hold[$CellContext`southok$$], False}}, {{
       Hold[$CellContext`northok$$], False}}, {{
       Hold[$CellContext`x$$], 0}}, {{
       Hold[$CellContext`y$$], 0}}, {{
       Hold[$CellContext`swattacked$$], False}}}, Typeset`size$$ = {
    400., {198., 202.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = False, $CellContext`colw$396$$ = 
    0, $CellContext`colb$397$$ = 0, $CellContext`randomwhite$398$$ = 
    False, $CellContext`randomblack$399$$ = 
    False, $CellContext`showmoves$400$$ = 
    False, $CellContext`showtargets$401$$ = False, $CellContext`prom$402$$ = 
    0, $CellContext`edit$403$$ = 0, $CellContext`h$404$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`bfrom$$ = {}, $CellContext`bpiece$$ = {}, \
$CellContext`bto$$ = {}, $CellContext`capture$$ = 
        "-", $CellContext`captures$$ = {{
          "-", "-"}}, $CellContext`checks$$ = {{
          " ", " "}}, $CellContext`colb$$ = 1, $CellContext`colw$$ = 
        1, $CellContext`eastok$$ = False, $CellContext`edit$$ = 
        "play", $CellContext`epblack$$ = {0, 0}, $CellContext`epwhite$$ = {0, 
         0}, $CellContext`f$$ = 
        0, $CellContext`from$$ = {0, 0}, $CellContext`h$$ = 
        1, $CellContext`i$$ = 0, $CellContext`j$$ = 0, $CellContext`kx$$ = 
        0, $CellContext`ky$$ = 
        0, $CellContext`list$$ = {{{0, 0}, {0, 0}}}, $CellContext`n$$ = 
        1, $CellContext`northok$$ = False, $CellContext`ok$$ = 
        False, $CellContext`oldfrom$$ = {0, 0}, $CellContext`part1$$ = 
        False, $CellContext`part2$$ = 
        False, $CellContext`pos$$ = {0, 0}, $CellContext`prom$$ = 
        "queen", $CellContext`r$$ = 0, $CellContext`randomblack$$ = 
        False, $CellContext`randomwhite$$ = False, $CellContext`showmoves$$ = 
        False, $CellContext`showtargets$$ = 
        True, $CellContext`side$$ = {{1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 
         0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
         0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {
         1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
         0, -1, -1}}, $CellContext`sides$$ = {{{1, 1, 0, 0, 0, 0, -1, -1}, {1,
          1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
         0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {
         1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
         0, -1, -1}}}, $CellContext`southok$$ = 
        False, $CellContext`swattacked$$ = 
        False, $CellContext`to$$ = {0, 0}, $CellContext`type$$ = {{2, 1, 0, 0,
          0, 0, 1, 2}, {3, 1, 0, 0, 0, 0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 4}, {5,
          1, 0, 0, 0, 0, 1, 5}, {6, 1, 0, 0, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0, 
         1, 4}, {3, 1, 0, 0, 0, 0, 1, 3}, {2, 1, 0, 0, 0, 0, 1, 
         2}}, $CellContext`types$$ = {{{2, 1, 0, 0, 0, 0, 1, 2}, {3, 1, 0, 0, 
         0, 0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 4}, {5, 1, 0, 0, 0, 0, 1, 5}, {6, 
         1, 0, 0, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0, 1, 4}, {3, 1, 0, 0, 0, 0, 1,
          3}, {2, 1, 0, 0, 0, 0, 1, 2}}}, $CellContext`unmoveda1$$ = 
        True, $CellContext`unmoveda8$$ = True, $CellContext`unmovedh1$$ = 
        True, $CellContext`unmovedh8$$ = True, $CellContext`westok$$ = 
        False, $CellContext`wfrom$$ = {}, $CellContext`wpiece$$ = {}, \
$CellContext`wto$$ = {}, $CellContext`x$$ = 0, $CellContext`y$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`colw$$, $CellContext`colw$396$$, 0], 
        Hold[$CellContext`colb$$, $CellContext`colb$397$$, 0], 
        Hold[$CellContext`randomwhite$$, $CellContext`randomwhite$398$$, 
         False], 
        Hold[$CellContext`randomblack$$, $CellContext`randomblack$399$$, 
         False], 
        Hold[$CellContext`showmoves$$, $CellContext`showmoves$400$$, False], 
        Hold[$CellContext`showtargets$$, $CellContext`showtargets$401$$, 
         False], 
        Hold[$CellContext`prom$$, $CellContext`prom$402$$, 0], 
        Hold[$CellContext`edit$$, $CellContext`edit$403$$, 0], 
        Hold[$CellContext`h$$, $CellContext`h$404$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`f$$ = Floor[$CellContext`h$$ $CellContext`r$$]; 
       If[
         And[$CellContext`list$$ == $CellContext`list0, $CellContext`from$$ == \
{0, 0}, $CellContext`to$$ == {0, 0}], 
         Do[$CellContext`t = 
            Part[$CellContext`type$$, $CellContext`x$$, $CellContext`y$$]; \
$CellContext`s = 
            Part[$CellContext`side$$, $CellContext`x$$, $CellContext`y$$]; 
           If[
             
             And[$CellContext`t == $CellContext`pp, $CellContext`s == 
              1, $CellContext`n$$ == 1], 
             If[Part[$CellContext`side$$, $CellContext`x$$, $CellContext`y$$ + 
                 1] == 0, $CellContext`list$$ = 
                AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$, $CellContext`y$$ + 1}}]; If[
                 And[$CellContext`y$$ == 2, 
                  Part[$CellContext`side$$, $CellContext`x$$, 4] == 
                  0], $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, 
                    2}, {$CellContext`x$$, 4}}]]]; 
             If[{$CellContext`x$$ + 1, $CellContext`y$$ + 
                 1} == $CellContext`epblack$$, $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$ + 1}}]]; 
             If[{$CellContext`x$$ - 1, $CellContext`y$$ + 
                 1} == $CellContext`epblack$$, $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$ + 1}}]]; If[
               
               And[$CellContext`x$$ < 8, $CellContext`y$$ < 8, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  1, $CellContext`y$$ + 
                  1] == -$CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$ + 1}}]]; If[
               
               And[$CellContext`x$$ > 1, $CellContext`y$$ < 8, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  1, $CellContext`y$$ + 
                  1] == -$CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$ + 1}}]]]; If[
             
             And[$CellContext`t == $CellContext`pp, $CellContext`s == -1, \
$CellContext`n$$ == -1], 
             If[Part[$CellContext`side$$, $CellContext`x$$, $CellContext`y$$ - 
                 1] == 0, $CellContext`list$$ = 
                AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$, $CellContext`y$$ - 1}}]; If[
                 
                 And[$CellContext`y$$ == 7, 
                  Part[$CellContext`side$$, $CellContext`x$$, 5] == 
                  0], $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, 
                    7}, {$CellContext`x$$, 5}}]]]; 
             If[{$CellContext`x$$ + 1, $CellContext`y$$ - 
                 1} == $CellContext`epwhite$$, $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$ - 1}}]]; 
             If[{$CellContext`x$$ - 1, $CellContext`y$$ - 
                 1} == $CellContext`epwhite$$, $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$ - 1}}]]; If[
               
               And[$CellContext`x$$ < 8, $CellContext`y$$ > 1, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  1, $CellContext`y$$ - 
                  1] == -$CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$ - 1}}]]; If[
               
               And[$CellContext`x$$ > 1, $CellContext`y$$ > 1, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  1, $CellContext`y$$ - 
                  1] == -$CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$ - 1}}]]]; If[
             
             And[$CellContext`t == $CellContext`nn, $CellContext`s == \
$CellContext`n$$], If[
               
               And[$CellContext`x$$ > 1, $CellContext`y$$ > 2, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  1, $CellContext`y$$ - 
                  2] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$ - 2}}]]; If[
               
               And[$CellContext`x$$ > 1, $CellContext`y$$ < 7, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  1, $CellContext`y$$ + 
                  2] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$ + 2}}]]; If[
               
               And[$CellContext`x$$ > 2, $CellContext`y$$ > 1, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  2, $CellContext`y$$ - 
                  1] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 2, $CellContext`y$$ - 1}}]]; If[
               And[$CellContext`x$$ > 2, $CellContext`y$$ < 8, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  2, $CellContext`y$$ + 
                  1] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 2, $CellContext`y$$ + 1}}]]; If[
               
               And[$CellContext`x$$ < 8, $CellContext`y$$ < 7, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  1, $CellContext`y$$ + 
                  2] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$ + 2}}]]; If[
               
               And[$CellContext`x$$ < 8, $CellContext`y$$ > 2, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  1, $CellContext`y$$ - 
                  2] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$ - 2}}]]; If[
               
               And[$CellContext`x$$ < 7, $CellContext`y$$ > 1, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  2, $CellContext`y$$ - 
                  1] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 2, $CellContext`y$$ - 1}}]]; If[
               
               And[$CellContext`x$$ < 7, $CellContext`y$$ < 8, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  2, $CellContext`y$$ + 
                  1] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 2, $CellContext`y$$ + 1}}]]]; If[
             And[
              
              Or[$CellContext`t == $CellContext`bb, $CellContext`t == \
$CellContext`qq], $CellContext`s == $CellContext`n$$], 
             For[$CellContext`i$$ = 1, 
               
               And[$CellContext`x$$ + $CellContext`i$$ < 
                9, $CellContext`y$$ + $CellContext`i$$ < 9], 
               Increment[$CellContext`i$$], 
               If[Part[$CellContext`side$$, $CellContext`x$$ + \
$CellContext`i$$, $CellContext`y$$ + $CellContext`i$$] != $CellContext`n$$, \
$CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + $CellContext`i$$, $CellContext`y$$ + \
$CellContext`i$$}}]]; 
               If[Part[$CellContext`side$$, $CellContext`x$$ + \
$CellContext`i$$, $CellContext`y$$ + $CellContext`i$$] != 0, 
                 Break[]]]; For[$CellContext`i$$ = 1, 
               
               And[$CellContext`x$$ + $CellContext`i$$ < 
                9, $CellContext`y$$ - $CellContext`i$$ > 0], 
               Increment[$CellContext`i$$], 
               If[Part[$CellContext`side$$, $CellContext`x$$ + \
$CellContext`i$$, $CellContext`y$$ - $CellContext`i$$] != $CellContext`n$$, \
$CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + $CellContext`i$$, $CellContext`y$$ - \
$CellContext`i$$}}]]; 
               If[Part[$CellContext`side$$, $CellContext`x$$ + \
$CellContext`i$$, $CellContext`y$$ - $CellContext`i$$] != 0, 
                 Break[]]]; For[$CellContext`i$$ = 1, 
               
               And[$CellContext`x$$ - $CellContext`i$$ > 
                0, $CellContext`y$$ + $CellContext`i$$ < 9], 
               Increment[$CellContext`i$$], 
               If[Part[$CellContext`side$$, $CellContext`x$$ - \
$CellContext`i$$, $CellContext`y$$ + $CellContext`i$$] != $CellContext`n$$, \
$CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - $CellContext`i$$, $CellContext`y$$ + \
$CellContext`i$$}}]]; 
               If[Part[$CellContext`side$$, $CellContext`x$$ - \
$CellContext`i$$, $CellContext`y$$ + $CellContext`i$$] != 0, 
                 Break[]]]; For[$CellContext`i$$ = 1, 
               
               And[$CellContext`x$$ - $CellContext`i$$ > 
                0, $CellContext`y$$ - $CellContext`i$$ > 0], 
               Increment[$CellContext`i$$], 
               If[Part[$CellContext`side$$, $CellContext`x$$ - \
$CellContext`i$$, $CellContext`y$$ - $CellContext`i$$] != $CellContext`n$$, \
$CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - $CellContext`i$$, $CellContext`y$$ - \
$CellContext`i$$}}]]; 
               If[Part[$CellContext`side$$, $CellContext`x$$ - \
$CellContext`i$$, $CellContext`y$$ - $CellContext`i$$] != 0, 
                 Break[]]]]; If[
             And[
              
              Or[$CellContext`t == $CellContext`rr, $CellContext`t == \
$CellContext`qq], $CellContext`s == $CellContext`n$$], 
             For[$CellContext`i$$ = $CellContext`x$$ + 1, $CellContext`i$$ < 
               9, 
               Increment[$CellContext`i$$], 
               If[Part[$CellContext`side$$, $CellContext`i$$, \
$CellContext`y$$] != $CellContext`n$$, $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`i$$, $CellContext`y$$}}]]; 
               If[Part[$CellContext`side$$, $CellContext`i$$, \
$CellContext`y$$] != 0, 
                 Break[]]]; 
             For[$CellContext`i$$ = $CellContext`x$$ - 1, $CellContext`i$$ > 
               0, 
               Decrement[$CellContext`i$$], 
               If[Part[$CellContext`side$$, $CellContext`i$$, \
$CellContext`y$$] != $CellContext`n$$, $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`i$$, $CellContext`y$$}}]]; 
               If[Part[$CellContext`side$$, $CellContext`i$$, \
$CellContext`y$$] != 0, 
                 Break[]]]; 
             For[$CellContext`i$$ = $CellContext`y$$ + 1, $CellContext`i$$ < 
               9, 
               Increment[$CellContext`i$$], 
               If[Part[$CellContext`side$$, $CellContext`x$$, \
$CellContext`i$$] != $CellContext`n$$, $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$, $CellContext`i$$}}]]; 
               If[Part[$CellContext`side$$, $CellContext`x$$, \
$CellContext`i$$] != 0, 
                 Break[]]]; 
             For[$CellContext`i$$ = $CellContext`y$$ - 1, $CellContext`i$$ > 
               0, 
               Decrement[$CellContext`i$$], 
               If[
                Part[$CellContext`side$$, $CellContext`x$$, $CellContext`i$$] != \
$CellContext`n$$, $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$, $CellContext`i$$}}]]; 
               If[Part[$CellContext`side$$, $CellContext`x$$, \
$CellContext`i$$] != 0, 
                 Break[]]]]; If[
             
             And[$CellContext`t == $CellContext`kk, $CellContext`s == \
$CellContext`n$$], $CellContext`kx$$ = $CellContext`x$$; $CellContext`ky$$ = \
$CellContext`y$$; 
             Part[$CellContext`side$$, $CellContext`x$$, $CellContext`y$$] = 
              0; Part[$CellContext`type$$, $CellContext`x$$, \
$CellContext`y$$] = 0; 
             If[$CellContext`x$$ < 
               8, $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, $CellContext`x$$ + 
                  1, $CellContext`y$$, $CellContext`n$$]; If[
                 Not[$CellContext`swattacked$$], $CellContext`eastok$$ = 
                 True, $CellContext`eastok$$ = False]]; 
             If[$CellContext`x$$ > 
               1, $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, $CellContext`x$$ - 
                  1, $CellContext`y$$, $CellContext`n$$]; If[
                 Not[$CellContext`swattacked$$], $CellContext`westok$$ = 
                 True, $CellContext`westok$$ = False]]; 
             If[$CellContext`y$$ < 
               8, $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, \
$CellContext`x$$, $CellContext`y$$ + 1, $CellContext`n$$]; If[
                 Not[$CellContext`swattacked$$], $CellContext`northok$$ = 
                 True, $CellContext`northok$$ = False]]; 
             If[$CellContext`y$$ > 
               1, $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, \
$CellContext`x$$, $CellContext`y$$ - 1, $CellContext`n$$]; If[
                 Not[$CellContext`swattacked$$], $CellContext`southok$$ = 
                 True, $CellContext`southok$$ = False]]; If[
               
               And[$CellContext`x$$ > 1, $CellContext`westok$$ == True, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  1, $CellContext`y$$] != $CellContext`n$$], \
$CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$}}]]; If[
               
               And[$CellContext`x$$ < 8, $CellContext`eastok$$ == True, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  1, $CellContext`y$$] != $CellContext`n$$], \
$CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$}}]]; If[
               
               And[$CellContext`y$$ > 1, $CellContext`southok$$ == True, 
                Part[$CellContext`side$$, $CellContext`x$$, $CellContext`y$$ - 
                  1] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$, $CellContext`y$$ - 1}}]]; If[
               
               And[$CellContext`y$$ < 8, $CellContext`northok$$ == True, 
                Part[$CellContext`side$$, $CellContext`x$$, $CellContext`y$$ + 
                  1] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$, $CellContext`y$$ + 1}}]]; If[
               
               And[$CellContext`x$$ > 1, $CellContext`y$$ > 1, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  1, $CellContext`y$$ - 
                  1] != $CellContext`n$$], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, $CellContext`x$$ - 
                  1, $CellContext`y$$ - 1, $CellContext`n$$]; If[
                 Not[$CellContext`swattacked$$], $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$ - 1}}]]]; If[
               
               And[$CellContext`x$$ > 1, $CellContext`y$$ < 8, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  1, $CellContext`y$$ + 
                  1] != $CellContext`n$$], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, $CellContext`x$$ - 
                  1, $CellContext`y$$ + 1, $CellContext`n$$]; If[
                 Not[$CellContext`swattacked$$], $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$ + 1}}]]]; If[
               
               And[$CellContext`x$$ < 8, $CellContext`y$$ > 1, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  1, $CellContext`y$$ - 
                  1] != $CellContext`n$$], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, $CellContext`x$$ + 
                  1, $CellContext`y$$ - 1, $CellContext`n$$]; If[
                 Not[$CellContext`swattacked$$], $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$ - 1}}]]]; If[
               
               And[$CellContext`x$$ < 8, $CellContext`y$$ < 8, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  1, $CellContext`y$$ + 
                  1] != $CellContext`n$$], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, $CellContext`x$$ + 
                  1, $CellContext`y$$ + 1, $CellContext`n$$]; If[
                 Not[$CellContext`swattacked$$], $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$ + 
                    1}}]]]; $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, \
$CellContext`x$$, $CellContext`y$$, $CellContext`n$$]; If[
               Not[$CellContext`swattacked$$], If[
                 
                 And[{$CellContext`x$$, $CellContext`y$$} == {5, 
                   1}, $CellContext`westok$$ == 
                  True, $CellContext`unmoveda1$$ == True, 
                  Part[$CellContext`side$$, 1, 1] == $CellContext`n$$, 
                  Part[$CellContext`side$$, 4, 1] == 0, 
                  Part[$CellContext`side$$, 3, 1] == 0, 
                  Part[$CellContext`side$$, 2, 1] == 
                  0], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, 3, 
                    1, $CellContext`n$$]; If[
                   Not[$CellContext`swattacked$$], $CellContext`list$$ = 
                   AppendTo[$CellContext`list$$, {{5, 1}, {3, 1}}]]]; If[
                 
                 And[{$CellContext`x$$, $CellContext`y$$} == {5, 
                   1}, $CellContext`eastok$$ == 
                  True, $CellContext`unmovedh1$$ == True, 
                  Part[$CellContext`side$$, 8, 1] == $CellContext`n$$, 
                  Part[$CellContext`side$$, 6, 1] == 0, 
                  Part[$CellContext`side$$, 7, 1] == 
                  0], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, 7, 
                    1, $CellContext`n$$]; If[
                   Not[$CellContext`swattacked$$], $CellContext`list$$ = 
                   AppendTo[$CellContext`list$$, {{5, 1}, {7, 1}}]]]; If[
                 
                 And[{$CellContext`x$$, $CellContext`y$$} == {5, 
                   8}, $CellContext`westok$$ == 
                  True, $CellContext`unmoveda8$$ == True, 
                  Part[$CellContext`side$$, 1, 8] == $CellContext`n$$, 
                  Part[$CellContext`side$$, 4, 8] == 0, 
                  Part[$CellContext`side$$, 3, 8] == 0, 
                  Part[$CellContext`side$$, 2, 8] == 
                  0], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, 3, 
                    8, $CellContext`n$$]; If[
                   Not[$CellContext`swattacked$$], $CellContext`list$$ = 
                   AppendTo[$CellContext`list$$, {{5, 8}, {3, 8}}]]]; If[
                 
                 And[{$CellContext`x$$, $CellContext`y$$} == {5, 
                   8}, $CellContext`eastok$$ == 
                  True, $CellContext`unmovedh8$$ == True, 
                  Part[$CellContext`side$$, 8, 8] == $CellContext`n$$, 
                  Part[$CellContext`side$$, 6, 8] == 0, 
                  Part[$CellContext`side$$, 7, 8] == 
                  0], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, 7, 
                    8, $CellContext`n$$]; If[
                   Not[$CellContext`swattacked$$], $CellContext`list$$ = 
                   AppendTo[$CellContext`list$$, {{5, 8}, {7, 8}}]]]]; 
             Part[$CellContext`side$$, $CellContext`x$$, $CellContext`y$$] = \
$CellContext`n$$; 
             Part[$CellContext`type$$, $CellContext`x$$, $CellContext`y$$] = \
$CellContext`kk], {$CellContext`x$$, 8}, {$CellContext`y$$, 
            8}]; $CellContext`l = Length[$CellContext`list$$]; 
         Do[$CellContext`a = 
            Part[$CellContext`list$$, $CellContext`j$$, 1]; $CellContext`b = 
            Part[$CellContext`list$$, $CellContext`j$$, 2]; $CellContext`ax = 
            Part[$CellContext`a, 1]; $CellContext`ay = 
            Part[$CellContext`a, 2]; $CellContext`bx = 
            Part[$CellContext`b, 1]; $CellContext`by = 
            Part[$CellContext`b, 2]; $CellContext`t = 
            Part[$CellContext`type$$, $CellContext`ax, $CellContext`ay]; 
           If[$CellContext`t != $CellContext`kk, 
             Part[$CellContext`side$$, $CellContext`ax, $CellContext`ay] = (
               Part[$CellContext`type$$, $CellContext`ax, $CellContext`ay] = 
               0); $CellContext`olds = 
              Part[$CellContext`side$$, $CellContext`bx, $CellContext`by]; \
$CellContext`oldt = 
              Part[$CellContext`type$$, $CellContext`bx, $CellContext`by]; 
             Part[$CellContext`side$$, $CellContext`bx, $CellContext`by] = \
$CellContext`n$$; 
             Part[$CellContext`type$$, $CellContext`bx, $CellContext`by] = \
$CellContext`t; $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, \
$CellContext`kx$$, $CellContext`ky$$, $CellContext`n$$]; 
             Part[$CellContext`side$$, $CellContext`ax, $CellContext`ay] = \
$CellContext`n$$; 
             Part[$CellContext`type$$, $CellContext`ax, $CellContext`ay] = \
$CellContext`t; 
             Part[$CellContext`side$$, $CellContext`bx, $CellContext`by] = \
$CellContext`olds; 
             Part[$CellContext`type$$, $CellContext`bx, $CellContext`by] = \
$CellContext`oldt; 
             If[$CellContext`swattacked$$, 
               Part[$CellContext`list$$, $CellContext`j$$] = {{0, 0}, {0, 
                0}}]], {$CellContext`j$$, 
            2, $CellContext`l}]; $CellContext`list1 = $CellContext`list0; Do[
           If[
           Part[$CellContext`list$$, $CellContext`j$$] != {{0, 0}, {0, 
             0}}, $CellContext`list1 = AppendTo[$CellContext`list1, 
              
              Part[$CellContext`list$$, $CellContext`j$$]]], \
{$CellContext`j$$, 
            2, $CellContext`l}]; $CellContext`list$$ = $CellContext`list1]; \
$CellContext`l = Length[$CellContext`list$$]; ClickPane[
         Graphics[{$CellContext`board, 
           EdgeForm[Thin], 
           If[$CellContext`f$$ == $CellContext`r$$, 
            Table[{
              If[
              Part[$CellContext`side$$, $CellContext`i$$, $CellContext`j$$] == 
               1, 
               Which[$CellContext`colw$$ == 1, 
                RGBColor[0.9, 0.9, 0.5], $CellContext`colw$$ == 2, 
                RGBColor[0.7, 0.7, 0.4], $CellContext`colw$$ == 3, 
                RGBColor[0.9, 0.3, 0.3]], 
               Which[$CellContext`colb$$ == 1, 
                RGBColor[0.4, 0.4, 0.3], $CellContext`colb$$ == 2, 
                RGBColor[0.3, 0.4, 0.1], $CellContext`colb$$ == 3, 
                RGBColor[0.2, 0.5, 0.5]]], 
              Which[
              Part[$CellContext`type$$, $CellContext`i$$, $CellContext`j$$] == \
$CellContext`pp, 
               
               Translate[$CellContext`pawn, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`type$$, $CellContext`i$$, $CellContext`j$$] == \
$CellContext`rr, 
               
               Translate[$CellContext`rook, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`type$$, $CellContext`i$$, $CellContext`j$$] == \
$CellContext`nn, 
               
               Translate[$CellContext`knight, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`type$$, $CellContext`i$$, $CellContext`j$$] == \
$CellContext`bb, 
               
               Translate[$CellContext`bishop, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`type$$, $CellContext`i$$, $CellContext`j$$] == \
$CellContext`qq, 
               
               Translate[$CellContext`queen, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`type$$, $CellContext`i$$, $CellContext`j$$] == \
$CellContext`kk, 
               
               Translate[$CellContext`king, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`type$$, $CellContext`i$$, $CellContext`j$$] == 
               0, {}]}, {$CellContext`i$$, 8}, {$CellContext`j$$, 8}], {}], 
           If[$CellContext`f$$ < $CellContext`r$$, 
            Table[{
              If[
              Part[$CellContext`sides$$, $CellContext`f$$ + 
                 1, $CellContext`i$$, $CellContext`j$$] == 1, 
               Which[$CellContext`colw$$ == 1, 
                RGBColor[0.9, 0.9, 0.5], $CellContext`colw$$ == 2, 
                RGBColor[0.7, 0.7, 0.4], $CellContext`colw$$ == 3, 
                RGBColor[0.9, 0.3, 0.3]], 
               Which[$CellContext`colb$$ == 1, 
                RGBColor[0.4, 0.4, 0.3], $CellContext`colb$$ == 2, 
                RGBColor[0.3, 0.4, 0.1], $CellContext`colb$$ == 3, 
                RGBColor[0.2, 0.5, 0.5]]], 
              Which[
              Part[$CellContext`types$$, $CellContext`f$$ + 
                 1, $CellContext`i$$, $CellContext`j$$] == $CellContext`pp, 
               
               Translate[$CellContext`pawn, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`types$$, $CellContext`f$$ + 
                 1, $CellContext`i$$, $CellContext`j$$] == $CellContext`rr, 
               
               Translate[$CellContext`rook, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`types$$, $CellContext`f$$ + 
                 1, $CellContext`i$$, $CellContext`j$$] == $CellContext`nn, 
               
               Translate[$CellContext`knight, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`types$$, $CellContext`f$$ + 
                 1, $CellContext`i$$, $CellContext`j$$] == $CellContext`bb, 
               
               Translate[$CellContext`bishop, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`types$$, $CellContext`f$$ + 
                 1, $CellContext`i$$, $CellContext`j$$] == $CellContext`qq, 
               
               Translate[$CellContext`queen, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`types$$, $CellContext`f$$ + 
                 1, $CellContext`i$$, $CellContext`j$$] == $CellContext`kk, 
               
               Translate[$CellContext`king, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`types$$, $CellContext`f$$ + 
                 1, $CellContext`i$$, $CellContext`j$$] == 
               0, {}]}, {$CellContext`i$$, 8}, {$CellContext`j$$, 8}], {}], 
           Green, 
           If[
            
            And[$CellContext`showtargets$$, $CellContext`h$$ == 
             1, $CellContext`from$$ != {0, 0}, $CellContext`to$$ == {0, 0}], 
            Table[
             If[
             Part[$CellContext`list$$, $CellContext`i$$, 
                1] == $CellContext`oldfrom$$, 
              
              Disk[{Part[$CellContext`list$$, $CellContext`i$$, 2, 1] - 0.5, 
                Part[$CellContext`list$$, $CellContext`i$$, 2, 2] - 0.5}, 
               0.2], {}], {$CellContext`i$$, $CellContext`l}], {}], 
           If[
            
            And[$CellContext`showmoves$$, $CellContext`h$$ == 
             1, $CellContext`from$$ == {0, 0}], 
            Table[
             
             Arrow[{Part[$CellContext`list$$, $CellContext`i$$, 1] - {0.5, 
               0.5}, Part[$CellContext`list$$, $CellContext`i$$, 2] - {0.5, 
               0.5}}], {$CellContext`i$$, 2, $CellContext`l}], {}], 
           If[$CellContext`unmoveda1$$, Green, Red], 
           If[$CellContext`edit$$ == "castling options", 
            Disk[{0.5, 0.5}, 0.2], {}], 
           If[$CellContext`unmovedh1$$, Green, Red], 
           If[$CellContext`edit$$ == "castling options", 
            Disk[{7.5, 0.5}, 0.2], {}], 
           If[$CellContext`unmoveda8$$, Green, Red], 
           If[$CellContext`edit$$ == "castling options", 
            Disk[{0.5, 7.5}, 0.2], {}], 
           If[$CellContext`unmovedh8$$, Green, Red], 
           If[$CellContext`edit$$ == "castling options", 
            Disk[{7.5, 7.5}, 0.2], {}], Yellow, 
           If[$CellContext`from$$ != {0, 0}, 
            Disk[$CellContext`from$$ - {0.5, 0.5}, 0.2], {}], Black, 
           If[$CellContext`n$$ == 1, 
            Disk[{0, 0}, 0.1], 
            Disk[{0, 8}, 0.1]], 
           If[$CellContext`f$$ > 0, 
            If[Part[$CellContext`wfrom$$, $CellContext`f$$] != {0, 0}, 
             Text[
              Style[
               Row[{$CellContext`f$$, ". ", 
                 Part[$CellContext`names, 
                  Part[$CellContext`wpiece$$, $CellContext`f$$]], 
                 Part[$CellContext`alpha, 
                  Part[$CellContext`wfrom$$, $CellContext`f$$, 1]], 
                 Part[$CellContext`wfrom$$, $CellContext`f$$, 2], " ", 
                 Part[$CellContext`captures$$, $CellContext`f$$, 1]}], 12], {
              2.95, -0.5}], 
             Text[
              Style[
               Row[{$CellContext`f$$, ". ", "... - ..."}], 12], {
              2.95, -0.5}]], 
            Text[" ", {2.8, -0.5}]], 
           If[
            And[
             Inequality[
              Length[$CellContext`wto$$], GreaterEqual, $CellContext`f$$, 
              Greater, 0], 
             Part[$CellContext`wto$$, $CellContext`f$$] != {0, 0}], {
             Text[
              Style[
               Row[{
                 Part[$CellContext`alpha, 
                  Part[$CellContext`wto$$, $CellContext`f$$, 1]], 
                 Part[$CellContext`wto$$, $CellContext`f$$, 2], 
                 Part[$CellContext`checks$$, $CellContext`f$$, 1]}], 12], {
              3.75, -0.5}], 
             If[
              
              And[$CellContext`l == 1, $CellContext`h$$ == 1, 
               Length[$CellContext`bto$$] < $CellContext`r$$], 
              If[Part[$CellContext`checks$$, $CellContext`f$$, 1] == "+", 
               Text[
                Style[
                 Row[{"mate"}], 12], {4.4, -0.5}], 
               Text[
                Style[
                 Row[{"stalemate"}], 12], {4.4, -0.5}]], {}]}, {}], 
           If[
            Inequality[
             Length[$CellContext`bfrom$$], GreaterEqual, $CellContext`f$$, 
             Greater, 0], 
            Text[
             Style[
              Row[{
                Part[$CellContext`names, 
                 Part[$CellContext`bpiece$$, $CellContext`f$$]], 
                Part[$CellContext`alpha, 
                 Part[$CellContext`bfrom$$, $CellContext`f$$, 1]], 
                Part[$CellContext`bfrom$$, $CellContext`f$$, 2], " ", 
                Part[$CellContext`captures$$, $CellContext`f$$, 2]}], 12], {
             4.4, -0.5}], {}], 
           If[
            Inequality[
             Length[$CellContext`bto$$], GreaterEqual, $CellContext`f$$, 
             Greater, 0], {
             Text[
              Style[
               Row[{
                 Part[$CellContext`alpha, 
                  Part[$CellContext`bto$$, $CellContext`f$$, 1]], 
                 Part[$CellContext`bto$$, $CellContext`f$$, 2], 
                 Part[$CellContext`checks$$, $CellContext`f$$, 2]}], 12], {
              5., -0.5}], 
             If[
              And[$CellContext`l == 1, $CellContext`h$$ == 1], 
              If[Part[$CellContext`checks$$, $CellContext`f$$, 2] == "+", 
               Text[
                Style[
                 Row[{"mate"}], 12], {5.8, -0.5}], 
               Text[
                Style[
                 Row[{"stalemate"}], 12], {5.8, -0.5}]], {}]}, {}]}, 
          PlotRange -> {{-0.1, 8.1}, {-0.9, 8.1}}, ImageSize -> {400, 400}], {
         
          If[
           And[$CellContext`h$$ == 1, 
            Or[
            Length[$CellContext`list$$] > 1, $CellContext`edit$$ != 
             "play"]], {$CellContext`pos$$ = Floor[#] + {1, 1}, 
            Part[$CellContext`pos$$, 1] = Max[
              Part[$CellContext`pos$$, 1], 1], Part[$CellContext`pos$$, 1] = 
            Min[
              Part[$CellContext`pos$$, 1], 8], Part[$CellContext`pos$$, 2] = 
            Max[
              Part[$CellContext`pos$$, 2], 1], Part[$CellContext`pos$$, 2] = 
            Min[
              Part[$CellContext`pos$$, 2], 8], 
            If[
             Not[$CellContext`part1$$], 
             Which[$CellContext`edit$$ == "play", {}, $CellContext`edit$$ == 
               "delete", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 0; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 0, $CellContext`edit$$ == 
               "white pawn", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 1, $CellContext`edit$$ == 
               "white rook", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 2, $CellContext`edit$$ == 
               "white knight", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 3, $CellContext`edit$$ == 
               "white bishop", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 4, $CellContext`edit$$ == 
               "white queen", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 5, $CellContext`edit$$ == 
               "white king", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 6, $CellContext`edit$$ == 
               "black pawn", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = -1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 1, $CellContext`edit$$ == 
               "black rook", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = -1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 2, $CellContext`edit$$ == 
               "black knight", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = -1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 3, $CellContext`edit$$ == 
               "black bishop", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = -1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 4, $CellContext`edit$$ == 
               "black queen", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = -1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 5, $CellContext`edit$$ == 
               "black king", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = -1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 6, 
               
               And[$CellContext`edit$$ == "next player", $CellContext`r$$ == 
                0], $CellContext`n$$ = -$CellContext`n$$]; 
             If[$CellContext`edit$$ != 
               "play", $CellContext`list$$ = $CellContext`list0]], 
            If[
             
             And[$CellContext`edit$$ == "castling options", 
              Part[$CellContext`type$$, 
                Part[$CellContext`pos$$, 1], 
                Part[$CellContext`pos$$, 2]] == $CellContext`rr], 
             If[$CellContext`pos$$ == {1, 1}, $CellContext`unmoveda1$$ = 
               Not[$CellContext`unmoveda1$$]]; 
             If[$CellContext`pos$$ == {8, 1}, $CellContext`unmovedh1$$ = 
               Not[$CellContext`unmovedh1$$]]; 
             If[$CellContext`pos$$ == {1, 8}, $CellContext`unmoveda8$$ = 
               Not[$CellContext`unmoveda8$$]]; 
             If[$CellContext`pos$$ == {8, 8}, $CellContext`unmovedh8$$ = 
               Not[$CellContext`unmovedh8$$]], {}], 
            
            If[$CellContext`edit$$ == 
             "reset", $CellContext`r$$ = 0; $CellContext`edit$$ = 
              "play"; $CellContext`wto$$ = ($CellContext`wfrom$$ = \
($CellContext`bfrom$$ = ($CellContext`bto$$ = ($CellContext`wpiece$$ = \
($CellContext`bpiece$$ = {}))))); $CellContext`side$$ = $CellContext`side0; \
$CellContext`type$$ = $CellContext`type0; $CellContext`list$$ = \
$CellContext`list0; $CellContext`sides$$ = {$CellContext`side0}; \
$CellContext`types$$ = {$CellContext`type0}; $CellContext`part1$$ = \
($CellContext`part2$$ = False); $CellContext`ok$$ = 
              False; $CellContext`from$$ = ($CellContext`to$$ = \
($CellContext`epwhite$$ = ($CellContext`epblack$$ = {0, 
                  0}))); $CellContext`n$$ = 
              1; $CellContext`unmoveda1$$ = ($CellContext`unmoveda8$$ = \
($CellContext`unmovedh1$$ = ($CellContext`unmovedh8$$ = True)))], 
            
            If[$CellContext`edit$$ == 
             "clear", $CellContext`r$$ = 
              0; $CellContext`wto$$ = ($CellContext`wfrom$$ = \
($CellContext`bfrom$$ = ($CellContext`bto$$ = ($CellContext`wpiece$$ = \
($CellContext`bpiece$$ = {}))))); $CellContext`list$$ = $CellContext`list0; \
$CellContext`side$$ = ($CellContext`type$$ = $CellContext`all0); \
$CellContext`sides$$ = ($CellContext`types$$ = {$CellContext`all0}); \
$CellContext`part1$$ = ($CellContext`part2$$ = False); $CellContext`ok$$ = 
              False; $CellContext`from$$ = ($CellContext`to$$ = \
($CellContext`epwhite$$ = ($CellContext`epblack$$ = {0, 
                  0}))); $CellContext`n$$ = 
              1; $CellContext`unmoveda1$$ = ($CellContext`unmoveda8$$ = \
($CellContext`unmovedh1$$ = ($CellContext`unmovedh8$$ = True)))], 
            If[$CellContext`edit$$ == "play", {
              If[
               Or[
                And[$CellContext`n$$ == 1, 
                 Not[$CellContext`randomwhite$$]], 
                And[$CellContext`n$$ == -1, 
                 Not[$CellContext`randomblack$$]]], {$CellContext`l = 
                Length[$CellContext`list$$], $CellContext`part1$$ = \
($CellContext`part2$$ = False), 
                If[
                 And[
                 Part[$CellContext`from$$, 1] == 0, $CellContext`n$$ == 
                  Part[$CellContext`side$$, 
                    Part[$CellContext`pos$$, 1], 
                    Part[$CellContext`pos$$, 2]]], {
                  
                  For[$CellContext`i$$ = 
                   1, $CellContext`i$$ <= $CellContext`l, 
                   Increment[$CellContext`i$$], 
                   If[
                   Part[$CellContext`list$$, $CellContext`i$$, 
                    1] == $CellContext`pos$$, {$CellContext`part1$$ = True, 
                    Break[]}]]}], 
                If[
                 And[
                 Part[$CellContext`from$$, 1] != 0, 
                  Part[$CellContext`to$$, 1] == 0, $CellContext`n$$ != 
                  Part[$CellContext`side$$, 
                    Part[$CellContext`pos$$, 1], 
                    Part[$CellContext`pos$$, 2]]], {
                  
                  For[$CellContext`i$$ = 
                   1, $CellContext`i$$ <= $CellContext`l, 
                   Increment[$CellContext`i$$], 
                   If[
                    And[
                    Part[$CellContext`list$$, $CellContext`i$$, 
                    1] == $CellContext`oldfrom$$, 
                    Part[$CellContext`list$$, $CellContext`i$$, 
                    2] == $CellContext`pos$$], {$CellContext`part2$$ = True, 
                    Break[]}]]}], 
                
                If[$CellContext`part1$$, $CellContext`oldfrom$$ = \
($CellContext`from$$ = $CellContext`pos$$); $CellContext`to$$ = {0, 0}], 
                
                If[$CellContext`part2$$, $CellContext`to$$ = \
$CellContext`pos$$], 
                If[
                 
                 And[$CellContext`part1$$, $CellContext`n$$ == 
                  1], $CellContext`r$$ = $CellContext`r$$ + 
                   1; $CellContext`wfrom$$ = 
                  AppendTo[$CellContext`wfrom$$, $CellContext`pos$$]; \
$CellContext`wpiece$$ = AppendTo[$CellContext`wpiece$$, 
                    Part[$CellContext`type$$, 
                    Part[$CellContext`pos$$, 1], 
                    Part[$CellContext`pos$$, 2]]]], 
                If[
                 
                 And[$CellContext`part1$$, $CellContext`n$$ == -1], \
$CellContext`bfrom$$ = 
                  AppendTo[$CellContext`bfrom$$, $CellContext`pos$$]; \
$CellContext`bpiece$$ = AppendTo[$CellContext`bpiece$$, 
                    Part[$CellContext`type$$, 
                    Part[$CellContext`pos$$, 1], 
                    Part[$CellContext`pos$$, 2]]]; 
                 If[$CellContext`r$$ == 
                   0, $CellContext`r$$ = 
                    1; $CellContext`wfrom$$ = ($CellContext`wto$$ = {{0, 
                    0}}); $CellContext`wpiece$$ = {$CellContext`pp}; \
$CellContext`captures$$ = {{"-", "-"}, {"-", "-"}}]], 
                If[
                 And[
                  Not[$CellContext`part1$$], 
                  Not[$CellContext`part2$$]], If[
                   
                   And[$CellContext`from$$ != {0, 0}, $CellContext`to$$ == {0,
                     0}, $CellContext`n$$ == 1], $CellContext`wfrom$$ = 
                    Delete[$CellContext`wfrom$$, $CellContext`r$$]; \
$CellContext`wpiece$$ = 
                    Delete[$CellContext`wpiece$$, $CellContext`r$$]; \
$CellContext`r$$ = $CellContext`r$$ - 1, {}]; If[
                   
                   And[$CellContext`from$$ != {0, 0}, $CellContext`to$$ == {0,
                     0}, $CellContext`n$$ == -1], $CellContext`bfrom$$ = 
                    Delete[$CellContext`wfrom$$, $CellContext`r$$]; \
$CellContext`bpiece$$ = 
                    Delete[$CellContext`bpiece$$, $CellContext`r$$], {}]; \
$CellContext`from$$ = ($CellContext`to$$ = {0, 0})]}], 
              If[
               
               And[$CellContext`randomwhite$$, $CellContext`n$$ == 
                1, $CellContext`from$$ == {0, 0}], $CellContext`i$$ = 
                RandomInteger[{2, 
                   Length[$CellContext`list$$]}]; $CellContext`from$$ = 
                Part[$CellContext`list$$, $CellContext`i$$, 
                  1]; $CellContext`pos$$ = ($CellContext`to$$ = 
                 Part[$CellContext`list$$, $CellContext`i$$, 
                   2]); $CellContext`wfrom$$ = 
                AppendTo[$CellContext`wfrom$$, $CellContext`from$$]; \
$CellContext`wpiece$$ = AppendTo[$CellContext`wpiece$$, 
                  Part[$CellContext`type$$, 
                   Part[$CellContext`from$$, 1], 
                   Part[$CellContext`from$$, 2]]]; $CellContext`captures$$ = 
                Append[$CellContext`captures$$, {
                  "-", "-"}]; $CellContext`checks$$ = 
                Append[$CellContext`checks$$, {
                  " ", " "}]; $CellContext`r$$ = $CellContext`r$$ + 
                 1; $CellContext`part1$$ = False; $CellContext`part2$$ = 
                True], 
              If[
               
               And[$CellContext`randomblack$$, $CellContext`n$$ == -1, \
$CellContext`from$$ == {0, 0}], $CellContext`i$$ = RandomInteger[{2, 
                   Length[$CellContext`list$$]}]; $CellContext`from$$ = 
                Part[$CellContext`list$$, $CellContext`i$$, 
                  1]; $CellContext`pos$$ = ($CellContext`to$$ = 
                 Part[$CellContext`list$$, $CellContext`i$$, 
                   2]); $CellContext`bfrom$$ = 
                AppendTo[$CellContext`bfrom$$, $CellContext`from$$]; \
$CellContext`bpiece$$ = AppendTo[$CellContext`bpiece$$, 
                  Part[$CellContext`type$$, 
                   Part[$CellContext`from$$, 1], 
                   Part[$CellContext`from$$, 2]]]; 
               If[$CellContext`r$$ == 
                 0, $CellContext`r$$ = 
                  1; $CellContext`wfrom$$ = ($CellContext`wto$$ = {{
                    9, 
                    " "}}); $CellContext`wpiece$$ = {$CellContext`pp}]; \
$CellContext`captures$$ = 
                Append[$CellContext`captures$$, {
                  "-", "-"}]; $CellContext`part1$$ = 
                False; $CellContext`part2$$ = True], $CellContext`x$$ = 
              Part[$CellContext`from$$, 1], $CellContext`y$$ = 
              Part[$CellContext`from$$, 2], 
              If[$CellContext`part2$$, {
                If[
                 
                 Or[$CellContext`from$$ == {1, 1}, $CellContext`to$$ == {1, 
                   1}, $CellContext`from$$ == {5, 
                   1}], $CellContext`unmoveda1$$ = False], 
                If[
                 
                 Or[$CellContext`from$$ == {8, 1}, $CellContext`to$$ == {8, 
                   1}, $CellContext`from$$ == {5, 
                   1}], $CellContext`unmovedh1$$ = False], 
                If[
                 
                 Or[$CellContext`from$$ == {1, 8}, $CellContext`to$$ == {1, 
                   8}, $CellContext`from$$ == {5, 
                   8}], $CellContext`unmoveda8$$ = False], 
                If[
                 
                 Or[$CellContext`from$$ == {8, 8}, $CellContext`to$$ == {8, 
                   8}, $CellContext`from$$ == {5, 
                   8}], $CellContext`unmovedh8$$ = False], 
                If[
                 And[
                 Part[$CellContext`type$$, $CellContext`x$$, \
$CellContext`y$$] == $CellContext`pp, $CellContext`y$$ == 2, 
                  Part[$CellContext`to$$, 2] == 
                  4], $CellContext`epwhite$$ = {$CellContext`x$$, 3}], 
                If[
                 And[
                 Part[$CellContext`type$$, $CellContext`x$$, \
$CellContext`y$$] == $CellContext`pp, $CellContext`y$$ == 7, 
                  Part[$CellContext`to$$, 2] == 
                  5], $CellContext`epblack$$ = {$CellContext`x$$, 6}], 
                If[
                 And[
                 Part[$CellContext`type$$, $CellContext`x$$, \
$CellContext`y$$] == $CellContext`pp, 
                  Or[
                  Part[$CellContext`to$$, 2] == 8, Part[$CellContext`to$$, 2] == 
                   1]], 
                 
                 Which[$CellContext`prom$$ == "queen", 
                  Part[$CellContext`type$$, 
                    Part[$CellContext`to$$, 1], 
                    
                    Part[$CellContext`to$$, 
                    2]] = $CellContext`qq, $CellContext`prom$$ == "rook", 
                  Part[$CellContext`type$$, 
                    Part[$CellContext`to$$, 1], 
                    
                    Part[$CellContext`to$$, 
                    2]] = $CellContext`rr, $CellContext`prom$$ == "bishop", 
                  Part[$CellContext`type$$, 
                    Part[$CellContext`to$$, 1], 
                    
                    Part[$CellContext`to$$, 
                    2]] = $CellContext`bb, $CellContext`prom$$ == "knight", 
                  Part[$CellContext`type$$, 
                    Part[$CellContext`to$$, 1], 
                    Part[$CellContext`to$$, 2]] = $CellContext`nn], 
                 Part[$CellContext`type$$, 
                   Part[$CellContext`to$$, 1], 
                   Part[$CellContext`to$$, 2]] = 
                 Part[$CellContext`type$$, $CellContext`x$$, \
$CellContext`y$$]], 
                If[
                Part[$CellContext`type$$, $CellContext`x$$, $CellContext`y$$] == \
$CellContext`kk, If[
                   
                   And[$CellContext`from$$ == {5, 1}, $CellContext`to$$ == {3,
                     1}], Part[$CellContext`type$$, 4, 1] = $CellContext`rr; 
                   Part[$CellContext`type$$, 1, 1] = 0; 
                   Part[$CellContext`side$$, 4, 1] = 1; 
                   Part[$CellContext`side$$, 1, 1] = 0]; If[
                   
                   And[$CellContext`from$$ == {5, 1}, $CellContext`to$$ == {7,
                     1}], Part[$CellContext`type$$, 6, 1] = $CellContext`rr; 
                   Part[$CellContext`type$$, 8, 1] = 0; 
                   Part[$CellContext`side$$, 6, 1] = 1; 
                   Part[$CellContext`side$$, 8, 1] = 0]; If[
                   
                   And[$CellContext`from$$ == {5, 8}, $CellContext`to$$ == {3,
                     8}], Part[$CellContext`type$$, 4, 8] = $CellContext`rr; 
                   Part[$CellContext`type$$, 1, 8] = 0; 
                   Part[$CellContext`side$$, 4, 8] = -1; 
                   Part[$CellContext`side$$, 1, 8] = 0]; If[
                   
                   And[$CellContext`from$$ == {5, 8}, $CellContext`to$$ == {7,
                     8}], Part[$CellContext`type$$, 6, 8] = $CellContext`rr; 
                   Part[$CellContext`type$$, 8, 8] = 0; 
                   Part[$CellContext`side$$, 6, 8] = -1; 
                   Part[$CellContext`side$$, 8, 8] = 
                    0]], $CellContext`capture$$ = "-"; If[
                  And[
                  Part[$CellContext`type$$, $CellContext`x$$, \
$CellContext`y$$] == $CellContext`pp, $CellContext`to$$ == \
$CellContext`epblack$$], Part[$CellContext`type$$, 
                    Part[$CellContext`to$$, 1], Part[$CellContext`to$$, 2] - 
                    1] = 0; Part[$CellContext`side$$, 
                    Part[$CellContext`to$$, 1], Part[$CellContext`to$$, 2] - 
                    1] = 0; $CellContext`capture$$ = "x"], 
                If[
                 And[
                 Part[$CellContext`type$$, $CellContext`x$$, \
$CellContext`y$$] == $CellContext`pp, $CellContext`to$$ == \
$CellContext`epwhite$$], Part[$CellContext`type$$, 
                    Part[$CellContext`to$$, 1], Part[$CellContext`to$$, 2] + 
                    1] = 0; Part[$CellContext`side$$, 
                    Part[$CellContext`to$$, 1], Part[$CellContext`to$$, 2] + 
                    1] = 0; $CellContext`capture$$ = "x"], 
                Part[$CellContext`type$$, $CellContext`x$$, $CellContext`y$$] = 
                0, 
                If[Part[$CellContext`side$$, 
                   Part[$CellContext`to$$, 1], 
                   Part[$CellContext`to$$, 2]] != 0, $CellContext`capture$$ = 
                 "x"], Part[$CellContext`side$$, 
                  Part[$CellContext`to$$, 1], 
                  Part[$CellContext`to$$, 2]] = 
                Part[$CellContext`side$$, $CellContext`x$$, $CellContext`y$$],
                 Part[$CellContext`side$$, $CellContext`x$$, \
$CellContext`y$$] = 0, 
                
                If[$CellContext`n$$ == 
                 1, $CellContext`wto$$ = 
                  AppendTo[$CellContext`wto$$, $CellContext`pos$$]; \
$CellContext`captures$$ = Append[$CellContext`captures$$, {"-", "-"}]; 
                 Part[$CellContext`captures$$, $CellContext`r$$, 
                    1] = $CellContext`capture$$; $CellContext`list$$ = \
$CellContext`list0; $CellContext`checks$$ = 
                  Append[$CellContext`checks$$, {" ", " "}]; Do[
                   If[
                    And[
                    Part[$CellContext`type$$, $CellContext`i$$, \
$CellContext`j$$] == $CellContext`kk, 
                    Part[$CellContext`side$$, $CellContext`i$$, \
$CellContext`j$$] == -$CellContext`n$$], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, \
$CellContext`i$$, $CellContext`j$$, -$CellContext`n$$]; 
                    Break[]], {$CellContext`i$$, 8}, {$CellContext`j$$, 8}]; 
                 If[$CellContext`swattacked$$, 
                   Part[$CellContext`checks$$, $CellContext`r$$, 1] = "+"]], 
                
                If[$CellContext`n$$ == -1, $CellContext`bto$$ = 
                  AppendTo[$CellContext`bto$$, $CellContext`pos$$]; \
$CellContext`sides$$ = 
                  AppendTo[$CellContext`sides$$, $CellContext`side$$]; \
$CellContext`types$$ = AppendTo[$CellContext`types$$, $CellContext`type$$]; 
                 Part[$CellContext`captures$$, $CellContext`r$$, 
                    2] = $CellContext`capture$$; $CellContext`list$$ = \
$CellContext`list0; Do[
                   If[
                    And[
                    Part[$CellContext`type$$, $CellContext`i$$, \
$CellContext`j$$] == $CellContext`kk, 
                    Part[$CellContext`side$$, $CellContext`i$$, \
$CellContext`j$$] == -$CellContext`n$$], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, \
$CellContext`i$$, $CellContext`j$$, -$CellContext`n$$]; 
                    Break[]], {$CellContext`i$$, 8}, {$CellContext`j$$, 8}]; 
                 If[$CellContext`swattacked$$, 
                   Part[$CellContext`checks$$, $CellContext`r$$, 2] = "+"]], 
                
                If[$CellContext`n$$ == 
                 1, $CellContext`epblack$$ = {0, 
                  0}, $CellContext`epwhite$$ = {0, 
                  0}], $CellContext`n$$ = -$CellContext`n$$, \
$CellContext`list$$ = $CellContext`list0, $CellContext`part1$$ = \
($CellContext`part2$$ = 
                 False), $CellContext`from$$ = ($CellContext`to$$ = {0, 
                  0})}]}]}]}& ]), 
      "Specifications" :> {{{$CellContext`colw$$, 1, 
          Style["color White", 10]}, {1, 2, 3}, ControlType -> 
         PopupMenu}, {{$CellContext`colb$$, 1, 
          Style["color Black", 10]}, {1, 2, 3}, ControlType -> 
         PopupMenu}, {{$CellContext`randomwhite$$, False, "random White"}, {
         True, False}}, {{$CellContext`randomblack$$, False, 
          "random Black"}, {
         True, False}}, {{$CellContext`showmoves$$, False, "show moves"}, {
         True, False}}, {{$CellContext`showtargets$$, True, "show targets"}, {
         True, False}}, {{$CellContext`prom$$, "queen", 
          Style["promotion to", 10]}, {"queen", "rook", "bishop", "knight"}, 
         ControlType -> PopupMenu}, {{$CellContext`edit$$, "play", 
          Style["edit position", 10]}, {
         "play", "reset", "clear", "delete", "white pawn", "white knight", 
          "white bishop", "white rook", "white queen", "white king", 
          "black pawn", "black knight", "black bishop", "black rook", 
          "black queen", "black king", "castling options", "next player"}, 
         ControlType -> PopupMenu}, {{$CellContext`h$$, 1, 
          Style["history"]}, 0, 1, ControlType -> Slider, ImageSize -> 
         Small}, {{$CellContext`i$$, 0}, ControlType -> 
         None}, {{$CellContext`j$$, 0}, ControlType -> 
         None}, {{$CellContext`kx$$, 0}, ControlType -> 
         None}, {{$CellContext`ky$$, 0}, ControlType -> 
         None}, {{$CellContext`pos$$, {0, 0}}, ControlType -> 
         None}, {{$CellContext`from$$, {0, 0}}, ControlType -> 
         None}, {{$CellContext`oldfrom$$, {0, 0}}, ControlType -> 
         None}, {{$CellContext`to$$, {0, 0}}, ControlType -> 
         None}, {{$CellContext`side$$, {{1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 
          0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
          0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
          0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
          0, -1, -1}}}, ControlType -> 
         None}, {{$CellContext`type$$, {{2, 1, 0, 0, 0, 0, 1, 2}, {3, 1, 0, 0,
           0, 0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 4}, {5, 1, 0, 0, 0, 0, 1, 5}, {
          6, 1, 0, 0, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0, 1, 4}, {3, 1, 0, 0, 0, 
          0, 1, 3}, {2, 1, 0, 0, 0, 0, 1, 2}}}, ControlType -> 
         None}, {{$CellContext`n$$, 1}, ControlType -> 
         None}, {{$CellContext`list$$, {{{0, 0}, {0, 0}}}}, ControlType -> 
         None}, {{$CellContext`sides$$, {{{1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 
          0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
          0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
          0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
          0, -1, -1}}}}, ControlType -> 
         None}, {{$CellContext`types$$, {{{2, 1, 0, 0, 0, 0, 1, 2}, {3, 1, 0, 
          0, 0, 0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 4}, {5, 1, 0, 0, 0, 0, 1, 
          5}, {6, 1, 0, 0, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0, 1, 4}, {3, 1, 0, 0,
           0, 0, 1, 3}, {2, 1, 0, 0, 0, 0, 1, 2}}}}, ControlType -> 
         None}, {{$CellContext`wfrom$$, {}}, ControlType -> 
         None}, {{$CellContext`wto$$, {}}, ControlType -> 
         None}, {{$CellContext`wpiece$$, {}}, ControlType -> 
         None}, {{$CellContext`bfrom$$, {}}, ControlType -> 
         None}, {{$CellContext`bto$$, {}}, ControlType -> 
         None}, {{$CellContext`bpiece$$, {}}, ControlType -> 
         None}, {{$CellContext`unmoveda1$$, True}, ControlType -> 
         None}, {{$CellContext`unmoveda8$$, True}, ControlType -> 
         None}, {{$CellContext`unmovedh1$$, True}, ControlType -> 
         None}, {{$CellContext`unmovedh8$$, True}, ControlType -> 
         None}, {{$CellContext`epwhite$$, {0, 0}}, ControlType -> 
         None}, {{$CellContext`epblack$$, {0, 0}}, ControlType -> 
         None}, {{$CellContext`r$$, 0}, ControlType -> 
         None}, {{$CellContext`f$$, 0}, ControlType -> 
         None}, {{$CellContext`capture$$, "-"}, ControlType -> 
         None}, {{$CellContext`captures$$, {{"-", "-"}}}, ControlType -> 
         None}, {{$CellContext`checks$$, {{" ", " "}}}, ControlType -> 
         None}, {{$CellContext`part1$$, False}, ControlType -> 
         None}, {{$CellContext`part2$$, False}, ControlType -> 
         None}, {{$CellContext`ok$$, False}, ControlType -> 
         None}, {{$CellContext`eastok$$, False}, ControlType -> 
         None}, {{$CellContext`westok$$, False}, ControlType -> 
         None}, {{$CellContext`southok$$, False}, ControlType -> 
         None}, {{$CellContext`northok$$, False}, ControlType -> 
         None}, {{$CellContext`x$$, 0}, ControlType -> 
         None}, {{$CellContext`y$$, 0}, ControlType -> 
         None}, {{$CellContext`swattacked$$, False}, ControlType -> None}}, 
      "Options" :> {ControlPlacement -> Left, AutorunSequencing -> {1}}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{651., {226., 231.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`list0 = {{{0, 0}, {0, 0}}}, $CellContext`t = 
       1, $CellContext`s = -1, $CellContext`pp = 1, $CellContext`nn = 
       3, $CellContext`bb = 4, $CellContext`qq = 5, $CellContext`rr = 
       2, $CellContext`kk = 6, $CellContext`check[
         Pattern[$CellContext`si$, 
          Blank[]], 
         Pattern[$CellContext`ty$, 
          Blank[]], 
         Pattern[$CellContext`x$, 
          Blank[]], 
         Pattern[$CellContext`y$, 
          Blank[]], 
         Pattern[$CellContext`n$, 
          Blank[]]] := 
       Module[{$CellContext`sw$}, $CellContext`sw$ = False; If[
           
           And[$CellContext`x$ < 8, $CellContext`n$ $CellContext`y$ < 
            4 + $CellContext`n$ 3, 
            Part[$CellContext`si$, $CellContext`x$ + 
              1, $CellContext`y$ + $CellContext`n$] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ + 
              1, $CellContext`y$ + $CellContext`n$] == $CellContext`pp], \
$CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ > 1, $CellContext`n$ $CellContext`y$ < 
            4 + $CellContext`n$ 3, 
            Part[$CellContext`si$, $CellContext`x$ - 
              1, $CellContext`y$ + $CellContext`n$] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ - 
              1, $CellContext`y$ + $CellContext`n$] == $CellContext`pp], \
$CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ < 8, $CellContext`y$ > 2, 
            Part[$CellContext`si$, $CellContext`x$ + 1, $CellContext`y$ - 
              2] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ + 1, $CellContext`y$ - 
              2] == $CellContext`nn], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ < 8, $CellContext`y$ < 7, 
            Part[$CellContext`si$, $CellContext`x$ + 1, $CellContext`y$ + 
              2] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ + 1, $CellContext`y$ + 
              2] == $CellContext`nn], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ > 1, $CellContext`y$ > 2, 
            Part[$CellContext`si$, $CellContext`x$ - 1, $CellContext`y$ - 
              2] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ - 1, $CellContext`y$ - 
              2] == $CellContext`nn], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ > 1, $CellContext`y$ < 7, 
            Part[$CellContext`si$, $CellContext`x$ - 1, $CellContext`y$ + 
              2] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ - 1, $CellContext`y$ + 
              2] == $CellContext`nn], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ < 7, $CellContext`y$ > 1, 
            Part[$CellContext`si$, $CellContext`x$ + 2, $CellContext`y$ - 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ + 2, $CellContext`y$ - 
              1] == $CellContext`nn], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ < 7, $CellContext`y$ < 8, 
            Part[$CellContext`si$, $CellContext`x$ + 2, $CellContext`y$ + 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ + 2, $CellContext`y$ + 
              1] == $CellContext`nn], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ > 2, $CellContext`y$ > 1, 
            Part[$CellContext`si$, $CellContext`x$ - 2, $CellContext`y$ - 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ - 2, $CellContext`y$ - 
              1] == $CellContext`nn], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ > 2, $CellContext`y$ < 8, 
            Part[$CellContext`si$, $CellContext`x$ - 2, $CellContext`y$ + 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ - 2, $CellContext`y$ + 
              1] == $CellContext`nn], $CellContext`sw$ = True]; 
         For[$CellContext`i$$ = 1, $CellContext`i$$ <= 
           Min[7 - $CellContext`x$, 7 - $CellContext`y$], 
           Increment[$CellContext`i$$], 
           If[
           Part[$CellContext`si$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$ + $CellContext`i$$] != 0, 
            Break[]]]; If[
           
           And[$CellContext`i$$ <= 
            Min[8 - $CellContext`x$, 8 - $CellContext`y$], 
            Part[$CellContext`si$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$ + $CellContext`i$$] == -$CellContext`n$, 
            Or[
            Part[$CellContext`ty$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$ + $CellContext`i$$] == $CellContext`qq, 
             Part[$CellContext`ty$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$ + $CellContext`i$$] == $CellContext`bb]], $CellContext`sw$ = 
           True]; For[$CellContext`i$$ = 1, $CellContext`i$$ <= 
           Min[$CellContext`x$ - 1, 7 - $CellContext`y$], 
           Increment[$CellContext`i$$], 
           If[
           Part[$CellContext`si$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$ + $CellContext`i$$] != 0, 
            Break[]]]; If[
           
           And[$CellContext`i$$ <= 
            Min[$CellContext`x$ - 1, 8 - $CellContext`y$], 
            Part[$CellContext`si$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$ + $CellContext`i$$] == -$CellContext`n$, 
            Or[
            Part[$CellContext`ty$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$ + $CellContext`i$$] == $CellContext`qq, 
             Part[$CellContext`ty$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$ + $CellContext`i$$] == $CellContext`bb]], $CellContext`sw$ = 
           True]; For[$CellContext`i$$ = 1, $CellContext`i$$ <= 
           Min[7 - $CellContext`x$, $CellContext`y$ - 1], 
           Increment[$CellContext`i$$], 
           If[
           Part[$CellContext`si$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$ - $CellContext`i$$] != 0, 
            Break[]]]; If[
           
           And[$CellContext`i$$ <= 
            Min[8 - $CellContext`x$, $CellContext`y$ - 1], 
            Part[$CellContext`si$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$ - $CellContext`i$$] == -$CellContext`n$, 
            Or[
            Part[$CellContext`ty$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$ - $CellContext`i$$] == $CellContext`qq, 
             Part[$CellContext`ty$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$ - $CellContext`i$$] == $CellContext`bb]], $CellContext`sw$ = 
           True]; For[$CellContext`i$$ = 1, $CellContext`i$$ <= 
           Min[$CellContext`x$ - 1, $CellContext`y$ - 1], 
           Increment[$CellContext`i$$], 
           If[
           Part[$CellContext`si$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$ - $CellContext`i$$] != 0, 
            Break[]]]; If[
           
           And[$CellContext`i$$ <= 
            Min[$CellContext`x$ - 1, $CellContext`y$ - 1], 
            Part[$CellContext`si$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$ - $CellContext`i$$] == -$CellContext`n$, 
            Or[
            Part[$CellContext`ty$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$ - $CellContext`i$$] == $CellContext`qq, 
             Part[$CellContext`ty$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$ - $CellContext`i$$] == $CellContext`bb]], $CellContext`sw$ = 
           True]; For[$CellContext`i$$ = 1, $CellContext`i$$ <= 
           7 - $CellContext`x$, 
           Increment[$CellContext`i$$], 
           If[
           Part[$CellContext`si$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$] != 0, 
            Break[]]]; If[
           
           And[$CellContext`i$$ <= 8 - $CellContext`x$, 
            Part[$CellContext`si$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$] == -$CellContext`n$, 
            Or[
            Part[$CellContext`ty$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$] == $CellContext`qq, 
             Part[$CellContext`ty$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$] == $CellContext`rr]], $CellContext`sw$ = True]; 
         For[$CellContext`i$$ = 1, $CellContext`i$$ <= $CellContext`x$ - 1, 
           Increment[$CellContext`i$$], 
           If[
           Part[$CellContext`si$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$] != 0, 
            Break[]]]; If[
           
           And[$CellContext`i$$ <= $CellContext`x$ - 1, 
            Part[$CellContext`si$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$] == -$CellContext`n$, 
            Or[
            Part[$CellContext`ty$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$] == $CellContext`qq, 
             Part[$CellContext`ty$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$] == $CellContext`rr]], $CellContext`sw$ = True]; 
         For[$CellContext`i$$ = 1, $CellContext`i$$ <= 7 - $CellContext`y$, 
           Increment[$CellContext`i$$], 
           If[
           Part[$CellContext`si$, $CellContext`x$, $CellContext`y$ + \
$CellContext`i$$] != 0, 
            Break[]]]; If[
           
           And[$CellContext`i$$ <= 8 - $CellContext`y$, 
            Part[$CellContext`si$, $CellContext`x$, $CellContext`y$ + \
$CellContext`i$$] == -$CellContext`n$, 
            Or[
            Part[$CellContext`ty$, $CellContext`x$, $CellContext`y$ + \
$CellContext`i$$] == $CellContext`qq, 
             Part[$CellContext`ty$, $CellContext`x$, $CellContext`y$ + \
$CellContext`i$$] == $CellContext`rr]], $CellContext`sw$ = True]; 
         For[$CellContext`i$$ = 1, $CellContext`i$$ <= $CellContext`y$ - 1, 
           Increment[$CellContext`i$$], 
           If[
           Part[$CellContext`si$, $CellContext`x$, $CellContext`y$ - \
$CellContext`i$$] != 0, 
            Break[]]]; If[
           
           And[$CellContext`i$$ <= $CellContext`y$ - 1, 
            Part[$CellContext`si$, $CellContext`x$, $CellContext`y$ - \
$CellContext`i$$] == -$CellContext`n$, 
            Or[
            Part[$CellContext`ty$, $CellContext`x$, $CellContext`y$ - \
$CellContext`i$$] == $CellContext`qq, 
             Part[$CellContext`ty$, $CellContext`x$, $CellContext`y$ - \
$CellContext`i$$] == $CellContext`rr]], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ < 8, 
            Part[$CellContext`si$, $CellContext`x$ + 
              1, $CellContext`y$] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ + 
              1, $CellContext`y$] == $CellContext`kk], $CellContext`sw$ = 
           True]; If[
           
           And[$CellContext`x$ > 1, 
            Part[$CellContext`si$, $CellContext`x$ - 
              1, $CellContext`y$] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ - 
              1, $CellContext`y$] == $CellContext`kk], $CellContext`sw$ = 
           True]; If[
           
           And[$CellContext`y$ < 8, 
            Part[$CellContext`si$, $CellContext`x$, $CellContext`y$ + 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$, $CellContext`y$ + 
              1] == $CellContext`kk], $CellContext`sw$ = True]; If[
           
           And[$CellContext`y$ > 1, 
            Part[$CellContext`si$, $CellContext`x$, $CellContext`y$ - 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$, $CellContext`y$ - 
              1] == $CellContext`kk], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ < 8, $CellContext`y$ < 8, 
            Part[$CellContext`si$, $CellContext`x$ + 1, $CellContext`y$ + 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ + 1, $CellContext`y$ + 
              1] == $CellContext`kk], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ > 1, $CellContext`y$ > 1, 
            Part[$CellContext`si$, $CellContext`x$ - 1, $CellContext`y$ - 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ - 1, $CellContext`y$ - 
              1] == $CellContext`kk], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ < 8, $CellContext`y$ > 1, 
            Part[$CellContext`si$, $CellContext`x$ + 1, $CellContext`y$ - 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ + 1, $CellContext`y$ - 
              1] == $CellContext`kk], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ > 1, $CellContext`y$ < 8, 
            Part[$CellContext`si$, $CellContext`x$ - 1, $CellContext`y$ + 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ - 1, $CellContext`y$ + 
              1] == $CellContext`kk], $CellContext`sw$ = 
           True]; $CellContext`sw$], $CellContext`l = 
       21, $CellContext`a = {8, 2}, $CellContext`b = {8, 4}, $CellContext`ax = 
       8, $CellContext`ay = 2, $CellContext`bx = 8, $CellContext`by = 
       4, $CellContext`olds = 0, $CellContext`oldt = 
       0, $CellContext`list1 = {{{0, 0}, {0, 0}}, {{1, 2}, {1, 3}}, {{1, 2}, {
        1, 4}}, {{2, 1}, {1, 3}}, {{2, 1}, {3, 3}}, {{2, 2}, {2, 3}}, {{2, 
        2}, {2, 4}}, {{3, 2}, {3, 3}}, {{3, 2}, {3, 4}}, {{4, 2}, {4, 3}}, {{
        4, 2}, {4, 4}}, {{5, 2}, {5, 3}}, {{5, 2}, {5, 4}}, {{6, 2}, {6, 
        3}}, {{6, 2}, {6, 4}}, {{7, 1}, {6, 3}}, {{7, 1}, {8, 3}}, {{7, 2}, {
        7, 3}}, {{7, 2}, {7, 4}}, {{8, 2}, {8, 3}}, {{8, 2}, {8, 
        4}}}, $CellContext`board = {
         RGBColor[0.7, 0.7, 0.5], 
         Polygon[{{0, 0}, {8, 0}, {8, 8}, {0, 8}}], 
         RGBColor[0.94, 0.91, 0.88], 
         Polygon[{{1, 0}, {1, 1}, {2, 1}, {2, 0}}], 
         Polygon[{{3, 0}, {3, 1}, {4, 1}, {4, 0}}], 
         Polygon[{{5, 0}, {5, 1}, {6, 1}, {6, 0}}], 
         Polygon[{{7, 0}, {7, 1}, {8, 1}, {8, 0}}], 
         Polygon[{{0, 1}, {0, 2}, {1, 2}, {1, 1}}], 
         Polygon[{{2, 1}, {2, 2}, {3, 2}, {3, 1}}], 
         Polygon[{{4, 1}, {4, 2}, {5, 2}, {5, 1}}], 
         Polygon[{{6, 1}, {6, 2}, {7, 2}, {7, 1}}], 
         Polygon[{{1, 2}, {1, 3}, {2, 3}, {2, 2}}], 
         Polygon[{{3, 2}, {3, 3}, {4, 3}, {4, 2}}], 
         Polygon[{{5, 2}, {5, 3}, {6, 3}, {6, 2}}], 
         Polygon[{{7, 2}, {7, 3}, {8, 3}, {8, 2}}], 
         Polygon[{{0, 3}, {0, 4}, {1, 4}, {1, 3}}], 
         Polygon[{{2, 3}, {2, 4}, {3, 4}, {3, 3}}], 
         Polygon[{{4, 3}, {4, 4}, {5, 4}, {5, 3}}], 
         Polygon[{{6, 3}, {6, 4}, {7, 4}, {7, 3}}], 
         Polygon[{{1, 4}, {1, 5}, {2, 5}, {2, 4}}], 
         Polygon[{{3, 4}, {3, 5}, {4, 5}, {4, 4}}], 
         Polygon[{{5, 4}, {5, 5}, {6, 5}, {6, 4}}], 
         Polygon[{{7, 4}, {7, 5}, {8, 5}, {8, 4}}], 
         Polygon[{{0, 5}, {0, 6}, {1, 6}, {1, 5}}], 
         Polygon[{{2, 5}, {2, 6}, {3, 6}, {3, 5}}], 
         Polygon[{{4, 5}, {4, 6}, {5, 6}, {5, 5}}], 
         Polygon[{{6, 5}, {6, 6}, {7, 6}, {7, 5}}], 
         Polygon[{{1, 6}, {1, 7}, {2, 7}, {2, 6}}], 
         Polygon[{{3, 6}, {3, 7}, {4, 7}, {4, 6}}], 
         Polygon[{{5, 6}, {5, 7}, {6, 7}, {6, 6}}], 
         Polygon[{{7, 6}, {7, 7}, {8, 7}, {8, 6}}], 
         Polygon[{{0, 7}, {0, 8}, {1, 8}, {1, 7}}], 
         Polygon[{{2, 7}, {2, 8}, {3, 8}, {3, 7}}], 
         Polygon[{{4, 7}, {4, 8}, {5, 8}, {5, 7}}], 
         Polygon[{{6, 7}, {6, 8}, {7, 8}, {7, 7}}], 
         GrayLevel[0.5], {
          Line[{{1, 0}, {1, 8}}], 
          Line[{{2, 0}, {2, 8}}], 
          Line[{{3, 0}, {3, 8}}], 
          Line[{{4, 0}, {4, 8}}], 
          Line[{{5, 0}, {5, 8}}], 
          Line[{{6, 0}, {6, 8}}], 
          Line[{{7, 0}, {7, 8}}]}, {
          Line[{{0, 1}, {8, 1}}], 
          Line[{{0, 2}, {8, 2}}], 
          Line[{{0, 3}, {8, 3}}], 
          Line[{{0, 4}, {8, 4}}], 
          Line[{{0, 5}, {8, 5}}], 
          Line[{{0, 6}, {8, 6}}], 
          Line[{{0, 7}, {8, 7}}]}, 
         GrayLevel[0], 
         Line[{{0, 0}, {0, 8}, {8, 8}, {8, 0}, {0, 0}}], {
          RGBColor[0, 0, 1], 
          Thickness[Large]}, 
         Line[{{-0.1, -0.1}, {-0.1, 8.1}, {8.1, 8.1}, {
          8.1, -0.1}, {-0.1, -0.1}}]}, $CellContext`pawn = 
       Disk[{-0.5, -0.5}, 0.35], $CellContext`rook = 
       Polygon[{{-0.9, -0.9}, {-0.09999999999999998, -0.9}, \
{-0.09999999999999998, -0.7}, {-0.30000000000000004`, -0.5}, \
{-0.09999999999999998, -0.30000000000000004`}, {-0.09999999999999998, \
-0.09999999999999998}, {-0.9, -0.09999999999999998}, {-0.9, \
-0.30000000000000004`}, {-0.7, -0.5}, {-0.9, -0.7}}], $CellContext`knight = 
       Polygon[{{-0.9, -0.9}, {-0.09999999999999998, -0.9}, \
{-0.09999999999999998, -0.6}, {-0.4, -0.6}, {-0.4, -0.4}, \
{-0.09999999999999998, -0.30000000000000004`}, {-0.09999999999999998, \
-0.09999999999999998}, {-0.6, -0.09999999999999998}, {-0.6, -0.6}, {-0.9, \
-0.6}}], $CellContext`bishop = 
       Polygon[{{-0.9, -0.9}, {-0.09999999999999998, -0.9}, {-0.5, \
-0.09999999999999998}}], $CellContext`queen = 
       Polygon[{{-0.9, -0.9}, {-0.09999999999999998, -0.9}, {-0.4, -0.6}, \
{-0.19999999999999996`, -0.30000000000000004`}, {-0.5, -0.09999999999999998}, \
{-0.8, -0.30000000000000004`}, {-0.6, -0.6}}], $CellContext`king = 
       Polygon[{{-0.9, -0.9}, {-0.09999999999999998, -0.9}, \
{-0.09999999999999998, -0.09999999999999998}, {-0.30000000000000004`, \
-0.30000000000000004`}, {-0.5, -0.09999999999999998}, {-0.7, \
-0.30000000000000004`}, {-0.9, -0.09999999999999998}}], $CellContext`names = {
        " ", "R", "N", "B", "Q", "K"}, $CellContext`alpha = {
        "a", "b", "c", "d", "e", "f", "g", "h", 
         "..."}, $CellContext`side0 = {{1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 
        0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
        0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {
        1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
        0, -1, -1}}, $CellContext`type0 = {{2, 1, 0, 0, 0, 0, 1, 2}, {3, 1, 0,
         0, 0, 0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 4}, {5, 1, 0, 0, 0, 0, 1, 5}, {
        6, 1, 0, 0, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0, 1, 4}, {3, 1, 0, 0, 0, 0, 
        1, 3}, {2, 1, 0, 0, 0, 0, 1, 2}}, $CellContext`all0 = {{0, 0, 0, 0, 0,
         0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 
        0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 
        0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}}}; 
     Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.35696210375764*^9, 3.404836196558592*^9, 3.404836269663712*^9, 
   3.404836408873886*^9, 3.4048365510683517`*^9, 3.4048716288690305`*^9, 
   3.4048718933092766`*^9, 3.404872167713851*^9, 3.404872416411461*^9, 
   3.404872924802491*^9, 3.404873037965211*^9, 3.4048732462647314`*^9, 
   3.4048733844634514`*^9, 3.404873552705371*^9, 3.4048737249630656`*^9, 
   3.404874484044571*^9, 3.404874989571483*^9, 3.404875987356227*^9, 
   3.404876670138019*^9, 3.404876953545539*^9, 3.404877042723771*^9, 
   3.4048775867961087`*^9, 3.4048776335132847`*^9, 3.4048777787721567`*^9, 
   3.404878160320797*^9, 3.404878218404317*^9, 3.4048858903446145`*^9, 
   3.404886017387293*^9, 3.404886080958704*^9, 3.404886254127709*^9, 
   3.4048865511948705`*^9, 3.404887475844451*^9, 3.4048875084413233`*^9, 
   3.404887548448851*^9, 3.4048879063334637`*^9, 3.4048880141084366`*^9, 
   3.4048880758972845`*^9, 3.404888341058568*^9, 3.404888486918304*^9, 
   3.4048885760064063`*^9, 3.40488865205576*^9, 3.404888748774835*^9, 
   3.4048890442697363`*^9, 3.4048894689103394`*^9, 3.4048896054166255`*^9, 
   3.4049210101895633`*^9, 3.4049218545536995`*^9, 3.4049230541886897`*^9, 
   3.4049233014342113`*^9, 3.404923440273853*^9, 3.4049235057179565`*^9, 
   3.40492396040176*^9, {3.404923995512246*^9, 3.404924015701277*^9}, 
   3.404924119961195*^9, 3.404924579141464*^9, 3.405034898546605*^9, {
   3.4050349377429667`*^9, 3.4050349652324944`*^9}, 3.4055549600013423`*^9},
 CellID->76637251],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`bfrom$$ = {}, $CellContext`bpiece$$ = {}, \
$CellContext`bto$$ = {}, $CellContext`capture$$ = 
    "-", $CellContext`captures$$ = {{"-", "-"}, {
     "-", "-"}}, $CellContext`checks$$ = {{" ", " "}, {
     " ", " "}}, $CellContext`colb$$ = 2, $CellContext`colw$$ = 
    2, $CellContext`eastok$$ = True, $CellContext`edit$$ = 
    "play", $CellContext`epblack$$ = {0, 0}, $CellContext`epwhite$$ = {5, 
    3}, $CellContext`f$$ = 1, $CellContext`from$$ = {0, 0}, $CellContext`h$$ =
     1., $CellContext`i$$ = 1, $CellContext`j$$ = 0, $CellContext`kx$$ = 
    5, $CellContext`ky$$ = 8, $CellContext`list$$ = {{{0, 0}, {0, 0}}, {{1, 
    7}, {1, 6}}, {{1, 7}, {1, 5}}, {{2, 7}, {2, 6}}, {{2, 7}, {2, 5}}, {{2, 
    8}, {1, 6}}, {{2, 8}, {3, 6}}, {{3, 7}, {3, 6}}, {{3, 7}, {3, 5}}, {{4, 
    7}, {4, 6}}, {{4, 7}, {4, 5}}, {{5, 7}, {5, 6}}, {{5, 7}, {5, 5}}, {{6, 
    7}, {6, 6}}, {{6, 7}, {6, 5}}, {{7, 7}, {7, 6}}, {{7, 7}, {7, 5}}, {{7, 
    8}, {6, 6}}, {{7, 8}, {8, 6}}, {{8, 7}, {8, 6}}, {{8, 7}, {8, 
    5}}}, $CellContext`n$$ = -1, $CellContext`northok$$ = 
    True, $CellContext`ok$$ = False, $CellContext`oldfrom$$ = {5, 
    2}, $CellContext`part1$$ = False, $CellContext`part2$$ = 
    False, $CellContext`pos$$ = {5, 4}, $CellContext`prom$$ = 
    "queen", $CellContext`r$$ = 1, $CellContext`randomblack$$ = 
    False, $CellContext`randomwhite$$ = False, $CellContext`showmoves$$ = 
    True, $CellContext`showtargets$$ = True, $CellContext`side$$ = {{1, 1, 0, 
    0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
    0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 0, 0, 1, 0, 0, -1, -1}, {1, 1,
     0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
    0, -1, -1}}, $CellContext`sides$$ = {{{1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 
    0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
    0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1,
     0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
    0, -1, -1}}}, $CellContext`southok$$ = True, $CellContext`swattacked$$ = 
    False, $CellContext`to$$ = {0, 0}, $CellContext`type$$ = {{2, 1, 0, 0, 0, 
    0, 1, 2}, {3, 1, 0, 0, 0, 0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 4}, {5, 1, 0, 0,
     0, 0, 1, 5}, {6, 0, 0, 1, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0, 1, 4}, {3, 1, 
    0, 0, 0, 0, 1, 3}, {2, 1, 0, 0, 0, 0, 1, 2}}, $CellContext`types$$ = {{{2,
     1, 0, 0, 0, 0, 1, 2}, {3, 1, 0, 0, 0, 0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 
    4}, {5, 1, 0, 0, 0, 0, 1, 5}, {6, 1, 0, 0, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0,
     1, 4}, {3, 1, 0, 0, 0, 0, 1, 3}, {2, 1, 0, 0, 0, 0, 1, 
    2}}}, $CellContext`unmoveda1$$ = True, $CellContext`unmoveda8$$ = 
    True, $CellContext`unmovedh1$$ = True, $CellContext`unmovedh8$$ = 
    True, $CellContext`westok$$ = True, $CellContext`wfrom$$ = {{5, 
    2}}, $CellContext`wpiece$$ = {1}, $CellContext`wto$$ = {{5, 
    4}}, $CellContext`x$$ = 5, $CellContext`y$$ = 2, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`colw$$], 1, 
       Style["color White", 10]}, {1, 2, 3}}, {{
       Hold[$CellContext`colb$$], 1, 
       Style["color Black", 10]}, {1, 2, 3}}, {{
       Hold[$CellContext`randomwhite$$], False, "random White"}, {
      True, False}}, {{
       Hold[$CellContext`randomblack$$], False, "random Black"}, {
      True, False}}, {{
       Hold[$CellContext`showmoves$$], False, "show moves"}, {
      True, False}}, {{
       Hold[$CellContext`showtargets$$], True, "show targets"}, {
      True, False}}, {{
       Hold[$CellContext`prom$$], "queen", 
       Style["promotion to", 10]}, {"queen", "rook", "bishop", "knight"}}, {{
       Hold[$CellContext`edit$$], "play", 
       Style["edit position", 10]}, {
      "play", "reset", "clear", "delete", "white pawn", "white knight", 
       "white bishop", "white rook", "white queen", "white king", 
       "black pawn", "black knight", "black bishop", "black rook", 
       "black queen", "black king", "castling options", "next player"}}, {{
       Hold[$CellContext`h$$], 1, 
       Style["history"]}, 0, 1}, {{
       Hold[$CellContext`i$$], 0}}, {{
       Hold[$CellContext`j$$], 0}}, {{
       Hold[$CellContext`kx$$], 0}}, {{
       Hold[$CellContext`ky$$], 0}}, {{
       Hold[$CellContext`pos$$], {0, 0}}}, {{
       Hold[$CellContext`from$$], {0, 0}}}, {{
       Hold[$CellContext`oldfrom$$], {0, 0}}}, {{
       Hold[$CellContext`to$$], {0, 0}}}, {{
       Hold[$CellContext`side$$], {{1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0,
        0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {
       1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
       0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}}}}, {{
       Hold[$CellContext`type$$], {{2, 1, 0, 0, 0, 0, 1, 2}, {3, 1, 0, 0, 0, 
       0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 4}, {5, 1, 0, 0, 0, 0, 1, 5}, {6, 1, 0,
        0, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0, 1, 4}, {3, 1, 0, 0, 0, 0, 1, 3}, {
       2, 1, 0, 0, 0, 0, 1, 2}}}}, {{
       Hold[$CellContext`n$$], 1}}, {{
       Hold[$CellContext`list$$], {{{0, 0}, {0, 0}}}}}, {{
       Hold[$CellContext`sides$$], {{{1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 
       0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
       0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1,
        1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}}}}}, {{
       Hold[$CellContext`types$$], {{{2, 1, 0, 0, 0, 0, 1, 2}, {3, 1, 0, 0, 0,
        0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 4}, {5, 1, 0, 0, 0, 0, 1, 5}, {6, 1, 
       0, 0, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0, 1, 4}, {3, 1, 0, 0, 0, 0, 1, 
       3}, {2, 1, 0, 0, 0, 0, 1, 2}}}}}, {{
       Hold[$CellContext`wfrom$$], {}}}, {{
       Hold[$CellContext`wto$$], {}}}, {{
       Hold[$CellContext`wpiece$$], {}}}, {{
       Hold[$CellContext`bfrom$$], {}}}, {{
       Hold[$CellContext`bto$$], {}}}, {{
       Hold[$CellContext`bpiece$$], {}}}, {{
       Hold[$CellContext`unmoveda1$$], True}}, {{
       Hold[$CellContext`unmoveda8$$], True}}, {{
       Hold[$CellContext`unmovedh1$$], True}}, {{
       Hold[$CellContext`unmovedh8$$], True}}, {{
       Hold[$CellContext`epwhite$$], {0, 0}}}, {{
       Hold[$CellContext`epblack$$], {0, 0}}}, {{
       Hold[$CellContext`r$$], 0}}, {{
       Hold[$CellContext`f$$], 0}}, {{
       Hold[$CellContext`capture$$], "-"}}, {{
       Hold[$CellContext`captures$$], {{"-", "-"}}}}, {{
       Hold[$CellContext`checks$$], {{" ", " "}}}}, {{
       Hold[$CellContext`part1$$], False}}, {{
       Hold[$CellContext`part2$$], False}}, {{
       Hold[$CellContext`ok$$], False}}, {{
       Hold[$CellContext`eastok$$], False}}, {{
       Hold[$CellContext`westok$$], False}}, {{
       Hold[$CellContext`southok$$], False}}, {{
       Hold[$CellContext`northok$$], False}}, {{
       Hold[$CellContext`x$$], 0}}, {{
       Hold[$CellContext`y$$], 0}}, {{
       Hold[$CellContext`swattacked$$], False}}}, Typeset`size$$ = {
    400., {198., 202.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = False, $CellContext`colw$396$$ = 
    0, $CellContext`colb$397$$ = 0, $CellContext`randomwhite$398$$ = 
    False, $CellContext`randomblack$399$$ = 
    False, $CellContext`showmoves$400$$ = 
    False, $CellContext`showtargets$401$$ = False, $CellContext`prom$402$$ = 
    0, $CellContext`edit$403$$ = 0, $CellContext`h$404$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`bfrom$$ = {}, $CellContext`bpiece$$ = {}, \
$CellContext`bto$$ = {}, $CellContext`capture$$ = 
        "-", $CellContext`captures$$ = {{
          "-", "-"}}, $CellContext`checks$$ = {{
          " ", " "}}, $CellContext`colb$$ = 1, $CellContext`colw$$ = 
        1, $CellContext`eastok$$ = False, $CellContext`edit$$ = 
        "play", $CellContext`epblack$$ = {0, 0}, $CellContext`epwhite$$ = {0, 
         0}, $CellContext`f$$ = 
        0, $CellContext`from$$ = {0, 0}, $CellContext`h$$ = 
        1, $CellContext`i$$ = 0, $CellContext`j$$ = 0, $CellContext`kx$$ = 
        0, $CellContext`ky$$ = 
        0, $CellContext`list$$ = {{{0, 0}, {0, 0}}}, $CellContext`n$$ = 
        1, $CellContext`northok$$ = False, $CellContext`ok$$ = 
        False, $CellContext`oldfrom$$ = {0, 0}, $CellContext`part1$$ = 
        False, $CellContext`part2$$ = 
        False, $CellContext`pos$$ = {0, 0}, $CellContext`prom$$ = 
        "queen", $CellContext`r$$ = 0, $CellContext`randomblack$$ = 
        False, $CellContext`randomwhite$$ = False, $CellContext`showmoves$$ = 
        False, $CellContext`showtargets$$ = 
        True, $CellContext`side$$ = {{1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 
         0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
         0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {
         1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
         0, -1, -1}}, $CellContext`sides$$ = {{{1, 1, 0, 0, 0, 0, -1, -1}, {1,
          1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
         0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {
         1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
         0, -1, -1}}}, $CellContext`southok$$ = 
        False, $CellContext`swattacked$$ = 
        False, $CellContext`to$$ = {0, 0}, $CellContext`type$$ = {{2, 1, 0, 0,
          0, 0, 1, 2}, {3, 1, 0, 0, 0, 0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 4}, {5,
          1, 0, 0, 0, 0, 1, 5}, {6, 1, 0, 0, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0, 
         1, 4}, {3, 1, 0, 0, 0, 0, 1, 3}, {2, 1, 0, 0, 0, 0, 1, 
         2}}, $CellContext`types$$ = {{{2, 1, 0, 0, 0, 0, 1, 2}, {3, 1, 0, 0, 
         0, 0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 4}, {5, 1, 0, 0, 0, 0, 1, 5}, {6, 
         1, 0, 0, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0, 1, 4}, {3, 1, 0, 0, 0, 0, 1,
          3}, {2, 1, 0, 0, 0, 0, 1, 2}}}, $CellContext`unmoveda1$$ = 
        True, $CellContext`unmoveda8$$ = True, $CellContext`unmovedh1$$ = 
        True, $CellContext`unmovedh8$$ = True, $CellContext`westok$$ = 
        False, $CellContext`wfrom$$ = {}, $CellContext`wpiece$$ = {}, \
$CellContext`wto$$ = {}, $CellContext`x$$ = 0, $CellContext`y$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`colw$$, $CellContext`colw$396$$, 0], 
        Hold[$CellContext`colb$$, $CellContext`colb$397$$, 0], 
        Hold[$CellContext`randomwhite$$, $CellContext`randomwhite$398$$, 
         False], 
        Hold[$CellContext`randomblack$$, $CellContext`randomblack$399$$, 
         False], 
        Hold[$CellContext`showmoves$$, $CellContext`showmoves$400$$, False], 
        Hold[$CellContext`showtargets$$, $CellContext`showtargets$401$$, 
         False], 
        Hold[$CellContext`prom$$, $CellContext`prom$402$$, 0], 
        Hold[$CellContext`edit$$, $CellContext`edit$403$$, 0], 
        Hold[$CellContext`h$$, $CellContext`h$404$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`f$$ = Floor[$CellContext`h$$ $CellContext`r$$]; 
       If[
         And[$CellContext`list$$ == $CellContext`list0, $CellContext`from$$ == \
{0, 0}, $CellContext`to$$ == {0, 0}], 
         Do[$CellContext`t = 
            Part[$CellContext`type$$, $CellContext`x$$, $CellContext`y$$]; \
$CellContext`s = 
            Part[$CellContext`side$$, $CellContext`x$$, $CellContext`y$$]; 
           If[
             
             And[$CellContext`t == $CellContext`pp, $CellContext`s == 
              1, $CellContext`n$$ == 1], 
             If[Part[$CellContext`side$$, $CellContext`x$$, $CellContext`y$$ + 
                 1] == 0, $CellContext`list$$ = 
                AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$, $CellContext`y$$ + 1}}]; If[
                 And[$CellContext`y$$ == 2, 
                  Part[$CellContext`side$$, $CellContext`x$$, 4] == 
                  0], $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, 
                    2}, {$CellContext`x$$, 4}}]]]; 
             If[{$CellContext`x$$ + 1, $CellContext`y$$ + 
                 1} == $CellContext`epblack$$, $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$ + 1}}]]; 
             If[{$CellContext`x$$ - 1, $CellContext`y$$ + 
                 1} == $CellContext`epblack$$, $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$ + 1}}]]; If[
               
               And[$CellContext`x$$ < 8, $CellContext`y$$ < 8, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  1, $CellContext`y$$ + 
                  1] == -$CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$ + 1}}]]; If[
               
               And[$CellContext`x$$ > 1, $CellContext`y$$ < 8, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  1, $CellContext`y$$ + 
                  1] == -$CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$ + 1}}]]]; If[
             
             And[$CellContext`t == $CellContext`pp, $CellContext`s == -1, \
$CellContext`n$$ == -1], 
             If[Part[$CellContext`side$$, $CellContext`x$$, $CellContext`y$$ - 
                 1] == 0, $CellContext`list$$ = 
                AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$, $CellContext`y$$ - 1}}]; If[
                 
                 And[$CellContext`y$$ == 7, 
                  Part[$CellContext`side$$, $CellContext`x$$, 5] == 
                  0], $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, 
                    7}, {$CellContext`x$$, 5}}]]]; 
             If[{$CellContext`x$$ + 1, $CellContext`y$$ - 
                 1} == $CellContext`epwhite$$, $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$ - 1}}]]; 
             If[{$CellContext`x$$ - 1, $CellContext`y$$ - 
                 1} == $CellContext`epwhite$$, $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$ - 1}}]]; If[
               
               And[$CellContext`x$$ < 8, $CellContext`y$$ > 1, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  1, $CellContext`y$$ - 
                  1] == -$CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$ - 1}}]]; If[
               
               And[$CellContext`x$$ > 1, $CellContext`y$$ > 1, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  1, $CellContext`y$$ - 
                  1] == -$CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$ - 1}}]]]; If[
             
             And[$CellContext`t == $CellContext`nn, $CellContext`s == \
$CellContext`n$$], If[
               
               And[$CellContext`x$$ > 1, $CellContext`y$$ > 2, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  1, $CellContext`y$$ - 
                  2] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$ - 2}}]]; If[
               
               And[$CellContext`x$$ > 1, $CellContext`y$$ < 7, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  1, $CellContext`y$$ + 
                  2] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$ + 2}}]]; If[
               
               And[$CellContext`x$$ > 2, $CellContext`y$$ > 1, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  2, $CellContext`y$$ - 
                  1] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 2, $CellContext`y$$ - 1}}]]; If[
               And[$CellContext`x$$ > 2, $CellContext`y$$ < 8, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  2, $CellContext`y$$ + 
                  1] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 2, $CellContext`y$$ + 1}}]]; If[
               
               And[$CellContext`x$$ < 8, $CellContext`y$$ < 7, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  1, $CellContext`y$$ + 
                  2] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$ + 2}}]]; If[
               
               And[$CellContext`x$$ < 8, $CellContext`y$$ > 2, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  1, $CellContext`y$$ - 
                  2] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$ - 2}}]]; If[
               
               And[$CellContext`x$$ < 7, $CellContext`y$$ > 1, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  2, $CellContext`y$$ - 
                  1] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 2, $CellContext`y$$ - 1}}]]; If[
               
               And[$CellContext`x$$ < 7, $CellContext`y$$ < 8, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  2, $CellContext`y$$ + 
                  1] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 2, $CellContext`y$$ + 1}}]]]; If[
             And[
              
              Or[$CellContext`t == $CellContext`bb, $CellContext`t == \
$CellContext`qq], $CellContext`s == $CellContext`n$$], 
             For[$CellContext`i$$ = 1, 
               
               And[$CellContext`x$$ + $CellContext`i$$ < 
                9, $CellContext`y$$ + $CellContext`i$$ < 9], 
               Increment[$CellContext`i$$], 
               If[Part[$CellContext`side$$, $CellContext`x$$ + \
$CellContext`i$$, $CellContext`y$$ + $CellContext`i$$] != $CellContext`n$$, \
$CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + $CellContext`i$$, $CellContext`y$$ + \
$CellContext`i$$}}]]; 
               If[Part[$CellContext`side$$, $CellContext`x$$ + \
$CellContext`i$$, $CellContext`y$$ + $CellContext`i$$] != 0, 
                 Break[]]]; For[$CellContext`i$$ = 1, 
               
               And[$CellContext`x$$ + $CellContext`i$$ < 
                9, $CellContext`y$$ - $CellContext`i$$ > 0], 
               Increment[$CellContext`i$$], 
               If[Part[$CellContext`side$$, $CellContext`x$$ + \
$CellContext`i$$, $CellContext`y$$ - $CellContext`i$$] != $CellContext`n$$, \
$CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + $CellContext`i$$, $CellContext`y$$ - \
$CellContext`i$$}}]]; 
               If[Part[$CellContext`side$$, $CellContext`x$$ + \
$CellContext`i$$, $CellContext`y$$ - $CellContext`i$$] != 0, 
                 Break[]]]; For[$CellContext`i$$ = 1, 
               
               And[$CellContext`x$$ - $CellContext`i$$ > 
                0, $CellContext`y$$ + $CellContext`i$$ < 9], 
               Increment[$CellContext`i$$], 
               If[Part[$CellContext`side$$, $CellContext`x$$ - \
$CellContext`i$$, $CellContext`y$$ + $CellContext`i$$] != $CellContext`n$$, \
$CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - $CellContext`i$$, $CellContext`y$$ + \
$CellContext`i$$}}]]; 
               If[Part[$CellContext`side$$, $CellContext`x$$ - \
$CellContext`i$$, $CellContext`y$$ + $CellContext`i$$] != 0, 
                 Break[]]]; For[$CellContext`i$$ = 1, 
               
               And[$CellContext`x$$ - $CellContext`i$$ > 
                0, $CellContext`y$$ - $CellContext`i$$ > 0], 
               Increment[$CellContext`i$$], 
               If[Part[$CellContext`side$$, $CellContext`x$$ - \
$CellContext`i$$, $CellContext`y$$ - $CellContext`i$$] != $CellContext`n$$, \
$CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - $CellContext`i$$, $CellContext`y$$ - \
$CellContext`i$$}}]]; 
               If[Part[$CellContext`side$$, $CellContext`x$$ - \
$CellContext`i$$, $CellContext`y$$ - $CellContext`i$$] != 0, 
                 Break[]]]]; If[
             And[
              
              Or[$CellContext`t == $CellContext`rr, $CellContext`t == \
$CellContext`qq], $CellContext`s == $CellContext`n$$], 
             For[$CellContext`i$$ = $CellContext`x$$ + 1, $CellContext`i$$ < 
               9, 
               Increment[$CellContext`i$$], 
               If[Part[$CellContext`side$$, $CellContext`i$$, \
$CellContext`y$$] != $CellContext`n$$, $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`i$$, $CellContext`y$$}}]]; 
               If[Part[$CellContext`side$$, $CellContext`i$$, \
$CellContext`y$$] != 0, 
                 Break[]]]; 
             For[$CellContext`i$$ = $CellContext`x$$ - 1, $CellContext`i$$ > 
               0, 
               Decrement[$CellContext`i$$], 
               If[Part[$CellContext`side$$, $CellContext`i$$, \
$CellContext`y$$] != $CellContext`n$$, $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`i$$, $CellContext`y$$}}]]; 
               If[Part[$CellContext`side$$, $CellContext`i$$, \
$CellContext`y$$] != 0, 
                 Break[]]]; 
             For[$CellContext`i$$ = $CellContext`y$$ + 1, $CellContext`i$$ < 
               9, 
               Increment[$CellContext`i$$], 
               If[Part[$CellContext`side$$, $CellContext`x$$, \
$CellContext`i$$] != $CellContext`n$$, $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$, $CellContext`i$$}}]]; 
               If[Part[$CellContext`side$$, $CellContext`x$$, \
$CellContext`i$$] != 0, 
                 Break[]]]; 
             For[$CellContext`i$$ = $CellContext`y$$ - 1, $CellContext`i$$ > 
               0, 
               Decrement[$CellContext`i$$], 
               If[
                Part[$CellContext`side$$, $CellContext`x$$, $CellContext`i$$] != \
$CellContext`n$$, $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$, $CellContext`i$$}}]]; 
               If[Part[$CellContext`side$$, $CellContext`x$$, \
$CellContext`i$$] != 0, 
                 Break[]]]]; If[
             
             And[$CellContext`t == $CellContext`kk, $CellContext`s == \
$CellContext`n$$], $CellContext`kx$$ = $CellContext`x$$; $CellContext`ky$$ = \
$CellContext`y$$; 
             Part[$CellContext`side$$, $CellContext`x$$, $CellContext`y$$] = 
              0; Part[$CellContext`type$$, $CellContext`x$$, \
$CellContext`y$$] = 0; 
             If[$CellContext`x$$ < 
               8, $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, $CellContext`x$$ + 
                  1, $CellContext`y$$, $CellContext`n$$]; If[
                 Not[$CellContext`swattacked$$], $CellContext`eastok$$ = 
                 True, $CellContext`eastok$$ = False]]; 
             If[$CellContext`x$$ > 
               1, $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, $CellContext`x$$ - 
                  1, $CellContext`y$$, $CellContext`n$$]; If[
                 Not[$CellContext`swattacked$$], $CellContext`westok$$ = 
                 True, $CellContext`westok$$ = False]]; 
             If[$CellContext`y$$ < 
               8, $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, \
$CellContext`x$$, $CellContext`y$$ + 1, $CellContext`n$$]; If[
                 Not[$CellContext`swattacked$$], $CellContext`northok$$ = 
                 True, $CellContext`northok$$ = False]]; 
             If[$CellContext`y$$ > 
               1, $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, \
$CellContext`x$$, $CellContext`y$$ - 1, $CellContext`n$$]; If[
                 Not[$CellContext`swattacked$$], $CellContext`southok$$ = 
                 True, $CellContext`southok$$ = False]]; If[
               
               And[$CellContext`x$$ > 1, $CellContext`westok$$ == True, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  1, $CellContext`y$$] != $CellContext`n$$], \
$CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$}}]]; If[
               
               And[$CellContext`x$$ < 8, $CellContext`eastok$$ == True, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  1, $CellContext`y$$] != $CellContext`n$$], \
$CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$}}]]; If[
               
               And[$CellContext`y$$ > 1, $CellContext`southok$$ == True, 
                Part[$CellContext`side$$, $CellContext`x$$, $CellContext`y$$ - 
                  1] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$, $CellContext`y$$ - 1}}]]; If[
               
               And[$CellContext`y$$ < 8, $CellContext`northok$$ == True, 
                Part[$CellContext`side$$, $CellContext`x$$, $CellContext`y$$ + 
                  1] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$, $CellContext`y$$ + 1}}]]; If[
               
               And[$CellContext`x$$ > 1, $CellContext`y$$ > 1, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  1, $CellContext`y$$ - 
                  1] != $CellContext`n$$], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, $CellContext`x$$ - 
                  1, $CellContext`y$$ - 1, $CellContext`n$$]; If[
                 Not[$CellContext`swattacked$$], $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$ - 1}}]]]; If[
               
               And[$CellContext`x$$ > 1, $CellContext`y$$ < 8, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  1, $CellContext`y$$ + 
                  1] != $CellContext`n$$], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, $CellContext`x$$ - 
                  1, $CellContext`y$$ + 1, $CellContext`n$$]; If[
                 Not[$CellContext`swattacked$$], $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$ + 1}}]]]; If[
               
               And[$CellContext`x$$ < 8, $CellContext`y$$ > 1, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  1, $CellContext`y$$ - 
                  1] != $CellContext`n$$], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, $CellContext`x$$ + 
                  1, $CellContext`y$$ - 1, $CellContext`n$$]; If[
                 Not[$CellContext`swattacked$$], $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$ - 1}}]]]; If[
               
               And[$CellContext`x$$ < 8, $CellContext`y$$ < 8, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  1, $CellContext`y$$ + 
                  1] != $CellContext`n$$], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, $CellContext`x$$ + 
                  1, $CellContext`y$$ + 1, $CellContext`n$$]; If[
                 Not[$CellContext`swattacked$$], $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$ + 
                    1}}]]]; $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, \
$CellContext`x$$, $CellContext`y$$, $CellContext`n$$]; If[
               Not[$CellContext`swattacked$$], If[
                 
                 And[{$CellContext`x$$, $CellContext`y$$} == {5, 
                   1}, $CellContext`westok$$ == 
                  True, $CellContext`unmoveda1$$ == True, 
                  Part[$CellContext`side$$, 1, 1] == $CellContext`n$$, 
                  Part[$CellContext`side$$, 4, 1] == 0, 
                  Part[$CellContext`side$$, 3, 1] == 0, 
                  Part[$CellContext`side$$, 2, 1] == 
                  0], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, 3, 
                    1, $CellContext`n$$]; If[
                   Not[$CellContext`swattacked$$], $CellContext`list$$ = 
                   AppendTo[$CellContext`list$$, {{5, 1}, {3, 1}}]]]; If[
                 
                 And[{$CellContext`x$$, $CellContext`y$$} == {5, 
                   1}, $CellContext`eastok$$ == 
                  True, $CellContext`unmovedh1$$ == True, 
                  Part[$CellContext`side$$, 8, 1] == $CellContext`n$$, 
                  Part[$CellContext`side$$, 6, 1] == 0, 
                  Part[$CellContext`side$$, 7, 1] == 
                  0], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, 7, 
                    1, $CellContext`n$$]; If[
                   Not[$CellContext`swattacked$$], $CellContext`list$$ = 
                   AppendTo[$CellContext`list$$, {{5, 1}, {7, 1}}]]]; If[
                 
                 And[{$CellContext`x$$, $CellContext`y$$} == {5, 
                   8}, $CellContext`westok$$ == 
                  True, $CellContext`unmoveda8$$ == True, 
                  Part[$CellContext`side$$, 1, 8] == $CellContext`n$$, 
                  Part[$CellContext`side$$, 4, 8] == 0, 
                  Part[$CellContext`side$$, 3, 8] == 0, 
                  Part[$CellContext`side$$, 2, 8] == 
                  0], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, 3, 
                    8, $CellContext`n$$]; If[
                   Not[$CellContext`swattacked$$], $CellContext`list$$ = 
                   AppendTo[$CellContext`list$$, {{5, 8}, {3, 8}}]]]; If[
                 
                 And[{$CellContext`x$$, $CellContext`y$$} == {5, 
                   8}, $CellContext`eastok$$ == 
                  True, $CellContext`unmovedh8$$ == True, 
                  Part[$CellContext`side$$, 8, 8] == $CellContext`n$$, 
                  Part[$CellContext`side$$, 6, 8] == 0, 
                  Part[$CellContext`side$$, 7, 8] == 
                  0], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, 7, 
                    8, $CellContext`n$$]; If[
                   Not[$CellContext`swattacked$$], $CellContext`list$$ = 
                   AppendTo[$CellContext`list$$, {{5, 8}, {7, 8}}]]]]; 
             Part[$CellContext`side$$, $CellContext`x$$, $CellContext`y$$] = \
$CellContext`n$$; 
             Part[$CellContext`type$$, $CellContext`x$$, $CellContext`y$$] = \
$CellContext`kk], {$CellContext`x$$, 8}, {$CellContext`y$$, 
            8}]; $CellContext`l = Length[$CellContext`list$$]; 
         Do[$CellContext`a = 
            Part[$CellContext`list$$, $CellContext`j$$, 1]; $CellContext`b = 
            Part[$CellContext`list$$, $CellContext`j$$, 2]; $CellContext`ax = 
            Part[$CellContext`a, 1]; $CellContext`ay = 
            Part[$CellContext`a, 2]; $CellContext`bx = 
            Part[$CellContext`b, 1]; $CellContext`by = 
            Part[$CellContext`b, 2]; $CellContext`t = 
            Part[$CellContext`type$$, $CellContext`ax, $CellContext`ay]; 
           If[$CellContext`t != $CellContext`kk, 
             Part[$CellContext`side$$, $CellContext`ax, $CellContext`ay] = (
               Part[$CellContext`type$$, $CellContext`ax, $CellContext`ay] = 
               0); $CellContext`olds = 
              Part[$CellContext`side$$, $CellContext`bx, $CellContext`by]; \
$CellContext`oldt = 
              Part[$CellContext`type$$, $CellContext`bx, $CellContext`by]; 
             Part[$CellContext`side$$, $CellContext`bx, $CellContext`by] = \
$CellContext`n$$; 
             Part[$CellContext`type$$, $CellContext`bx, $CellContext`by] = \
$CellContext`t; $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, \
$CellContext`kx$$, $CellContext`ky$$, $CellContext`n$$]; 
             Part[$CellContext`side$$, $CellContext`ax, $CellContext`ay] = \
$CellContext`n$$; 
             Part[$CellContext`type$$, $CellContext`ax, $CellContext`ay] = \
$CellContext`t; 
             Part[$CellContext`side$$, $CellContext`bx, $CellContext`by] = \
$CellContext`olds; 
             Part[$CellContext`type$$, $CellContext`bx, $CellContext`by] = \
$CellContext`oldt; 
             If[$CellContext`swattacked$$, 
               Part[$CellContext`list$$, $CellContext`j$$] = {{0, 0}, {0, 
                0}}]], {$CellContext`j$$, 
            2, $CellContext`l}]; $CellContext`list1 = $CellContext`list0; Do[
           If[
           Part[$CellContext`list$$, $CellContext`j$$] != {{0, 0}, {0, 
             0}}, $CellContext`list1 = AppendTo[$CellContext`list1, 
              
              Part[$CellContext`list$$, $CellContext`j$$]]], \
{$CellContext`j$$, 
            2, $CellContext`l}]; $CellContext`list$$ = $CellContext`list1]; \
$CellContext`l = Length[$CellContext`list$$]; ClickPane[
         Graphics[{$CellContext`board, 
           EdgeForm[Thin], 
           If[$CellContext`f$$ == $CellContext`r$$, 
            Table[{
              If[
              Part[$CellContext`side$$, $CellContext`i$$, $CellContext`j$$] == 
               1, 
               Which[$CellContext`colw$$ == 1, 
                RGBColor[0.9, 0.9, 0.5], $CellContext`colw$$ == 2, 
                RGBColor[0.7, 0.7, 0.4], $CellContext`colw$$ == 3, 
                RGBColor[0.9, 0.3, 0.3]], 
               Which[$CellContext`colb$$ == 1, 
                RGBColor[0.4, 0.4, 0.3], $CellContext`colb$$ == 2, 
                RGBColor[0.3, 0.4, 0.1], $CellContext`colb$$ == 3, 
                RGBColor[0.2, 0.5, 0.5]]], 
              Which[
              Part[$CellContext`type$$, $CellContext`i$$, $CellContext`j$$] == \
$CellContext`pp, 
               
               Translate[$CellContext`pawn, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`type$$, $CellContext`i$$, $CellContext`j$$] == \
$CellContext`rr, 
               
               Translate[$CellContext`rook, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`type$$, $CellContext`i$$, $CellContext`j$$] == \
$CellContext`nn, 
               
               Translate[$CellContext`knight, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`type$$, $CellContext`i$$, $CellContext`j$$] == \
$CellContext`bb, 
               
               Translate[$CellContext`bishop, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`type$$, $CellContext`i$$, $CellContext`j$$] == \
$CellContext`qq, 
               
               Translate[$CellContext`queen, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`type$$, $CellContext`i$$, $CellContext`j$$] == \
$CellContext`kk, 
               
               Translate[$CellContext`king, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`type$$, $CellContext`i$$, $CellContext`j$$] == 
               0, {}]}, {$CellContext`i$$, 8}, {$CellContext`j$$, 8}], {}], 
           If[$CellContext`f$$ < $CellContext`r$$, 
            Table[{
              If[
              Part[$CellContext`sides$$, $CellContext`f$$ + 
                 1, $CellContext`i$$, $CellContext`j$$] == 1, 
               Which[$CellContext`colw$$ == 1, 
                RGBColor[0.9, 0.9, 0.5], $CellContext`colw$$ == 2, 
                RGBColor[0.7, 0.7, 0.4], $CellContext`colw$$ == 3, 
                RGBColor[0.9, 0.3, 0.3]], 
               Which[$CellContext`colb$$ == 1, 
                RGBColor[0.4, 0.4, 0.3], $CellContext`colb$$ == 2, 
                RGBColor[0.3, 0.4, 0.1], $CellContext`colb$$ == 3, 
                RGBColor[0.2, 0.5, 0.5]]], 
              Which[
              Part[$CellContext`types$$, $CellContext`f$$ + 
                 1, $CellContext`i$$, $CellContext`j$$] == $CellContext`pp, 
               
               Translate[$CellContext`pawn, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`types$$, $CellContext`f$$ + 
                 1, $CellContext`i$$, $CellContext`j$$] == $CellContext`rr, 
               
               Translate[$CellContext`rook, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`types$$, $CellContext`f$$ + 
                 1, $CellContext`i$$, $CellContext`j$$] == $CellContext`nn, 
               
               Translate[$CellContext`knight, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`types$$, $CellContext`f$$ + 
                 1, $CellContext`i$$, $CellContext`j$$] == $CellContext`bb, 
               
               Translate[$CellContext`bishop, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`types$$, $CellContext`f$$ + 
                 1, $CellContext`i$$, $CellContext`j$$] == $CellContext`qq, 
               
               Translate[$CellContext`queen, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`types$$, $CellContext`f$$ + 
                 1, $CellContext`i$$, $CellContext`j$$] == $CellContext`kk, 
               
               Translate[$CellContext`king, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`types$$, $CellContext`f$$ + 
                 1, $CellContext`i$$, $CellContext`j$$] == 
               0, {}]}, {$CellContext`i$$, 8}, {$CellContext`j$$, 8}], {}], 
           Green, 
           If[
            
            And[$CellContext`showtargets$$, $CellContext`h$$ == 
             1, $CellContext`from$$ != {0, 0}, $CellContext`to$$ == {0, 0}], 
            Table[
             If[
             Part[$CellContext`list$$, $CellContext`i$$, 
                1] == $CellContext`oldfrom$$, 
              
              Disk[{Part[$CellContext`list$$, $CellContext`i$$, 2, 1] - 0.5, 
                Part[$CellContext`list$$, $CellContext`i$$, 2, 2] - 0.5}, 
               0.2], {}], {$CellContext`i$$, $CellContext`l}], {}], 
           If[
            
            And[$CellContext`showmoves$$, $CellContext`h$$ == 
             1, $CellContext`from$$ == {0, 0}], 
            Table[
             
             Arrow[{Part[$CellContext`list$$, $CellContext`i$$, 1] - {0.5, 
               0.5}, Part[$CellContext`list$$, $CellContext`i$$, 2] - {0.5, 
               0.5}}], {$CellContext`i$$, 2, $CellContext`l}], {}], 
           If[$CellContext`unmoveda1$$, Green, Red], 
           If[$CellContext`edit$$ == "castling options", 
            Disk[{0.5, 0.5}, 0.2], {}], 
           If[$CellContext`unmovedh1$$, Green, Red], 
           If[$CellContext`edit$$ == "castling options", 
            Disk[{7.5, 0.5}, 0.2], {}], 
           If[$CellContext`unmoveda8$$, Green, Red], 
           If[$CellContext`edit$$ == "castling options", 
            Disk[{0.5, 7.5}, 0.2], {}], 
           If[$CellContext`unmovedh8$$, Green, Red], 
           If[$CellContext`edit$$ == "castling options", 
            Disk[{7.5, 7.5}, 0.2], {}], Yellow, 
           If[$CellContext`from$$ != {0, 0}, 
            Disk[$CellContext`from$$ - {0.5, 0.5}, 0.2], {}], Black, 
           If[$CellContext`n$$ == 1, 
            Disk[{0, 0}, 0.1], 
            Disk[{0, 8}, 0.1]], 
           If[$CellContext`f$$ > 0, 
            If[Part[$CellContext`wfrom$$, $CellContext`f$$] != {0, 0}, 
             Text[
              Style[
               Row[{$CellContext`f$$, ". ", 
                 Part[$CellContext`names, 
                  Part[$CellContext`wpiece$$, $CellContext`f$$]], 
                 Part[$CellContext`alpha, 
                  Part[$CellContext`wfrom$$, $CellContext`f$$, 1]], 
                 Part[$CellContext`wfrom$$, $CellContext`f$$, 2], " ", 
                 Part[$CellContext`captures$$, $CellContext`f$$, 1]}], 12], {
              2.95, -0.5}], 
             Text[
              Style[
               Row[{$CellContext`f$$, ". ", "... - ..."}], 12], {
              2.95, -0.5}]], 
            Text[" ", {2.8, -0.5}]], 
           If[
            And[
             Inequality[
              Length[$CellContext`wto$$], GreaterEqual, $CellContext`f$$, 
              Greater, 0], 
             Part[$CellContext`wto$$, $CellContext`f$$] != {0, 0}], {
             Text[
              Style[
               Row[{
                 Part[$CellContext`alpha, 
                  Part[$CellContext`wto$$, $CellContext`f$$, 1]], 
                 Part[$CellContext`wto$$, $CellContext`f$$, 2], 
                 Part[$CellContext`checks$$, $CellContext`f$$, 1]}], 12], {
              3.75, -0.5}], 
             If[
              
              And[$CellContext`l == 1, $CellContext`h$$ == 1, 
               Length[$CellContext`bto$$] < $CellContext`r$$], 
              If[Part[$CellContext`checks$$, $CellContext`f$$, 1] == "+", 
               Text[
                Style[
                 Row[{"mate"}], 12], {4.4, -0.5}], 
               Text[
                Style[
                 Row[{"stalemate"}], 12], {4.4, -0.5}]], {}]}, {}], 
           If[
            Inequality[
             Length[$CellContext`bfrom$$], GreaterEqual, $CellContext`f$$, 
             Greater, 0], 
            Text[
             Style[
              Row[{
                Part[$CellContext`names, 
                 Part[$CellContext`bpiece$$, $CellContext`f$$]], 
                Part[$CellContext`alpha, 
                 Part[$CellContext`bfrom$$, $CellContext`f$$, 1]], 
                Part[$CellContext`bfrom$$, $CellContext`f$$, 2], " ", 
                Part[$CellContext`captures$$, $CellContext`f$$, 2]}], 12], {
             4.4, -0.5}], {}], 
           If[
            Inequality[
             Length[$CellContext`bto$$], GreaterEqual, $CellContext`f$$, 
             Greater, 0], {
             Text[
              Style[
               Row[{
                 Part[$CellContext`alpha, 
                  Part[$CellContext`bto$$, $CellContext`f$$, 1]], 
                 Part[$CellContext`bto$$, $CellContext`f$$, 2], 
                 Part[$CellContext`checks$$, $CellContext`f$$, 2]}], 12], {
              5., -0.5}], 
             If[
              And[$CellContext`l == 1, $CellContext`h$$ == 1], 
              If[Part[$CellContext`checks$$, $CellContext`f$$, 2] == "+", 
               Text[
                Style[
                 Row[{"mate"}], 12], {5.8, -0.5}], 
               Text[
                Style[
                 Row[{"stalemate"}], 12], {5.8, -0.5}]], {}]}, {}]}, 
          PlotRange -> {{-0.1, 8.1}, {-0.9, 8.1}}, ImageSize -> {400, 400}], {
         
          If[
           And[$CellContext`h$$ == 1, 
            Or[
            Length[$CellContext`list$$] > 1, $CellContext`edit$$ != 
             "play"]], {$CellContext`pos$$ = Floor[#] + {1, 1}, 
            Part[$CellContext`pos$$, 1] = Max[
              Part[$CellContext`pos$$, 1], 1], Part[$CellContext`pos$$, 1] = 
            Min[
              Part[$CellContext`pos$$, 1], 8], Part[$CellContext`pos$$, 2] = 
            Max[
              Part[$CellContext`pos$$, 2], 1], Part[$CellContext`pos$$, 2] = 
            Min[
              Part[$CellContext`pos$$, 2], 8], 
            If[
             Not[$CellContext`part1$$], 
             Which[$CellContext`edit$$ == "play", {}, $CellContext`edit$$ == 
               "delete", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 0; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 0, $CellContext`edit$$ == 
               "white pawn", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 1, $CellContext`edit$$ == 
               "white rook", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 2, $CellContext`edit$$ == 
               "white knight", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 3, $CellContext`edit$$ == 
               "white bishop", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 4, $CellContext`edit$$ == 
               "white queen", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 5, $CellContext`edit$$ == 
               "white king", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 6, $CellContext`edit$$ == 
               "black pawn", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = -1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 1, $CellContext`edit$$ == 
               "black rook", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = -1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 2, $CellContext`edit$$ == 
               "black knight", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = -1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 3, $CellContext`edit$$ == 
               "black bishop", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = -1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 4, $CellContext`edit$$ == 
               "black queen", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = -1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 5, $CellContext`edit$$ == 
               "black king", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = -1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 6, 
               
               And[$CellContext`edit$$ == "next player", $CellContext`r$$ == 
                0], $CellContext`n$$ = -$CellContext`n$$]; 
             If[$CellContext`edit$$ != 
               "play", $CellContext`list$$ = $CellContext`list0]], 
            If[
             
             And[$CellContext`edit$$ == "castling options", 
              Part[$CellContext`type$$, 
                Part[$CellContext`pos$$, 1], 
                Part[$CellContext`pos$$, 2]] == $CellContext`rr], 
             If[$CellContext`pos$$ == {1, 1}, $CellContext`unmoveda1$$ = 
               Not[$CellContext`unmoveda1$$]]; 
             If[$CellContext`pos$$ == {8, 1}, $CellContext`unmovedh1$$ = 
               Not[$CellContext`unmovedh1$$]]; 
             If[$CellContext`pos$$ == {1, 8}, $CellContext`unmoveda8$$ = 
               Not[$CellContext`unmoveda8$$]]; 
             If[$CellContext`pos$$ == {8, 8}, $CellContext`unmovedh8$$ = 
               Not[$CellContext`unmovedh8$$]], {}], 
            
            If[$CellContext`edit$$ == 
             "reset", $CellContext`r$$ = 0; $CellContext`edit$$ = 
              "play"; $CellContext`wto$$ = ($CellContext`wfrom$$ = \
($CellContext`bfrom$$ = ($CellContext`bto$$ = ($CellContext`wpiece$$ = \
($CellContext`bpiece$$ = {}))))); $CellContext`side$$ = $CellContext`side0; \
$CellContext`type$$ = $CellContext`type0; $CellContext`list$$ = \
$CellContext`list0; $CellContext`sides$$ = {$CellContext`side0}; \
$CellContext`types$$ = {$CellContext`type0}; $CellContext`part1$$ = \
($CellContext`part2$$ = False); $CellContext`ok$$ = 
              False; $CellContext`from$$ = ($CellContext`to$$ = \
($CellContext`epwhite$$ = ($CellContext`epblack$$ = {0, 
                  0}))); $CellContext`n$$ = 
              1; $CellContext`unmoveda1$$ = ($CellContext`unmoveda8$$ = \
($CellContext`unmovedh1$$ = ($CellContext`unmovedh8$$ = True)))], 
            
            If[$CellContext`edit$$ == 
             "clear", $CellContext`r$$ = 
              0; $CellContext`wto$$ = ($CellContext`wfrom$$ = \
($CellContext`bfrom$$ = ($CellContext`bto$$ = ($CellContext`wpiece$$ = \
($CellContext`bpiece$$ = {}))))); $CellContext`list$$ = $CellContext`list0; \
$CellContext`side$$ = ($CellContext`type$$ = $CellContext`all0); \
$CellContext`sides$$ = ($CellContext`types$$ = {$CellContext`all0}); \
$CellContext`part1$$ = ($CellContext`part2$$ = False); $CellContext`ok$$ = 
              False; $CellContext`from$$ = ($CellContext`to$$ = \
($CellContext`epwhite$$ = ($CellContext`epblack$$ = {0, 
                  0}))); $CellContext`n$$ = 
              1; $CellContext`unmoveda1$$ = ($CellContext`unmoveda8$$ = \
($CellContext`unmovedh1$$ = ($CellContext`unmovedh8$$ = True)))], 
            If[$CellContext`edit$$ == "play", {
              If[
               Or[
                And[$CellContext`n$$ == 1, 
                 Not[$CellContext`randomwhite$$]], 
                And[$CellContext`n$$ == -1, 
                 Not[$CellContext`randomblack$$]]], {$CellContext`l = 
                Length[$CellContext`list$$], $CellContext`part1$$ = \
($CellContext`part2$$ = False), 
                If[
                 And[
                 Part[$CellContext`from$$, 1] == 0, $CellContext`n$$ == 
                  Part[$CellContext`side$$, 
                    Part[$CellContext`pos$$, 1], 
                    Part[$CellContext`pos$$, 2]]], {
                  
                  For[$CellContext`i$$ = 
                   1, $CellContext`i$$ <= $CellContext`l, 
                   Increment[$CellContext`i$$], 
                   If[
                   Part[$CellContext`list$$, $CellContext`i$$, 
                    1] == $CellContext`pos$$, {$CellContext`part1$$ = True, 
                    Break[]}]]}], 
                If[
                 And[
                 Part[$CellContext`from$$, 1] != 0, 
                  Part[$CellContext`to$$, 1] == 0, $CellContext`n$$ != 
                  Part[$CellContext`side$$, 
                    Part[$CellContext`pos$$, 1], 
                    Part[$CellContext`pos$$, 2]]], {
                  
                  For[$CellContext`i$$ = 
                   1, $CellContext`i$$ <= $CellContext`l, 
                   Increment[$CellContext`i$$], 
                   If[
                    And[
                    Part[$CellContext`list$$, $CellContext`i$$, 
                    1] == $CellContext`oldfrom$$, 
                    Part[$CellContext`list$$, $CellContext`i$$, 
                    2] == $CellContext`pos$$], {$CellContext`part2$$ = True, 
                    Break[]}]]}], 
                
                If[$CellContext`part1$$, $CellContext`oldfrom$$ = \
($CellContext`from$$ = $CellContext`pos$$); $CellContext`to$$ = {0, 0}], 
                
                If[$CellContext`part2$$, $CellContext`to$$ = \
$CellContext`pos$$], 
                If[
                 
                 And[$CellContext`part1$$, $CellContext`n$$ == 
                  1], $CellContext`r$$ = $CellContext`r$$ + 
                   1; $CellContext`wfrom$$ = 
                  AppendTo[$CellContext`wfrom$$, $CellContext`pos$$]; \
$CellContext`wpiece$$ = AppendTo[$CellContext`wpiece$$, 
                    Part[$CellContext`type$$, 
                    Part[$CellContext`pos$$, 1], 
                    Part[$CellContext`pos$$, 2]]]], 
                If[
                 
                 And[$CellContext`part1$$, $CellContext`n$$ == -1], \
$CellContext`bfrom$$ = 
                  AppendTo[$CellContext`bfrom$$, $CellContext`pos$$]; \
$CellContext`bpiece$$ = AppendTo[$CellContext`bpiece$$, 
                    Part[$CellContext`type$$, 
                    Part[$CellContext`pos$$, 1], 
                    Part[$CellContext`pos$$, 2]]]; 
                 If[$CellContext`r$$ == 
                   0, $CellContext`r$$ = 
                    1; $CellContext`wfrom$$ = ($CellContext`wto$$ = {{0, 
                    0}}); $CellContext`wpiece$$ = {$CellContext`pp}; \
$CellContext`captures$$ = {{"-", "-"}, {"-", "-"}}]], 
                If[
                 And[
                  Not[$CellContext`part1$$], 
                  Not[$CellContext`part2$$]], If[
                   
                   And[$CellContext`from$$ != {0, 0}, $CellContext`to$$ == {0,
                     0}, $CellContext`n$$ == 1], $CellContext`wfrom$$ = 
                    Delete[$CellContext`wfrom$$, $CellContext`r$$]; \
$CellContext`wpiece$$ = 
                    Delete[$CellContext`wpiece$$, $CellContext`r$$]; \
$CellContext`r$$ = $CellContext`r$$ - 1, {}]; If[
                   
                   And[$CellContext`from$$ != {0, 0}, $CellContext`to$$ == {0,
                     0}, $CellContext`n$$ == -1], $CellContext`bfrom$$ = 
                    Delete[$CellContext`wfrom$$, $CellContext`r$$]; \
$CellContext`bpiece$$ = 
                    Delete[$CellContext`bpiece$$, $CellContext`r$$], {}]; \
$CellContext`from$$ = ($CellContext`to$$ = {0, 0})]}], 
              If[
               
               And[$CellContext`randomwhite$$, $CellContext`n$$ == 
                1, $CellContext`from$$ == {0, 0}], $CellContext`i$$ = 
                RandomInteger[{2, 
                   Length[$CellContext`list$$]}]; $CellContext`from$$ = 
                Part[$CellContext`list$$, $CellContext`i$$, 
                  1]; $CellContext`pos$$ = ($CellContext`to$$ = 
                 Part[$CellContext`list$$, $CellContext`i$$, 
                   2]); $CellContext`wfrom$$ = 
                AppendTo[$CellContext`wfrom$$, $CellContext`from$$]; \
$CellContext`wpiece$$ = AppendTo[$CellContext`wpiece$$, 
                  Part[$CellContext`type$$, 
                   Part[$CellContext`from$$, 1], 
                   Part[$CellContext`from$$, 2]]]; $CellContext`captures$$ = 
                Append[$CellContext`captures$$, {
                  "-", "-"}]; $CellContext`checks$$ = 
                Append[$CellContext`checks$$, {
                  " ", " "}]; $CellContext`r$$ = $CellContext`r$$ + 
                 1; $CellContext`part1$$ = False; $CellContext`part2$$ = 
                True], 
              If[
               
               And[$CellContext`randomblack$$, $CellContext`n$$ == -1, \
$CellContext`from$$ == {0, 0}], $CellContext`i$$ = RandomInteger[{2, 
                   Length[$CellContext`list$$]}]; $CellContext`from$$ = 
                Part[$CellContext`list$$, $CellContext`i$$, 
                  1]; $CellContext`pos$$ = ($CellContext`to$$ = 
                 Part[$CellContext`list$$, $CellContext`i$$, 
                   2]); $CellContext`bfrom$$ = 
                AppendTo[$CellContext`bfrom$$, $CellContext`from$$]; \
$CellContext`bpiece$$ = AppendTo[$CellContext`bpiece$$, 
                  Part[$CellContext`type$$, 
                   Part[$CellContext`from$$, 1], 
                   Part[$CellContext`from$$, 2]]]; 
               If[$CellContext`r$$ == 
                 0, $CellContext`r$$ = 
                  1; $CellContext`wfrom$$ = ($CellContext`wto$$ = {{
                    9, 
                    " "}}); $CellContext`wpiece$$ = {$CellContext`pp}]; \
$CellContext`captures$$ = 
                Append[$CellContext`captures$$, {
                  "-", "-"}]; $CellContext`part1$$ = 
                False; $CellContext`part2$$ = True], $CellContext`x$$ = 
              Part[$CellContext`from$$, 1], $CellContext`y$$ = 
              Part[$CellContext`from$$, 2], 
              If[$CellContext`part2$$, {
                If[
                 
                 Or[$CellContext`from$$ == {1, 1}, $CellContext`to$$ == {1, 
                   1}, $CellContext`from$$ == {5, 
                   1}], $CellContext`unmoveda1$$ = False], 
                If[
                 
                 Or[$CellContext`from$$ == {8, 1}, $CellContext`to$$ == {8, 
                   1}, $CellContext`from$$ == {5, 
                   1}], $CellContext`unmovedh1$$ = False], 
                If[
                 
                 Or[$CellContext`from$$ == {1, 8}, $CellContext`to$$ == {1, 
                   8}, $CellContext`from$$ == {5, 
                   8}], $CellContext`unmoveda8$$ = False], 
                If[
                 
                 Or[$CellContext`from$$ == {8, 8}, $CellContext`to$$ == {8, 
                   8}, $CellContext`from$$ == {5, 
                   8}], $CellContext`unmovedh8$$ = False], 
                If[
                 And[
                 Part[$CellContext`type$$, $CellContext`x$$, \
$CellContext`y$$] == $CellContext`pp, $CellContext`y$$ == 2, 
                  Part[$CellContext`to$$, 2] == 
                  4], $CellContext`epwhite$$ = {$CellContext`x$$, 3}], 
                If[
                 And[
                 Part[$CellContext`type$$, $CellContext`x$$, \
$CellContext`y$$] == $CellContext`pp, $CellContext`y$$ == 7, 
                  Part[$CellContext`to$$, 2] == 
                  5], $CellContext`epblack$$ = {$CellContext`x$$, 6}], 
                If[
                 And[
                 Part[$CellContext`type$$, $CellContext`x$$, \
$CellContext`y$$] == $CellContext`pp, 
                  Or[
                  Part[$CellContext`to$$, 2] == 8, Part[$CellContext`to$$, 2] == 
                   1]], 
                 
                 Which[$CellContext`prom$$ == "queen", 
                  Part[$CellContext`type$$, 
                    Part[$CellContext`to$$, 1], 
                    
                    Part[$CellContext`to$$, 
                    2]] = $CellContext`qq, $CellContext`prom$$ == "rook", 
                  Part[$CellContext`type$$, 
                    Part[$CellContext`to$$, 1], 
                    
                    Part[$CellContext`to$$, 
                    2]] = $CellContext`rr, $CellContext`prom$$ == "bishop", 
                  Part[$CellContext`type$$, 
                    Part[$CellContext`to$$, 1], 
                    
                    Part[$CellContext`to$$, 
                    2]] = $CellContext`bb, $CellContext`prom$$ == "knight", 
                  Part[$CellContext`type$$, 
                    Part[$CellContext`to$$, 1], 
                    Part[$CellContext`to$$, 2]] = $CellContext`nn], 
                 Part[$CellContext`type$$, 
                   Part[$CellContext`to$$, 1], 
                   Part[$CellContext`to$$, 2]] = 
                 Part[$CellContext`type$$, $CellContext`x$$, \
$CellContext`y$$]], 
                If[
                Part[$CellContext`type$$, $CellContext`x$$, $CellContext`y$$] == \
$CellContext`kk, If[
                   
                   And[$CellContext`from$$ == {5, 1}, $CellContext`to$$ == {3,
                     1}], Part[$CellContext`type$$, 4, 1] = $CellContext`rr; 
                   Part[$CellContext`type$$, 1, 1] = 0; 
                   Part[$CellContext`side$$, 4, 1] = 1; 
                   Part[$CellContext`side$$, 1, 1] = 0]; If[
                   
                   And[$CellContext`from$$ == {5, 1}, $CellContext`to$$ == {7,
                     1}], Part[$CellContext`type$$, 6, 1] = $CellContext`rr; 
                   Part[$CellContext`type$$, 8, 1] = 0; 
                   Part[$CellContext`side$$, 6, 1] = 1; 
                   Part[$CellContext`side$$, 8, 1] = 0]; If[
                   
                   And[$CellContext`from$$ == {5, 8}, $CellContext`to$$ == {3,
                     8}], Part[$CellContext`type$$, 4, 8] = $CellContext`rr; 
                   Part[$CellContext`type$$, 1, 8] = 0; 
                   Part[$CellContext`side$$, 4, 8] = -1; 
                   Part[$CellContext`side$$, 1, 8] = 0]; If[
                   
                   And[$CellContext`from$$ == {5, 8}, $CellContext`to$$ == {7,
                     8}], Part[$CellContext`type$$, 6, 8] = $CellContext`rr; 
                   Part[$CellContext`type$$, 8, 8] = 0; 
                   Part[$CellContext`side$$, 6, 8] = -1; 
                   Part[$CellContext`side$$, 8, 8] = 
                    0]], $CellContext`capture$$ = "-"; If[
                  And[
                  Part[$CellContext`type$$, $CellContext`x$$, \
$CellContext`y$$] == $CellContext`pp, $CellContext`to$$ == \
$CellContext`epblack$$], Part[$CellContext`type$$, 
                    Part[$CellContext`to$$, 1], Part[$CellContext`to$$, 2] - 
                    1] = 0; Part[$CellContext`side$$, 
                    Part[$CellContext`to$$, 1], Part[$CellContext`to$$, 2] - 
                    1] = 0; $CellContext`capture$$ = "x"], 
                If[
                 And[
                 Part[$CellContext`type$$, $CellContext`x$$, \
$CellContext`y$$] == $CellContext`pp, $CellContext`to$$ == \
$CellContext`epwhite$$], Part[$CellContext`type$$, 
                    Part[$CellContext`to$$, 1], Part[$CellContext`to$$, 2] + 
                    1] = 0; Part[$CellContext`side$$, 
                    Part[$CellContext`to$$, 1], Part[$CellContext`to$$, 2] + 
                    1] = 0; $CellContext`capture$$ = "x"], 
                Part[$CellContext`type$$, $CellContext`x$$, $CellContext`y$$] = 
                0, 
                If[Part[$CellContext`side$$, 
                   Part[$CellContext`to$$, 1], 
                   Part[$CellContext`to$$, 2]] != 0, $CellContext`capture$$ = 
                 "x"], Part[$CellContext`side$$, 
                  Part[$CellContext`to$$, 1], 
                  Part[$CellContext`to$$, 2]] = 
                Part[$CellContext`side$$, $CellContext`x$$, $CellContext`y$$],
                 Part[$CellContext`side$$, $CellContext`x$$, \
$CellContext`y$$] = 0, 
                
                If[$CellContext`n$$ == 
                 1, $CellContext`wto$$ = 
                  AppendTo[$CellContext`wto$$, $CellContext`pos$$]; \
$CellContext`captures$$ = Append[$CellContext`captures$$, {"-", "-"}]; 
                 Part[$CellContext`captures$$, $CellContext`r$$, 
                    1] = $CellContext`capture$$; $CellContext`list$$ = \
$CellContext`list0; $CellContext`checks$$ = 
                  Append[$CellContext`checks$$, {" ", " "}]; Do[
                   If[
                    And[
                    Part[$CellContext`type$$, $CellContext`i$$, \
$CellContext`j$$] == $CellContext`kk, 
                    Part[$CellContext`side$$, $CellContext`i$$, \
$CellContext`j$$] == -$CellContext`n$$], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, \
$CellContext`i$$, $CellContext`j$$, -$CellContext`n$$]; 
                    Break[]], {$CellContext`i$$, 8}, {$CellContext`j$$, 8}]; 
                 If[$CellContext`swattacked$$, 
                   Part[$CellContext`checks$$, $CellContext`r$$, 1] = "+"]], 
                
                If[$CellContext`n$$ == -1, $CellContext`bto$$ = 
                  AppendTo[$CellContext`bto$$, $CellContext`pos$$]; \
$CellContext`sides$$ = 
                  AppendTo[$CellContext`sides$$, $CellContext`side$$]; \
$CellContext`types$$ = AppendTo[$CellContext`types$$, $CellContext`type$$]; 
                 Part[$CellContext`captures$$, $CellContext`r$$, 
                    2] = $CellContext`capture$$; $CellContext`list$$ = \
$CellContext`list0; Do[
                   If[
                    And[
                    Part[$CellContext`type$$, $CellContext`i$$, \
$CellContext`j$$] == $CellContext`kk, 
                    Part[$CellContext`side$$, $CellContext`i$$, \
$CellContext`j$$] == -$CellContext`n$$], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, \
$CellContext`i$$, $CellContext`j$$, -$CellContext`n$$]; 
                    Break[]], {$CellContext`i$$, 8}, {$CellContext`j$$, 8}]; 
                 If[$CellContext`swattacked$$, 
                   Part[$CellContext`checks$$, $CellContext`r$$, 2] = "+"]], 
                
                If[$CellContext`n$$ == 
                 1, $CellContext`epblack$$ = {0, 
                  0}, $CellContext`epwhite$$ = {0, 
                  0}], $CellContext`n$$ = -$CellContext`n$$, \
$CellContext`list$$ = $CellContext`list0, $CellContext`part1$$ = \
($CellContext`part2$$ = 
                 False), $CellContext`from$$ = ($CellContext`to$$ = {0, 
                  0})}]}]}]}& ]), 
      "Specifications" :> {{{$CellContext`colw$$, 1, 
          Style["color White", 10]}, {1, 2, 3}, ControlType -> 
         PopupMenu}, {{$CellContext`colb$$, 1, 
          Style["color Black", 10]}, {1, 2, 3}, ControlType -> 
         PopupMenu}, {{$CellContext`randomwhite$$, False, "random White"}, {
         True, False}}, {{$CellContext`randomblack$$, False, 
          "random Black"}, {
         True, False}}, {{$CellContext`showmoves$$, False, "show moves"}, {
         True, False}}, {{$CellContext`showtargets$$, True, "show targets"}, {
         True, False}}, {{$CellContext`prom$$, "queen", 
          Style["promotion to", 10]}, {"queen", "rook", "bishop", "knight"}, 
         ControlType -> PopupMenu}, {{$CellContext`edit$$, "play", 
          Style["edit position", 10]}, {
         "play", "reset", "clear", "delete", "white pawn", "white knight", 
          "white bishop", "white rook", "white queen", "white king", 
          "black pawn", "black knight", "black bishop", "black rook", 
          "black queen", "black king", "castling options", "next player"}, 
         ControlType -> PopupMenu}, {{$CellContext`h$$, 1, 
          Style["history"]}, 0, 1, ControlType -> Slider, ImageSize -> 
         Small}, {{$CellContext`i$$, 0}, ControlType -> 
         None}, {{$CellContext`j$$, 0}, ControlType -> 
         None}, {{$CellContext`kx$$, 0}, ControlType -> 
         None}, {{$CellContext`ky$$, 0}, ControlType -> 
         None}, {{$CellContext`pos$$, {0, 0}}, ControlType -> 
         None}, {{$CellContext`from$$, {0, 0}}, ControlType -> 
         None}, {{$CellContext`oldfrom$$, {0, 0}}, ControlType -> 
         None}, {{$CellContext`to$$, {0, 0}}, ControlType -> 
         None}, {{$CellContext`side$$, {{1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 
          0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
          0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
          0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
          0, -1, -1}}}, ControlType -> 
         None}, {{$CellContext`type$$, {{2, 1, 0, 0, 0, 0, 1, 2}, {3, 1, 0, 0,
           0, 0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 4}, {5, 1, 0, 0, 0, 0, 1, 5}, {
          6, 1, 0, 0, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0, 1, 4}, {3, 1, 0, 0, 0, 
          0, 1, 3}, {2, 1, 0, 0, 0, 0, 1, 2}}}, ControlType -> 
         None}, {{$CellContext`n$$, 1}, ControlType -> 
         None}, {{$CellContext`list$$, {{{0, 0}, {0, 0}}}}, ControlType -> 
         None}, {{$CellContext`sides$$, {{{1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 
          0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
          0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
          0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
          0, -1, -1}}}}, ControlType -> 
         None}, {{$CellContext`types$$, {{{2, 1, 0, 0, 0, 0, 1, 2}, {3, 1, 0, 
          0, 0, 0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 4}, {5, 1, 0, 0, 0, 0, 1, 
          5}, {6, 1, 0, 0, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0, 1, 4}, {3, 1, 0, 0,
           0, 0, 1, 3}, {2, 1, 0, 0, 0, 0, 1, 2}}}}, ControlType -> 
         None}, {{$CellContext`wfrom$$, {}}, ControlType -> 
         None}, {{$CellContext`wto$$, {}}, ControlType -> 
         None}, {{$CellContext`wpiece$$, {}}, ControlType -> 
         None}, {{$CellContext`bfrom$$, {}}, ControlType -> 
         None}, {{$CellContext`bto$$, {}}, ControlType -> 
         None}, {{$CellContext`bpiece$$, {}}, ControlType -> 
         None}, {{$CellContext`unmoveda1$$, True}, ControlType -> 
         None}, {{$CellContext`unmoveda8$$, True}, ControlType -> 
         None}, {{$CellContext`unmovedh1$$, True}, ControlType -> 
         None}, {{$CellContext`unmovedh8$$, True}, ControlType -> 
         None}, {{$CellContext`epwhite$$, {0, 0}}, ControlType -> 
         None}, {{$CellContext`epblack$$, {0, 0}}, ControlType -> 
         None}, {{$CellContext`r$$, 0}, ControlType -> 
         None}, {{$CellContext`f$$, 0}, ControlType -> 
         None}, {{$CellContext`capture$$, "-"}, ControlType -> 
         None}, {{$CellContext`captures$$, {{"-", "-"}}}, ControlType -> 
         None}, {{$CellContext`checks$$, {{" ", " "}}}, ControlType -> 
         None}, {{$CellContext`part1$$, False}, ControlType -> 
         None}, {{$CellContext`part2$$, False}, ControlType -> 
         None}, {{$CellContext`ok$$, False}, ControlType -> 
         None}, {{$CellContext`eastok$$, False}, ControlType -> 
         None}, {{$CellContext`westok$$, False}, ControlType -> 
         None}, {{$CellContext`southok$$, False}, ControlType -> 
         None}, {{$CellContext`northok$$, False}, ControlType -> 
         None}, {{$CellContext`x$$, 0}, ControlType -> 
         None}, {{$CellContext`y$$, 0}, ControlType -> 
         None}, {{$CellContext`swattacked$$, False}, ControlType -> None}}, 
      "Options" :> {ControlPlacement -> Left, AutorunSequencing -> {1}}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{651., {226., 231.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`list0 = {{{0, 0}, {0, 0}}}, $CellContext`t = 
       1, $CellContext`s = -1, $CellContext`pp = 1, $CellContext`nn = 
       3, $CellContext`bb = 4, $CellContext`qq = 5, $CellContext`rr = 
       2, $CellContext`kk = 6, $CellContext`check[
         Pattern[$CellContext`si$, 
          Blank[]], 
         Pattern[$CellContext`ty$, 
          Blank[]], 
         Pattern[$CellContext`x$, 
          Blank[]], 
         Pattern[$CellContext`y$, 
          Blank[]], 
         Pattern[$CellContext`n$, 
          Blank[]]] := 
       Module[{$CellContext`sw$}, $CellContext`sw$ = False; If[
           
           And[$CellContext`x$ < 8, $CellContext`n$ $CellContext`y$ < 
            4 + $CellContext`n$ 3, 
            Part[$CellContext`si$, $CellContext`x$ + 
              1, $CellContext`y$ + $CellContext`n$] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ + 
              1, $CellContext`y$ + $CellContext`n$] == $CellContext`pp], \
$CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ > 1, $CellContext`n$ $CellContext`y$ < 
            4 + $CellContext`n$ 3, 
            Part[$CellContext`si$, $CellContext`x$ - 
              1, $CellContext`y$ + $CellContext`n$] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ - 
              1, $CellContext`y$ + $CellContext`n$] == $CellContext`pp], \
$CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ < 8, $CellContext`y$ > 2, 
            Part[$CellContext`si$, $CellContext`x$ + 1, $CellContext`y$ - 
              2] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ + 1, $CellContext`y$ - 
              2] == $CellContext`nn], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ < 8, $CellContext`y$ < 7, 
            Part[$CellContext`si$, $CellContext`x$ + 1, $CellContext`y$ + 
              2] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ + 1, $CellContext`y$ + 
              2] == $CellContext`nn], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ > 1, $CellContext`y$ > 2, 
            Part[$CellContext`si$, $CellContext`x$ - 1, $CellContext`y$ - 
              2] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ - 1, $CellContext`y$ - 
              2] == $CellContext`nn], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ > 1, $CellContext`y$ < 7, 
            Part[$CellContext`si$, $CellContext`x$ - 1, $CellContext`y$ + 
              2] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ - 1, $CellContext`y$ + 
              2] == $CellContext`nn], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ < 7, $CellContext`y$ > 1, 
            Part[$CellContext`si$, $CellContext`x$ + 2, $CellContext`y$ - 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ + 2, $CellContext`y$ - 
              1] == $CellContext`nn], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ < 7, $CellContext`y$ < 8, 
            Part[$CellContext`si$, $CellContext`x$ + 2, $CellContext`y$ + 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ + 2, $CellContext`y$ + 
              1] == $CellContext`nn], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ > 2, $CellContext`y$ > 1, 
            Part[$CellContext`si$, $CellContext`x$ - 2, $CellContext`y$ - 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ - 2, $CellContext`y$ - 
              1] == $CellContext`nn], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ > 2, $CellContext`y$ < 8, 
            Part[$CellContext`si$, $CellContext`x$ - 2, $CellContext`y$ + 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ - 2, $CellContext`y$ + 
              1] == $CellContext`nn], $CellContext`sw$ = True]; 
         For[$CellContext`i$$ = 1, $CellContext`i$$ <= 
           Min[7 - $CellContext`x$, 7 - $CellContext`y$], 
           Increment[$CellContext`i$$], 
           If[
           Part[$CellContext`si$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$ + $CellContext`i$$] != 0, 
            Break[]]]; If[
           
           And[$CellContext`i$$ <= 
            Min[8 - $CellContext`x$, 8 - $CellContext`y$], 
            Part[$CellContext`si$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$ + $CellContext`i$$] == -$CellContext`n$, 
            Or[
            Part[$CellContext`ty$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$ + $CellContext`i$$] == $CellContext`qq, 
             Part[$CellContext`ty$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$ + $CellContext`i$$] == $CellContext`bb]], $CellContext`sw$ = 
           True]; For[$CellContext`i$$ = 1, $CellContext`i$$ <= 
           Min[$CellContext`x$ - 1, 7 - $CellContext`y$], 
           Increment[$CellContext`i$$], 
           If[
           Part[$CellContext`si$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$ + $CellContext`i$$] != 0, 
            Break[]]]; If[
           
           And[$CellContext`i$$ <= 
            Min[$CellContext`x$ - 1, 8 - $CellContext`y$], 
            Part[$CellContext`si$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$ + $CellContext`i$$] == -$CellContext`n$, 
            Or[
            Part[$CellContext`ty$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$ + $CellContext`i$$] == $CellContext`qq, 
             Part[$CellContext`ty$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$ + $CellContext`i$$] == $CellContext`bb]], $CellContext`sw$ = 
           True]; For[$CellContext`i$$ = 1, $CellContext`i$$ <= 
           Min[7 - $CellContext`x$, $CellContext`y$ - 1], 
           Increment[$CellContext`i$$], 
           If[
           Part[$CellContext`si$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$ - $CellContext`i$$] != 0, 
            Break[]]]; If[
           
           And[$CellContext`i$$ <= 
            Min[8 - $CellContext`x$, $CellContext`y$ - 1], 
            Part[$CellContext`si$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$ - $CellContext`i$$] == -$CellContext`n$, 
            Or[
            Part[$CellContext`ty$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$ - $CellContext`i$$] == $CellContext`qq, 
             Part[$CellContext`ty$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$ - $CellContext`i$$] == $CellContext`bb]], $CellContext`sw$ = 
           True]; For[$CellContext`i$$ = 1, $CellContext`i$$ <= 
           Min[$CellContext`x$ - 1, $CellContext`y$ - 1], 
           Increment[$CellContext`i$$], 
           If[
           Part[$CellContext`si$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$ - $CellContext`i$$] != 0, 
            Break[]]]; If[
           
           And[$CellContext`i$$ <= 
            Min[$CellContext`x$ - 1, $CellContext`y$ - 1], 
            Part[$CellContext`si$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$ - $CellContext`i$$] == -$CellContext`n$, 
            Or[
            Part[$CellContext`ty$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$ - $CellContext`i$$] == $CellContext`qq, 
             Part[$CellContext`ty$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$ - $CellContext`i$$] == $CellContext`bb]], $CellContext`sw$ = 
           True]; For[$CellContext`i$$ = 1, $CellContext`i$$ <= 
           7 - $CellContext`x$, 
           Increment[$CellContext`i$$], 
           If[
           Part[$CellContext`si$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$] != 0, 
            Break[]]]; If[
           
           And[$CellContext`i$$ <= 8 - $CellContext`x$, 
            Part[$CellContext`si$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$] == -$CellContext`n$, 
            Or[
            Part[$CellContext`ty$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$] == $CellContext`qq, 
             Part[$CellContext`ty$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$] == $CellContext`rr]], $CellContext`sw$ = True]; 
         For[$CellContext`i$$ = 1, $CellContext`i$$ <= $CellContext`x$ - 1, 
           Increment[$CellContext`i$$], 
           If[
           Part[$CellContext`si$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$] != 0, 
            Break[]]]; If[
           
           And[$CellContext`i$$ <= $CellContext`x$ - 1, 
            Part[$CellContext`si$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$] == -$CellContext`n$, 
            Or[
            Part[$CellContext`ty$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$] == $CellContext`qq, 
             Part[$CellContext`ty$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$] == $CellContext`rr]], $CellContext`sw$ = True]; 
         For[$CellContext`i$$ = 1, $CellContext`i$$ <= 7 - $CellContext`y$, 
           Increment[$CellContext`i$$], 
           If[
           Part[$CellContext`si$, $CellContext`x$, $CellContext`y$ + \
$CellContext`i$$] != 0, 
            Break[]]]; If[
           
           And[$CellContext`i$$ <= 8 - $CellContext`y$, 
            Part[$CellContext`si$, $CellContext`x$, $CellContext`y$ + \
$CellContext`i$$] == -$CellContext`n$, 
            Or[
            Part[$CellContext`ty$, $CellContext`x$, $CellContext`y$ + \
$CellContext`i$$] == $CellContext`qq, 
             Part[$CellContext`ty$, $CellContext`x$, $CellContext`y$ + \
$CellContext`i$$] == $CellContext`rr]], $CellContext`sw$ = True]; 
         For[$CellContext`i$$ = 1, $CellContext`i$$ <= $CellContext`y$ - 1, 
           Increment[$CellContext`i$$], 
           If[
           Part[$CellContext`si$, $CellContext`x$, $CellContext`y$ - \
$CellContext`i$$] != 0, 
            Break[]]]; If[
           
           And[$CellContext`i$$ <= $CellContext`y$ - 1, 
            Part[$CellContext`si$, $CellContext`x$, $CellContext`y$ - \
$CellContext`i$$] == -$CellContext`n$, 
            Or[
            Part[$CellContext`ty$, $CellContext`x$, $CellContext`y$ - \
$CellContext`i$$] == $CellContext`qq, 
             Part[$CellContext`ty$, $CellContext`x$, $CellContext`y$ - \
$CellContext`i$$] == $CellContext`rr]], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ < 8, 
            Part[$CellContext`si$, $CellContext`x$ + 
              1, $CellContext`y$] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ + 
              1, $CellContext`y$] == $CellContext`kk], $CellContext`sw$ = 
           True]; If[
           
           And[$CellContext`x$ > 1, 
            Part[$CellContext`si$, $CellContext`x$ - 
              1, $CellContext`y$] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ - 
              1, $CellContext`y$] == $CellContext`kk], $CellContext`sw$ = 
           True]; If[
           
           And[$CellContext`y$ < 8, 
            Part[$CellContext`si$, $CellContext`x$, $CellContext`y$ + 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$, $CellContext`y$ + 
              1] == $CellContext`kk], $CellContext`sw$ = True]; If[
           
           And[$CellContext`y$ > 1, 
            Part[$CellContext`si$, $CellContext`x$, $CellContext`y$ - 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$, $CellContext`y$ - 
              1] == $CellContext`kk], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ < 8, $CellContext`y$ < 8, 
            Part[$CellContext`si$, $CellContext`x$ + 1, $CellContext`y$ + 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ + 1, $CellContext`y$ + 
              1] == $CellContext`kk], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ > 1, $CellContext`y$ > 1, 
            Part[$CellContext`si$, $CellContext`x$ - 1, $CellContext`y$ - 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ - 1, $CellContext`y$ - 
              1] == $CellContext`kk], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ < 8, $CellContext`y$ > 1, 
            Part[$CellContext`si$, $CellContext`x$ + 1, $CellContext`y$ - 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ + 1, $CellContext`y$ - 
              1] == $CellContext`kk], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ > 1, $CellContext`y$ < 8, 
            Part[$CellContext`si$, $CellContext`x$ - 1, $CellContext`y$ + 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ - 1, $CellContext`y$ + 
              1] == $CellContext`kk], $CellContext`sw$ = 
           True]; $CellContext`sw$], $CellContext`l = 
       21, $CellContext`a = {8, 2}, $CellContext`b = {8, 4}, $CellContext`ax = 
       8, $CellContext`ay = 2, $CellContext`bx = 8, $CellContext`by = 
       4, $CellContext`olds = 0, $CellContext`oldt = 
       0, $CellContext`list1 = {{{0, 0}, {0, 0}}, {{1, 2}, {1, 3}}, {{1, 2}, {
        1, 4}}, {{2, 1}, {1, 3}}, {{2, 1}, {3, 3}}, {{2, 2}, {2, 3}}, {{2, 
        2}, {2, 4}}, {{3, 2}, {3, 3}}, {{3, 2}, {3, 4}}, {{4, 2}, {4, 3}}, {{
        4, 2}, {4, 4}}, {{5, 2}, {5, 3}}, {{5, 2}, {5, 4}}, {{6, 2}, {6, 
        3}}, {{6, 2}, {6, 4}}, {{7, 1}, {6, 3}}, {{7, 1}, {8, 3}}, {{7, 2}, {
        7, 3}}, {{7, 2}, {7, 4}}, {{8, 2}, {8, 3}}, {{8, 2}, {8, 
        4}}}, $CellContext`board = {
         RGBColor[0.7, 0.7, 0.5], 
         Polygon[{{0, 0}, {8, 0}, {8, 8}, {0, 8}}], 
         RGBColor[0.94, 0.91, 0.88], 
         Polygon[{{1, 0}, {1, 1}, {2, 1}, {2, 0}}], 
         Polygon[{{3, 0}, {3, 1}, {4, 1}, {4, 0}}], 
         Polygon[{{5, 0}, {5, 1}, {6, 1}, {6, 0}}], 
         Polygon[{{7, 0}, {7, 1}, {8, 1}, {8, 0}}], 
         Polygon[{{0, 1}, {0, 2}, {1, 2}, {1, 1}}], 
         Polygon[{{2, 1}, {2, 2}, {3, 2}, {3, 1}}], 
         Polygon[{{4, 1}, {4, 2}, {5, 2}, {5, 1}}], 
         Polygon[{{6, 1}, {6, 2}, {7, 2}, {7, 1}}], 
         Polygon[{{1, 2}, {1, 3}, {2, 3}, {2, 2}}], 
         Polygon[{{3, 2}, {3, 3}, {4, 3}, {4, 2}}], 
         Polygon[{{5, 2}, {5, 3}, {6, 3}, {6, 2}}], 
         Polygon[{{7, 2}, {7, 3}, {8, 3}, {8, 2}}], 
         Polygon[{{0, 3}, {0, 4}, {1, 4}, {1, 3}}], 
         Polygon[{{2, 3}, {2, 4}, {3, 4}, {3, 3}}], 
         Polygon[{{4, 3}, {4, 4}, {5, 4}, {5, 3}}], 
         Polygon[{{6, 3}, {6, 4}, {7, 4}, {7, 3}}], 
         Polygon[{{1, 4}, {1, 5}, {2, 5}, {2, 4}}], 
         Polygon[{{3, 4}, {3, 5}, {4, 5}, {4, 4}}], 
         Polygon[{{5, 4}, {5, 5}, {6, 5}, {6, 4}}], 
         Polygon[{{7, 4}, {7, 5}, {8, 5}, {8, 4}}], 
         Polygon[{{0, 5}, {0, 6}, {1, 6}, {1, 5}}], 
         Polygon[{{2, 5}, {2, 6}, {3, 6}, {3, 5}}], 
         Polygon[{{4, 5}, {4, 6}, {5, 6}, {5, 5}}], 
         Polygon[{{6, 5}, {6, 6}, {7, 6}, {7, 5}}], 
         Polygon[{{1, 6}, {1, 7}, {2, 7}, {2, 6}}], 
         Polygon[{{3, 6}, {3, 7}, {4, 7}, {4, 6}}], 
         Polygon[{{5, 6}, {5, 7}, {6, 7}, {6, 6}}], 
         Polygon[{{7, 6}, {7, 7}, {8, 7}, {8, 6}}], 
         Polygon[{{0, 7}, {0, 8}, {1, 8}, {1, 7}}], 
         Polygon[{{2, 7}, {2, 8}, {3, 8}, {3, 7}}], 
         Polygon[{{4, 7}, {4, 8}, {5, 8}, {5, 7}}], 
         Polygon[{{6, 7}, {6, 8}, {7, 8}, {7, 7}}], 
         GrayLevel[0.5], {
          Line[{{1, 0}, {1, 8}}], 
          Line[{{2, 0}, {2, 8}}], 
          Line[{{3, 0}, {3, 8}}], 
          Line[{{4, 0}, {4, 8}}], 
          Line[{{5, 0}, {5, 8}}], 
          Line[{{6, 0}, {6, 8}}], 
          Line[{{7, 0}, {7, 8}}]}, {
          Line[{{0, 1}, {8, 1}}], 
          Line[{{0, 2}, {8, 2}}], 
          Line[{{0, 3}, {8, 3}}], 
          Line[{{0, 4}, {8, 4}}], 
          Line[{{0, 5}, {8, 5}}], 
          Line[{{0, 6}, {8, 6}}], 
          Line[{{0, 7}, {8, 7}}]}, 
         GrayLevel[0], 
         Line[{{0, 0}, {0, 8}, {8, 8}, {8, 0}, {0, 0}}], {
          RGBColor[0, 0, 1], 
          Thickness[Large]}, 
         Line[{{-0.1, -0.1}, {-0.1, 8.1}, {8.1, 8.1}, {
          8.1, -0.1}, {-0.1, -0.1}}]}, $CellContext`pawn = 
       Disk[{-0.5, -0.5}, 0.35], $CellContext`rook = 
       Polygon[{{-0.9, -0.9}, {-0.09999999999999998, -0.9}, \
{-0.09999999999999998, -0.7}, {-0.30000000000000004`, -0.5}, \
{-0.09999999999999998, -0.30000000000000004`}, {-0.09999999999999998, \
-0.09999999999999998}, {-0.9, -0.09999999999999998}, {-0.9, \
-0.30000000000000004`}, {-0.7, -0.5}, {-0.9, -0.7}}], $CellContext`knight = 
       Polygon[{{-0.9, -0.9}, {-0.09999999999999998, -0.9}, \
{-0.09999999999999998, -0.6}, {-0.4, -0.6}, {-0.4, -0.4}, \
{-0.09999999999999998, -0.30000000000000004`}, {-0.09999999999999998, \
-0.09999999999999998}, {-0.6, -0.09999999999999998}, {-0.6, -0.6}, {-0.9, \
-0.6}}], $CellContext`bishop = 
       Polygon[{{-0.9, -0.9}, {-0.09999999999999998, -0.9}, {-0.5, \
-0.09999999999999998}}], $CellContext`queen = 
       Polygon[{{-0.9, -0.9}, {-0.09999999999999998, -0.9}, {-0.4, -0.6}, \
{-0.19999999999999996`, -0.30000000000000004`}, {-0.5, -0.09999999999999998}, \
{-0.8, -0.30000000000000004`}, {-0.6, -0.6}}], $CellContext`king = 
       Polygon[{{-0.9, -0.9}, {-0.09999999999999998, -0.9}, \
{-0.09999999999999998, -0.09999999999999998}, {-0.30000000000000004`, \
-0.30000000000000004`}, {-0.5, -0.09999999999999998}, {-0.7, \
-0.30000000000000004`}, {-0.9, -0.09999999999999998}}], $CellContext`names = {
        " ", "R", "N", "B", "Q", "K"}, $CellContext`alpha = {
        "a", "b", "c", "d", "e", "f", "g", "h", 
         "..."}, $CellContext`side0 = {{1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 
        0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
        0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {
        1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
        0, -1, -1}}, $CellContext`type0 = {{2, 1, 0, 0, 0, 0, 1, 2}, {3, 1, 0,
         0, 0, 0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 4}, {5, 1, 0, 0, 0, 0, 1, 5}, {
        6, 1, 0, 0, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0, 1, 4}, {3, 1, 0, 0, 0, 0, 
        1, 3}, {2, 1, 0, 0, 0, 0, 1, 2}}, $CellContext`all0 = {{0, 0, 0, 0, 0,
         0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 
        0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 
        0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}}}; 
     Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.35696210375764*^9, 3.404836196558592*^9, 3.404836269663712*^9, 
   3.404836408873886*^9, 3.4048365510683517`*^9, 3.4048716288690305`*^9, 
   3.4048718933092766`*^9, 3.404872167713851*^9, 3.404872416411461*^9, 
   3.404872924802491*^9, 3.404873037965211*^9, 3.4048732462647314`*^9, 
   3.4048733844634514`*^9, 3.404873552705371*^9, 3.4048737249630656`*^9, 
   3.404874484044571*^9, 3.404874989571483*^9, 3.404875987356227*^9, 
   3.404876670138019*^9, 3.404876953545539*^9, 3.404877042723771*^9, 
   3.4048775867961087`*^9, 3.4048776335132847`*^9, 3.4048777787721567`*^9, 
   3.404878160320797*^9, 3.404878218404317*^9, 3.4048858903446145`*^9, 
   3.404886017387293*^9, 3.404886080958704*^9, 3.404886254127709*^9, 
   3.4048865511948705`*^9, 3.404887475844451*^9, 3.4048875084413233`*^9, 
   3.404887548448851*^9, 3.4048879063334637`*^9, 3.4048880141084366`*^9, 
   3.4048880758972845`*^9, 3.404888341058568*^9, 3.404888486918304*^9, 
   3.4048885760064063`*^9, 3.40488865205576*^9, 3.404888748774835*^9, 
   3.4048890442697363`*^9, 3.4048894689103394`*^9, 3.4048896054166255`*^9, 
   3.4049210101895633`*^9, 3.4049218545536995`*^9, 3.4049230541886897`*^9, 
   3.4049233014342113`*^9, 3.404923440273853*^9, 3.4049235057179565`*^9, 
   3.40492396040176*^9, {3.404923995512246*^9, 3.404924015701277*^9}, 
   3.404924119961195*^9, 3.404924579141464*^9, 3.405034898546605*^9, {
   3.4050349377429667`*^9, 3.4050349652324944`*^9}, 3.4055549600013423`*^9},
 CellID->85663174],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`bfrom$$ = {}, $CellContext`bpiece$$ = {}, \
$CellContext`bto$$ = {}, $CellContext`capture$$ = 
    "x", $CellContext`captures$$ = {{"x", "-"}, {"-", "-"}, {
     "-", "-"}}, $CellContext`checks$$ = {{"+", " "}, {" ", " "}, {
     " ", " "}}, $CellContext`colb$$ = 3, $CellContext`colw$$ = 
    3, $CellContext`eastok$$ = False, $CellContext`edit$$ = 
    "play", $CellContext`epblack$$ = {0, 0}, $CellContext`epwhite$$ = {0, 
    0}, $CellContext`f$$ = 1, $CellContext`from$$ = {0, 0}, $CellContext`h$$ =
     1., $CellContext`i$$ = 7, $CellContext`j$$ = 0, $CellContext`kx$$ = 
    5, $CellContext`ky$$ = 8, $CellContext`list$$ = {{{0, 0}, {0, 
    0}}}, $CellContext`n$$ = -1, $CellContext`northok$$ = 
    True, $CellContext`ok$$ = False, $CellContext`oldfrom$$ = {6, 
    4}, $CellContext`part1$$ = False, $CellContext`part2$$ = 
    False, $CellContext`pos$$ = {6, 7}, $CellContext`prom$$ = 
    "queen", $CellContext`r$$ = 1, $CellContext`randomblack$$ = 
    False, $CellContext`randomwhite$$ = False, $CellContext`showmoves$$ = 
    False, $CellContext`showtargets$$ = True, $CellContext`side$$ = {{1, 1, 0,
     0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 1, 0, 
    0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1,
     0, 0, 0, 0, 1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
    0, -1, -1}}, $CellContext`sides$$ = {{{1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 
    0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
    0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1,
     0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
    0, -1, -1}}}, $CellContext`southok$$ = False, $CellContext`swattacked$$ = 
    True, $CellContext`to$$ = {0, 0}, $CellContext`type$$ = {{2, 1, 0, 0, 0, 
    0, 1, 2}, {3, 1, 0, 0, 0, 0, 1, 3}, {4, 1, 0, 4, 0, 0, 1, 4}, {5, 1, 0, 0,
     0, 0, 1, 5}, {6, 1, 0, 0, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0, 5, 4}, {3, 1, 
    0, 0, 0, 0, 1, 3}, {2, 1, 0, 0, 0, 0, 1, 2}}, $CellContext`types$$ = {{{2,
     1, 0, 0, 0, 0, 1, 2}, {3, 1, 0, 0, 0, 0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 
    4}, {5, 1, 0, 0, 0, 0, 1, 5}, {6, 1, 0, 0, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0,
     1, 4}, {3, 1, 0, 0, 0, 0, 1, 3}, {2, 1, 0, 0, 0, 0, 1, 
    2}}}, $CellContext`unmoveda1$$ = True, $CellContext`unmoveda8$$ = 
    True, $CellContext`unmovedh1$$ = True, $CellContext`unmovedh8$$ = 
    True, $CellContext`westok$$ = True, $CellContext`wfrom$$ = {{6, 
    4}}, $CellContext`wpiece$$ = {5}, $CellContext`wto$$ = {{6, 
    7}}, $CellContext`x$$ = 6, $CellContext`y$$ = 4, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`colw$$], 1, 
       Style["color White", 10]}, {1, 2, 3}}, {{
       Hold[$CellContext`colb$$], 1, 
       Style["color Black", 10]}, {1, 2, 3}}, {{
       Hold[$CellContext`randomwhite$$], False, "random White"}, {
      True, False}}, {{
       Hold[$CellContext`randomblack$$], False, "random Black"}, {
      True, False}}, {{
       Hold[$CellContext`showmoves$$], False, "show moves"}, {
      True, False}}, {{
       Hold[$CellContext`showtargets$$], True, "show targets"}, {
      True, False}}, {{
       Hold[$CellContext`prom$$], "queen", 
       Style["promotion to", 10]}, {"queen", "rook", "bishop", "knight"}}, {{
       Hold[$CellContext`edit$$], "play", 
       Style["edit position", 10]}, {
      "play", "reset", "clear", "delete", "white pawn", "white knight", 
       "white bishop", "white rook", "white queen", "white king", 
       "black pawn", "black knight", "black bishop", "black rook", 
       "black queen", "black king", "castling options", "next player"}}, {{
       Hold[$CellContext`h$$], 1, 
       Style["history"]}, 0, 1}, {{
       Hold[$CellContext`i$$], 0}}, {{
       Hold[$CellContext`j$$], 0}}, {{
       Hold[$CellContext`kx$$], 0}}, {{
       Hold[$CellContext`ky$$], 0}}, {{
       Hold[$CellContext`pos$$], {0, 0}}}, {{
       Hold[$CellContext`from$$], {0, 0}}}, {{
       Hold[$CellContext`oldfrom$$], {0, 0}}}, {{
       Hold[$CellContext`to$$], {0, 0}}}, {{
       Hold[$CellContext`side$$], {{1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0,
        0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {
       1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
       0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}}}}, {{
       Hold[$CellContext`type$$], {{2, 1, 0, 0, 0, 0, 1, 2}, {3, 1, 0, 0, 0, 
       0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 4}, {5, 1, 0, 0, 0, 0, 1, 5}, {6, 1, 0,
        0, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0, 1, 4}, {3, 1, 0, 0, 0, 0, 1, 3}, {
       2, 1, 0, 0, 0, 0, 1, 2}}}}, {{
       Hold[$CellContext`n$$], 1}}, {{
       Hold[$CellContext`list$$], {{{0, 0}, {0, 0}}}}}, {{
       Hold[$CellContext`sides$$], {{{1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 
       0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
       0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1,
        1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}}}}}, {{
       Hold[$CellContext`types$$], {{{2, 1, 0, 0, 0, 0, 1, 2}, {3, 1, 0, 0, 0,
        0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 4}, {5, 1, 0, 0, 0, 0, 1, 5}, {6, 1, 
       0, 0, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0, 1, 4}, {3, 1, 0, 0, 0, 0, 1, 
       3}, {2, 1, 0, 0, 0, 0, 1, 2}}}}}, {{
       Hold[$CellContext`wfrom$$], {}}}, {{
       Hold[$CellContext`wto$$], {}}}, {{
       Hold[$CellContext`wpiece$$], {}}}, {{
       Hold[$CellContext`bfrom$$], {}}}, {{
       Hold[$CellContext`bto$$], {}}}, {{
       Hold[$CellContext`bpiece$$], {}}}, {{
       Hold[$CellContext`unmoveda1$$], True}}, {{
       Hold[$CellContext`unmoveda8$$], True}}, {{
       Hold[$CellContext`unmovedh1$$], True}}, {{
       Hold[$CellContext`unmovedh8$$], True}}, {{
       Hold[$CellContext`epwhite$$], {0, 0}}}, {{
       Hold[$CellContext`epblack$$], {0, 0}}}, {{
       Hold[$CellContext`r$$], 0}}, {{
       Hold[$CellContext`f$$], 0}}, {{
       Hold[$CellContext`capture$$], "-"}}, {{
       Hold[$CellContext`captures$$], {{"-", "-"}}}}, {{
       Hold[$CellContext`checks$$], {{" ", " "}}}}, {{
       Hold[$CellContext`part1$$], False}}, {{
       Hold[$CellContext`part2$$], False}}, {{
       Hold[$CellContext`ok$$], False}}, {{
       Hold[$CellContext`eastok$$], False}}, {{
       Hold[$CellContext`westok$$], False}}, {{
       Hold[$CellContext`southok$$], False}}, {{
       Hold[$CellContext`northok$$], False}}, {{
       Hold[$CellContext`x$$], 0}}, {{
       Hold[$CellContext`y$$], 0}}, {{
       Hold[$CellContext`swattacked$$], False}}}, Typeset`size$$ = {
    400., {198., 202.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = False, $CellContext`colw$396$$ = 
    0, $CellContext`colb$397$$ = 0, $CellContext`randomwhite$398$$ = 
    False, $CellContext`randomblack$399$$ = 
    False, $CellContext`showmoves$400$$ = 
    False, $CellContext`showtargets$401$$ = False, $CellContext`prom$402$$ = 
    0, $CellContext`edit$403$$ = 0, $CellContext`h$404$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`bfrom$$ = {}, $CellContext`bpiece$$ = {}, \
$CellContext`bto$$ = {}, $CellContext`capture$$ = 
        "-", $CellContext`captures$$ = {{
          "-", "-"}}, $CellContext`checks$$ = {{
          " ", " "}}, $CellContext`colb$$ = 1, $CellContext`colw$$ = 
        1, $CellContext`eastok$$ = False, $CellContext`edit$$ = 
        "play", $CellContext`epblack$$ = {0, 0}, $CellContext`epwhite$$ = {0, 
         0}, $CellContext`f$$ = 
        0, $CellContext`from$$ = {0, 0}, $CellContext`h$$ = 
        1, $CellContext`i$$ = 0, $CellContext`j$$ = 0, $CellContext`kx$$ = 
        0, $CellContext`ky$$ = 
        0, $CellContext`list$$ = {{{0, 0}, {0, 0}}}, $CellContext`n$$ = 
        1, $CellContext`northok$$ = False, $CellContext`ok$$ = 
        False, $CellContext`oldfrom$$ = {0, 0}, $CellContext`part1$$ = 
        False, $CellContext`part2$$ = 
        False, $CellContext`pos$$ = {0, 0}, $CellContext`prom$$ = 
        "queen", $CellContext`r$$ = 0, $CellContext`randomblack$$ = 
        False, $CellContext`randomwhite$$ = False, $CellContext`showmoves$$ = 
        False, $CellContext`showtargets$$ = 
        True, $CellContext`side$$ = {{1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 
         0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
         0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {
         1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
         0, -1, -1}}, $CellContext`sides$$ = {{{1, 1, 0, 0, 0, 0, -1, -1}, {1,
          1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
         0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {
         1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
         0, -1, -1}}}, $CellContext`southok$$ = 
        False, $CellContext`swattacked$$ = 
        False, $CellContext`to$$ = {0, 0}, $CellContext`type$$ = {{2, 1, 0, 0,
          0, 0, 1, 2}, {3, 1, 0, 0, 0, 0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 4}, {5,
          1, 0, 0, 0, 0, 1, 5}, {6, 1, 0, 0, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0, 
         1, 4}, {3, 1, 0, 0, 0, 0, 1, 3}, {2, 1, 0, 0, 0, 0, 1, 
         2}}, $CellContext`types$$ = {{{2, 1, 0, 0, 0, 0, 1, 2}, {3, 1, 0, 0, 
         0, 0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 4}, {5, 1, 0, 0, 0, 0, 1, 5}, {6, 
         1, 0, 0, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0, 1, 4}, {3, 1, 0, 0, 0, 0, 1,
          3}, {2, 1, 0, 0, 0, 0, 1, 2}}}, $CellContext`unmoveda1$$ = 
        True, $CellContext`unmoveda8$$ = True, $CellContext`unmovedh1$$ = 
        True, $CellContext`unmovedh8$$ = True, $CellContext`westok$$ = 
        False, $CellContext`wfrom$$ = {}, $CellContext`wpiece$$ = {}, \
$CellContext`wto$$ = {}, $CellContext`x$$ = 0, $CellContext`y$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`colw$$, $CellContext`colw$396$$, 0], 
        Hold[$CellContext`colb$$, $CellContext`colb$397$$, 0], 
        Hold[$CellContext`randomwhite$$, $CellContext`randomwhite$398$$, 
         False], 
        Hold[$CellContext`randomblack$$, $CellContext`randomblack$399$$, 
         False], 
        Hold[$CellContext`showmoves$$, $CellContext`showmoves$400$$, False], 
        Hold[$CellContext`showtargets$$, $CellContext`showtargets$401$$, 
         False], 
        Hold[$CellContext`prom$$, $CellContext`prom$402$$, 0], 
        Hold[$CellContext`edit$$, $CellContext`edit$403$$, 0], 
        Hold[$CellContext`h$$, $CellContext`h$404$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`f$$ = Floor[$CellContext`h$$ $CellContext`r$$]; 
       If[
         And[$CellContext`list$$ == $CellContext`list0, $CellContext`from$$ == \
{0, 0}, $CellContext`to$$ == {0, 0}], 
         Do[$CellContext`t = 
            Part[$CellContext`type$$, $CellContext`x$$, $CellContext`y$$]; \
$CellContext`s = 
            Part[$CellContext`side$$, $CellContext`x$$, $CellContext`y$$]; 
           If[
             
             And[$CellContext`t == $CellContext`pp, $CellContext`s == 
              1, $CellContext`n$$ == 1], 
             If[Part[$CellContext`side$$, $CellContext`x$$, $CellContext`y$$ + 
                 1] == 0, $CellContext`list$$ = 
                AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$, $CellContext`y$$ + 1}}]; If[
                 
                 And[$CellContext`y$$ == 2, 
                  Part[$CellContext`side$$, $CellContext`x$$, 4] == 
                  0], $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, 
                    2}, {$CellContext`x$$, 4}}]]]; 
             If[{$CellContext`x$$ + 1, $CellContext`y$$ + 
                 1} == $CellContext`epblack$$, $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$ + 1}}]]; 
             If[{$CellContext`x$$ - 1, $CellContext`y$$ + 
                 1} == $CellContext`epblack$$, $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$ + 1}}]]; If[
               
               And[$CellContext`x$$ < 8, $CellContext`y$$ < 8, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  1, $CellContext`y$$ + 
                  1] == -$CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$ + 1}}]]; If[
               
               And[$CellContext`x$$ > 1, $CellContext`y$$ < 8, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  1, $CellContext`y$$ + 
                  1] == -$CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$ + 1}}]]]; If[
             
             And[$CellContext`t == $CellContext`pp, $CellContext`s == -1, \
$CellContext`n$$ == -1], 
             If[Part[$CellContext`side$$, $CellContext`x$$, $CellContext`y$$ - 
                 1] == 0, $CellContext`list$$ = 
                AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$, $CellContext`y$$ - 1}}]; If[
                 
                 And[$CellContext`y$$ == 7, 
                  Part[$CellContext`side$$, $CellContext`x$$, 5] == 
                  0], $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, 
                    7}, {$CellContext`x$$, 5}}]]]; 
             If[{$CellContext`x$$ + 1, $CellContext`y$$ - 
                 1} == $CellContext`epwhite$$, $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$ - 1}}]]; 
             If[{$CellContext`x$$ - 1, $CellContext`y$$ - 
                 1} == $CellContext`epwhite$$, $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$ - 1}}]]; If[
               
               And[$CellContext`x$$ < 8, $CellContext`y$$ > 1, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  1, $CellContext`y$$ - 
                  1] == -$CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$ - 1}}]]; If[
               
               And[$CellContext`x$$ > 1, $CellContext`y$$ > 1, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  1, $CellContext`y$$ - 
                  1] == -$CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$ - 1}}]]]; If[
             
             And[$CellContext`t == $CellContext`nn, $CellContext`s == \
$CellContext`n$$], If[
               
               And[$CellContext`x$$ > 1, $CellContext`y$$ > 2, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  1, $CellContext`y$$ - 
                  2] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$ - 2}}]]; If[
               
               And[$CellContext`x$$ > 1, $CellContext`y$$ < 7, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  1, $CellContext`y$$ + 
                  2] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$ + 2}}]]; If[
               
               And[$CellContext`x$$ > 2, $CellContext`y$$ > 1, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  2, $CellContext`y$$ - 
                  1] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 2, $CellContext`y$$ - 1}}]]; If[
               
               And[$CellContext`x$$ > 2, $CellContext`y$$ < 8, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  2, $CellContext`y$$ + 
                  1] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 2, $CellContext`y$$ + 1}}]]; If[
               And[$CellContext`x$$ < 8, $CellContext`y$$ < 7, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  1, $CellContext`y$$ + 
                  2] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$ + 2}}]]; If[
               
               And[$CellContext`x$$ < 8, $CellContext`y$$ > 2, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  1, $CellContext`y$$ - 
                  2] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$ - 2}}]]; If[
               
               And[$CellContext`x$$ < 7, $CellContext`y$$ > 1, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  2, $CellContext`y$$ - 
                  1] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 2, $CellContext`y$$ - 1}}]]; If[
               
               And[$CellContext`x$$ < 7, $CellContext`y$$ < 8, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  2, $CellContext`y$$ + 
                  1] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 2, $CellContext`y$$ + 1}}]]]; If[
             And[
              
              Or[$CellContext`t == $CellContext`bb, $CellContext`t == \
$CellContext`qq], $CellContext`s == $CellContext`n$$], 
             For[$CellContext`i$$ = 1, 
               
               And[$CellContext`x$$ + $CellContext`i$$ < 
                9, $CellContext`y$$ + $CellContext`i$$ < 9], 
               Increment[$CellContext`i$$], 
               If[Part[$CellContext`side$$, $CellContext`x$$ + \
$CellContext`i$$, $CellContext`y$$ + $CellContext`i$$] != $CellContext`n$$, \
$CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + $CellContext`i$$, $CellContext`y$$ + \
$CellContext`i$$}}]]; 
               If[Part[$CellContext`side$$, $CellContext`x$$ + \
$CellContext`i$$, $CellContext`y$$ + $CellContext`i$$] != 0, 
                 Break[]]]; For[$CellContext`i$$ = 1, 
               
               And[$CellContext`x$$ + $CellContext`i$$ < 
                9, $CellContext`y$$ - $CellContext`i$$ > 0], 
               Increment[$CellContext`i$$], 
               If[Part[$CellContext`side$$, $CellContext`x$$ + \
$CellContext`i$$, $CellContext`y$$ - $CellContext`i$$] != $CellContext`n$$, \
$CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + $CellContext`i$$, $CellContext`y$$ - \
$CellContext`i$$}}]]; 
               If[Part[$CellContext`side$$, $CellContext`x$$ + \
$CellContext`i$$, $CellContext`y$$ - $CellContext`i$$] != 0, 
                 Break[]]]; For[$CellContext`i$$ = 1, 
               
               And[$CellContext`x$$ - $CellContext`i$$ > 
                0, $CellContext`y$$ + $CellContext`i$$ < 9], 
               Increment[$CellContext`i$$], 
               If[Part[$CellContext`side$$, $CellContext`x$$ - \
$CellContext`i$$, $CellContext`y$$ + $CellContext`i$$] != $CellContext`n$$, \
$CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - $CellContext`i$$, $CellContext`y$$ + \
$CellContext`i$$}}]]; 
               If[Part[$CellContext`side$$, $CellContext`x$$ - \
$CellContext`i$$, $CellContext`y$$ + $CellContext`i$$] != 0, 
                 Break[]]]; For[$CellContext`i$$ = 1, 
               
               And[$CellContext`x$$ - $CellContext`i$$ > 
                0, $CellContext`y$$ - $CellContext`i$$ > 0], 
               Increment[$CellContext`i$$], 
               If[Part[$CellContext`side$$, $CellContext`x$$ - \
$CellContext`i$$, $CellContext`y$$ - $CellContext`i$$] != $CellContext`n$$, \
$CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - $CellContext`i$$, $CellContext`y$$ - \
$CellContext`i$$}}]]; 
               If[Part[$CellContext`side$$, $CellContext`x$$ - \
$CellContext`i$$, $CellContext`y$$ - $CellContext`i$$] != 0, 
                 Break[]]]]; If[
             And[
              
              Or[$CellContext`t == $CellContext`rr, $CellContext`t == \
$CellContext`qq], $CellContext`s == $CellContext`n$$], 
             For[$CellContext`i$$ = $CellContext`x$$ + 1, $CellContext`i$$ < 
               9, 
               Increment[$CellContext`i$$], 
               If[Part[$CellContext`side$$, $CellContext`i$$, \
$CellContext`y$$] != $CellContext`n$$, $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`i$$, $CellContext`y$$}}]]; 
               If[Part[$CellContext`side$$, $CellContext`i$$, \
$CellContext`y$$] != 0, 
                 Break[]]]; 
             For[$CellContext`i$$ = $CellContext`x$$ - 1, $CellContext`i$$ > 
               0, 
               Decrement[$CellContext`i$$], 
               If[Part[$CellContext`side$$, $CellContext`i$$, \
$CellContext`y$$] != $CellContext`n$$, $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`i$$, $CellContext`y$$}}]]; 
               If[Part[$CellContext`side$$, $CellContext`i$$, \
$CellContext`y$$] != 0, 
                 Break[]]]; 
             For[$CellContext`i$$ = $CellContext`y$$ + 1, $CellContext`i$$ < 
               9, 
               Increment[$CellContext`i$$], 
               If[Part[$CellContext`side$$, $CellContext`x$$, \
$CellContext`i$$] != $CellContext`n$$, $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$, $CellContext`i$$}}]]; 
               If[Part[$CellContext`side$$, $CellContext`x$$, \
$CellContext`i$$] != 0, 
                 Break[]]]; 
             For[$CellContext`i$$ = $CellContext`y$$ - 1, $CellContext`i$$ > 
               0, 
               Decrement[$CellContext`i$$], 
               If[Part[$CellContext`side$$, $CellContext`x$$, \
$CellContext`i$$] != $CellContext`n$$, $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$, $CellContext`i$$}}]]; 
               If[Part[$CellContext`side$$, $CellContext`x$$, \
$CellContext`i$$] != 0, 
                 Break[]]]]; If[
             
             And[$CellContext`t == $CellContext`kk, $CellContext`s == \
$CellContext`n$$], $CellContext`kx$$ = $CellContext`x$$; $CellContext`ky$$ = \
$CellContext`y$$; 
             Part[$CellContext`side$$, $CellContext`x$$, $CellContext`y$$] = 
              0; Part[$CellContext`type$$, $CellContext`x$$, \
$CellContext`y$$] = 0; 
             If[$CellContext`x$$ < 
               8, $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, $CellContext`x$$ + 
                  1, $CellContext`y$$, $CellContext`n$$]; If[
                 Not[$CellContext`swattacked$$], $CellContext`eastok$$ = 
                 True, $CellContext`eastok$$ = False]]; 
             If[$CellContext`x$$ > 
               1, $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, $CellContext`x$$ - 
                  1, $CellContext`y$$, $CellContext`n$$]; If[
                 Not[$CellContext`swattacked$$], $CellContext`westok$$ = 
                 True, $CellContext`westok$$ = False]]; 
             If[$CellContext`y$$ < 
               8, $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, \
$CellContext`x$$, $CellContext`y$$ + 1, $CellContext`n$$]; If[
                 Not[$CellContext`swattacked$$], $CellContext`northok$$ = 
                 True, $CellContext`northok$$ = False]]; 
             If[$CellContext`y$$ > 
               1, $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, \
$CellContext`x$$, $CellContext`y$$ - 1, $CellContext`n$$]; If[
                 Not[$CellContext`swattacked$$], $CellContext`southok$$ = 
                 True, $CellContext`southok$$ = False]]; If[
               
               And[$CellContext`x$$ > 1, $CellContext`westok$$ == True, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  1, $CellContext`y$$] != $CellContext`n$$], \
$CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$}}]]; If[
               
               And[$CellContext`x$$ < 8, $CellContext`eastok$$ == True, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  
                  1, $CellContext`y$$] != $CellContext`n$$], \
$CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$}}]]; If[
               
               And[$CellContext`y$$ > 1, $CellContext`southok$$ == True, 
                Part[$CellContext`side$$, $CellContext`x$$, $CellContext`y$$ - 
                  1] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$, $CellContext`y$$ - 1}}]]; If[
               
               And[$CellContext`y$$ < 8, $CellContext`northok$$ == True, 
                Part[$CellContext`side$$, $CellContext`x$$, $CellContext`y$$ + 
                  1] != $CellContext`n$$], $CellContext`list$$ = 
               AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$, $CellContext`y$$ + 1}}]]; If[
               
               And[$CellContext`x$$ > 1, $CellContext`y$$ > 1, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  1, $CellContext`y$$ - 
                  1] != $CellContext`n$$], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, $CellContext`x$$ - 
                  1, $CellContext`y$$ - 1, $CellContext`n$$]; If[
                 Not[$CellContext`swattacked$$], $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$ - 1}}]]]; If[
               
               And[$CellContext`x$$ > 1, $CellContext`y$$ < 8, 
                Part[$CellContext`side$$, $CellContext`x$$ - 
                  1, $CellContext`y$$ + 
                  1] != $CellContext`n$$], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, $CellContext`x$$ - 
                  1, $CellContext`y$$ + 1, $CellContext`n$$]; If[
                 Not[$CellContext`swattacked$$], $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ - 1, $CellContext`y$$ + 1}}]]]; If[
               
               And[$CellContext`x$$ < 8, $CellContext`y$$ > 1, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  1, $CellContext`y$$ - 
                  1] != $CellContext`n$$], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, $CellContext`x$$ + 
                  1, $CellContext`y$$ - 1, $CellContext`n$$]; If[
                 Not[$CellContext`swattacked$$], $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$ - 1}}]]]; If[
               
               And[$CellContext`x$$ < 8, $CellContext`y$$ < 8, 
                Part[$CellContext`side$$, $CellContext`x$$ + 
                  1, $CellContext`y$$ + 
                  1] != $CellContext`n$$], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, $CellContext`x$$ + 
                  1, $CellContext`y$$ + 1, $CellContext`n$$]; If[
                 Not[$CellContext`swattacked$$], $CellContext`list$$ = 
                 AppendTo[$CellContext`list$$, {{$CellContext`x$$, \
$CellContext`y$$}, {$CellContext`x$$ + 1, $CellContext`y$$ + 
                    1}}]]]; $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, \
$CellContext`x$$, $CellContext`y$$, $CellContext`n$$]; If[
               Not[$CellContext`swattacked$$], If[
                 
                 And[{$CellContext`x$$, $CellContext`y$$} == {5, 
                   1}, $CellContext`westok$$ == 
                  True, $CellContext`unmoveda1$$ == True, 
                  Part[$CellContext`side$$, 1, 1] == $CellContext`n$$, 
                  Part[$CellContext`side$$, 4, 1] == 0, 
                  Part[$CellContext`side$$, 3, 1] == 0, 
                  Part[$CellContext`side$$, 2, 1] == 
                  0], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, 3, 
                    1, $CellContext`n$$]; If[
                   Not[$CellContext`swattacked$$], $CellContext`list$$ = 
                   AppendTo[$CellContext`list$$, {{5, 1}, {3, 1}}]]]; If[
                 
                 And[{$CellContext`x$$, $CellContext`y$$} == {5, 
                   1}, $CellContext`eastok$$ == 
                  True, $CellContext`unmovedh1$$ == True, 
                  Part[$CellContext`side$$, 8, 1] == $CellContext`n$$, 
                  Part[$CellContext`side$$, 6, 1] == 0, 
                  Part[$CellContext`side$$, 7, 1] == 
                  0], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, 7, 
                    1, $CellContext`n$$]; If[
                   Not[$CellContext`swattacked$$], $CellContext`list$$ = 
                   AppendTo[$CellContext`list$$, {{5, 1}, {7, 1}}]]]; If[
                 
                 And[{$CellContext`x$$, $CellContext`y$$} == {5, 
                   8}, $CellContext`westok$$ == 
                  True, $CellContext`unmoveda8$$ == True, 
                  Part[$CellContext`side$$, 1, 8] == $CellContext`n$$, 
                  Part[$CellContext`side$$, 4, 8] == 0, 
                  Part[$CellContext`side$$, 3, 8] == 0, 
                  Part[$CellContext`side$$, 2, 8] == 
                  0], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, 3, 
                    8, $CellContext`n$$]; If[
                   Not[$CellContext`swattacked$$], $CellContext`list$$ = 
                   AppendTo[$CellContext`list$$, {{5, 8}, {3, 8}}]]]; If[
                 
                 And[{$CellContext`x$$, $CellContext`y$$} == {5, 
                   8}, $CellContext`eastok$$ == 
                  True, $CellContext`unmovedh8$$ == True, 
                  Part[$CellContext`side$$, 8, 8] == $CellContext`n$$, 
                  Part[$CellContext`side$$, 6, 8] == 0, 
                  Part[$CellContext`side$$, 7, 8] == 
                  0], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, 7, 
                    8, $CellContext`n$$]; If[
                   Not[$CellContext`swattacked$$], $CellContext`list$$ = 
                   AppendTo[$CellContext`list$$, {{5, 8}, {7, 8}}]]]]; 
             Part[$CellContext`side$$, $CellContext`x$$, $CellContext`y$$] = \
$CellContext`n$$; 
             Part[$CellContext`type$$, $CellContext`x$$, $CellContext`y$$] = \
$CellContext`kk], {$CellContext`x$$, 8}, {$CellContext`y$$, 
            8}]; $CellContext`l = Length[$CellContext`list$$]; 
         Do[$CellContext`a = 
            Part[$CellContext`list$$, $CellContext`j$$, 1]; $CellContext`b = 
            Part[$CellContext`list$$, $CellContext`j$$, 2]; $CellContext`ax = 
            Part[$CellContext`a, 1]; $CellContext`ay = 
            Part[$CellContext`a, 2]; $CellContext`bx = 
            Part[$CellContext`b, 1]; $CellContext`by = 
            Part[$CellContext`b, 2]; $CellContext`t = 
            Part[$CellContext`type$$, $CellContext`ax, $CellContext`ay]; 
           If[$CellContext`t != $CellContext`kk, 
             Part[$CellContext`side$$, $CellContext`ax, $CellContext`ay] = (
               Part[$CellContext`type$$, $CellContext`ax, $CellContext`ay] = 
               0); $CellContext`olds = 
              Part[$CellContext`side$$, $CellContext`bx, $CellContext`by]; \
$CellContext`oldt = 
              Part[$CellContext`type$$, $CellContext`bx, $CellContext`by]; 
             Part[$CellContext`side$$, $CellContext`bx, $CellContext`by] = \
$CellContext`n$$; 
             Part[$CellContext`type$$, $CellContext`bx, $CellContext`by] = \
$CellContext`t; $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, \
$CellContext`kx$$, $CellContext`ky$$, $CellContext`n$$]; 
             Part[$CellContext`side$$, $CellContext`ax, $CellContext`ay] = \
$CellContext`n$$; 
             Part[$CellContext`type$$, $CellContext`ax, $CellContext`ay] = \
$CellContext`t; 
             Part[$CellContext`side$$, $CellContext`bx, $CellContext`by] = \
$CellContext`olds; 
             Part[$CellContext`type$$, $CellContext`bx, $CellContext`by] = \
$CellContext`oldt; 
             If[$CellContext`swattacked$$, 
               Part[$CellContext`list$$, $CellContext`j$$] = {{0, 0}, {0, 
                0}}]], {$CellContext`j$$, 
            2, $CellContext`l}]; $CellContext`list1 = $CellContext`list0; Do[
           If[
           Part[$CellContext`list$$, $CellContext`j$$] != {{0, 0}, {0, 
             0}}, $CellContext`list1 = AppendTo[$CellContext`list1, 
              
              Part[$CellContext`list$$, $CellContext`j$$]]], \
{$CellContext`j$$, 
            2, $CellContext`l}]; $CellContext`list$$ = $CellContext`list1]; \
$CellContext`l = Length[$CellContext`list$$]; ClickPane[
         Graphics[{$CellContext`board, 
           EdgeForm[Thin], 
           If[$CellContext`f$$ == $CellContext`r$$, 
            Table[{
              If[
              Part[$CellContext`side$$, $CellContext`i$$, $CellContext`j$$] == 
               1, 
               Which[$CellContext`colw$$ == 1, 
                RGBColor[0.9, 0.9, 0.5], $CellContext`colw$$ == 2, 
                RGBColor[0.7, 0.7, 0.4], $CellContext`colw$$ == 3, 
                RGBColor[0.9, 0.3, 0.3]], 
               Which[$CellContext`colb$$ == 1, 
                RGBColor[0.4, 0.4, 0.3], $CellContext`colb$$ == 2, 
                RGBColor[0.3, 0.4, 0.1], $CellContext`colb$$ == 3, 
                RGBColor[0.2, 0.5, 0.5]]], 
              Which[
              Part[$CellContext`type$$, $CellContext`i$$, $CellContext`j$$] == \
$CellContext`pp, 
               
               Translate[$CellContext`pawn, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`type$$, $CellContext`i$$, $CellContext`j$$] == \
$CellContext`rr, 
               
               Translate[$CellContext`rook, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`type$$, $CellContext`i$$, $CellContext`j$$] == \
$CellContext`nn, 
               
               Translate[$CellContext`knight, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`type$$, $CellContext`i$$, $CellContext`j$$] == \
$CellContext`bb, 
               
               Translate[$CellContext`bishop, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`type$$, $CellContext`i$$, $CellContext`j$$] == \
$CellContext`qq, 
               
               Translate[$CellContext`queen, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`type$$, $CellContext`i$$, $CellContext`j$$] == \
$CellContext`kk, 
               
               Translate[$CellContext`king, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`type$$, $CellContext`i$$, $CellContext`j$$] == 
               0, {}]}, {$CellContext`i$$, 8}, {$CellContext`j$$, 8}], {}], 
           If[$CellContext`f$$ < $CellContext`r$$, 
            Table[{
              If[
              Part[$CellContext`sides$$, $CellContext`f$$ + 
                 1, $CellContext`i$$, $CellContext`j$$] == 1, 
               Which[$CellContext`colw$$ == 1, 
                RGBColor[0.9, 0.9, 0.5], $CellContext`colw$$ == 2, 
                RGBColor[0.7, 0.7, 0.4], $CellContext`colw$$ == 3, 
                RGBColor[0.9, 0.3, 0.3]], 
               Which[$CellContext`colb$$ == 1, 
                RGBColor[0.4, 0.4, 0.3], $CellContext`colb$$ == 2, 
                RGBColor[0.3, 0.4, 0.1], $CellContext`colb$$ == 3, 
                RGBColor[0.2, 0.5, 0.5]]], 
              Which[
              Part[$CellContext`types$$, $CellContext`f$$ + 
                 1, $CellContext`i$$, $CellContext`j$$] == $CellContext`pp, 
               
               Translate[$CellContext`pawn, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`types$$, $CellContext`f$$ + 
                 1, $CellContext`i$$, $CellContext`j$$] == $CellContext`rr, 
               
               Translate[$CellContext`rook, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`types$$, $CellContext`f$$ + 
                 1, $CellContext`i$$, $CellContext`j$$] == $CellContext`nn, 
               
               Translate[$CellContext`knight, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`types$$, $CellContext`f$$ + 
                 1, $CellContext`i$$, $CellContext`j$$] == $CellContext`bb, 
               
               Translate[$CellContext`bishop, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`types$$, $CellContext`f$$ + 
                 1, $CellContext`i$$, $CellContext`j$$] == $CellContext`qq, 
               
               Translate[$CellContext`queen, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`types$$, $CellContext`f$$ + 
                 1, $CellContext`i$$, $CellContext`j$$] == $CellContext`kk, 
               
               Translate[$CellContext`king, {$CellContext`i$$, \
$CellContext`j$$}], 
               Part[$CellContext`types$$, $CellContext`f$$ + 
                 1, $CellContext`i$$, $CellContext`j$$] == 
               0, {}]}, {$CellContext`i$$, 8}, {$CellContext`j$$, 8}], {}], 
           Green, 
           If[
            
            And[$CellContext`showtargets$$, $CellContext`h$$ == 
             1, $CellContext`from$$ != {0, 0}, $CellContext`to$$ == {0, 0}], 
            Table[
             If[
             Part[$CellContext`list$$, $CellContext`i$$, 
                1] == $CellContext`oldfrom$$, 
              
              Disk[{Part[$CellContext`list$$, $CellContext`i$$, 2, 1] - 0.5, 
                Part[$CellContext`list$$, $CellContext`i$$, 2, 2] - 0.5}, 
               0.2], {}], {$CellContext`i$$, $CellContext`l}], {}], 
           If[
            
            And[$CellContext`showmoves$$, $CellContext`h$$ == 
             1, $CellContext`from$$ == {0, 0}], 
            Table[
             
             Arrow[{Part[$CellContext`list$$, $CellContext`i$$, 1] - {0.5, 
               0.5}, Part[$CellContext`list$$, $CellContext`i$$, 2] - {0.5, 
               0.5}}], {$CellContext`i$$, 2, $CellContext`l}], {}], 
           If[$CellContext`unmoveda1$$, Green, Red], 
           If[$CellContext`edit$$ == "castling options", 
            Disk[{0.5, 0.5}, 0.2], {}], 
           If[$CellContext`unmovedh1$$, Green, Red], 
           If[$CellContext`edit$$ == "castling options", 
            Disk[{7.5, 0.5}, 0.2], {}], 
           If[$CellContext`unmoveda8$$, Green, Red], 
           If[$CellContext`edit$$ == "castling options", 
            Disk[{0.5, 7.5}, 0.2], {}], 
           If[$CellContext`unmovedh8$$, Green, Red], 
           If[$CellContext`edit$$ == "castling options", 
            Disk[{7.5, 7.5}, 0.2], {}], Yellow, 
           If[$CellContext`from$$ != {0, 0}, 
            Disk[$CellContext`from$$ - {0.5, 0.5}, 0.2], {}], Black, 
           If[$CellContext`n$$ == 1, 
            Disk[{0, 0}, 0.1], 
            Disk[{0, 8}, 0.1]], 
           If[$CellContext`f$$ > 0, 
            If[Part[$CellContext`wfrom$$, $CellContext`f$$] != {0, 0}, 
             Text[
              Style[
               Row[{$CellContext`f$$, ". ", 
                 Part[$CellContext`names, 
                  Part[$CellContext`wpiece$$, $CellContext`f$$]], 
                 Part[$CellContext`alpha, 
                  Part[$CellContext`wfrom$$, $CellContext`f$$, 1]], 
                 Part[$CellContext`wfrom$$, $CellContext`f$$, 2], " ", 
                 Part[$CellContext`captures$$, $CellContext`f$$, 1]}], 12], {
              2.95, -0.5}], 
             Text[
              Style[
               Row[{$CellContext`f$$, ". ", "... - ..."}], 12], {
              2.95, -0.5}]], 
            Text[" ", {2.8, -0.5}]], 
           If[
            And[
             Inequality[
              Length[$CellContext`wto$$], GreaterEqual, $CellContext`f$$, 
              Greater, 0], 
             Part[$CellContext`wto$$, $CellContext`f$$] != {0, 0}], {
             Text[
              Style[
               Row[{
                 Part[$CellContext`alpha, 
                  Part[$CellContext`wto$$, $CellContext`f$$, 1]], 
                 Part[$CellContext`wto$$, $CellContext`f$$, 2], 
                 Part[$CellContext`checks$$, $CellContext`f$$, 1]}], 12], {
              3.75, -0.5}], 
             If[
              
              And[$CellContext`l == 1, $CellContext`h$$ == 1, 
               Length[$CellContext`bto$$] < $CellContext`r$$], 
              If[Part[$CellContext`checks$$, $CellContext`f$$, 1] == "+", 
               Text[
                Style[
                 Row[{"mate"}], 12], {4.4, -0.5}], 
               Text[
                Style[
                 Row[{"stalemate"}], 12], {4.4, -0.5}]], {}]}, {}], 
           If[
            Inequality[
             Length[$CellContext`bfrom$$], GreaterEqual, $CellContext`f$$, 
             Greater, 0], 
            Text[
             Style[
              Row[{
                Part[$CellContext`names, 
                 Part[$CellContext`bpiece$$, $CellContext`f$$]], 
                Part[$CellContext`alpha, 
                 Part[$CellContext`bfrom$$, $CellContext`f$$, 1]], 
                Part[$CellContext`bfrom$$, $CellContext`f$$, 2], " ", 
                Part[$CellContext`captures$$, $CellContext`f$$, 2]}], 12], {
             4.4, -0.5}], {}], 
           If[
            Inequality[
             Length[$CellContext`bto$$], GreaterEqual, $CellContext`f$$, 
             Greater, 0], {
             Text[
              Style[
               Row[{
                 Part[$CellContext`alpha, 
                  Part[$CellContext`bto$$, $CellContext`f$$, 1]], 
                 Part[$CellContext`bto$$, $CellContext`f$$, 2], 
                 Part[$CellContext`checks$$, $CellContext`f$$, 2]}], 12], {
              5., -0.5}], 
             If[
              And[$CellContext`l == 1, $CellContext`h$$ == 1], 
              If[Part[$CellContext`checks$$, $CellContext`f$$, 2] == "+", 
               Text[
                Style[
                 Row[{"mate"}], 12], {5.8, -0.5}], 
               Text[
                Style[
                 Row[{"stalemate"}], 12], {5.8, -0.5}]], {}]}, {}]}, 
          PlotRange -> {{-0.1, 8.1}, {-0.9, 8.1}}, ImageSize -> {400, 400}], {
         
          If[
           And[$CellContext`h$$ == 1, 
            Or[
            Length[$CellContext`list$$] > 1, $CellContext`edit$$ != 
             "play"]], {$CellContext`pos$$ = Floor[#] + {1, 1}, 
            Part[$CellContext`pos$$, 1] = Max[
              Part[$CellContext`pos$$, 1], 1], Part[$CellContext`pos$$, 1] = 
            Min[
              Part[$CellContext`pos$$, 1], 8], Part[$CellContext`pos$$, 2] = 
            Max[
              Part[$CellContext`pos$$, 2], 1], Part[$CellContext`pos$$, 2] = 
            Min[
              Part[$CellContext`pos$$, 2], 8], 
            If[
             Not[$CellContext`part1$$], 
             Which[$CellContext`edit$$ == "play", {}, $CellContext`edit$$ == 
               "delete", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 0; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 0, $CellContext`edit$$ == 
               "white pawn", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 1, $CellContext`edit$$ == 
               "white rook", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 2, $CellContext`edit$$ == 
               "white knight", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 3, $CellContext`edit$$ == 
               "white bishop", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 4, $CellContext`edit$$ == 
               "white queen", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 5, $CellContext`edit$$ == 
               "white king", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 6, $CellContext`edit$$ == 
               "black pawn", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = -1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 1, $CellContext`edit$$ == 
               "black rook", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = -1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 2, $CellContext`edit$$ == 
               "black knight", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = -1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 3, $CellContext`edit$$ == 
               "black bishop", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = -1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 4, $CellContext`edit$$ == 
               "black queen", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = -1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 5, $CellContext`edit$$ == 
               "black king", Part[$CellContext`side$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = -1; 
               Part[$CellContext`type$$, 
                  Part[$CellContext`pos$$, 1], 
                  Part[$CellContext`pos$$, 2]] = 6, 
               
               And[$CellContext`edit$$ == "next player", $CellContext`r$$ == 
                0], $CellContext`n$$ = -$CellContext`n$$]; 
             If[$CellContext`edit$$ != 
               "play", $CellContext`list$$ = $CellContext`list0]], 
            If[
             
             And[$CellContext`edit$$ == "castling options", 
              Part[$CellContext`type$$, 
                Part[$CellContext`pos$$, 1], 
                Part[$CellContext`pos$$, 2]] == $CellContext`rr], 
             If[$CellContext`pos$$ == {1, 1}, $CellContext`unmoveda1$$ = 
               Not[$CellContext`unmoveda1$$]]; 
             If[$CellContext`pos$$ == {8, 1}, $CellContext`unmovedh1$$ = 
               Not[$CellContext`unmovedh1$$]]; 
             If[$CellContext`pos$$ == {1, 8}, $CellContext`unmoveda8$$ = 
               Not[$CellContext`unmoveda8$$]]; 
             If[$CellContext`pos$$ == {8, 8}, $CellContext`unmovedh8$$ = 
               Not[$CellContext`unmovedh8$$]], {}], 
            
            If[$CellContext`edit$$ == 
             "reset", $CellContext`r$$ = 0; $CellContext`edit$$ = 
              "play"; $CellContext`wto$$ = ($CellContext`wfrom$$ = \
($CellContext`bfrom$$ = ($CellContext`bto$$ = ($CellContext`wpiece$$ = \
($CellContext`bpiece$$ = {}))))); $CellContext`side$$ = $CellContext`side0; \
$CellContext`type$$ = $CellContext`type0; $CellContext`list$$ = \
$CellContext`list0; $CellContext`sides$$ = {$CellContext`side0}; \
$CellContext`types$$ = {$CellContext`type0}; $CellContext`part1$$ = \
($CellContext`part2$$ = False); $CellContext`ok$$ = 
              False; $CellContext`from$$ = ($CellContext`to$$ = \
($CellContext`epwhite$$ = ($CellContext`epblack$$ = {0, 
                  0}))); $CellContext`n$$ = 
              1; $CellContext`unmoveda1$$ = ($CellContext`unmoveda8$$ = \
($CellContext`unmovedh1$$ = ($CellContext`unmovedh8$$ = True)))], 
            
            If[$CellContext`edit$$ == 
             "clear", $CellContext`r$$ = 
              0; $CellContext`wto$$ = ($CellContext`wfrom$$ = \
($CellContext`bfrom$$ = ($CellContext`bto$$ = ($CellContext`wpiece$$ = \
($CellContext`bpiece$$ = {}))))); $CellContext`list$$ = $CellContext`list0; \
$CellContext`side$$ = ($CellContext`type$$ = $CellContext`all0); \
$CellContext`sides$$ = ($CellContext`types$$ = {$CellContext`all0}); \
$CellContext`part1$$ = ($CellContext`part2$$ = False); $CellContext`ok$$ = 
              False; $CellContext`from$$ = ($CellContext`to$$ = \
($CellContext`epwhite$$ = ($CellContext`epblack$$ = {0, 
                  0}))); $CellContext`n$$ = 
              1; $CellContext`unmoveda1$$ = ($CellContext`unmoveda8$$ = \
($CellContext`unmovedh1$$ = ($CellContext`unmovedh8$$ = True)))], 
            If[$CellContext`edit$$ == "play", {
              If[
               Or[
                And[$CellContext`n$$ == 1, 
                 Not[$CellContext`randomwhite$$]], 
                And[$CellContext`n$$ == -1, 
                 Not[$CellContext`randomblack$$]]], {$CellContext`l = 
                Length[$CellContext`list$$], $CellContext`part1$$ = \
($CellContext`part2$$ = False), 
                If[
                 And[
                 Part[$CellContext`from$$, 1] == 0, $CellContext`n$$ == 
                  Part[$CellContext`side$$, 
                    Part[$CellContext`pos$$, 1], 
                    Part[$CellContext`pos$$, 2]]], {
                  
                  For[$CellContext`i$$ = 
                   1, $CellContext`i$$ <= $CellContext`l, 
                   Increment[$CellContext`i$$], 
                   If[
                   Part[$CellContext`list$$, $CellContext`i$$, 
                    1] == $CellContext`pos$$, {$CellContext`part1$$ = True, 
                    Break[]}]]}], 
                If[
                 And[
                 Part[$CellContext`from$$, 1] != 0, 
                  Part[$CellContext`to$$, 1] == 0, $CellContext`n$$ != 
                  Part[$CellContext`side$$, 
                    Part[$CellContext`pos$$, 1], 
                    Part[$CellContext`pos$$, 2]]], {
                  
                  For[$CellContext`i$$ = 
                   1, $CellContext`i$$ <= $CellContext`l, 
                   Increment[$CellContext`i$$], 
                   If[
                    And[
                    Part[$CellContext`list$$, $CellContext`i$$, 
                    1] == $CellContext`oldfrom$$, 
                    Part[$CellContext`list$$, $CellContext`i$$, 
                    2] == $CellContext`pos$$], {$CellContext`part2$$ = True, 
                    Break[]}]]}], 
                
                If[$CellContext`part1$$, $CellContext`oldfrom$$ = \
($CellContext`from$$ = $CellContext`pos$$); $CellContext`to$$ = {0, 0}], 
                
                If[$CellContext`part2$$, $CellContext`to$$ = \
$CellContext`pos$$], 
                If[
                 
                 And[$CellContext`part1$$, $CellContext`n$$ == 
                  1], $CellContext`r$$ = $CellContext`r$$ + 
                   1; $CellContext`wfrom$$ = 
                  AppendTo[$CellContext`wfrom$$, $CellContext`pos$$]; \
$CellContext`wpiece$$ = AppendTo[$CellContext`wpiece$$, 
                    Part[$CellContext`type$$, 
                    Part[$CellContext`pos$$, 1], 
                    Part[$CellContext`pos$$, 2]]]], 
                If[
                 
                 And[$CellContext`part1$$, $CellContext`n$$ == -1], \
$CellContext`bfrom$$ = 
                  AppendTo[$CellContext`bfrom$$, $CellContext`pos$$]; \
$CellContext`bpiece$$ = AppendTo[$CellContext`bpiece$$, 
                    Part[$CellContext`type$$, 
                    Part[$CellContext`pos$$, 1], 
                    Part[$CellContext`pos$$, 2]]]; 
                 If[$CellContext`r$$ == 
                   0, $CellContext`r$$ = 
                    1; $CellContext`wfrom$$ = ($CellContext`wto$$ = {{0, 
                    0}}); $CellContext`wpiece$$ = {$CellContext`pp}; \
$CellContext`captures$$ = {{"-", "-"}, {"-", "-"}}]], 
                If[
                 And[
                  Not[$CellContext`part1$$], 
                  Not[$CellContext`part2$$]], If[
                   
                   And[$CellContext`from$$ != {0, 0}, $CellContext`to$$ == {0,
                     0}, $CellContext`n$$ == 1], $CellContext`wfrom$$ = 
                    Delete[$CellContext`wfrom$$, $CellContext`r$$]; \
$CellContext`wpiece$$ = 
                    Delete[$CellContext`wpiece$$, $CellContext`r$$]; \
$CellContext`r$$ = $CellContext`r$$ - 1, {}]; If[
                   
                   And[$CellContext`from$$ != {0, 0}, $CellContext`to$$ == {0,
                     0}, $CellContext`n$$ == -1], $CellContext`bfrom$$ = 
                    Delete[$CellContext`wfrom$$, $CellContext`r$$]; \
$CellContext`bpiece$$ = 
                    Delete[$CellContext`bpiece$$, $CellContext`r$$], {}]; \
$CellContext`from$$ = ($CellContext`to$$ = {0, 0})]}], 
              If[
               
               And[$CellContext`randomwhite$$, $CellContext`n$$ == 
                1, $CellContext`from$$ == {0, 0}], $CellContext`i$$ = 
                RandomInteger[{2, 
                   Length[$CellContext`list$$]}]; $CellContext`from$$ = 
                Part[$CellContext`list$$, $CellContext`i$$, 
                  1]; $CellContext`pos$$ = ($CellContext`to$$ = 
                 Part[$CellContext`list$$, $CellContext`i$$, 
                   2]); $CellContext`wfrom$$ = 
                AppendTo[$CellContext`wfrom$$, $CellContext`from$$]; \
$CellContext`wpiece$$ = AppendTo[$CellContext`wpiece$$, 
                  Part[$CellContext`type$$, 
                   Part[$CellContext`from$$, 1], 
                   Part[$CellContext`from$$, 2]]]; $CellContext`captures$$ = 
                Append[$CellContext`captures$$, {
                  "-", "-"}]; $CellContext`checks$$ = 
                Append[$CellContext`checks$$, {
                  " ", " "}]; $CellContext`r$$ = $CellContext`r$$ + 
                 1; $CellContext`part1$$ = False; $CellContext`part2$$ = 
                True], 
              If[
               
               And[$CellContext`randomblack$$, $CellContext`n$$ == -1, \
$CellContext`from$$ == {0, 0}], $CellContext`i$$ = RandomInteger[{2, 
                   Length[$CellContext`list$$]}]; $CellContext`from$$ = 
                Part[$CellContext`list$$, $CellContext`i$$, 
                  1]; $CellContext`pos$$ = ($CellContext`to$$ = 
                 Part[$CellContext`list$$, $CellContext`i$$, 
                   2]); $CellContext`bfrom$$ = 
                AppendTo[$CellContext`bfrom$$, $CellContext`from$$]; \
$CellContext`bpiece$$ = AppendTo[$CellContext`bpiece$$, 
                  Part[$CellContext`type$$, 
                   Part[$CellContext`from$$, 1], 
                   Part[$CellContext`from$$, 2]]]; 
               If[$CellContext`r$$ == 
                 0, $CellContext`r$$ = 
                  1; $CellContext`wfrom$$ = ($CellContext`wto$$ = {{
                    9, " "}}); $CellContext`wpiece$$ = {$CellContext`pp}]; \
$CellContext`captures$$ = 
                Append[$CellContext`captures$$, {
                  "-", "-"}]; $CellContext`part1$$ = 
                False; $CellContext`part2$$ = True], $CellContext`x$$ = 
              Part[$CellContext`from$$, 1], $CellContext`y$$ = 
              Part[$CellContext`from$$, 2], 
              If[$CellContext`part2$$, {
                If[
                 Or[$CellContext`from$$ == {1, 1}, $CellContext`to$$ == {1, 
                   1}, $CellContext`from$$ == {5, 
                   1}], $CellContext`unmoveda1$$ = False], 
                If[
                 
                 Or[$CellContext`from$$ == {8, 1}, $CellContext`to$$ == {8, 
                   1}, $CellContext`from$$ == {5, 
                   1}], $CellContext`unmovedh1$$ = False], 
                If[
                 
                 Or[$CellContext`from$$ == {1, 8}, $CellContext`to$$ == {1, 
                   8}, $CellContext`from$$ == {5, 
                   8}], $CellContext`unmoveda8$$ = False], 
                If[
                 
                 Or[$CellContext`from$$ == {8, 8}, $CellContext`to$$ == {8, 
                   8}, $CellContext`from$$ == {5, 
                   8}], $CellContext`unmovedh8$$ = False], 
                If[
                 And[
                 Part[$CellContext`type$$, $CellContext`x$$, \
$CellContext`y$$] == $CellContext`pp, $CellContext`y$$ == 2, 
                  Part[$CellContext`to$$, 2] == 
                  4], $CellContext`epwhite$$ = {$CellContext`x$$, 3}], 
                If[
                 And[
                 Part[$CellContext`type$$, $CellContext`x$$, \
$CellContext`y$$] == $CellContext`pp, $CellContext`y$$ == 7, 
                  Part[$CellContext`to$$, 2] == 
                  5], $CellContext`epblack$$ = {$CellContext`x$$, 6}], 
                If[
                 And[
                 Part[$CellContext`type$$, $CellContext`x$$, \
$CellContext`y$$] == $CellContext`pp, 
                  Or[
                  Part[$CellContext`to$$, 2] == 8, Part[$CellContext`to$$, 2] == 
                   1]], 
                 
                 Which[$CellContext`prom$$ == "queen", 
                  Part[$CellContext`type$$, 
                    Part[$CellContext`to$$, 1], 
                    
                    Part[$CellContext`to$$, 
                    2]] = $CellContext`qq, $CellContext`prom$$ == "rook", 
                  Part[$CellContext`type$$, 
                    Part[$CellContext`to$$, 1], 
                    
                    Part[$CellContext`to$$, 
                    2]] = $CellContext`rr, $CellContext`prom$$ == "bishop", 
                  Part[$CellContext`type$$, 
                    Part[$CellContext`to$$, 1], 
                    
                    Part[$CellContext`to$$, 
                    2]] = $CellContext`bb, $CellContext`prom$$ == "knight", 
                  Part[$CellContext`type$$, 
                    Part[$CellContext`to$$, 1], 
                    Part[$CellContext`to$$, 2]] = $CellContext`nn], 
                 Part[$CellContext`type$$, 
                   Part[$CellContext`to$$, 1], 
                   Part[$CellContext`to$$, 2]] = 
                 Part[$CellContext`type$$, $CellContext`x$$, \
$CellContext`y$$]], 
                If[
                Part[$CellContext`type$$, $CellContext`x$$, $CellContext`y$$] == \
$CellContext`kk, If[
                   
                   And[$CellContext`from$$ == {5, 1}, $CellContext`to$$ == {3,
                     1}], Part[$CellContext`type$$, 4, 1] = $CellContext`rr; 
                   Part[$CellContext`type$$, 1, 1] = 0; 
                   Part[$CellContext`side$$, 4, 1] = 1; 
                   Part[$CellContext`side$$, 1, 1] = 0]; If[
                   
                   And[$CellContext`from$$ == {5, 1}, $CellContext`to$$ == {7,
                     1}], Part[$CellContext`type$$, 6, 1] = $CellContext`rr; 
                   Part[$CellContext`type$$, 8, 1] = 0; 
                   Part[$CellContext`side$$, 6, 1] = 1; 
                   Part[$CellContext`side$$, 8, 1] = 0]; If[
                   
                   And[$CellContext`from$$ == {5, 8}, $CellContext`to$$ == {3,
                     8}], Part[$CellContext`type$$, 4, 8] = $CellContext`rr; 
                   Part[$CellContext`type$$, 1, 8] = 0; 
                   Part[$CellContext`side$$, 4, 8] = -1; 
                   Part[$CellContext`side$$, 1, 8] = 0]; If[
                   
                   And[$CellContext`from$$ == {5, 8}, $CellContext`to$$ == {7,
                     8}], Part[$CellContext`type$$, 6, 8] = $CellContext`rr; 
                   Part[$CellContext`type$$, 8, 8] = 0; 
                   Part[$CellContext`side$$, 6, 8] = -1; 
                   Part[$CellContext`side$$, 8, 8] = 
                    0]], $CellContext`capture$$ = "-"; If[
                  And[
                  Part[$CellContext`type$$, $CellContext`x$$, \
$CellContext`y$$] == $CellContext`pp, $CellContext`to$$ == \
$CellContext`epblack$$], Part[$CellContext`type$$, 
                    Part[$CellContext`to$$, 1], Part[$CellContext`to$$, 2] - 
                    1] = 0; Part[$CellContext`side$$, 
                    Part[$CellContext`to$$, 1], Part[$CellContext`to$$, 2] - 
                    1] = 0; $CellContext`capture$$ = "x"], 
                If[
                 And[
                 Part[$CellContext`type$$, $CellContext`x$$, \
$CellContext`y$$] == $CellContext`pp, $CellContext`to$$ == \
$CellContext`epwhite$$], Part[$CellContext`type$$, 
                    Part[$CellContext`to$$, 1], Part[$CellContext`to$$, 2] + 
                    1] = 0; Part[$CellContext`side$$, 
                    Part[$CellContext`to$$, 1], Part[$CellContext`to$$, 2] + 
                    1] = 0; $CellContext`capture$$ = "x"], 
                Part[$CellContext`type$$, $CellContext`x$$, $CellContext`y$$] = 
                0, 
                If[Part[$CellContext`side$$, 
                   Part[$CellContext`to$$, 1], 
                   Part[$CellContext`to$$, 2]] != 0, $CellContext`capture$$ = 
                 "x"], Part[$CellContext`side$$, 
                  Part[$CellContext`to$$, 1], 
                  Part[$CellContext`to$$, 2]] = 
                Part[$CellContext`side$$, $CellContext`x$$, $CellContext`y$$],
                 Part[$CellContext`side$$, $CellContext`x$$, \
$CellContext`y$$] = 0, 
                
                If[$CellContext`n$$ == 
                 1, $CellContext`wto$$ = 
                  AppendTo[$CellContext`wto$$, $CellContext`pos$$]; \
$CellContext`captures$$ = Append[$CellContext`captures$$, {"-", "-"}]; 
                 Part[$CellContext`captures$$, $CellContext`r$$, 
                    1] = $CellContext`capture$$; $CellContext`list$$ = \
$CellContext`list0; $CellContext`checks$$ = 
                  Append[$CellContext`checks$$, {" ", " "}]; Do[
                   If[
                    And[
                    Part[$CellContext`type$$, $CellContext`i$$, \
$CellContext`j$$] == $CellContext`kk, 
                    Part[$CellContext`side$$, $CellContext`i$$, \
$CellContext`j$$] == -$CellContext`n$$], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, \
$CellContext`i$$, $CellContext`j$$, -$CellContext`n$$]; 
                    Break[]], {$CellContext`i$$, 8}, {$CellContext`j$$, 8}]; 
                 If[$CellContext`swattacked$$, 
                   Part[$CellContext`checks$$, $CellContext`r$$, 1] = "+"]], 
                
                If[$CellContext`n$$ == -1, $CellContext`bto$$ = 
                  AppendTo[$CellContext`bto$$, $CellContext`pos$$]; \
$CellContext`sides$$ = 
                  AppendTo[$CellContext`sides$$, $CellContext`side$$]; \
$CellContext`types$$ = AppendTo[$CellContext`types$$, $CellContext`type$$]; 
                 Part[$CellContext`captures$$, $CellContext`r$$, 
                    2] = $CellContext`capture$$; $CellContext`list$$ = \
$CellContext`list0; Do[
                   If[
                    And[
                    Part[$CellContext`type$$, $CellContext`i$$, \
$CellContext`j$$] == $CellContext`kk, 
                    Part[$CellContext`side$$, $CellContext`i$$, \
$CellContext`j$$] == -$CellContext`n$$], $CellContext`swattacked$$ = \
$CellContext`check[$CellContext`side$$, $CellContext`type$$, \
$CellContext`i$$, $CellContext`j$$, -$CellContext`n$$]; 
                    Break[]], {$CellContext`i$$, 8}, {$CellContext`j$$, 8}]; 
                 If[$CellContext`swattacked$$, 
                   Part[$CellContext`checks$$, $CellContext`r$$, 2] = "+"]], 
                
                If[$CellContext`n$$ == 
                 1, $CellContext`epblack$$ = {0, 
                  0}, $CellContext`epwhite$$ = {0, 
                  0}], $CellContext`n$$ = -$CellContext`n$$, \
$CellContext`list$$ = $CellContext`list0, $CellContext`part1$$ = \
($CellContext`part2$$ = 
                 False), $CellContext`from$$ = ($CellContext`to$$ = {0, 
                  0})}]}]}]}& ]), 
      "Specifications" :> {{{$CellContext`colw$$, 1, 
          Style["color White", 10]}, {1, 2, 3}, ControlType -> 
         PopupMenu}, {{$CellContext`colb$$, 1, 
          Style["color Black", 10]}, {1, 2, 3}, ControlType -> 
         PopupMenu}, {{$CellContext`randomwhite$$, False, "random White"}, {
         True, False}}, {{$CellContext`randomblack$$, False, 
          "random Black"}, {
         True, False}}, {{$CellContext`showmoves$$, False, "show moves"}, {
         True, False}}, {{$CellContext`showtargets$$, True, "show targets"}, {
         True, False}}, {{$CellContext`prom$$, "queen", 
          Style["promotion to", 10]}, {"queen", "rook", "bishop", "knight"}, 
         ControlType -> PopupMenu}, {{$CellContext`edit$$, "play", 
          Style["edit position", 10]}, {
         "play", "reset", "clear", "delete", "white pawn", "white knight", 
          "white bishop", "white rook", "white queen", "white king", 
          "black pawn", "black knight", "black bishop", "black rook", 
          "black queen", "black king", "castling options", "next player"}, 
         ControlType -> PopupMenu}, {{$CellContext`h$$, 1, 
          Style["history"]}, 0, 1, ControlType -> Slider, ImageSize -> 
         Small}, {{$CellContext`i$$, 0}, ControlType -> 
         None}, {{$CellContext`j$$, 0}, ControlType -> 
         None}, {{$CellContext`kx$$, 0}, ControlType -> 
         None}, {{$CellContext`ky$$, 0}, ControlType -> 
         None}, {{$CellContext`pos$$, {0, 0}}, ControlType -> 
         None}, {{$CellContext`from$$, {0, 0}}, ControlType -> 
         None}, {{$CellContext`oldfrom$$, {0, 0}}, ControlType -> 
         None}, {{$CellContext`to$$, {0, 0}}, ControlType -> 
         None}, {{$CellContext`side$$, {{1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 
          0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
          0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
          0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
          0, -1, -1}}}, ControlType -> 
         None}, {{$CellContext`type$$, {{2, 1, 0, 0, 0, 0, 1, 2}, {3, 1, 0, 0,
           0, 0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 4}, {5, 1, 0, 0, 0, 0, 1, 5}, {
          6, 1, 0, 0, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0, 1, 4}, {3, 1, 0, 0, 0, 
          0, 1, 3}, {2, 1, 0, 0, 0, 0, 1, 2}}}, ControlType -> 
         None}, {{$CellContext`n$$, 1}, ControlType -> 
         None}, {{$CellContext`list$$, {{{0, 0}, {0, 0}}}}, ControlType -> 
         None}, {{$CellContext`sides$$, {{{1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 
          0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
          0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
          0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
          0, -1, -1}}}}, ControlType -> 
         None}, {{$CellContext`types$$, {{{2, 1, 0, 0, 0, 0, 1, 2}, {3, 1, 0, 
          0, 0, 0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 4}, {5, 1, 0, 0, 0, 0, 1, 
          5}, {6, 1, 0, 0, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0, 1, 4}, {3, 1, 0, 0,
           0, 0, 1, 3}, {2, 1, 0, 0, 0, 0, 1, 2}}}}, ControlType -> 
         None}, {{$CellContext`wfrom$$, {}}, ControlType -> 
         None}, {{$CellContext`wto$$, {}}, ControlType -> 
         None}, {{$CellContext`wpiece$$, {}}, ControlType -> 
         None}, {{$CellContext`bfrom$$, {}}, ControlType -> 
         None}, {{$CellContext`bto$$, {}}, ControlType -> 
         None}, {{$CellContext`bpiece$$, {}}, ControlType -> 
         None}, {{$CellContext`unmoveda1$$, True}, ControlType -> 
         None}, {{$CellContext`unmoveda8$$, True}, ControlType -> 
         None}, {{$CellContext`unmovedh1$$, True}, ControlType -> 
         None}, {{$CellContext`unmovedh8$$, True}, ControlType -> 
         None}, {{$CellContext`epwhite$$, {0, 0}}, ControlType -> 
         None}, {{$CellContext`epblack$$, {0, 0}}, ControlType -> 
         None}, {{$CellContext`r$$, 0}, ControlType -> 
         None}, {{$CellContext`f$$, 0}, ControlType -> 
         None}, {{$CellContext`capture$$, "-"}, ControlType -> 
         None}, {{$CellContext`captures$$, {{"-", "-"}}}, ControlType -> 
         None}, {{$CellContext`checks$$, {{" ", " "}}}, ControlType -> 
         None}, {{$CellContext`part1$$, False}, ControlType -> 
         None}, {{$CellContext`part2$$, False}, ControlType -> 
         None}, {{$CellContext`ok$$, False}, ControlType -> 
         None}, {{$CellContext`eastok$$, False}, ControlType -> 
         None}, {{$CellContext`westok$$, False}, ControlType -> 
         None}, {{$CellContext`southok$$, False}, ControlType -> 
         None}, {{$CellContext`northok$$, False}, ControlType -> 
         None}, {{$CellContext`x$$, 0}, ControlType -> 
         None}, {{$CellContext`y$$, 0}, ControlType -> 
         None}, {{$CellContext`swattacked$$, False}, ControlType -> None}}, 
      "Options" :> {ControlPlacement -> Left, AutorunSequencing -> {1}}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{651., {226., 231.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`list0 = {{{0, 0}, {0, 0}}}, $CellContext`t = 
       1, $CellContext`s = -1, $CellContext`pp = 1, $CellContext`nn = 
       3, $CellContext`bb = 4, $CellContext`qq = 5, $CellContext`rr = 
       2, $CellContext`kk = 6, $CellContext`check[
         Pattern[$CellContext`si$, 
          Blank[]], 
         Pattern[$CellContext`ty$, 
          Blank[]], 
         Pattern[$CellContext`x$, 
          Blank[]], 
         Pattern[$CellContext`y$, 
          Blank[]], 
         Pattern[$CellContext`n$, 
          Blank[]]] := 
       Module[{$CellContext`sw$}, $CellContext`sw$ = False; If[
           
           And[$CellContext`x$ < 8, $CellContext`n$ $CellContext`y$ < 
            4 + $CellContext`n$ 3, 
            Part[$CellContext`si$, $CellContext`x$ + 
              1, $CellContext`y$ + $CellContext`n$] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ + 
              1, $CellContext`y$ + $CellContext`n$] == $CellContext`pp], \
$CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ > 1, $CellContext`n$ $CellContext`y$ < 
            4 + $CellContext`n$ 3, 
            Part[$CellContext`si$, $CellContext`x$ - 
              1, $CellContext`y$ + $CellContext`n$] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ - 
              1, $CellContext`y$ + $CellContext`n$] == $CellContext`pp], \
$CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ < 8, $CellContext`y$ > 2, 
            Part[$CellContext`si$, $CellContext`x$ + 1, $CellContext`y$ - 
              2] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ + 1, $CellContext`y$ - 
              2] == $CellContext`nn], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ < 8, $CellContext`y$ < 7, 
            Part[$CellContext`si$, $CellContext`x$ + 1, $CellContext`y$ + 
              2] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ + 1, $CellContext`y$ + 
              2] == $CellContext`nn], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ > 1, $CellContext`y$ > 2, 
            Part[$CellContext`si$, $CellContext`x$ - 1, $CellContext`y$ - 
              2] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ - 1, $CellContext`y$ - 
              2] == $CellContext`nn], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ > 1, $CellContext`y$ < 7, 
            Part[$CellContext`si$, $CellContext`x$ - 1, $CellContext`y$ + 
              2] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ - 1, $CellContext`y$ + 
              2] == $CellContext`nn], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ < 7, $CellContext`y$ > 1, 
            Part[$CellContext`si$, $CellContext`x$ + 2, $CellContext`y$ - 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ + 2, $CellContext`y$ - 
              1] == $CellContext`nn], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ < 7, $CellContext`y$ < 8, 
            Part[$CellContext`si$, $CellContext`x$ + 2, $CellContext`y$ + 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ + 2, $CellContext`y$ + 
              1] == $CellContext`nn], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ > 2, $CellContext`y$ > 1, 
            Part[$CellContext`si$, $CellContext`x$ - 2, $CellContext`y$ - 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ - 2, $CellContext`y$ - 
              1] == $CellContext`nn], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ > 2, $CellContext`y$ < 8, 
            Part[$CellContext`si$, $CellContext`x$ - 2, $CellContext`y$ + 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ - 2, $CellContext`y$ + 
              1] == $CellContext`nn], $CellContext`sw$ = True]; 
         For[$CellContext`i$$ = 1, $CellContext`i$$ <= 
           Min[7 - $CellContext`x$, 7 - $CellContext`y$], 
           Increment[$CellContext`i$$], 
           If[
           Part[$CellContext`si$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$ + $CellContext`i$$] != 0, 
            Break[]]]; If[
           
           And[$CellContext`i$$ <= 
            Min[8 - $CellContext`x$, 8 - $CellContext`y$], 
            
            Part[$CellContext`si$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$ + $CellContext`i$$] == -$CellContext`n$, 
            Or[
            Part[$CellContext`ty$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$ + $CellContext`i$$] == $CellContext`qq, 
             Part[$CellContext`ty$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$ + $CellContext`i$$] == $CellContext`bb]], $CellContext`sw$ = 
           True]; For[$CellContext`i$$ = 1, $CellContext`i$$ <= 
           Min[$CellContext`x$ - 1, 7 - $CellContext`y$], 
           Increment[$CellContext`i$$], 
           If[
           Part[$CellContext`si$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$ + $CellContext`i$$] != 0, 
            Break[]]]; If[
           
           And[$CellContext`i$$ <= 
            Min[$CellContext`x$ - 1, 8 - $CellContext`y$], 
            Part[$CellContext`si$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$ + $CellContext`i$$] == -$CellContext`n$, 
            Or[
            Part[$CellContext`ty$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$ + $CellContext`i$$] == $CellContext`qq, 
             Part[$CellContext`ty$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$ + $CellContext`i$$] == $CellContext`bb]], $CellContext`sw$ = 
           True]; For[$CellContext`i$$ = 1, $CellContext`i$$ <= 
           Min[7 - $CellContext`x$, $CellContext`y$ - 1], 
           Increment[$CellContext`i$$], 
           If[
           Part[$CellContext`si$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$ - $CellContext`i$$] != 0, 
            Break[]]]; If[
           
           And[$CellContext`i$$ <= 
            Min[8 - $CellContext`x$, $CellContext`y$ - 1], 
            Part[$CellContext`si$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$ - $CellContext`i$$] == -$CellContext`n$, 
            Or[
            Part[$CellContext`ty$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$ - $CellContext`i$$] == $CellContext`qq, 
             Part[$CellContext`ty$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$ - $CellContext`i$$] == $CellContext`bb]], $CellContext`sw$ = 
           True]; 
         For[$CellContext`i$$ = 1, $CellContext`i$$ <= 
           Min[$CellContext`x$ - 1, $CellContext`y$ - 1], 
           Increment[$CellContext`i$$], 
           If[
           Part[$CellContext`si$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$ - $CellContext`i$$] != 0, 
            Break[]]]; If[
           
           And[$CellContext`i$$ <= 
            Min[$CellContext`x$ - 1, $CellContext`y$ - 1], 
            Part[$CellContext`si$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$ - $CellContext`i$$] == -$CellContext`n$, 
            Or[
            Part[$CellContext`ty$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$ - $CellContext`i$$] == $CellContext`qq, 
             Part[$CellContext`ty$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$ - $CellContext`i$$] == $CellContext`bb]], $CellContext`sw$ = 
           True]; For[$CellContext`i$$ = 1, $CellContext`i$$ <= 
           7 - $CellContext`x$, 
           Increment[$CellContext`i$$], 
           If[
           Part[$CellContext`si$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$] != 0, 
            Break[]]]; If[
           
           And[$CellContext`i$$ <= 8 - $CellContext`x$, 
            Part[$CellContext`si$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$] == -$CellContext`n$, 
            Or[
            Part[$CellContext`ty$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$] == $CellContext`qq, 
             Part[$CellContext`ty$, $CellContext`x$ + $CellContext`i$$, \
$CellContext`y$] == $CellContext`rr]], $CellContext`sw$ = True]; 
         For[$CellContext`i$$ = 1, $CellContext`i$$ <= $CellContext`x$ - 1, 
           Increment[$CellContext`i$$], 
           If[
           Part[$CellContext`si$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$] != 0, 
            Break[]]]; If[
           
           And[$CellContext`i$$ <= $CellContext`x$ - 1, 
            Part[$CellContext`si$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$] == -$CellContext`n$, 
            Or[
            Part[$CellContext`ty$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$] == $CellContext`qq, 
             Part[$CellContext`ty$, $CellContext`x$ - $CellContext`i$$, \
$CellContext`y$] == $CellContext`rr]], $CellContext`sw$ = True]; 
         For[$CellContext`i$$ = 1, $CellContext`i$$ <= 7 - $CellContext`y$, 
           Increment[$CellContext`i$$], 
           If[
           Part[$CellContext`si$, $CellContext`x$, $CellContext`y$ + \
$CellContext`i$$] != 0, 
            Break[]]]; If[
           
           And[$CellContext`i$$ <= 8 - $CellContext`y$, 
            Part[$CellContext`si$, $CellContext`x$, $CellContext`y$ + \
$CellContext`i$$] == -$CellContext`n$, 
            Or[
            Part[$CellContext`ty$, $CellContext`x$, $CellContext`y$ + \
$CellContext`i$$] == $CellContext`qq, 
             Part[$CellContext`ty$, $CellContext`x$, $CellContext`y$ + \
$CellContext`i$$] == $CellContext`rr]], $CellContext`sw$ = True]; 
         For[$CellContext`i$$ = 1, $CellContext`i$$ <= $CellContext`y$ - 1, 
           Increment[$CellContext`i$$], 
           If[
           Part[$CellContext`si$, $CellContext`x$, $CellContext`y$ - \
$CellContext`i$$] != 0, 
            Break[]]]; If[
           
           And[$CellContext`i$$ <= $CellContext`y$ - 1, 
            Part[$CellContext`si$, $CellContext`x$, $CellContext`y$ - \
$CellContext`i$$] == -$CellContext`n$, 
            Or[
            Part[$CellContext`ty$, $CellContext`x$, $CellContext`y$ - \
$CellContext`i$$] == $CellContext`qq, 
             Part[$CellContext`ty$, $CellContext`x$, $CellContext`y$ - \
$CellContext`i$$] == $CellContext`rr]], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ < 8, 
            Part[$CellContext`si$, $CellContext`x$ + 
              1, $CellContext`y$] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ + 
              1, $CellContext`y$] == $CellContext`kk], $CellContext`sw$ = 
           True]; If[
           
           And[$CellContext`x$ > 1, 
            Part[$CellContext`si$, $CellContext`x$ - 
              1, $CellContext`y$] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ - 
              1, $CellContext`y$] == $CellContext`kk], $CellContext`sw$ = 
           True]; If[
           
           And[$CellContext`y$ < 8, 
            Part[$CellContext`si$, $CellContext`x$, $CellContext`y$ + 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$, $CellContext`y$ + 
              1] == $CellContext`kk], $CellContext`sw$ = True]; If[
           
           And[$CellContext`y$ > 1, 
            Part[$CellContext`si$, $CellContext`x$, $CellContext`y$ - 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$, $CellContext`y$ - 
              1] == $CellContext`kk], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ < 8, $CellContext`y$ < 8, 
            Part[$CellContext`si$, $CellContext`x$ + 1, $CellContext`y$ + 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ + 1, $CellContext`y$ + 
              1] == $CellContext`kk], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ > 1, $CellContext`y$ > 1, 
            Part[$CellContext`si$, $CellContext`x$ - 1, $CellContext`y$ - 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ - 1, $CellContext`y$ - 
              1] == $CellContext`kk], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ < 8, $CellContext`y$ > 1, 
            Part[$CellContext`si$, $CellContext`x$ + 1, $CellContext`y$ - 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ + 1, $CellContext`y$ - 
              1] == $CellContext`kk], $CellContext`sw$ = True]; If[
           
           And[$CellContext`x$ > 1, $CellContext`y$ < 8, 
            Part[$CellContext`si$, $CellContext`x$ - 1, $CellContext`y$ + 
              1] == -$CellContext`n$, 
            Part[$CellContext`ty$, $CellContext`x$ - 1, $CellContext`y$ + 
              1] == $CellContext`kk], $CellContext`sw$ = 
           True]; $CellContext`sw$], $CellContext`l = 
       21, $CellContext`a = {8, 2}, $CellContext`b = {8, 4}, $CellContext`ax = 
       8, $CellContext`ay = 2, $CellContext`bx = 8, $CellContext`by = 
       4, $CellContext`olds = 0, $CellContext`oldt = 
       0, $CellContext`list1 = {{{0, 0}, {0, 0}}, {{1, 2}, {1, 3}}, {{1, 2}, {
        1, 4}}, {{2, 1}, {1, 3}}, {{2, 1}, {3, 3}}, {{2, 2}, {2, 3}}, {{2, 
        2}, {2, 4}}, {{3, 2}, {3, 3}}, {{3, 2}, {3, 4}}, {{4, 2}, {4, 3}}, {{
        4, 2}, {4, 4}}, {{5, 2}, {5, 3}}, {{5, 2}, {5, 4}}, {{6, 2}, {6, 
        3}}, {{6, 2}, {6, 4}}, {{7, 1}, {6, 3}}, {{7, 1}, {8, 3}}, {{7, 2}, {
        7, 3}}, {{7, 2}, {7, 4}}, {{8, 2}, {8, 3}}, {{8, 2}, {8, 
        4}}}, $CellContext`board = {
         RGBColor[0.7, 0.7, 0.5], 
         Polygon[{{0, 0}, {8, 0}, {8, 8}, {0, 8}}], 
         RGBColor[0.94, 0.91, 0.88], 
         Polygon[{{1, 0}, {1, 1}, {2, 1}, {2, 0}}], 
         Polygon[{{3, 0}, {3, 1}, {4, 1}, {4, 0}}], 
         Polygon[{{5, 0}, {5, 1}, {6, 1}, {6, 0}}], 
         Polygon[{{7, 0}, {7, 1}, {8, 1}, {8, 0}}], 
         Polygon[{{0, 1}, {0, 2}, {1, 2}, {1, 1}}], 
         Polygon[{{2, 1}, {2, 2}, {3, 2}, {3, 1}}], 
         Polygon[{{4, 1}, {4, 2}, {5, 2}, {5, 1}}], 
         Polygon[{{6, 1}, {6, 2}, {7, 2}, {7, 1}}], 
         Polygon[{{1, 2}, {1, 3}, {2, 3}, {2, 2}}], 
         Polygon[{{3, 2}, {3, 3}, {4, 3}, {4, 2}}], 
         Polygon[{{5, 2}, {5, 3}, {6, 3}, {6, 2}}], 
         Polygon[{{7, 2}, {7, 3}, {8, 3}, {8, 2}}], 
         Polygon[{{0, 3}, {0, 4}, {1, 4}, {1, 3}}], 
         Polygon[{{2, 3}, {2, 4}, {3, 4}, {3, 3}}], 
         Polygon[{{4, 3}, {4, 4}, {5, 4}, {5, 3}}], 
         Polygon[{{6, 3}, {6, 4}, {7, 4}, {7, 3}}], 
         Polygon[{{1, 4}, {1, 5}, {2, 5}, {2, 4}}], 
         Polygon[{{3, 4}, {3, 5}, {4, 5}, {4, 4}}], 
         Polygon[{{5, 4}, {5, 5}, {6, 5}, {6, 4}}], 
         Polygon[{{7, 4}, {7, 5}, {8, 5}, {8, 4}}], 
         Polygon[{{0, 5}, {0, 6}, {1, 6}, {1, 5}}], 
         Polygon[{{2, 5}, {2, 6}, {3, 6}, {3, 5}}], 
         Polygon[{{4, 5}, {4, 6}, {5, 6}, {5, 5}}], 
         Polygon[{{6, 5}, {6, 6}, {7, 6}, {7, 5}}], 
         Polygon[{{1, 6}, {1, 7}, {2, 7}, {2, 6}}], 
         Polygon[{{3, 6}, {3, 7}, {4, 7}, {4, 6}}], 
         Polygon[{{5, 6}, {5, 7}, {6, 7}, {6, 6}}], 
         Polygon[{{7, 6}, {7, 7}, {8, 7}, {8, 6}}], 
         Polygon[{{0, 7}, {0, 8}, {1, 8}, {1, 7}}], 
         Polygon[{{2, 7}, {2, 8}, {3, 8}, {3, 7}}], 
         Polygon[{{4, 7}, {4, 8}, {5, 8}, {5, 7}}], 
         Polygon[{{6, 7}, {6, 8}, {7, 8}, {7, 7}}], 
         GrayLevel[0.5], {
          Line[{{1, 0}, {1, 8}}], 
          Line[{{2, 0}, {2, 8}}], 
          Line[{{3, 0}, {3, 8}}], 
          Line[{{4, 0}, {4, 8}}], 
          Line[{{5, 0}, {5, 8}}], 
          Line[{{6, 0}, {6, 8}}], 
          Line[{{7, 0}, {7, 8}}]}, {
          Line[{{0, 1}, {8, 1}}], 
          Line[{{0, 2}, {8, 2}}], 
          Line[{{0, 3}, {8, 3}}], 
          Line[{{0, 4}, {8, 4}}], 
          Line[{{0, 5}, {8, 5}}], 
          Line[{{0, 6}, {8, 6}}], 
          Line[{{0, 7}, {8, 7}}]}, 
         GrayLevel[0], 
         Line[{{0, 0}, {0, 8}, {8, 8}, {8, 0}, {0, 0}}], {
          RGBColor[0, 0, 1], 
          Thickness[Large]}, 
         Line[{{-0.1, -0.1}, {-0.1, 8.1}, {8.1, 8.1}, {
          8.1, -0.1}, {-0.1, -0.1}}]}, $CellContext`pawn = 
       Disk[{-0.5, -0.5}, 0.35], $CellContext`rook = 
       Polygon[{{-0.9, -0.9}, {-0.09999999999999998, -0.9}, \
{-0.09999999999999998, -0.7}, {-0.30000000000000004`, -0.5}, \
{-0.09999999999999998, -0.30000000000000004`}, {-0.09999999999999998, \
-0.09999999999999998}, {-0.9, -0.09999999999999998}, {-0.9, \
-0.30000000000000004`}, {-0.7, -0.5}, {-0.9, -0.7}}], $CellContext`knight = 
       Polygon[{{-0.9, -0.9}, {-0.09999999999999998, -0.9}, \
{-0.09999999999999998, -0.6}, {-0.4, -0.6}, {-0.4, -0.4}, \
{-0.09999999999999998, -0.30000000000000004`}, {-0.09999999999999998, \
-0.09999999999999998}, {-0.6, -0.09999999999999998}, {-0.6, -0.6}, {-0.9, \
-0.6}}], $CellContext`bishop = 
       Polygon[{{-0.9, -0.9}, {-0.09999999999999998, -0.9}, {-0.5, \
-0.09999999999999998}}], $CellContext`queen = 
       Polygon[{{-0.9, -0.9}, {-0.09999999999999998, -0.9}, {-0.4, -0.6}, \
{-0.19999999999999996`, -0.30000000000000004`}, {-0.5, -0.09999999999999998}, \
{-0.8, -0.30000000000000004`}, {-0.6, -0.6}}], $CellContext`king = 
       Polygon[{{-0.9, -0.9}, {-0.09999999999999998, -0.9}, \
{-0.09999999999999998, -0.09999999999999998}, {-0.30000000000000004`, \
-0.30000000000000004`}, {-0.5, -0.09999999999999998}, {-0.7, \
-0.30000000000000004`}, {-0.9, -0.09999999999999998}}], $CellContext`names = {
        " ", "R", "N", "B", "Q", "K"}, $CellContext`alpha = {
        "a", "b", "c", "d", "e", "f", "g", "h", 
         "..."}, $CellContext`side0 = {{1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 
        0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
        0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 0, -1, -1}, {
        1, 1, 0, 0, 0, 0, -1, -1}, {1, 1, 0, 0, 0, 
        0, -1, -1}}, $CellContext`type0 = {{2, 1, 0, 0, 0, 0, 1, 2}, {3, 1, 0,
         0, 0, 0, 1, 3}, {4, 1, 0, 0, 0, 0, 1, 4}, {5, 1, 0, 0, 0, 0, 1, 5}, {
        6, 1, 0, 0, 0, 0, 1, 6}, {4, 1, 0, 0, 0, 0, 1, 4}, {3, 1, 0, 0, 0, 0, 
        1, 3}, {2, 1, 0, 0, 0, 0, 1, 2}}, $CellContext`all0 = {{0, 0, 0, 0, 0,
         0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 
        0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 
        0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}}}; 
     Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.35696210375764*^9, 3.404836196558592*^9, 3.404836269663712*^9, 
   3.404836408873886*^9, 3.4048365510683517`*^9, 3.4048716288690305`*^9, 
   3.4048718933092766`*^9, 3.404872167713851*^9, 3.404872416411461*^9, 
   3.404872924802491*^9, 3.404873037965211*^9, 3.4048732462647314`*^9, 
   3.4048733844634514`*^9, 3.404873552705371*^9, 3.4048737249630656`*^9, 
   3.404874484044571*^9, 3.404874989571483*^9, 3.404875987356227*^9, 
   3.404876670138019*^9, 3.404876953545539*^9, 3.404877042723771*^9, 
   3.4048775867961087`*^9, 3.4048776335132847`*^9, 3.4048777787721567`*^9, 
   3.404878160320797*^9, 3.404878218404317*^9, 3.4048858903446145`*^9, 
   3.404886017387293*^9, 3.404886080958704*^9, 3.404886254127709*^9, 
   3.4048865511948705`*^9, 3.404887475844451*^9, 3.4048875084413233`*^9, 
   3.404887548448851*^9, 3.4048879063334637`*^9, 3.4048880141084366`*^9, 
   3.4048880758972845`*^9, 3.404888341058568*^9, 3.404888486918304*^9, 
   3.4048885760064063`*^9, 3.40488865205576*^9, 3.404888748774835*^9, 
   3.4048890442697363`*^9, 3.4048894689103394`*^9, 3.4048896054166255`*^9, 
   3.4049210101895633`*^9, 3.4049218545536995`*^9, 3.4049230541886897`*^9, 
   3.4049233014342113`*^9, 3.404923440273853*^9, 3.4049235057179565`*^9, 
   3.40492396040176*^9, {3.404923995512246*^9, 3.404924015701277*^9}, 
   3.404924119961195*^9, 3.404924579141464*^9, 3.405034898546605*^9, {
   3.4050349377429667`*^9, 3.4050349652324944`*^9}, 3.4055549600013423`*^9},
 CellID->50149262]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "DetailsSection"],

Cell["\<\
A small black marker on the left border shows whose turn it is.\
\>", "DetailNotes",
 CellChangeTimes->{
  3.35696210375764*^9, {3.4194502256135745`*^9, 3.419450308673008*^9}, {
   3.4195510645536704`*^9, 3.4195510851633053`*^9}, 3.419827044437475*^9, {
   3.4359430781400414`*^9, 3.4359430784994164`*^9}},
 CellID->568991858],

Cell["\<\
To make a move, first click the from-position (it will be marked) and then \
the to-position. If you click a from-position but change your mind and want \
to move a different piece, click the same position again.\
\>", "DetailNotes",
 CellChangeTimes->{
  3.35696210375764*^9, 3.4194502256135745`*^9, {3.419450272380822*^9, 
   3.419450278529664*^9}, {3.4194503165242977`*^9, 3.419450372745139*^9}, {
   3.4198271144080877`*^9, 3.419827116140579*^9}, {3.420210894561703*^9, 
   3.420210899061703*^9}, {3.4326582561282816`*^9, 3.432658262377267*^9}},
 CellID->142369034],

Cell["\<\
The \"show moves\" checkbox displays all current legal moves as green arrows, \
assuming no piece has been selected yet.\
\>", "DetailNotes",
 CellChangeTimes->{
  3.35696210375764*^9, {3.4041151135847406`*^9, 3.4041151221871104`*^9}, {
   3.404115168513725*^9, 3.4041151893937488`*^9}, {3.4041473291607776`*^9, 
   3.40414734013656*^9}, {3.4359430971400414`*^9, 3.4359431589994164`*^9}, {
   3.4361103195225077`*^9, 3.436110321312687*^9}},
 CellID->393421744],

Cell["\<\
Once you click a from-position, all target-positions will be marked green. \
You can switch this feature off  with the \"show targets\" checkbox.\
\>", "DetailNotes",
 CellChangeTimes->{
  3.35696210375764*^9, 3.4041151897642813`*^9, {3.4041473633799825`*^9, 
   3.404147387574773*^9}, {3.4359431699994164`*^9, 3.4359431815619164`*^9}, {
   3.4361103358861446`*^9, 3.436110337636319*^9}},
 CellID->319443538],

Cell["\<\
The options \"show moves\" and \"show targets\" are temporarily inactivated \
while looking at historic moves.\
\>", "DetailNotes",
 CellChangeTimes->{
  3.35696210375764*^9, {3.4041473897478976`*^9, 3.404147447220539*^9}, 
   3.4359431884369164`*^9},
 CellID->159159791],

Cell["\<\
Set the option \"random Black\" to allow the Black player to make random \
moves. After your move for White, click the board anywhere to cause Black's \
random move. \
\>", "DetailNotes",
 CellChangeTimes->{
  3.35696210375764*^9, 3.4041151696653805`*^9, {3.4041210366917505`*^9, 
   3.4041211354437485`*^9}, 3.4041211880594063`*^9, {3.404121224451736*^9, 
   3.4041212530929203`*^9}, 3.4041213026742144`*^9, {3.4041218599255023`*^9, 
   3.404121890158976*^9}, 3.4041441642098017`*^9, {3.404147489170861*^9, 
   3.404147489170861*^9}, {3.4359431976712914`*^9, 3.4359432311087914`*^9}},
 CellID->188883139],

Cell["\<\
Similarly the \"random White\" option creates random moves for White.\
\>", "DetailNotes",
 CellChangeTimes->{
  3.35696210375764*^9, {3.404147496241027*^9, 3.404147529508864*^9}},
 CellID->75184241],

Cell["\<\
To promote a pawn, select the piece you want from the associated popup menu \
first. \
\>", "DetailNotes",
 CellChangeTimes->{
  3.35696210375764*^9, {3.419450454582816*^9, 3.4194505030424976`*^9}, {
   3.419827096312067*^9, 3.419827096312067*^9}, 3.420210918686703*^9, {
   3.4203821685762205`*^9, 3.4203821763649993`*^9}},
 CellID->776764227],

Cell["\<\
The last move by both sides is  displayed at the bottom of the screen.\
\>", "DetailNotes",
 CellChangeTimes->{
  3.35696210375764*^9, 3.4198270967927585`*^9, {3.419827139414045*^9, 
   3.419827139414045*^9}},
 CellID->5291711],

Cell["\<\
You can look at all previous moves simply by adjusting the history slider. No \
chess moves can be made while historic moves are being viewed.\
\>", "DetailNotes",
 CellID->265211612],

Cell[TextData[StyleBox["The Editing Menu",
 FontWeight->"Bold"]], "DetailNotes",
 CellChangeTimes->{
  3.35696210375764*^9, {3.436110347858341*^9, 3.436110353616917*^9}},
 CellID->273781669],

Cell["\<\
You can edit the board at any stage in the game by using the editing menu.\
\>", "DetailNotes",
 CellChangeTimes->{
  3.35696210375764*^9, {3.4194504220961027`*^9, 3.4194504434968753`*^9}, {
   3.4194505094817567`*^9, 3.4194505209782877`*^9}, {3.4195508779353266`*^9, 
   3.4041212797212095`*^9}, {3.4359432577494164`*^9, 3.4359432588587914`*^9}},
 
 CellID->239245866],

Cell["\<\
Select a piece type and then click the board to add such a piece.\
\>", "DetailNotes",
 CellChangeTimes->{
  3.35696210375764*^9, {3.419550883803765*^9, 3.4012672432996273`*^9}, {
   3.4359433356869164`*^9, 3.4359433367181664`*^9}},
 CellID->326968025],

Cell["\<\
Select the \"castling options\" and then click a rook to switch a castling \
option on  or off (green or red marker). \
\>", "DetailNotes",
 CellChangeTimes->{
  3.35696210375764*^9, {3.419550904012824*^9, 3.4195509875128913`*^9}, {
   3.419551142806192*^9, 3.419551142806192*^9}, {3.4203821901013727`*^9, 
   3.420382192803643*^9}, {3.4359433569369164`*^9, 3.4359433640931664`*^9}},
 CellID->102488541],

Cell["\<\
Select the \"delete\" option and then click a piece to remove it from the \
board. \
\>", "DetailNotes",
 CellChangeTimes->{
  3.35696210375764*^9, {3.419551143336955*^9, 3.419551167311429*^9}, {
   3.41955257080956*^9, 3.41955257080956*^9}, {3.420382196150978*^9, 
   3.420382198098172*^9}},
 CellID->532196296],

Cell["\<\
Select the \"clear\" option and then click the board anywhere to empty it. \
\>", "DetailNotes",
 CellChangeTimes->{
  3.35696210375764*^9, {3.4195525712301645`*^9, 3.4195525931016145`*^9}, {
   3.4195526785945473`*^9, 3.419552680166808*^9}, {3.4203822035887213`*^9, 
   3.420382205882951*^9}},
 CellID->70383717],

Cell["\<\
Select the \"reset\" option and then click the board anywhere to recreate the \
original setup. The system will automatically go into \"play\" mode. \
\>", "DetailNotes",
 CellChangeTimes->{
  3.35696210375764*^9, {3.419552593512205*^9, 3.4195526132606015`*^9}, {
   3.4195526849536915`*^9, 3.419552686395765*^9}, 3.4196248291187105`*^9, {
   3.420382208205183*^9, 3.420382210230386*^9}, {3.4230393079763117`*^9, 
   3.4230393237089343`*^9}, {3.4230393612729487`*^9, 3.4049223412935967`*^9}},
 
 CellID->66349836],

Cell["\<\
Select the \"next player\" option and then click the board anywhere to change \
whose turn it is. This option is only available as long as no moves have been \
executed. The option can be used for setting up chess problems with Black to \
move, for example.\
\>", "DetailNotes",
 CellChangeTimes->{
  3.35696210375764*^9, {3.419552614151883*^9, 3.4195526577145233`*^9}, {
   3.4195526884387026`*^9, 3.419552689099653*^9}, {3.419624908442773*^9, 
   3.419624908502859*^9}, {3.4198271476959534`*^9, 3.4198271476959534`*^9}, {
   3.4203822125326157`*^9, 3.420382214785841*^9}, {3.4230393641871395`*^9, 
   3.423039402882781*^9}, {3.423073069454582*^9, 3.4012672678449216`*^9}, {
   3.4041132308174543`*^9, 3.404113230827469*^9}, {3.4041212098106833`*^9, 
   3.4041212113128433`*^9}},
 CellID->826774252]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ControlSuggestionsSection"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Resize Images"]}],
  "\"Click inside an image to reveal its orange resize frame.\\nDrag any of \
the orange resize handles to resize the image.\"",
  ActionDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->"ResizeImages"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Rotate and Zoom in 3D"]}],
  RowBox[{
   "\"Drag a 3D graphic to rotate it. Starting the drag near the center \
tumbles\\nthe graphic; starting near a corner turns it parallel to the plane \
of the screen.\\nHold down \"", 
    FrameBox[
    "Ctrl", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" (or \"", 
    FrameBox[
    "Cmd", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" on Mac) and drag up and down to zoom.\""}],
  ActionDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->"RotateAndZoomIn3D"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Drag Locators"]}],
  RowBox[{"\"Drag any locator (\"", 
    GraphicsBox[
     LocatorBox[
      Scaled[{0.5, 0.5}]], ImageSize -> 20], 
    "\", etc.) to move it around.\""}],
  ActionDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.35696210375764*^9, 3.4155884569855905`*^9, 
  3.4194459318348093`*^9},
 FontFamily->"Verdana",
 CellTags->"DragLocators"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Create and Delete Locators"]}],
  RowBox[{"\"Insert a new locator in the graphic by holding down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], 
    "\" key\\nand clicking where you want it to be. Delete a locator by \
clicking it\\nwhile holding down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" key.\""}],
  ActionDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.35696210375764*^9, 3.4159863994436336`*^9, 
  3.4194459323555584`*^9},
 FontFamily->"Verdana",
 CellTags->"CreateAndDeleteLocators"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Slider Zoom"]}],
  RowBox[{"\"Hold down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], 
    "\" key while moving a slider to make fine adjustments in the slider \
value.\\nHold \"", 
    FrameBox[
    "Ctrl", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" and/or \"", 
    FrameBox[
    "Shift", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" at the same time as \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" to make ever finer adjustments.\""}],
  ActionDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->"SliderZoom"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Gamepad Controls"]}],
  "\"Control this Demonstration with a gamepad or other\\nhuman interface \
device connected to your computer.\"",
  ActionDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.35696210375764*^9, 3.3895522232313623`*^9},
 FontFamily->"Verdana",
 CellTags->"GamepadControls"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Automatic Animation"]}],
  RowBox[{"\"Animate a slider in this Demonstration by clicking the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJzzTSzJSM1NLMlMTlRwL0osyMhMLlZwyy8CCjEzMjAwcIKwAgOI/R/IhBKc\n\
/4EAyGAG0f+nTZsGwgysIJIRKsWKLAXGIHFmEpUgLADxWUAkI24jZs+eTaEt\n\
IG+wQKRmzJgBlYf5lhEA30OqWA=="], "Graphics", ImageSize -> {9, 9}, ImageMargins -> 
      0], BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"button\\nnext to the slider, and then clicking the play button that \
appears.\\nAnimate all controls by selecting \"", 
    StyleBox["Autorun", FontWeight -> "Bold"], "\" from the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJyNULENwyAQfEySIlMwTVJlCGRFsosokeNtqBmDBagoaZjAI1C8/8GUUUC6\n\
57h7cQ8PvU7Pl17nUav7oj/TPH7V7b2QJAUAXBkKmCPRowxICy64bRvGGNF7\n\
X8CctGoDSN4xhIDGGDhzFXwUh3/ClBKrDQPmnGXtI6u0OOd+tZBVUqy1xSaH\n\
UqiK6pPe4XdEdAz6563tx/gejuORGMxJaz8mdpJn7hc="], "Graphics", 
      ImageSize -> {10, 10}, ImageMargins -> 0], BoxBaselineShift -> 
     0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"menu.\""}],
  ActionDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->"AutomaticAnimation"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Bookmark Animation"]}],
  RowBox[{
   "\"See a prepared animation of this Demonstration by selecting\\n\"", 
    StyleBox["Animate Bookmarks", FontWeight -> "Bold"], "\" from the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJyNULENwyAQfEySIlMwTVJlCGRFsosokeNtqBmDBagoaZjAI1C8/8GUUUC6\n\
57h7cQ8PvU7Pl17nUav7oj/TPH7V7b2QJAUAXBkKmCPRowxICy64bRvGGNF7\n\
X8CctGoDSN4xhIDGGDhzFXwUh3/ClBKrDQPmnGXtI6u0OOd+tZBVUqy1xSaH\n\
UqiK6pPe4XdEdAz6563tx/gejuORGMxJaz8mdpJn7hc="], "Graphics", 
      ImageSize -> {10, 10}, ImageMargins -> 0], BoxBaselineShift -> 
     0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"menu.\""}],
  ActionDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->"BookmarkAnimation"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SearchTermsSection"],

Cell["chess", "SearchTerms",
 CellChangeTimes->{
  3.35696210375764*^9, {3.4155885109531918`*^9, 3.4155885121348915`*^9}, {
   3.4159864178501005`*^9, 3.4159864217256737`*^9}, {3.4161626766190357`*^9, 
   3.4161626767284107`*^9}, {3.4195527233889585`*^9, 3.4195527242101393`*^9}},
 
 CellID->165533380],

Cell["boardgame", "SearchTerms",
 CellChangeTimes->{
  3.35696210375764*^9, {3.4159864363667264`*^9, 3.4159864374182386`*^9}, {
   3.4161626795721607`*^9, 3.4161626841346607`*^9}, {3.4195527275649633`*^9, 
   3.4195527295077567`*^9}},
 CellID->22494708],

Cell["", "SearchTerms",
 CellChangeTimes->{
  3.35696210375764*^9, {3.4159864363667264`*^9, 3.4159864374182386`*^9}, {
   3.4161626795721607`*^9, 3.4161626841346607`*^9}, {3.419552733193056*^9, 
   3.419552734094352*^9}},
 CellID->175062413]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "RelatedLinksSection"],

Cell[TextData[ButtonBox["Chess",
 BaseStyle->"Hyperlink",
 ButtonData->{
   URL["http://mathworld.wolfram.com/Chess.html"], None}]], "RelatedLinks",
 CellChangeTimes->{
  3.35696210375764*^9, {3.420299509977521*^9, 3.42029951556708*^9}},
 CellID->380406321]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "AuthorSection"],

Cell[TextData[{
 "Contributed by: ",
 ButtonBox["Karl Scherer",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/author.html?author=Karl+Scherer"], 
    None},
  ButtonNote->
   "http://demonstrations.wolfram.com/author.html?author=Karl+Scherer"]
}], "Author",
 CellChangeTimes->{
  3.35696210375764*^9, {3.415588575956662*^9, 3.4155885783701324`*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{970, 606},
WindowMargins->{{3, Automatic}, {Automatic, 24}},
FrontEndVersion->"6.0 for Microsoft Windows (64-bit) (May 21, 2008)",
StyleDefinitions->FrontEnd`FileName[{"Wolfram"}, "Demonstration.nb", 
  CharacterEncoding -> "WindowsANSI"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "ResizeImages"->{
  Cell[772163, 15683, 311, 8, 22, "ControlSuggestions",
   CellTags->"ResizeImages"]},
 "RotateAndZoomIn3D"->{
  Cell[772477, 15693, 677, 16, 22, "ControlSuggestions",
   CellTags->"RotateAndZoomIn3D"]},
 "DragLocators"->{
  Cell[773157, 15711, 431, 13, 22, "ControlSuggestions",
   CellTags->"DragLocators"]},
 "CreateAndDeleteLocators"->{
  Cell[773591, 15726, 728, 17, 22, "ControlSuggestions",
   CellTags->"CreateAndDeleteLocators"]},
 "SliderZoom"->{
  Cell[774322, 15745, 843, 21, 22, "ControlSuggestions",
   CellTags->"SliderZoom"]},
 "GamepadControls"->{
  Cell[775168, 15768, 368, 9, 22, "ControlSuggestions",
   CellTags->"GamepadControls"]},
 "AutomaticAnimation"->{
  Cell[775539, 15779, 1411, 31, 22, "ControlSuggestions",
   CellTags->"AutomaticAnimation"]},
 "BookmarkAnimation"->{
  Cell[776953, 15812, 881, 21, 22, "ControlSuggestions",
   CellTags->"BookmarkAnimation"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"ResizeImages", 779885, 15906},
 {"RotateAndZoomIn3D", 779996, 15909},
 {"DragLocators", 780108, 15912},
 {"CreateAndDeleteLocators", 780226, 15915},
 {"SliderZoom", 780342, 15918},
 {"GamepadControls", 780450, 15921},
 {"AutomaticAnimation", 780565, 15924},
 {"BookmarkAnimation", 780684, 15927}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[590, 23, 219, 4, 74, "DemoTitle"],
Cell[CellGroupData[{
Cell[834, 31, 33, 0, 156, "InitializationSection"],
Cell[870, 33, 58564, 1460, 2968, "Input",
 InitializationCell->True,
 CellID->551978520]
}, Closed]],
Cell[CellGroupData[{
Cell[59471, 1498, 29, 0, 188, "ManipulateSection"],
Cell[CellGroupData[{
Cell[59525, 1502, 238754, 5195, 11468, "Input",
 CellID->289034776],
Cell[298282, 6699, 92644, 1746, 469, "Output",
 CellID->60040281]
}, {2}]]
}, Open  ]],
Cell[CellGroupData[{
Cell[390972, 8451, 36, 0, 136, "ManipulateCaptionSection"],
Cell[391011, 8453, 678, 12, 22, "ManipulateCaption",
 CellID->173026597],
Cell[391692, 8467, 279, 5, 22, "ManipulateCaption",
 CellID->147701185]
}, Open  ]],
Cell[CellGroupData[{
Cell[392008, 8477, 28, 0, 168, "ThumbnailSection"],
Cell[392039, 8479, 93322, 1752, 469, "Output",
 CellID->887323984]
}, Open  ]],
Cell[CellGroupData[{
Cell[485398, 10236, 28, 0, 138, "SnapshotsSection"],
Cell[485429, 10238, 93336, 1753, 469, "Output",
 CellID->76637251],
Cell[578768, 11993, 93320, 1752, 469, "Output",
 CellID->85663174],
Cell[672091, 13747, 92964, 1748, 469, "Output",
 CellID->50149262]
}, Open  ]],
Cell[CellGroupData[{
Cell[765092, 15500, 26, 0, 232, "DetailsSection"],
Cell[765121, 15502, 336, 7, 22, "DetailNotes",
 CellID->568991858],
Cell[765460, 15511, 579, 10, 37, "DetailNotes",
 CellID->142369034],
Cell[766042, 15523, 470, 9, 22, "DetailNotes",
 CellID->393421744],
Cell[766515, 15534, 418, 8, 37, "DetailNotes",
 CellID->319443538],
Cell[766936, 15544, 281, 7, 22, "DetailNotes",
 CellID->159159791],
Cell[767220, 15553, 615, 11, 37, "DetailNotes",
 CellID->188883139],
Cell[767838, 15566, 209, 5, 22, "DetailNotes",
 CellID->75184241],
Cell[768050, 15573, 354, 8, 22, "DetailNotes",
 CellID->776764227],
Cell[768407, 15583, 237, 6, 22, "DetailNotes",
 CellID->5291711],
Cell[768647, 15591, 193, 4, 37, "DetailNotes",
 CellID->265211612],
Cell[768843, 15597, 190, 4, 22, "DetailNotes",
 CellID->273781669],
Cell[769036, 15603, 379, 8, 22, "DetailNotes",
 CellID->239245866],
Cell[769418, 15613, 262, 6, 22, "DetailNotes",
 CellID->326968025],
Cell[769683, 15621, 413, 8, 22, "DetailNotes",
 CellID->102488541],
Cell[770099, 15631, 322, 8, 22, "DetailNotes",
 CellID->532196296],
Cell[770424, 15641, 323, 7, 22, "DetailNotes",
 CellID->70383717],
Cell[770750, 15650, 523, 10, 37, "DetailNotes",
 CellID->66349836],
Cell[771276, 15662, 810, 14, 37, "DetailNotes",
 CellID->826774252]
}, Open  ]],
Cell[CellGroupData[{
Cell[772123, 15681, 37, 0, 120, "ControlSuggestionsSection"],
Cell[772163, 15683, 311, 8, 22, "ControlSuggestions",
 CellTags->"ResizeImages"],
Cell[772477, 15693, 677, 16, 22, "ControlSuggestions",
 CellTags->"RotateAndZoomIn3D"],
Cell[773157, 15711, 431, 13, 22, "ControlSuggestions",
 CellTags->"DragLocators"],
Cell[773591, 15726, 728, 17, 22, "ControlSuggestions",
 CellTags->"CreateAndDeleteLocators"],
Cell[774322, 15745, 843, 21, 22, "ControlSuggestions",
 CellTags->"SliderZoom"],
Cell[775168, 15768, 368, 9, 22, "ControlSuggestions",
 CellTags->"GamepadControls"],
Cell[775539, 15779, 1411, 31, 22, "ControlSuggestions",
 CellTags->"AutomaticAnimation"],
Cell[776953, 15812, 881, 21, 22, "ControlSuggestions",
 CellTags->"BookmarkAnimation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[777871, 15838, 30, 0, 152, "SearchTermsSection"],
Cell[777904, 15840, 302, 6, 22, "SearchTerms",
 CellID->165533380],
Cell[778209, 15848, 253, 5, 22, "SearchTerms",
 CellID->22494708],
Cell[778465, 15855, 241, 5, 22, "SearchTerms",
 CellID->175062413]
}, Open  ]],
Cell[CellGroupData[{
Cell[778743, 15865, 31, 0, 138, "RelatedLinksSection"],
Cell[778777, 15867, 257, 6, 22, "RelatedLinks",
 CellID->380406321]
}, Open  ]],
Cell[CellGroupData[{
Cell[779071, 15878, 25, 0, 136, "AuthorSection"],
Cell[779099, 15880, 388, 11, 22, "Author"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
